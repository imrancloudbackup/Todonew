!function(){return function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){return i(t[a][1][e]||e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}}()({1:[function(e,t,n){var r=e("randombytes"),i=e("create-hash");function o(){return r(16).toString("hex")}function a(e){e=e||{},this._genNonce=e.genNonce||o}a.Mechanism=a,a.prototype.name="DIGEST-MD5",a.prototype.clientFirst=!1,a.prototype.response=function(e){if(!this._completed){var t=e.serviceType+"/"+e.host;e.serviceName&&e.host!==e.serviceName&&(t+="/"+e.serviceName);var n=e.realm||this._realm||"",r=this._genNonce(),o="00000001",a="auth",s="";s+='username="'+e.username+'"',n&&(s+=',realm="'+n+'"'),s+=',nonce="'+this._nonce+'"',s+=',cnonce="'+r+'"',s+=",nc="+o,s+=",qop=auth",s+=',digest-uri="'+t+'"';var c=i("md5").update(e.username).update(":").update(n).update(":").update(e.password).digest(),u=i("md5").update(c).update(":").update(this._nonce).update(":").update(r);e.authzid&&u.update(":").update(e.authzid),u=u.digest("hex");var l=i("md5").update("AUTHENTICATE:").update(t);return l=l.digest("hex"),s+=",response="+i("md5").update(u).update(":").update(this._nonce).update(":").update(o).update(":").update(r).update(":").update(a).update(":").update(l).digest("hex"),"utf-8"===this._charset&&(s+=",charset=utf-8"),e.authzid&&(s+='authzid="'+e.authzid+'"'),s}},a.prototype.challenge=function(e){var t=function(e){for(var t={},n=e.split(/,(?=(?:[^"]|"[^"]*")*$)/),r=0,i=n.length;r<i;r++){var o=/(\w+)=["]?([^"]+)["]?$/.exec(n[r]);o&&(t[o[1]]=o[2])}return t}(e);return this._completed=!!t.rspauth,this._realm=t.realm,this._nonce=t.nonce,this._qop=(t.qop||"auth").split(","),this._stale=t.stale,this._maxbuf=parseInt(t.maxbuf)||65536,this._charset=t.charset,this._algo=t.algorithm,this._cipher=t.cipher,this._cipher&&this._cipher.split(","),this},t.exports=a},{"create-hash":28,randombytes:211}],2:[function(e,t,n){(function(e,n){!function(){var r,i,o={};function a(e){var t=!1;return function(){if(t)throw new Error("Callback was already called.");t=!0,e.apply(r,arguments)}}null!=(r=this)&&(i=r.async),o.noConflict=function(){return r.async=i,o};var s=Object.prototype.toString,c=Array.isArray||function(e){return"[object Array]"===s.call(e)},u=function(e,t){for(var n=0;n<e.length;n+=1)t(e[n],n,e)},l=function(e,t){if(e.map)return e.map(t);var n=[];return u(e,function(e,r,i){n.push(t(e,r,i))}),n},d=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};void 0!==e&&e.nextTick?(o.nextTick=e.nextTick,o.setImmediate=void 0!==n?function(e){n(e)}:o.nextTick):"function"==typeof n?(o.nextTick=function(e){n(e)},o.setImmediate=o.nextTick):(o.nextTick=function(e){setTimeout(e,0)},o.setImmediate=o.nextTick),o.each=function(e,t,n){if(n=n||function(){},!e.length)return n();var r=0;function i(t){t?(n(t),n=function(){}):(r+=1)>=e.length&&n()}u(e,function(e){t(e,a(i))})},o.forEach=o.each,o.eachSeries=function(e,t,n){if(n=n||function(){},!e.length)return n();var r=0,i=function(){t(e[r],function(t){t?(n(t),n=function(){}):(r+=1)>=e.length?n():i()})};i()},o.forEachSeries=o.eachSeries,o.eachLimit=function(e,t,n,r){p(t).apply(null,[e,n,r])},o.forEachLimit=o.eachLimit;var p=function(e){return function(t,n,r){if(r=r||function(){},!t.length||e<=0)return r();var i=0,o=0,a=0;!function s(){if(i>=t.length)return r();for(;a<e&&o<t.length;)a+=1,n(t[(o+=1)-1],function(e){e?(r(e),r=function(){}):(a-=1,(i+=1)>=t.length?r():s())})}()}},f=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[o.each].concat(t))}},h=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[o.eachSeries].concat(t))}},m=function(e,t,n,r){if(t=l(t,function(e,t){return{index:t,value:e}}),r){var i=[];e(t,function(e,t){n(e.value,function(n,r){i[e.index]=r,t(n)})},function(e){r(e,i)})}else e(t,function(e,t){n(e.value,function(e){t(e)})})};o.map=f(m),o.mapSeries=h(m),o.mapLimit=function(e,t,n,r){return v(t)(e,n,r)};var v=function(e){return function(e,t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[p(e)].concat(n))}}(e,m)};o.reduce=function(e,t,n,r){o.eachSeries(e,function(e,r){n(t,e,function(e,n){t=n,r(e)})},function(e){r(e,t)})},o.inject=o.reduce,o.foldl=o.reduce,o.reduceRight=function(e,t,n,r){var i=l(e,function(e){return e}).reverse();o.reduce(i,t,n,r)},o.foldr=o.reduceRight;var y=function(e,t,n,r){var i=[];e(t=l(t,function(e,t){return{index:t,value:e}}),function(e,t){n(e.value,function(n){n&&i.push(e),t()})},function(e){r(l(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};o.filter=f(y),o.filterSeries=h(y),o.select=o.filter,o.selectSeries=o.filterSeries;var g=function(e,t,n,r){var i=[];e(t=l(t,function(e,t){return{index:t,value:e}}),function(e,t){n(e.value,function(n){n||i.push(e),t()})},function(e){r(l(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};o.reject=f(g),o.rejectSeries=h(g);var S=function(e,t,n,r){e(t,function(e,t){n(e,function(n){n?(r(e),r=function(){}):t()})},function(e){r()})};o.detect=f(S),o.detectSeries=h(S),o.some=function(e,t,n){o.each(e,function(e,r){t(e,function(e){e&&(n(!0),n=function(){}),r()})},function(e){n(!1)})},o.any=o.some,o.every=function(e,t,n){o.each(e,function(e,r){t(e,function(e){e||(n(!1),n=function(){}),r()})},function(e){n(!0)})},o.all=o.every,o.sortBy=function(e,t,n){o.map(e,function(e,n){t(e,function(t,r){t?n(t):n(null,{value:e,criteria:r})})},function(e,t){if(e)return n(e);n(null,l(t.sort(function(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0}),function(e){return e.value}))})},o.auto=function(e,t){t=t||function(){};var n=d(e),r=n.length;if(!r)return t();var i={},a=[],s=function(e){a.unshift(e)},l=function(){r--,u(a.slice(0),function(e){e()})};s(function(){if(!r){var e=t;t=function(){},e(null,i)}}),u(n,function(n){var r=c(e[n])?e[n]:[e[n]],p=function(e){var r=Array.prototype.slice.call(arguments,1);if(r.length<=1&&(r=r[0]),e){var a={};u(d(i),function(e){a[e]=i[e]}),a[n]=r,t(e,a),t=function(){}}else i[n]=r,o.setImmediate(l)},f=r.slice(0,Math.abs(r.length-1))||[],h=function(){return t=function(e,t){return e&&i.hasOwnProperty(t)},r=!0,((e=f).reduce?e.reduce(t,r):(u(e,function(e,n,i){r=t(r,e,n,i)}),r))&&!i.hasOwnProperty(n);var e,t,r};if(h())r[r.length-1](p,i);else{var m=function(){h()&&(!function(e){for(var t=0;t<a.length;t+=1)if(a[t]===e)return void a.splice(t,1)}(m),r[r.length-1](p,i))};s(m)}})},o.retry=function(e,t,n){var r=[];"function"==typeof e&&(n=t,t=e,e=5),e=parseInt(e,10)||5;var i=function(i,a){for(var s=function(e,t){return function(n){e(function(e,r){n(!e||t,{err:e,result:r})},a)}};e;)r.push(s(t,!(e-=1)));o.series(r,function(e,t){t=t[t.length-1],(i||n)(t.err,t.result)})};return n?i():i},o.waterfall=function(e,t){if(t=t||function(){},!c(e)){var n=new Error("First argument to waterfall must be an array of functions");return t(n)}if(!e.length)return t();var r=function(e){return function(n){if(n)t.apply(null,arguments),t=function(){};else{var i=Array.prototype.slice.call(arguments,1),a=e.next();a?i.push(r(a)):i.push(t),o.setImmediate(function(){e.apply(null,i)})}}};r(o.iterator(e))()};var _=function(e,t,n){if(n=n||function(){},c(t))e.map(t,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},n);else{var r={};e.each(d(t),function(e,n){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[e]=i,n(t)})},function(e){n(e,r)})}};o.parallel=function(e,t){_({map:o.map,each:o.each},e,t)},o.parallelLimit=function(e,t,n){_({map:v(t),each:p(t)},e,n)},o.series=function(e,t){if(t=t||function(){},c(e))o.mapSeries(e,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},t);else{var n={};o.eachSeries(d(e),function(t,r){e[t](function(e){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),n[t]=i,r(e)})},function(e){t(e,n)})}},o.iterator=function(e){var t=function(n){var r=function(){return e.length&&e[n].apply(null,arguments),r.next()};return r.next=function(){return n<e.length-1?t(n+1):null},r};return t(0)},o.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var b=function(e,t,n,r){var i=[];e(t,function(e,t){n(e,function(e,n){i=i.concat(n||[]),t(e)})},function(e){r(e,i)})};o.concat=f(b),o.concatSeries=h(b),o.whilst=function(e,t,n){e()?t(function(r){if(r)return n(r);o.whilst(e,t,n)}):n()},o.doWhilst=function(e,t,n){e(function(r){if(r)return n(r);var i=Array.prototype.slice.call(arguments,1);t.apply(null,i)?o.doWhilst(e,t,n):n()})},o.until=function(e,t,n){e()?n():t(function(r){if(r)return n(r);o.until(e,t,n)})},o.doUntil=function(e,t,n){e(function(r){if(r)return n(r);var i=Array.prototype.slice.call(arguments,1);t.apply(null,i)?n():o.doUntil(e,t,n)})},o.queue=function(e,t){function n(e,t,n,r){if(e.started||(e.started=!0),c(t)||(t=[t]),0==t.length)return o.setImmediate(function(){e.drain&&e.drain()});u(t,function(t){var i={data:t,callback:"function"==typeof r?r:null};n?e.tasks.unshift(i):e.tasks.push(i),e.saturated&&e.tasks.length===e.concurrency&&e.saturated(),o.setImmediate(e.process)})}void 0===t&&(t=1);var r=0,i={tasks:[],concurrency:t,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(e,t){n(i,e,!1,t)},kill:function(){i.drain=null,i.tasks=[]},unshift:function(e,t){n(i,e,!0,t)},process:function(){if(!i.paused&&r<i.concurrency&&i.tasks.length){var t=i.tasks.shift();i.empty&&0===i.tasks.length&&i.empty(),r+=1;var n=a(function(){r-=1,t.callback&&t.callback.apply(t,arguments),i.drain&&i.tasks.length+r===0&&i.drain(),i.process()});e(t.data,n)}},length:function(){return i.tasks.length},running:function(){return r},idle:function(){return i.tasks.length+r===0},pause:function(){!0!==i.paused&&(i.paused=!0)},resume:function(){if(!1!==i.paused){i.paused=!1;for(var e=1;e<=i.concurrency;e++)o.setImmediate(i.process)}}};return i},o.priorityQueue=function(e,t){function n(e,t){return e.priority-t.priority}var r=o.queue(e,t);return r.push=function(e,t,i){!function(e,t,r,i){if(e.started||(e.started=!0),c(t)||(t=[t]),0==t.length)return o.setImmediate(function(){e.drain&&e.drain()});u(t,function(t){var a={data:t,priority:r,callback:"function"==typeof i?i:null};e.tasks.splice(function(e,t,n){for(var r=-1,i=e.length-1;r<i;){var o=r+(i-r+1>>>1);n(t,e[o])>=0?r=o:i=o-1}return r}(e.tasks,a,n)+1,0,a),e.saturated&&e.tasks.length===e.concurrency&&e.saturated(),o.setImmediate(e.process)})}(r,e,t,i)},delete r.unshift,r},o.cargo=function(e,t){var n=!1,r=[],i={tasks:r,payload:t,saturated:null,empty:null,drain:null,drained:!0,push:function(e,n){c(e)||(e=[e]),u(e,function(e){r.push({data:e,callback:"function"==typeof n?n:null}),i.drained=!1,i.saturated&&r.length===t&&i.saturated()}),o.setImmediate(i.process)},process:function o(){if(!n){if(0===r.length)return i.drain&&!i.drained&&i.drain(),void(i.drained=!0);var a="number"==typeof t?r.splice(0,t):r.splice(0,r.length),s=l(a,function(e){return e.data});i.empty&&i.empty(),n=!0,e(s,function(){n=!1;var e=arguments;u(a,function(t){t.callback&&t.callback.apply(null,e)}),o()})}},length:function(){return r.length},running:function(){return n}};return i};var C=function(e){return function(t){var n=Array.prototype.slice.call(arguments,1);t.apply(null,n.concat([function(t){var n=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[e]&&u(n,function(t){console[e](t)}))}]))}};o.log=C("log"),o.dir=C("dir"),o.memoize=function(e,t){var n={},r={};t=t||function(e){return e};var i=function(){var i=Array.prototype.slice.call(arguments),a=i.pop(),s=t.apply(null,i);s in n?o.nextTick(function(){a.apply(null,n[s])}):s in r?r[s].push(a):(r[s]=[a],e.apply(null,i.concat([function(){n[s]=arguments;var e=r[s];delete r[s];for(var t=0,i=e.length;t<i;t++)e[t].apply(null,arguments)}])))};return i.memo=n,i.unmemoized=e,i},o.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},o.times=function(e,t,n){for(var r=[],i=0;i<e;i++)r.push(i);return o.map(r,t,n)},o.timesSeries=function(e,t,n){for(var r=[],i=0;i<e;i++)r.push(i);return o.mapSeries(r,t,n)},o.seq=function(){var e=arguments;return function(){var t=this,n=Array.prototype.slice.call(arguments),r=n.pop();o.reduce(e,n,function(e,n,r){n.apply(t,e.concat([function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);r(e,t)}]))},function(e,n){r.apply(t,[e].concat(n))})}},o.compose=function(){return o.seq.apply(null,Array.prototype.reverse.call(arguments))};var w=function(e,t){var n=function(){var n=this,r=Array.prototype.slice.call(arguments),i=r.pop();return e(t,function(e,t){e.apply(n,r.concat([t]))},i)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return n.apply(this,r)}return n};o.applyEach=f(w),o.applyEachSeries=h(w),o.forever=function(e,t){!function n(r){if(r){if(t)return t(r);throw r}e(n)}()},void 0!==t&&t.exports?t.exports=o:"undefined"!=typeof define&&define.amd?define([],function(){return o}):r.async=o}()}).call(this,e("_process"),e("timers").setImmediate)},{_process:8,timers:326}],3:[function(e,t,n){t.exports={default:e("core-js/library/fn/object/assign"),__esModule:!0}},{"core-js/library/fn/object/assign":13}],4:[function(e,t,n){"use strict";n.default=function(e){return e&&e.__esModule?e:{default:e}},n.__esModule=!0},{}],5:[function(e,t,n){"use strict";n.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},n.toByteArray=function(e){for(var t,n=u(e),r=n[0],a=n[1],s=new o(function(e,t,n){return 3*(t+n)/4-n}(0,r,a)),c=0,l=a>0?r-4:r,d=0;d<l;d+=4)t=i[e.charCodeAt(d)]<<18|i[e.charCodeAt(d+1)]<<12|i[e.charCodeAt(d+2)]<<6|i[e.charCodeAt(d+3)],s[c++]=t>>16&255,s[c++]=t>>8&255,s[c++]=255&t;2===a&&(t=i[e.charCodeAt(d)]<<2|i[e.charCodeAt(d+1)]>>4,s[c++]=255&t);1===a&&(t=i[e.charCodeAt(d)]<<10|i[e.charCodeAt(d+1)]<<4|i[e.charCodeAt(d+2)]>>2,s[c++]=t>>8&255,s[c++]=255&t);return s},n.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(l(e,a,a+16383>s?s:a+16383));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],6:[function(e,t,n){(function(e){t.exports=function(t,n){e.isBuffer(t)||(t=new e(t));e.isBuffer(n)||(n=new e(n));var r=[];if(t.length>n.length)for(var i=0;i<n.length;i++)r.push(t[i]^n[i]);else for(var i=0;i<t.length;i++)r.push(t[i]^n[i]);return new e(r)}}).call(this,e("buffer").Buffer)},{buffer:10}],7:[function(e,t,n){},{}],8:[function(e,t,n){var r,i,o=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var u,l=[],d=!1,p=-1;function f(){d&&u&&(d=!1,u.length?l=u.concat(l):p=-1,l.length&&h())}function h(){if(!d){var e=c(f);d=!0;for(var t=l.length;t;){for(u=l,l=[];++p<t;)u&&u[p].run();p=-1,t=l.length}u=null,d=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function v(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new m(e,t)),1!==l.length||d||c(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],9:[function(e,t,n){(function(e){!function(r){var i="object"==typeof n&&n&&!n.nodeType&&n,o="object"==typeof t&&t&&!t.nodeType&&t,a="object"==typeof e&&e;a.global!==a&&a.window!==a&&a.self!==a||(r=a);var s,c,u=2147483647,l=36,d=1,p=26,f=38,h=700,m=72,v=128,y="-",g=/^xn--/,S=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},C=l-d,w=Math.floor,E=String.fromCharCode;function R(e){throw new RangeError(b[e])}function P(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function L(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+P((e=e.replace(_,".")).split("."),t).join(".")}function T(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function x(e){return P(e,function(e){var t="";return e>65535&&(t+=E((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=E(e)}).join("")}function M(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function A(e,t,n){var r=0;for(e=n?w(e/h):e>>1,e+=w(e/t);e>C*p>>1;r+=l)e=w(e/C);return w(r+(C+1)*e/(e+f))}function I(e){var t,n,r,i,o,a,s,c,f,h,g,S=[],_=e.length,b=0,C=v,E=m;for((n=e.lastIndexOf(y))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&R("not-basic"),S.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<_;){for(o=b,a=1,s=l;i>=_&&R("invalid-input"),((c=(g=e.charCodeAt(i++))-48<10?g-22:g-65<26?g-65:g-97<26?g-97:l)>=l||c>w((u-b)/a))&&R("overflow"),b+=c*a,!(c<(f=s<=E?d:s>=E+p?p:s-E));s+=l)a>w(u/(h=l-f))&&R("overflow"),a*=h;E=A(b-o,t=S.length+1,0==o),w(b/t)>u-C&&R("overflow"),C+=w(b/t),b%=t,S.splice(b++,0,C)}return x(S)}function O(e){var t,n,r,i,o,a,s,c,f,h,g,S,_,b,C,P=[];for(S=(e=T(e)).length,t=v,n=0,o=m,a=0;a<S;++a)(g=e[a])<128&&P.push(E(g));for(r=i=P.length,i&&P.push(y);r<S;){for(s=u,a=0;a<S;++a)(g=e[a])>=t&&g<s&&(s=g);for(s-t>w((u-n)/(_=r+1))&&R("overflow"),n+=(s-t)*_,t=s,a=0;a<S;++a)if((g=e[a])<t&&++n>u&&R("overflow"),g==t){for(c=n,f=l;!(c<(h=f<=o?d:f>=o+p?p:f-o));f+=l)C=c-h,b=l-h,P.push(E(M(h+C%b,0))),c=w(C/b);P.push(E(M(c,0))),o=A(n,_,r==i),n=0,++r}++n,++t}return P.join("")}if(s={version:"1.4.1",ucs2:{decode:T,encode:x},decode:I,encode:O,toASCII:function(e){return L(e,function(e){return S.test(e)?"xn--"+O(e):e})},toUnicode:function(e){return L(e,function(e){return g.test(e)?I(e.slice(4).toLowerCase()):e})}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return s});else if(i&&o)if(t.exports==i)o.exports=s;else for(c in s)s.hasOwnProperty(c)&&(i[c]=s[c]);else r.punycode=s}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(e,t,n){(function(t,r){"use strict";var i=e("base64-js"),o=e("ieee754"),a=e("isarray");function s(){return r.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function c(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return r.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=r.prototype:(null===e&&(e=new r(t)),e.length=t),e}function r(e,t,n){if(!(r.TYPED_ARRAY_SUPPORT||this instanceof r))return new r(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return u(this,e,t,n)}function u(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i);r.TYPED_ARRAY_SUPPORT?(e=t).__proto__=r.prototype:e=p(e,t);return e}(e,t,n,i):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!r.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|h(t,n),o=(e=c(e,i)).write(t,n);o!==i&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(r.isBuffer(t)){var n=0|f(t.length);return 0===(e=c(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?c(e,0):p(e,t);if("Buffer"===t.type&&a(t.data))return p(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(l(t),e=c(e,t<0?0:0|f(t)),!r.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t){var n=t.length<0?0:0|f(t.length);e=c(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function h(e,t){if(r.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return B(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return F(e).length;default:if(i)return B(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,i,o){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=r.from(t,i)),r.isBuffer(t))return 0===t.length?-1:y(e,t,n,i,o);if("number"==typeof t)return t&=255,r.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,i,o);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var o,a=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,n/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=n;o<s;o++)if(u(e,o)===u(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+c>s&&(n=s-c),o=n;o>=0;o--){for(var d=!0,p=0;p<c;p++)if(u(e,o+p)!==u(t,p)){d=!1;break}if(d)return o}return-1}function g(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function S(e,t,n,r){return G(B(t,e.length-n),e,n,r)}function _(e,t,n,r){return G(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function b(e,t,n,r){return _(e,t,n,r)}function C(e,t,n,r){return G(F(t),e,n,r)}function w(e,t,n,r){return G(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function E(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function R(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,c,u=e[i],l=null,d=u>239?4:u>223?3:u>191?2:1;if(i+d<=n)switch(d){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(c=(15&u)<<12|(63&o)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,d=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=d}return function(e){var t=e.length;if(t<=P)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=P));return n}(r)}n.Buffer=r,n.SlowBuffer=function(e){+e!=e&&(e=0);return r.alloc(+e)},n.INSPECT_MAX_BYTES=50,r.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),n.kMaxLength=s(),r.poolSize=8192,r._augment=function(e){return e.__proto__=r.prototype,e},r.from=function(e,t,n){return u(null,e,t,n)},r.TYPED_ARRAY_SUPPORT&&(r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0})),r.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?c(e,t):void 0!==n?"string"==typeof r?c(e,t).fill(n,r):c(e,t).fill(n):c(e,t)}(null,e,t,n)},r.allocUnsafe=function(e){return d(null,e)},r.allocUnsafeSlow=function(e){return d(null,e)},r.isBuffer=function(e){return!(null==e||!e._isBuffer)},r.compare=function(e,t){if(!r.isBuffer(e)||!r.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,o=0,a=Math.min(n,i);o<a;++o)if(e[o]!==t[o]){n=e[o],i=t[o];break}return n<i?-1:i<n?1:0},r.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return r.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=r.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var s=e[n];if(!r.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,o),o+=s.length}return i},r.byteLength=h,r.prototype._isBuffer=!0,r.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},r.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},r.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},r.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?R(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return x(this,t,n);case"utf8":case"utf-8":return R(this,t,n);case"ascii":return L(this,t,n);case"latin1":case"binary":return T(this,t,n);case"base64":return E(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},r.prototype.equals=function(e){if(!r.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===r.compare(this,e)},r.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},r.prototype.compare=function(e,t,n,i,o){if(!r.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),t<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&t>=n)return 0;if(i>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(o>>>=0)-(i>>>=0),s=(n>>>=0)-(t>>>=0),c=Math.min(a,s),u=this.slice(i,o),l=e.slice(t,n),d=0;d<c;++d)if(u[d]!==l[d]){a=u[d],s=l[d];break}return a<s?-1:s<a?1:0},r.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},r.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},r.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},r.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return g(this,e,t,n);case"utf8":case"utf-8":return S(this,e,t,n);case"ascii":return _(this,e,t,n);case"latin1":case"binary":return b(this,e,t,n);case"base64":return C(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var P=4096;function L(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function T(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function x(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=U(e[o]);return i}function M(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function A(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function I(e,t,n,i,o,a){if(!r.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<a)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function O(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function D(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function k(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function j(e,t,n,r,i){return i||k(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function N(e,t,n,r,i){return i||k(e,0,n,8),o.write(e,t,n,r,52,8),n+8}r.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),r.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=r.prototype;else{var o=t-e;n=new r(o,void 0);for(var a=0;a<o;++a)n[a]=this[a+e]}return n},r.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},r.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},r.prototype.readUInt8=function(e,t){return t||A(e,1,this.length),this[e]},r.prototype.readUInt16LE=function(e,t){return t||A(e,2,this.length),this[e]|this[e+1]<<8},r.prototype.readUInt16BE=function(e,t){return t||A(e,2,this.length),this[e]<<8|this[e+1]},r.prototype.readUInt32LE=function(e,t){return t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},r.prototype.readUInt32BE=function(e,t){return t||A(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},r.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},r.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||A(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},r.prototype.readInt8=function(e,t){return t||A(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},r.prototype.readInt16LE=function(e,t){t||A(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},r.prototype.readInt16BE=function(e,t){t||A(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},r.prototype.readInt32LE=function(e,t){return t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},r.prototype.readInt32BE=function(e,t){return t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},r.prototype.readFloatLE=function(e,t){return t||A(e,4,this.length),o.read(this,e,!0,23,4)},r.prototype.readFloatBE=function(e,t){return t||A(e,4,this.length),o.read(this,e,!1,23,4)},r.prototype.readDoubleLE=function(e,t){return t||A(e,8,this.length),o.read(this,e,!0,52,8)},r.prototype.readDoubleBE=function(e,t){return t||A(e,8,this.length),o.read(this,e,!1,52,8)},r.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||I(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},r.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||I(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},r.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,1,255,0),r.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},r.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},r.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},r.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},r.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},r.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);I(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},r.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);I(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},r.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,1,127,-128),r.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},r.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},r.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},r.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,2147483647,-2147483648),r.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},r.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),r.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},r.prototype.writeFloatLE=function(e,t,n){return j(this,e,t,!0,n)},r.prototype.writeFloatBE=function(e,t,n){return j(this,e,t,!1,n)},r.prototype.writeDoubleLE=function(e,t,n){return N(this,e,t,!0,n)},r.prototype.writeDoubleBE=function(e,t,n){return N(this,e,t,!1,n)},r.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var o,a=i-n;if(this===e&&n<t&&t<i)for(o=a-1;o>=0;--o)e[o+t]=this[o+n];else if(a<1e3||!r.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},r.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!r.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var s=r.isBuffer(e)?e:B(new r(e,i).toString()),c=s.length;for(a=0;a<n-t;++a)this[a+t]=s[a%c]}return this};var V=/[^+\/0-9A-Za-z-_]/g;function U(e){return e<16?"0"+e.toString(16):e.toString(16)}function B(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function F(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(V,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{"base64-js":5,buffer:10,ieee754:60,isarray:11}],11:[function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},{}],12:[function(e,t,n){var r=e("safe-buffer").Buffer,i=e("stream").Transform,o=e("string_decoder").StringDecoder;function a(e){i.call(this),this.hashMode="string"==typeof e,this.hashMode?this[e]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}e("inherits")(a,i),a.prototype.update=function(e,t,n){"string"==typeof e&&(e=r.from(e,t));var i=this._update(e);return this.hashMode?this:(n&&(i=this._toString(i,n)),i)},a.prototype.setAutoPadding=function(){},a.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},a.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},a.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},a.prototype._transform=function(e,t,n){var r;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(e){r=e}finally{n(r)}},a.prototype._flush=function(e){var t;try{this.push(this.__final())}catch(e){t=e}e(t)},a.prototype._finalOrDigest=function(e){var t=this.__final()||r.alloc(0);return e&&(t=this._toString(t,e,!0)),t},a.prototype._toString=function(e,t,n){if(this._decoder||(this._decoder=new o(t),this._encoding=t),this._encoding!==t)throw new Error("can't switch encodings");var r=this._decoder.write(e);return n&&(r+=this._decoder.end()),r},t.exports=a},{inherits:61,"safe-buffer":230,stream:320,string_decoder:325}],13:[function(e,t,n){e("../../modules/es6.object.assign"),t.exports=e("../../modules/$.core").Object.assign},{"../../modules/$.core":16,"../../modules/es6.object.assign":26}],14:[function(e,t,n){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],15:[function(e,t,n){var r={}.toString;t.exports=function(e){return r.call(e).slice(8,-1)}},{}],16:[function(e,t,n){var r=t.exports={version:"1.2.6"};"number"==typeof __e&&(__e=r)},{}],17:[function(e,t,n){var r=e("./$.a-function");t.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},{"./$.a-function":14}],18:[function(e,t,n){t.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},{}],19:[function(e,t,n){var r=e("./$.global"),i=e("./$.core"),o=e("./$.ctx"),a=function(e,t,n){var s,c,u,l=e&a.F,d=e&a.G,p=e&a.S,f=e&a.P,h=e&a.B,m=e&a.W,v=d?i:i[t]||(i[t]={}),y=d?r:p?r[t]:(r[t]||{}).prototype;for(s in d&&(n=t),n)(c=!l&&y&&s in y)&&s in v||(u=c?y[s]:n[s],v[s]=d&&"function"!=typeof y[s]?n[s]:h&&c?o(u,r):m&&y[s]==u?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t.prototype=e.prototype,t}(u):f&&"function"==typeof u?o(Function.call,u):u,f&&((v.prototype||(v.prototype={}))[s]=u))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,t.exports=a},{"./$.core":16,"./$.ctx":17,"./$.global":21}],20:[function(e,t,n){t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],21:[function(e,t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},{}],22:[function(e,t,n){var r=e("./$.cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},{"./$.cof":15}],23:[function(e,t,n){var r=Object;t.exports={create:r.create,getProto:r.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:r.getOwnPropertyDescriptor,setDesc:r.defineProperty,setDescs:r.defineProperties,getKeys:r.keys,getNames:r.getOwnPropertyNames,getSymbols:r.getOwnPropertySymbols,each:[].forEach}},{}],24:[function(e,t,n){var r=e("./$"),i=e("./$.to-object"),o=e("./$.iobject");t.exports=e("./$.fails")(function(){var e=Object.assign,t={},n={},r=Symbol(),i="abcdefghijklmnopqrst";return t[r]=7,i.split("").forEach(function(e){n[e]=e}),7!=e({},t)[r]||Object.keys(e({},n)).join("")!=i})?function(e,t){for(var n=i(e),a=arguments,s=a.length,c=1,u=r.getKeys,l=r.getSymbols,d=r.isEnum;s>c;)for(var p,f=o(a[c++]),h=l?u(f).concat(l(f)):u(f),m=h.length,v=0;m>v;)d.call(f,p=h[v++])&&(n[p]=f[p]);return n}:Object.assign},{"./$":23,"./$.fails":20,"./$.iobject":22,"./$.to-object":25}],25:[function(e,t,n){var r=e("./$.defined");t.exports=function(e){return Object(r(e))}},{"./$.defined":18}],26:[function(e,t,n){var r=e("./$.export");r(r.S+r.F,"Object",{assign:e("./$.object-assign")})},{"./$.export":19,"./$.object-assign":24}],27:[function(e,t,n){(function(e){function t(e){return Object.prototype.toString.call(e)}n.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===t(e)},n.isBoolean=function(e){return"boolean"==typeof e},n.isNull=function(e){return null===e},n.isNullOrUndefined=function(e){return null==e},n.isNumber=function(e){return"number"==typeof e},n.isString=function(e){return"string"==typeof e},n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=function(e){return void 0===e},n.isRegExp=function(e){return"[object RegExp]"===t(e)},n.isObject=function(e){return"object"==typeof e&&null!==e},n.isDate=function(e){return"[object Date]"===t(e)},n.isError=function(e){return"[object Error]"===t(e)||e instanceof Error},n.isFunction=function(e){return"function"==typeof e},n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=e.isBuffer}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":63}],28:[function(e,t,n){"use strict";var r=e("inherits"),i=e("md5.js"),o=e("ripemd160"),a=e("sha.js"),s=e("cipher-base");function c(e){s.call(this,"digest"),this._hash=e}r(c,s),c.prototype._update=function(e){this._hash.update(e)},c.prototype._final=function(){return this._hash.digest()},t.exports=function(e){return"md5"===(e=e.toLowerCase())?new i:"rmd160"===e||"ripemd160"===e?new o:new c(a(e))}},{"cipher-base":12,inherits:61,"md5.js":204,ripemd160:227,"sha.js":251}],29:[function(e,t,n){var r=e("md5.js");t.exports=function(e){return(new r).update(e).digest()}},{"md5.js":204}],30:[function(e,t,n){"use strict";var r=e("inherits"),i=e("./legacy"),o=e("cipher-base"),a=e("safe-buffer").Buffer,s=e("create-hash/md5"),c=e("ripemd160"),u=e("sha.js"),l=a.alloc(128);function d(e,t){o.call(this,"digest"),"string"==typeof t&&(t=a.from(t));var n="sha512"===e||"sha384"===e?128:64;(this._alg=e,this._key=t,t.length>n)?t=("rmd160"===e?new c:u(e)).update(t).digest():t.length<n&&(t=a.concat([t,l],n));for(var r=this._ipad=a.allocUnsafe(n),i=this._opad=a.allocUnsafe(n),s=0;s<n;s++)r[s]=54^t[s],i[s]=92^t[s];this._hash="rmd160"===e?new c:u(e),this._hash.update(r)}r(d,o),d.prototype._update=function(e){this._hash.update(e)},d.prototype._final=function(){var e=this._hash.digest();return("rmd160"===this._alg?new c:u(this._alg)).update(this._opad).update(e).digest()},t.exports=function(e,t){return"rmd160"===(e=e.toLowerCase())||"ripemd160"===e?new d("rmd160",t):"md5"===e?new i(s,t):new d(e,t)}},{"./legacy":31,"cipher-base":12,"create-hash/md5":29,inherits:61,ripemd160:227,"safe-buffer":230,"sha.js":251}],31:[function(e,t,n){"use strict";var r=e("inherits"),i=e("safe-buffer").Buffer,o=e("cipher-base"),a=i.alloc(128),s=64;function c(e,t){o.call(this,"digest"),"string"==typeof t&&(t=i.from(t)),this._alg=e,this._key=t,t.length>s?t=e(t):t.length<s&&(t=i.concat([t,a],s));for(var n=this._ipad=i.allocUnsafe(s),r=this._opad=i.allocUnsafe(s),c=0;c<s;c++)n[c]=54^t[c],r[c]=92^t[c];this._hash=[n]}r(c,o),c.prototype._update=function(e){this._hash.push(e)},c.prototype._final=function(){var e=this._alg(i.concat(this._hash));return this._alg(i.concat([this._opad,e]))},t.exports=c},{"cipher-base":12,inherits:61,"safe-buffer":230}],32:[function(e,t,n){"use strict";var r=e("object-keys"),i="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),o=Object.prototype.toString,a=Array.prototype.concat,s=Object.defineProperty,c=s&&function(){var e={};try{for(var t in s(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),u=function(e,t,n,r){var i;t in e&&("function"!=typeof(i=r)||"[object Function]"!==o.call(i)||!r())||(c?s(e,t,{configurable:!0,enumerable:!1,value:n,writable:!0}):e[t]=n)},l=function(e,t){var n=arguments.length>2?arguments[2]:{},o=r(t);i&&(o=a.call(o,Object.getOwnPropertySymbols(t)));for(var s=0;s<o.length;s+=1)u(e,o[s],t[o[s]],n[o[s]])};l.supportsDescriptors=!!c,t.exports=l},{"object-keys":206}],33:[function(e,t,n){(function(n){function r(e){var t=a([["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/]]).filter(function(t){return t.rule&&t.rule.test(e)})[0];return t?t.name:null}function i(){return"undefined"==typeof navigator&&void 0!==n?{name:"node",version:n.version.slice(1),os:e("os").type().toLowerCase()}:null}function o(e){var t=a([["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\ ([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile$/]]);if(!e)return null;var n=t.map(function(t){var n=t.rule.exec(e),r=n&&n[1].split(/[._]/).slice(0,3);return r&&r.length<3&&(r=r.concat(1==r.length?[0,0]:[0])),n&&{name:t.name,version:r.join(".")}}).filter(Boolean)[0]||null;return n&&(n.os=r(e)),/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/i.test(e)&&((n=n||{}).bot=!0),n}function a(e){return e.map(function(e){return{name:e[0],rule:e[1]}})}t.exports={detect:function(){var e=i();return e||("undefined"!=typeof navigator?o(navigator.userAgent):null)},detectOS:r,getNodeVersion:i,parseUserAgent:o}}).call(this,e("_process"))},{_process:8,os:208}],34:[function(e,t,n){"use strict";var r=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,o=Object.getPrototypeOf||function(e){return e.__proto__},a=void 0,s="undefined"==typeof Uint8Array?void 0:o(Uint8Array),c={"$ %Array%":Array,"$ %ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"$ %ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":i?o([][Symbol.iterator]()):void 0,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":void 0,"$ %AsyncFunction%":void 0,"$ %AsyncFunctionPrototype%":void 0,"$ %AsyncGenerator%":void 0,"$ %AsyncGeneratorFunction%":void 0,"$ %AsyncGeneratorPrototype%":void 0,"$ %AsyncIteratorPrototype%":a&&i&&Symbol.asyncIterator?a[Symbol.asyncIterator]():void 0,"$ %Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":"undefined"==typeof DataView?void 0:DataView,"$ %DataViewPrototype%":"undefined"==typeof DataView?void 0:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"$ %Float32ArrayPrototype%":"undefined"==typeof Float32Array?void 0:Float32Array.prototype,"$ %Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"$ %Float64ArrayPrototype%":"undefined"==typeof Float64Array?void 0:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":void 0,"$ %GeneratorFunction%":void 0,"$ %GeneratorPrototype%":void 0,"$ %Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"$ %Int8ArrayPrototype%":"undefined"==typeof Int8Array?void 0:Int8Array.prototype,"$ %Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"$ %Int16ArrayPrototype%":"undefined"==typeof Int16Array?void 0:Int8Array.prototype,"$ %Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"$ %Int32ArrayPrototype%":"undefined"==typeof Int32Array?void 0:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":i?o(o([][Symbol.iterator]())):void 0,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":"undefined"==typeof Map?void 0:Map,"$ %MapIteratorPrototype%":"undefined"!=typeof Map&&i?o((new Map)[Symbol.iterator]()):void 0,"$ %MapPrototype%":"undefined"==typeof Map?void 0:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":"undefined"==typeof Promise?void 0:Promise,"$ %PromisePrototype%":"undefined"==typeof Promise?void 0:Promise.prototype,"$ %PromiseProto_then%":"undefined"==typeof Promise?void 0:Promise.prototype.then,"$ %Promise_all%":"undefined"==typeof Promise?void 0:Promise.all,"$ %Promise_reject%":"undefined"==typeof Promise?void 0:Promise.reject,"$ %Promise_resolve%":"undefined"==typeof Promise?void 0:Promise.resolve,"$ %Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":"undefined"==typeof Set?void 0:Set,"$ %SetIteratorPrototype%":"undefined"!=typeof Set&&i?o((new Set)[Symbol.iterator]()):void 0,"$ %SetPrototype%":"undefined"==typeof Set?void 0:Set.prototype,"$ %SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":i?o(""[Symbol.iterator]()):void 0,"$ %StringPrototype%":String.prototype,"$ %Symbol%":i?Symbol:void 0,"$ %SymbolPrototype%":i?Symbol.prototype:void 0,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":r,"$ %TypedArray%":s,"$ %TypedArrayPrototype%":s?s.prototype:void 0,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"$ %Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?void 0:Uint8Array.prototype,"$ %Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray.prototype,"$ %Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"$ %Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?void 0:Uint16Array.prototype,"$ %Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"$ %Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?void 0:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"$ %WeakMapPrototype%":"undefined"==typeof WeakMap?void 0:WeakMap.prototype,"$ %WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet,"$ %WeakSetPrototype%":"undefined"==typeof WeakSet?void 0:WeakSet.prototype};t.exports=function(e,t){if(arguments.length>1&&"boolean"!=typeof t)throw new TypeError('"allowMissing" argument must be a boolean');var n="$ "+e;if(!(n in c))throw new SyntaxError("intrinsic "+e+" does not exist!");if(void 0===c[n]&&!t)throw new TypeError("intrinsic "+e+" exists, but is not available. Please file an issue!");return c[n]}},{}],35:[function(e,t,n){"use strict";var r=e("./GetIntrinsic"),i=r("%Object%"),o=r("%TypeError%"),a=r("%String%"),s=e("./helpers/assertRecord"),c=e("./helpers/isNaN"),u=e("./helpers/isFinite"),l=e("./helpers/sign"),d=e("./helpers/mod"),p=e("is-callable"),f=e("es-to-primitive/es5"),h=e("has"),m={ToPrimitive:f,ToBoolean:function(e){return!!e},ToNumber:function(e){return+e},ToInteger:function(e){var t=this.ToNumber(e);return c(t)?0:0!==t&&u(t)?l(t)*Math.floor(Math.abs(t)):t},ToInt32:function(e){return this.ToNumber(e)>>0},ToUint32:function(e){return this.ToNumber(e)>>>0},ToUint16:function(e){var t=this.ToNumber(e);if(c(t)||0===t||!u(t))return 0;var n=l(t)*Math.floor(Math.abs(t));return d(n,65536)},ToString:function(e){return a(e)},ToObject:function(e){return this.CheckObjectCoercible(e),i(e)},CheckObjectCoercible:function(e,t){if(null==e)throw new o(t||"Cannot call method on "+e);return e},IsCallable:p,SameValue:function(e,t){return e===t?0!==e||1/e==1/t:c(e)&&c(t)},Type:function(e){return null===e?"Null":void 0===e?"Undefined":"function"==typeof e||"object"==typeof e?"Object":"number"==typeof e?"Number":"boolean"==typeof e?"Boolean":"string"==typeof e?"String":void 0},IsPropertyDescriptor:function(e){if("Object"!==this.Type(e))return!1;var t={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var n in e)if(h(e,n)&&!t[n])return!1;var r=h(e,"[[Value]]"),i=h(e,"[[Get]]")||h(e,"[[Set]]");if(r&&i)throw new o("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(e){return void 0!==e&&(s(this,"Property Descriptor","Desc",e),!(!h(e,"[[Get]]")&&!h(e,"[[Set]]")))},IsDataDescriptor:function(e){return void 0!==e&&(s(this,"Property Descriptor","Desc",e),!(!h(e,"[[Value]]")&&!h(e,"[[Writable]]")))},IsGenericDescriptor:function(e){return void 0!==e&&(s(this,"Property Descriptor","Desc",e),!this.IsAccessorDescriptor(e)&&!this.IsDataDescriptor(e))},FromPropertyDescriptor:function(e){if(void 0===e)return e;if(s(this,"Property Descriptor","Desc",e),this.IsDataDescriptor(e))return{value:e["[[Value]]"],writable:!!e["[[Writable]]"],enumerable:!!e["[[Enumerable]]"],configurable:!!e["[[Configurable]]"]};if(this.IsAccessorDescriptor(e))return{get:e["[[Get]]"],set:e["[[Set]]"],enumerable:!!e["[[Enumerable]]"],configurable:!!e["[[Configurable]]"]};throw new o("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(e){if("Object"!==this.Type(e))throw new o("ToPropertyDescriptor requires an object");var t={};if(h(e,"enumerable")&&(t["[[Enumerable]]"]=this.ToBoolean(e.enumerable)),h(e,"configurable")&&(t["[[Configurable]]"]=this.ToBoolean(e.configurable)),h(e,"value")&&(t["[[Value]]"]=e.value),h(e,"writable")&&(t["[[Writable]]"]=this.ToBoolean(e.writable)),h(e,"get")){var n=e.get;if(void 0!==n&&!this.IsCallable(n))throw new TypeError("getter must be a function");t["[[Get]]"]=n}if(h(e,"set")){var r=e.set;if(void 0!==r&&!this.IsCallable(r))throw new o("setter must be a function");t["[[Set]]"]=r}if((h(t,"[[Get]]")||h(t,"[[Set]]"))&&(h(t,"[[Value]]")||h(t,"[[Writable]]")))throw new o("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return t}};t.exports=m},{"./GetIntrinsic":34,"./helpers/assertRecord":36,"./helpers/isFinite":37,"./helpers/isNaN":38,"./helpers/mod":39,"./helpers/sign":40,"es-to-primitive/es5":41,has:53,"is-callable":64}],36:[function(e,t,n){"use strict";var r=e("../GetIntrinsic"),i=r("%TypeError%"),o=r("%SyntaxError%"),a=e("has"),s={"Property Descriptor":function(e,t){if("Object"!==e.Type(t))return!1;var n={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var r in t)if(a(t,r)&&!n[r])return!1;var o=a(t,"[[Value]]"),s=a(t,"[[Get]]")||a(t,"[[Set]]");if(o&&s)throw new i("Property Descriptors may not be both accessor and data descriptors");return!0}};t.exports=function(e,t,n,r){var a=s[t];if("function"!=typeof a)throw new o("unknown record type: "+t);if(!a(e,r))throw new i(n+" must be a "+t);console.log(a(e,r),r)}},{"../GetIntrinsic":34,has:53}],37:[function(e,t,n){var r=Number.isNaN||function(e){return e!=e};t.exports=Number.isFinite||function(e){return"number"==typeof e&&!r(e)&&e!==1/0&&e!==-1/0}},{}],38:[function(e,t,n){t.exports=Number.isNaN||function(e){return e!=e}},{}],39:[function(e,t,n){t.exports=function(e,t){var n=e%t;return Math.floor(n>=0?n:n+t)}},{}],40:[function(e,t,n){t.exports=function(e){return e>=0?1:-1}},{}],41:[function(e,t,n){"use strict";var r=Object.prototype.toString,i=e("./helpers/isPrimitive"),o=e("is-callable"),a=function(e){var t;if((t=arguments.length>1?arguments[1]:"[object Date]"===r.call(e)?String:Number)===String||t===Number){var n,a,s=t===String?["toString","valueOf"]:["valueOf","toString"];for(a=0;a<s.length;++a)if(o(e[s[a]])&&(n=e[s[a]](),i(n)))return n;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")};t.exports=function(e){return i(e)?e:arguments.length>1?a(e,arguments[1]):a(e)}},{"./helpers/isPrimitive":42,"is-callable":64}],42:[function(e,t,n){t.exports=function(e){return null===e||"function"!=typeof e&&"object"!=typeof e}},{}],43:[function(e,t,n){(function(r,i){!function(e,r){"object"==typeof n&&void 0!==t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.ES6Promise=r()}(this,function(){"use strict";function t(e){return"function"==typeof e}var n=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,a=void 0,s=void 0,c=function(e,t){m[o]=e,m[o+1]=t,2===(o+=2)&&(s?s(v):b())};var u="undefined"!=typeof window?window:void 0,l=u||{},d=l.MutationObserver||l.WebKitMutationObserver,p="undefined"==typeof self&&void 0!==r&&"[object process]"==={}.toString.call(r),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var e=setTimeout;return function(){return e(v,1)}}var m=new Array(1e3);function v(){for(var e=0;e<o;e+=2){(0,m[e])(m[e+1]),m[e]=void 0,m[e+1]=void 0}o=0}var y,g,S,_,b=void 0;function C(e,t){var n=arguments,r=this,i=new this.constructor(R);void 0===i[E]&&G(i);var o,a=r._state;return a?(o=n[a-1],c(function(){return B(a,i,o,r._result)})):j(r,i,e,t),i}function w(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(R);return I(t,e),t}p?b=function(){return r.nextTick(v)}:d?(g=0,S=new d(v),_=document.createTextNode(""),S.observe(_,{characterData:!0}),b=function(){_.data=g=++g%2}):f?((y=new MessageChannel).port1.onmessage=v,b=function(){return y.port2.postMessage(0)}):b=void 0===u&&"function"==typeof e?function(){try{var t=e("vertx");return void 0!==(a=t.runOnLoop||t.runOnContext)?function(){a(v)}:h()}catch(e){return h()}}():h();var E=Math.random().toString(36).substring(16);function R(){}var P=void 0,L=1,T=2,x=new V;function M(e){try{return e.then}catch(e){return x.error=e,x}}function A(e,n,r){n.constructor===e.constructor&&r===C&&n.constructor.resolve===w?function(e,t){t._state===L?D(e,t._result):t._state===T?k(e,t._result):j(t,void 0,function(t){return I(e,t)},function(t){return k(e,t)})}(e,n):r===x?k(e,x.error):void 0===r?D(e,n):t(r)?function(e,t,n){c(function(e){var r=!1,i=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,function(n){r||(r=!0,t!==n?I(e,n):D(e,n))},function(t){r||(r=!0,k(e,t))},e._label);!r&&i&&(r=!0,k(e,i))},e)}(e,n,r):D(e,n)}function I(e,t){var n;e===t?k(e,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(n=t)||"object"==typeof n&&null!==n?A(e,t,M(t)):D(e,t)}function O(e){e._onerror&&e._onerror(e._result),N(e)}function D(e,t){e._state===P&&(e._result=t,e._state=L,0!==e._subscribers.length&&c(N,e))}function k(e,t){e._state===P&&(e._state=T,e._result=t,c(O,e))}function j(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+L]=n,i[o+T]=r,0===o&&e._state&&c(N,e)}function N(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)r=t[a],i=t[a+n],r?B(n,r,i,o):i(o);e._subscribers.length=0}}function V(){this.error=null}var U=new V;function B(e,n,r,i){var o=t(r),a=void 0,s=void 0,c=void 0,u=void 0;if(o){if((a=function(e,t){try{return e(t)}catch(e){return U.error=e,U}}(r,i))===U?(u=!0,s=a.error,a=null):c=!0,n===a)return void k(n,new TypeError("A promises callback cannot return that same promise."))}else a=i,c=!0;n._state!==P||(o&&c?I(n,a):u?k(n,s):e===L?D(n,a):e===T&&k(n,a))}var F=0;function G(e){e[E]=F++,e._state=void 0,e._result=void 0,e._subscribers=[]}function W(e,t){this._instanceConstructor=e,this.promise=new e(R),this.promise[E]||G(this.promise),n(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?D(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&D(this.promise,this._result))):k(this.promise,new Error("Array Methods must be provided an Array"))}function J(e){this[E]=F++,this._result=this._state=void 0,this._subscribers=[],R!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof J?function(e,t){try{t(function(t){I(e,t)},function(t){k(e,t)})}catch(t){k(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return W.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===P&&n<e;n++)this._eachEntry(t[n],n)},W.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===w){var i=M(e);if(i===C&&e._state!==P)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===J){var o=new n(R);A(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},W.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===P&&(this._remaining--,e===T?k(r,n):this._result[t]=n),0===this._remaining&&D(r,this._result)},W.prototype._willSettleAt=function(e,t){var n=this;j(e,void 0,function(e){return n._settledAt(L,t,e)},function(e){return n._settledAt(T,t,e)})},J.all=function(e){return new W(this,e).promise},J.race=function(e){var t=this;return n(e)?new t(function(n,r){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(n,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},J.resolve=w,J.reject=function(e){var t=new this(R);return k(t,e),t},J._setScheduler=function(e){s=e},J._setAsap=function(e){c=e},J._asap=c,J.prototype={constructor:J,then:C,catch:function(e){return this.then(null,e)}},J.polyfill=function(){var e=void 0;if(void 0!==i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=J},J.Promise=J,J})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:8}],44:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,s,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(a(n=this._events[e]))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(o(n))for(s=Array.prototype.slice.call(arguments,1),r=(u=n.slice()).length,c=0;c<r;c++)u[c].apply(this,s);return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(n=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var n,r,a,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(a=(n=this._events[e]).length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],45:[function(e,t,n){var r=[],i=r.forEach,o=r.slice;t.exports=function(e){return i.call(o.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e}},{}],46:[function(e,t,n){var r=e("wildemitter"),i=e("util");function o(e){r.call(this);var t,n=e||{};for(t in this.config={chunksize:16384,pacing:0},n)this.config[t]=n[t];this.file=null,this.channel=null}function a(){r.call(this),this.receiveBuffer=[],this.received=0,this.metadata={},this.channel=null}i.inherits(o,r),o.prototype.send=function(e,t){var n=this;this.file=e,this.channel=t;var r="number"!=typeof t.bufferedAmountLowThreshold,i=0,o=function(){var a=new window.FileReader;a.onload=function(a){n.channel.send(a.target.result),n.emit("progress",i,e.size,a.target.result),e.size>i+a.target.result.byteLength?r?window.setTimeout(o,n.config.pacing):t.bufferedAmount<=t.bufferedAmountLowThreshold&&window.setTimeout(o,0):(n.emit("progress",e.size,e.size,null),n.emit("sentFile")),i+=n.config.chunksize};var s=e.slice(i,i+n.config.chunksize);a.readAsArrayBuffer(s)};r||(t.bufferedAmountLowThreshold=8*this.config.chunksize,t.addEventListener("bufferedamountlow",o)),window.setTimeout(o,0)},i.inherits(a,r),a.prototype.receive=function(e,t){var n=this;e&&(this.metadata=e),this.channel=t,t.binaryType="arraybuffer",this.channel.onmessage=function(e){var t=e.data.byteLength;n.received+=t,n.receiveBuffer.push(e.data),n.emit("progress",n.received,n.metadata.size,e.data),n.received===n.metadata.size?(n.emit("receivedFile",new window.Blob(n.receiveBuffer),n.metadata),n.receiveBuffer=[]):n.received>n.metadata.size&&(console.error("received more than expected, discarding..."),n.receiveBuffer=[])}},t.exports={},t.exports.support="undefined"!=typeof window&&window&&window.File&&window.FileReader&&window.Blob,t.exports.Sender=o,t.exports.Receiver=a},{util:331,wildemitter:48}],47:[function(e,t,n){var r=e("wildemitter"),i=e("util"),o=e("iana-hashes"),a=e("./filetransfer");function s(e){r.call(this);var t=this;this.base=new a.Sender(e);var n=e||{};n.hash||(n.hash="sha-1"),this.hash=o.createHash(n.hash),this.base.on("progress",function(e,n,r){t.emit("progress",e,n,r),r&&t.hash.update(new Uint8Array(r))}),this.base.on("sentFile",function(){t.emit("sentFile",{hash:t.hash.digest("hex"),algo:n.hash})})}function c(e){r.call(this);var t=this;this.base=new a.Receiver(e);var n=e||{};n.hash||(n.hash="sha-1"),this.hash=o.createHash(n.hash),this.base.on("progress",function(e,n,r){t.emit("progress",e,n,r),r&&t.hash.update(new Uint8Array(r))}),this.base.on("receivedFile",function(e,n){n.actualhash=t.hash.digest("hex"),t.emit("receivedFile",e,n)})}i.inherits(s,r),s.prototype.send=function(){this.base.send.apply(this.base,arguments)},i.inherits(c,r),c.prototype.receive=function(){this.base.receive.apply(this.base,arguments)},Object.defineProperty(c.prototype,"metadata",{get:function(){return this.base.metadata},set:function(e){this.base.metadata=e}}),t.exports={},t.exports.support=a.support,t.exports.Sender=s,t.exports.Receiver=c},{"./filetransfer":46,"iana-hashes":58,util:331,wildemitter:48}],48:[function(e,t,n){function r(){}t.exports=r,r.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,n){this.callbacks=this.callbacks||{};var r=3===arguments.length,i=r?arguments[1]:void 0,o=r?arguments[2]:arguments[1];return o._groupName=i,(this.callbacks[e]=this.callbacks[e]||[]).push(o),this},t.once=function(e,t,n){var r=this,i=3===arguments.length,o=i?arguments[1]:void 0,a=i?arguments[2]:arguments[1];return this.on(e,o,function t(){r.off(e,t),a.apply(this,arguments)}),this},t.releaseGroup=function(e){var t,n,r,i;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(n=0,r=(i=this.callbacks[t]).length;n<r;n++)i[n]._groupName===e&&(i.splice(n,1),n--,r--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var n,r=this.callbacks[e];return r?1===arguments.length?(delete this.callbacks[e],this):(-1!==(n=r.indexOf(t))&&(r.splice(n,1),0===r.length&&delete this.callbacks[e]),this):this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,n,r,i=[].slice.call(arguments,1),o=this.callbacks[e],a=this.getWildcardCallbacks(e);if(o)for(t=0,n=(r=o.slice()).length;t<n&&r[t];++t)r[t].apply(this,i);if(a)for(n=a.length,t=0,n=(r=a.slice()).length;t<n&&r[t];++t)r[t].apply(this,[e].concat(i));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,r=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(r=r.concat(this.callbacks[t]));return r}},r.mixin(r)},{}],49:[function(e,t,n){"use strict";var r=e("is-callable"),i=Object.prototype.toString,o=Object.prototype.hasOwnProperty;t.exports=function(e,t,n){if(!r(t))throw new TypeError("iterator must be a function");var a;arguments.length>=3&&(a=n),"[object Array]"===i.call(e)?function(e,t,n){for(var r=0,i=e.length;r<i;r++)o.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))}(e,t,a):"string"==typeof e?function(e,t,n){for(var r=0,i=e.length;r<i;r++)null==n?t(e.charAt(r),r,e):t.call(n,e.charAt(r),r,e)}(e,t,a):function(e,t,n){for(var r in e)o.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))}(e,t,a)}},{"is-callable":64}],50:[function(e,t,n){"use strict";var r=Array.prototype.slice,i=Object.prototype.toString;t.exports=function(e){var t=this;if("function"!=typeof t||"[object Function]"!==i.call(t))throw new TypeError("Function.prototype.bind called on incompatible "+t);for(var n,o=r.call(arguments,1),a=Math.max(0,t.length-o.length),s=[],c=0;c<a;c++)s.push("$"+c);if(n=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof n){var i=t.apply(this,o.concat(r.call(arguments)));return Object(i)===i?i:this}return t.apply(e,o.concat(r.call(arguments)))}),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n}},{}],51:[function(e,t,n){"use strict";var r=e("./implementation");t.exports=Function.prototype.bind||r},{"./implementation":50}],52:[function(e,t,n){(function(e){var n;n="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],53:[function(e,t,n){"use strict";var r=e("function-bind");t.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":51}],54:[function(e,t,n){"use strict";var r=e("safe-buffer").Buffer,i=e("stream").Transform;function o(e){i.call(this),this._block=r.allocUnsafe(e),this._blockSize=e,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}e("inherits")(o,i),o.prototype._transform=function(e,t,n){var r=null;try{this.update(e,t)}catch(e){r=e}n(r)},o.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(e){t=e}e(t)},o.prototype.update=function(e,t){if(function(e,t){if(!r.isBuffer(e)&&"string"!=typeof e)throw new TypeError(t+" must be a string or a buffer")}(e,"Data"),this._finalized)throw new Error("Digest already called");r.isBuffer(e)||(e=r.from(e,t));for(var n=this._block,i=0;this._blockOffset+e.length-i>=this._blockSize;){for(var o=this._blockOffset;o<this._blockSize;)n[o++]=e[i++];this._update(),this._blockOffset=0}for(;i<e.length;)n[this._blockOffset++]=e[i++];for(var a=0,s=8*e.length;s>0;++a)this._length[a]+=s,(s=this._length[a]/4294967296|0)>0&&(this._length[a]-=4294967296*s);return this},o.prototype._update=function(){throw new Error("_update is not implemented")},o.prototype.digest=function(e){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var t=this._digest();void 0!==e&&(t=t.toString(e)),this._block.fill(0),this._blockOffset=0;for(var n=0;n<4;++n)this._length[n]=0;return t},o.prototype._digest=function(){throw new Error("_digest is not implemented")},t.exports=o},{inherits:61,"safe-buffer":230,stream:320}],55:[function(e,t,n){"use strict";var r=e("async"),i=e("request"),o=e("jxt").createRegistry();o.use(e("./lib/xrd")),t.exports=function(e,t){"string"==typeof e&&(e={host:e});var n={ssl:!0,json:!0,xrd:!0};for(var a in e)n[a]=e[a];var s=n.ssl?"https://":"http://";r.parallel([function(e){i(s+n.host+"/.well-known/host-meta.json",function(t,n,r){if(t)return e(null);var i;try{i=JSON.parse(r)}catch(e){i=null}return e(i)})},function(e){i(s+n.host+"/.well-known/host-meta",function(t,n,r){if(t)return e(null);var i=o.parse(r);return e(i.toJSON())})}],function(e){e?t(null,e):t("no-host-meta")})}},{"./lib/xrd":56,async:57,jxt:159,request:351}],56:[function(e,t,n){"use strict";var r=e("jxt"),i="http://docs.oasis-open.org/ns/xri/xrd-1.0";t.exports=function(e){var t={get:function(){for(var e={},t=r.find(this.xml,i,"Property"),n=0,o=t.length;n<o;n++){var a=t[n];e[r.getAttribute(a,"type")]=a.textContent}return e}},n=e.define({name:"xrd",namespace:i,element:"XRD",fields:{subject:r.subText(i,"Subject"),expires:r.dateSub(i,"Expires"),aliases:r.multiSubText(i,"Alias"),properties:t}}),o=e.define({name:"_xrdlink",namespace:i,element:"Link",fields:{rel:r.attribute("rel"),href:r.attribute("href"),type:r.attribute("type"),template:r.attribute("template"),titles:r.subLangText(i,"Title","default"),properties:t}});return e.extend(n,o,"links"),n}},{jxt:159}],57:[function(e,t,n){(function(e,r,i){!function(e,r){"object"==typeof n&&void 0!==t?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r(e.async=e.async||{})}(this,function(n){"use strict";function o(e,t){t|=0;for(var n=Math.max(e.length-t,0),r=Array(n),i=0;i<n;i++)r[i]=e[t+i];return r}var a=function(e){var t=o(arguments,1);return function(){var n=o(arguments);return e.apply(null,t.concat(n))}},s=function(e){return function(){var t=o(arguments),n=t.pop();e.call(this,t,n)}};function c(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var u="function"==typeof i&&i,l="object"==typeof e&&"function"==typeof e.nextTick;function d(e){setTimeout(e,0)}function p(e){return function(t){var n=o(arguments,1);e(function(){t.apply(null,n)})}}var f=p(u?i:l?e.nextTick:d);function h(e){return s(function(t,n){var r;try{r=e.apply(this,t)}catch(e){return n(e)}c(r)&&"function"==typeof r.then?r.then(function(e){m(n,null,e)},function(e){m(n,e.message?e:new Error(e))}):n(null,r)})}function m(e,t,n){try{e(t,n)}catch(e){f(v,e)}}function v(e){throw e}var y="function"==typeof Symbol;function g(e){return y&&"AsyncFunction"===e[Symbol.toStringTag]}function S(e){return g(e)?h(e):e}function _(e){return function(t){var n=o(arguments,1),r=s(function(n,r){var i=this;return e(t,function(e,t){S(e).apply(i,n.concat(t))},r)});return n.length?r.apply(this,n):r}}var b="object"==typeof r&&r&&r.Object===Object&&r,C="object"==typeof self&&self&&self.Object===Object&&self,w=b||C||Function("return this")(),E=w.Symbol,R=Object.prototype,P=R.hasOwnProperty,L=R.toString,T=E?E.toStringTag:void 0;var x=Object.prototype.toString;var M="[object Null]",A="[object Undefined]",I=E?E.toStringTag:void 0;function O(e){return null==e?void 0===e?A:M:I&&I in Object(e)?function(e){var t=P.call(e,T),n=e[T];try{e[T]=void 0;var r=!0}catch(e){}var i=L.call(e);return r&&(t?e[T]=n:delete e[T]),i}(e):function(e){return x.call(e)}(e)}var D="[object AsyncFunction]",k="[object Function]",j="[object GeneratorFunction]",N="[object Proxy]";var V=9007199254740991;function U(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=V}function B(e){return null!=e&&U(e.length)&&!function(e){if(!c(e))return!1;var t=O(e);return t==k||t==j||t==D||t==N}(e)}var F={};function G(){}function W(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}var J="function"==typeof Symbol&&Symbol.iterator,q=function(e){return J&&e[J]&&e[J]()};function H(e){return null!=e&&"object"==typeof e}var z="[object Arguments]";function X(e){return H(e)&&O(e)==z}var $=Object.prototype,Y=$.hasOwnProperty,K=$.propertyIsEnumerable,Q=X(function(){return arguments}())?X:function(e){return H(e)&&Y.call(e,"callee")&&!K.call(e,"callee")},Z=Array.isArray;var ee="object"==typeof n&&n&&!n.nodeType&&n,te=ee&&"object"==typeof t&&t&&!t.nodeType&&t,ne=te&&te.exports===ee?w.Buffer:void 0,re=(ne?ne.isBuffer:void 0)||function(){return!1},ie=9007199254740991,oe=/^(?:0|[1-9]\d*)$/;function ae(e,t){var n=typeof e;return!!(t=null==t?ie:t)&&("number"==n||"symbol"!=n&&oe.test(e))&&e>-1&&e%1==0&&e<t}var se={};se["[object Float32Array]"]=se["[object Float64Array]"]=se["[object Int8Array]"]=se["[object Int16Array]"]=se["[object Int32Array]"]=se["[object Uint8Array]"]=se["[object Uint8ClampedArray]"]=se["[object Uint16Array]"]=se["[object Uint32Array]"]=!0,se["[object Arguments]"]=se["[object Array]"]=se["[object ArrayBuffer]"]=se["[object Boolean]"]=se["[object DataView]"]=se["[object Date]"]=se["[object Error]"]=se["[object Function]"]=se["[object Map]"]=se["[object Number]"]=se["[object Object]"]=se["[object RegExp]"]=se["[object Set]"]=se["[object String]"]=se["[object WeakMap]"]=!1;var ce,ue="object"==typeof n&&n&&!n.nodeType&&n,le=ue&&"object"==typeof t&&t&&!t.nodeType&&t,de=le&&le.exports===ue&&b.process,pe=function(){try{var e=le&&le.require&&le.require("util").types;return e||de&&de.binding&&de.binding("util")}catch(e){}}(),fe=pe&&pe.isTypedArray,he=fe?(ce=fe,function(e){return ce(e)}):function(e){return H(e)&&U(e.length)&&!!se[O(e)]},me=Object.prototype.hasOwnProperty;function ve(e,t){var n=Z(e),r=!n&&Q(e),i=!n&&!r&&re(e),o=!n&&!r&&!i&&he(e),a=n||r||i||o,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=s.length;for(var u in e)!t&&!me.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ae(u,c))||s.push(u);return s}var ye=Object.prototype;var ge=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),Se=Object.prototype.hasOwnProperty;function _e(e){if(n=(t=e)&&t.constructor,t!==("function"==typeof n&&n.prototype||ye))return ge(e);var t,n,r=[];for(var i in Object(e))Se.call(e,i)&&"constructor"!=i&&r.push(i);return r}function be(e){return B(e)?ve(e):_e(e)}function Ce(e){if(B(e))return function(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}(e);var t,n,r,i,o=q(e);return o?function(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}(o):(n=be(t=e),r=-1,i=n.length,function(){var e=n[++r];return r<i?{value:t[e],key:e}:null})}function we(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function Ee(e){return function(t,n,r){if(r=W(r||G),e<=0||!t)return r(null);var i=Ce(t),o=!1,a=0,s=!1;function c(e,t){if(a-=1,e)o=!0,r(e);else{if(t===F||o&&a<=0)return o=!0,r(null);s||u()}}function u(){for(s=!0;a<e&&!o;){var t=i();if(null===t)return o=!0,void(a<=0&&r(null));a+=1,n(t.value,t.key,we(c))}s=!1}u()}}function Re(e,t,n,r){Ee(t)(e,S(n),r)}function Pe(e,t){return function(n,r,i){return e(n,t,r,i)}}function Le(e,t,n){n=W(n||G);var r=0,i=0,o=e.length;function a(e,t){e?n(e):++i!==o&&t!==F||n(null)}for(0===o&&n(null);r<o;r++)t(e[r],r,we(a))}var Te=Pe(Re,1/0),xe=function(e,t,n){(B(e)?Le:Te)(e,S(t),n)};function Me(e){return function(t,n,r){return e(xe,t,S(n),r)}}function Ae(e,t,n,r){r=r||G,t=t||[];var i=[],o=0,a=S(n);e(t,function(e,t,n){var r=o++;a(e,function(e,t){i[r]=t,n(e)})},function(e){r(e,i)})}var Ie=Me(Ae),Oe=_(Ie);function De(e){return function(t,n,r,i){return e(Ee(n),t,S(r),i)}}var ke=De(Ae),je=Pe(ke,1),Ne=_(je);function Ve(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}var Ue,Be=function(e,t,n){for(var r=-1,i=Object(e),o=n(e),a=o.length;a--;){var s=o[Ue?a:++r];if(!1===t(i[s],s,i))break}return e};function Fe(e,t){return e&&Be(e,t,be)}function Ge(e){return e!=e}function We(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,Ge,n)}var Je=function(e,t,n){"function"==typeof t&&(n=t,t=null),n=W(n||G);var r=be(e).length;if(!r)return n(null);t||(t=r);var i={},a=0,s=!1,c=Object.create(null),u=[],l=[],d={};function p(e,t){u.push(function(){!function(e,t){if(s)return;var r=we(function(t,r){if(a--,arguments.length>2&&(r=o(arguments,1)),t){var u={};Fe(i,function(e,t){u[t]=e}),u[e]=r,s=!0,c=Object.create(null),n(t,u)}else i[e]=r,Ve(c[e]||[],function(e){e()}),f()});a++;var u=S(t[t.length-1]);t.length>1?u(i,r):u(r)}(e,t)})}function f(){if(0===u.length&&0===a)return n(null,i);for(;u.length&&a<t;){u.shift()()}}function h(t){var n=[];return Fe(e,function(e,r){Z(e)&&We(e,t,0)>=0&&n.push(r)}),n}Fe(e,function(t,n){if(!Z(t))return p(n,[t]),void l.push(n);var r=t.slice(0,t.length-1),i=r.length;if(0===i)return p(n,t),void l.push(n);d[n]=i,Ve(r,function(o){if(!e[o])throw new Error("async.auto task `"+n+"` has a non-existent dependency `"+o+"` in "+r.join(", "));!function(e,t){var n=c[e];n||(n=c[e]=[]);n.push(t)}(o,function(){0===--i&&p(n,t)})})}),function(){var e,t=0;for(;l.length;)e=l.pop(),t++,Ve(h(e),function(e){0==--d[e]&&l.push(e)});if(t!==r)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),f()};function qe(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var He="[object Symbol]";var ze=1/0,Xe=E?E.prototype:void 0,$e=Xe?Xe.toString:void 0;function Ye(e){if("string"==typeof e)return e;if(Z(e))return qe(e,Ye)+"";if(function(e){return"symbol"==typeof e||H(e)&&O(e)==He}(e))return $e?$e.call(e):"";var t=e+"";return"0"==t&&1/e==-ze?"-0":t}function Ke(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}(e,t,n)}var Qe=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Ze="[\\ud800-\\udfff]",et="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",tt="\\ud83c[\\udffb-\\udfff]",nt="[^\\ud800-\\udfff]",rt="(?:\\ud83c[\\udde6-\\uddff]){2}",it="[\\ud800-\\udbff][\\udc00-\\udfff]",ot="(?:"+et+"|"+tt+")"+"?",at="[\\ufe0e\\ufe0f]?"+ot+("(?:\\u200d(?:"+[nt,rt,it].join("|")+")[\\ufe0e\\ufe0f]?"+ot+")*"),st="(?:"+[nt+et+"?",et,rt,it,Ze].join("|")+")",ct=RegExp(tt+"(?="+tt+")|"+st+at,"g");function ut(e){return function(e){return Qe.test(e)}(e)?function(e){return e.match(ct)||[]}(e):function(e){return e.split("")}(e)}var lt=/^\s+|\s+$/g;function dt(e,t,n){var r;if((e=null==(r=e)?"":Ye(r))&&(n||void 0===t))return e.replace(lt,"");if(!e||!(t=Ye(t)))return e;var i=ut(e),o=ut(t);return Ke(i,function(e,t){for(var n=-1,r=e.length;++n<r&&We(t,e[n],0)>-1;);return n}(i,o),function(e,t){for(var n=e.length;n--&&We(t,e[n],0)>-1;);return n}(i,o)+1).join("")}var pt=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,ft=/,/,ht=/(=.+)?(\s*)$/,mt=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function vt(e,t){var n={};Fe(e,function(e,t){var r,i,o=g(e),a=!o&&1===e.length||o&&0===e.length;if(Z(e))r=e.slice(0,-1),e=e[e.length-1],n[t]=r.concat(r.length>0?s:e);else if(a)n[t]=e;else{if(r=i=(i=(i=(i=(i=e).toString().replace(mt,"")).match(pt)[2].replace(" ",""))?i.split(ft):[]).map(function(e){return dt(e.replace(ht,""))}),0===e.length&&!o&&0===r.length)throw new Error("autoInject task functions require explicit parameters.");o||r.pop(),n[t]=r.concat(s)}function s(t,n){var i=qe(r,function(e){return t[e]});i.push(n),S(e).apply(null,i)}}),Je(n,t)}function yt(){this.head=this.tail=null,this.length=0}function gt(e,t){e.length=1,e.head=e.tail=t}function St(e,t,n){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var r=S(e),i=0,o=[],a=!1;function s(e,t,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(l.started=!0,Z(e)||(e=[e]),0===e.length&&l.idle())return f(function(){l.drain()});for(var r=0,i=e.length;r<i;r++){var o={data:e[r],callback:n||G};t?l._tasks.unshift(o):l._tasks.push(o)}a||(a=!0,f(function(){a=!1,l.process()}))}function c(e){return function(t){i-=1;for(var n=0,r=e.length;n<r;n++){var a=e[n],s=We(o,a,0);0===s?o.shift():s>0&&o.splice(s,1),a.callback.apply(a,arguments),null!=t&&l.error(t,a.data)}i<=l.concurrency-l.buffer&&l.unsaturated(),l.idle()&&l.drain(),l.process()}}var u=!1,l={_tasks:new yt,concurrency:t,payload:n,saturated:G,unsaturated:G,buffer:t/4,empty:G,drain:G,error:G,started:!1,paused:!1,push:function(e,t){s(e,!1,t)},kill:function(){l.drain=G,l._tasks.empty()},unshift:function(e,t){s(e,!0,t)},remove:function(e){l._tasks.remove(e)},process:function(){if(!u){for(u=!0;!l.paused&&i<l.concurrency&&l._tasks.length;){var e=[],t=[],n=l._tasks.length;l.payload&&(n=Math.min(n,l.payload));for(var a=0;a<n;a++){var s=l._tasks.shift();e.push(s),o.push(s),t.push(s.data)}i+=1,0===l._tasks.length&&l.empty(),i===l.concurrency&&l.saturated();var d=we(c(e));r(t,d)}u=!1}},length:function(){return l._tasks.length},running:function(){return i},workersList:function(){return o},idle:function(){return l._tasks.length+i===0},pause:function(){l.paused=!0},resume:function(){!1!==l.paused&&(l.paused=!1,f(l.process))}};return l}function _t(e,t){return St(e,1,t)}yt.prototype.removeLink=function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e},yt.prototype.empty=function(){for(;this.head;)this.shift();return this},yt.prototype.insertAfter=function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1},yt.prototype.insertBefore=function(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1},yt.prototype.unshift=function(e){this.head?this.insertBefore(this.head,e):gt(this,e)},yt.prototype.push=function(e){this.tail?this.insertAfter(this.tail,e):gt(this,e)},yt.prototype.shift=function(){return this.head&&this.removeLink(this.head)},yt.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},yt.prototype.toArray=function(){for(var e=Array(this.length),t=this.head,n=0;n<this.length;n++)e[n]=t.data,t=t.next;return e},yt.prototype.remove=function(e){for(var t=this.head;t;){var n=t.next;e(t)&&this.removeLink(t),t=n}return this};var bt=Pe(Re,1);function Ct(e,t,n,r){r=W(r||G);var i=S(n);bt(e,function(e,n,r){i(t,e,function(e,n){t=n,r(e)})},function(e){r(e,t)})}function wt(){var e=qe(arguments,S);return function(){var t=o(arguments),n=this,r=t[t.length-1];"function"==typeof r?t.pop():r=G,Ct(e,t,function(e,t,r){t.apply(n,e.concat(function(e){var t=o(arguments,1);r(e,t)}))},function(e,t){r.apply(n,[e].concat(t))})}}var Et=function(){return wt.apply(null,o(arguments).reverse())},Rt=Array.prototype.concat,Pt=function(e,t,n,r){r=r||G;var i=S(n);ke(e,t,function(e,t){i(e,function(e){return e?t(e):t(null,o(arguments,1))})},function(e,t){for(var n=[],i=0;i<t.length;i++)t[i]&&(n=Rt.apply(n,t[i]));return r(e,n)})},Lt=Pe(Pt,1/0),Tt=Pe(Pt,1),xt=function(){var e=o(arguments),t=[null].concat(e);return function(){return arguments[arguments.length-1].apply(this,t)}};function Mt(e){return e}function At(e,t){return function(n,r,i,o){o=o||G;var a,s=!1;n(r,function(n,r,o){i(n,function(r,i){r?o(r):e(i)&&!a?(s=!0,a=t(!0,n),o(null,F)):o()})},function(e){e?o(e):o(null,s?a:t(!1))})}}function It(e,t){return t}var Ot=Me(At(Mt,It)),Dt=De(At(Mt,It)),kt=Pe(Dt,1);function jt(e){return function(t){var n=o(arguments,1);n.push(function(t){var n=o(arguments,1);"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&Ve(n,function(t){console[e](t)}))}),S(t).apply(null,n)}}var Nt=jt("dir");function Vt(e,t,n){n=we(n||G);var r=S(e),i=S(t);function a(e){if(e)return n(e);var t=o(arguments,1);t.push(s),i.apply(this,t)}function s(e,t){return e?n(e):t?void r(a):n(null)}s(null,!0)}function Ut(e,t,n){n=we(n||G);var r=S(e),i=function(e){if(e)return n(e);var a=o(arguments,1);if(t.apply(this,a))return r(i);n.apply(null,[null].concat(a))};r(i)}function Bt(e,t,n){Ut(e,function(){return!t.apply(this,arguments)},n)}function Ft(e,t,n){n=we(n||G);var r=S(t),i=S(e);function o(e){if(e)return n(e);i(a)}function a(e,t){return e?n(e):t?void r(o):n(null)}i(a)}function Gt(e){return function(t,n,r){return e(t,r)}}function Wt(e,t,n){xe(e,Gt(S(t)),n)}function Jt(e,t,n,r){Ee(t)(e,Gt(S(n)),r)}var qt=Pe(Jt,1);function Ht(e){return g(e)?e:s(function(t,n){var r=!0;t.push(function(){var e=arguments;r?f(function(){n.apply(null,e)}):n.apply(null,e)}),e.apply(this,t),r=!1})}function zt(e){return!e}var Xt=Me(At(zt,zt)),$t=De(At(zt,zt)),Yt=Pe($t,1);function Kt(e){return function(t){return null==t?void 0:t[e]}}function Qt(e,t,n,r){var i=new Array(t.length);e(t,function(e,t,r){n(e,function(e,n){i[t]=!!n,r(e)})},function(e){if(e)return r(e);for(var n=[],o=0;o<t.length;o++)i[o]&&n.push(t[o]);r(null,n)})}function Zt(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(n,o){n?r(n):(o&&i.push({index:t,value:e}),r())})},function(e){e?r(e):r(null,qe(i.sort(function(e,t){return e.index-t.index}),Kt("value")))})}function en(e,t,n,r){(B(t)?Qt:Zt)(e,t,S(n),r||G)}var tn=Me(en),nn=De(en),rn=Pe(nn,1);function on(e,t){var n=we(t||G),r=S(Ht(e));!function e(t){if(t)return n(t);r(e)}()}var an=function(e,t,n,r){r=r||G;var i=S(n);ke(e,t,function(e,t){i(e,function(n,r){return n?t(n):t(null,{key:r,val:e})})},function(e,t){for(var n={},i=Object.prototype.hasOwnProperty,o=0;o<t.length;o++)if(t[o]){var a=t[o].key,s=t[o].val;i.call(n,a)?n[a].push(s):n[a]=[s]}return r(e,n)})},sn=Pe(an,1/0),cn=Pe(an,1),un=jt("log");function ln(e,t,n,r){r=W(r||G);var i={},o=S(n);Re(e,t,function(e,t,n){o(e,t,function(e,r){if(e)return n(e);i[t]=r,n()})},function(e){r(e,i)})}var dn=Pe(ln,1/0),pn=Pe(ln,1);function fn(e,t){return t in e}function hn(e,t){var n=Object.create(null),r=Object.create(null);t=t||Mt;var i=S(e),a=s(function(e,a){var s=t.apply(null,e);fn(n,s)?f(function(){a.apply(null,n[s])}):fn(r,s)?r[s].push(a):(r[s]=[a],i.apply(null,e.concat(function(){var e=o(arguments);n[s]=e;var t=r[s];delete r[s];for(var i=0,a=t.length;i<a;i++)t[i].apply(null,e)})))});return a.memo=n,a.unmemoized=e,a}var mn=p(l?e.nextTick:u?i:d);function vn(e,t,n){n=n||G;var r=B(t)?[]:{};e(t,function(e,t,n){S(e)(function(e,i){arguments.length>2&&(i=o(arguments,1)),r[t]=i,n(e)})},function(e){n(e,r)})}function yn(e,t){vn(xe,e,t)}function gn(e,t,n){vn(Ee(t),e,n)}var Sn=function(e,t){var n=S(e);return St(function(e,t){n(e[0],t)},t,1)},_n=function(e,t){var n=Sn(e,t);return n.push=function(e,t,r){if(null==r&&(r=G),"function"!=typeof r)throw new Error("task callback must be a function");if(n.started=!0,Z(e)||(e=[e]),0===e.length)return f(function(){n.drain()});t=t||0;for(var i=n._tasks.head;i&&t>=i.priority;)i=i.next;for(var o=0,a=e.length;o<a;o++){var s={data:e[o],priority:t,callback:r};i?n._tasks.insertBefore(i,s):n._tasks.push(s)}f(n.process)},delete n.unshift,n};function bn(e,t){if(t=W(t||G),!Z(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var n=0,r=e.length;n<r;n++)S(e[n])(t)}function Cn(e,t,n,r){Ct(o(e).reverse(),t,n,r)}function wn(e){var t=S(e);return s(function(e,n){return e.push(function(e,t){var r;e?n(null,{error:e}):(r=arguments.length<=2?t:o(arguments,1),n(null,{value:r}))}),t.apply(this,e)})}function En(e){var t;return Z(e)?t=qe(e,wn):(t={},Fe(e,function(e,n){t[n]=wn.call(this,e)})),t}function Rn(e,t,n,r){en(e,t,function(e,t){n(e,function(e,n){t(e,!n)})},r)}var Pn=Me(Rn),Ln=De(Rn),Tn=Pe(Ln,1);function xn(e){return function(){return e}}function Mn(e,t,n){var r=5,i=0,o={times:r,intervalFunc:xn(i)};if(arguments.length<3&&"function"==typeof e?(n=t||G,t=e):(!function(e,t){if("object"==typeof t)e.times=+t.times||r,e.intervalFunc="function"==typeof t.interval?t.interval:xn(+t.interval||i),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||r}}(o,e),n=n||G),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var a=S(t),s=1;!function e(){a(function(t){t&&s++<o.times&&("function"!=typeof o.errorFilter||o.errorFilter(t))?setTimeout(e,o.intervalFunc(s)):n.apply(null,arguments)})}()}var An=function(e,t){t||(t=e,e=null);var n=S(t);return s(function(t,r){function i(e){n.apply(null,t.concat(e))}e?Mn(e,i,r):Mn(i,r)})};function In(e,t){vn(bt,e,t)}var On=Me(At(Boolean,Mt)),Dn=De(At(Boolean,Mt)),kn=Pe(Dn,1);function jn(e,t,n){var r=S(t);function i(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0}Ie(e,function(e,t){r(e,function(n,r){if(n)return t(n);t(null,{value:e,criteria:r})})},function(e,t){if(e)return n(e);n(null,qe(t.sort(i),Kt("value")))})}function Nn(e,t,n){var r=S(e);return s(function(i,o){var a,s=!1;i.push(function(){s||(o.apply(null,arguments),clearTimeout(a))}),a=setTimeout(function(){var t=e.name||"anonymous",r=new Error('Callback function "'+t+'" timed out.');r.code="ETIMEDOUT",n&&(r.info=n),s=!0,o(r)},t),r.apply(null,i)})}var Vn=Math.ceil,Un=Math.max;function Bn(e,t,n,r){var i=S(n);ke(function(e,t,n,r){for(var i=-1,o=Un(Vn((t-e)/(n||1)),0),a=Array(o);o--;)a[r?o:++i]=e,e+=n;return a}(0,e,1),t,i,r)}var Fn=Pe(Bn,1/0),Gn=Pe(Bn,1);function Wn(e,t,n,r){arguments.length<=3&&(r=n,n=t,t=Z(e)?[]:{}),r=W(r||G);var i=S(n);xe(e,function(e,n,r){i(t,e,n,r)},function(e){r(e,t)})}function Jn(e,t){var n,r=null;t=t||G,qt(e,function(e,t){S(e)(function(e,i){n=arguments.length>2?o(arguments,1):i,r=e,t(!e)})},function(){t(r,n)})}function qn(e){return function(){return(e.unmemoized||e).apply(null,arguments)}}function Hn(e,t,n){n=we(n||G);var r=S(t);if(!e())return n(null);var i=function(t){if(t)return n(t);if(e())return r(i);var a=o(arguments,1);n.apply(null,[null].concat(a))};r(i)}function zn(e,t,n){Hn(function(){return!e.apply(this,arguments)},t,n)}var Xn=function(e,t){if(t=W(t||G),!Z(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var n=0;function r(t){var r=S(e[n++]);t.push(we(i)),r.apply(null,t)}function i(i){if(i||n===e.length)return t.apply(null,arguments);r(o(arguments,1))}r([])},$n={apply:a,applyEach:Oe,applyEachSeries:Ne,asyncify:h,auto:Je,autoInject:vt,cargo:_t,compose:Et,concat:Lt,concatLimit:Pt,concatSeries:Tt,constant:xt,detect:Ot,detectLimit:Dt,detectSeries:kt,dir:Nt,doDuring:Vt,doUntil:Bt,doWhilst:Ut,during:Ft,each:Wt,eachLimit:Jt,eachOf:xe,eachOfLimit:Re,eachOfSeries:bt,eachSeries:qt,ensureAsync:Ht,every:Xt,everyLimit:$t,everySeries:Yt,filter:tn,filterLimit:nn,filterSeries:rn,forever:on,groupBy:sn,groupByLimit:an,groupBySeries:cn,log:un,map:Ie,mapLimit:ke,mapSeries:je,mapValues:dn,mapValuesLimit:ln,mapValuesSeries:pn,memoize:hn,nextTick:mn,parallel:yn,parallelLimit:gn,priorityQueue:_n,queue:Sn,race:bn,reduce:Ct,reduceRight:Cn,reflect:wn,reflectAll:En,reject:Pn,rejectLimit:Ln,rejectSeries:Tn,retry:Mn,retryable:An,seq:wt,series:In,setImmediate:f,some:On,someLimit:Dn,someSeries:kn,sortBy:jn,timeout:Nn,times:Fn,timesLimit:Bn,timesSeries:Gn,transform:Wn,tryEach:Jn,unmemoize:qn,until:zn,waterfall:Xn,whilst:Hn,all:Xt,allLimit:$t,allSeries:Yt,any:On,anyLimit:Dn,anySeries:kn,find:Ot,findLimit:Dt,findSeries:kt,forEach:Wt,forEachSeries:qt,forEachLimit:Jt,forEachOf:xe,forEachOfSeries:bt,forEachOfLimit:Re,inject:Ct,foldl:Ct,foldr:Cn,select:tn,selectLimit:nn,selectSeries:rn,wrapSync:h};n.default=$n,n.apply=a,n.applyEach=Oe,n.applyEachSeries=Ne,n.asyncify=h,n.auto=Je,n.autoInject=vt,n.cargo=_t,n.compose=Et,n.concat=Lt,n.concatLimit=Pt,n.concatSeries=Tt,n.constant=xt,n.detect=Ot,n.detectLimit=Dt,n.detectSeries=kt,n.dir=Nt,n.doDuring=Vt,n.doUntil=Bt,n.doWhilst=Ut,n.during=Ft,n.each=Wt,n.eachLimit=Jt,n.eachOf=xe,n.eachOfLimit=Re,n.eachOfSeries=bt,n.eachSeries=qt,n.ensureAsync=Ht,n.every=Xt,n.everyLimit=$t,n.everySeries=Yt,n.filter=tn,n.filterLimit=nn,n.filterSeries=rn,n.forever=on,n.groupBy=sn,n.groupByLimit=an,n.groupBySeries=cn,n.log=un,n.map=Ie,n.mapLimit=ke,n.mapSeries=je,n.mapValues=dn,n.mapValuesLimit=ln,n.mapValuesSeries=pn,n.memoize=hn,n.nextTick=mn,n.parallel=yn,n.parallelLimit=gn,n.priorityQueue=_n,n.queue=Sn,n.race=bn,n.reduce=Ct,n.reduceRight=Cn,n.reflect=wn,n.reflectAll=En,n.reject=Pn,n.rejectLimit=Ln,n.rejectSeries=Tn,n.retry=Mn,n.retryable=An,n.seq=wt,n.series=In,n.setImmediate=f,n.some=On,n.someLimit=Dn,n.someSeries=kn,n.sortBy=jn,n.timeout=Nn,n.times=Fn,n.timesLimit=Bn,n.timesSeries=Gn,n.transform=Wn,n.tryEach=Jn,n.unmemoize=qn,n.until=zn,n.waterfall=Xn,n.whilst=Hn,n.all=Xt,n.allLimit=$t,n.allSeries=Yt,n.any=On,n.anyLimit=Dn,n.anySeries=kn,n.find=Ot,n.findLimit=Dt,n.findSeries=kt,n.forEach=Wt,n.forEachSeries=qt,n.forEachLimit=Jt,n.forEachOf=xe,n.forEachOfSeries=bt,n.forEachOfLimit=Re,n.inject=Ct,n.foldl=Ct,n.foldr=Cn,n.select=tn,n.selectLimit=nn,n.selectSeries=rn,n.wrapSync=h,Object.defineProperty(n,"__esModule",{value:!0})})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{_process:8,timers:326}],58:[function(e,t,n){var r=e("create-hash"),i=e("create-hmac"),o=e("randombytes"),a=e("./lib/get-hashes"),s={md2:"md2",md5:"md5","sha-1":"sha1","sha-224":"sha224","sha-256":"sha256","sha-384":"sha384","sha-512":"sha512"},c=Object.keys(s);n.getHashes=function(){for(var e=[],t=a(),n=0,r=c.length;n<r;n++)t.indexOf(s[c[n]])>=0&&e.push(c[n]);return e},n.createHash=function(e){return e=e.toLowerCase(),s[e]&&(e=s[e]),r(e)},n.createHmac=function(e,t){return e=e.toLowerCase(),s[e]&&(e=s[e]),i(e,t)},n.randomBytes=function(e){return o(e)}},{"./lib/get-hashes":59,"create-hash":28,"create-hmac":30,randombytes:211}],59:[function(e,t,n){t.exports=function(){return["sha1","sha224","sha256","sha384","sha512","md5","rmd160"]}},{}],60:[function(e,t,n){n.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,c=(1<<s)-1,u=c>>1,l=-7,d=n?i-1:0,p=n?-1:1,f=e[t+d];for(d+=p,o=f&(1<<-l)-1,f>>=-l,l+=s;l>0;o=256*o+e[t+d],d+=p,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+d],d+=p,l-=8);if(0===o)o=1-u;else{if(o===c)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),o-=u}return(f?-1:1)*a*Math.pow(2,o-r)},n.write=function(e,t,n,r,i,o){var a,s,c,u=8*o-i-1,l=(1<<u)-1,d=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+d>=1?p/c:p*Math.pow(2,1-d))*c>=2&&(a++,c/=2),a+d>=l?(s=0,a=l):a+d>=1?(s=(t*c-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[n+f]=255&s,f+=h,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[n+f]=255&a,f+=h,a/=256,u-=8);e[n+f-h]|=128*m}},{}],61:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},{}],62:[function(e,t,n){function r(e,t){for(var n=[],r=0;r<e.length;r++)i(t,e[r])>-1&&n.push(e[r]);return n}function i(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}t.exports=r,r.big=function(e,t){for(var n=[],r={},i=0;i<t.length;i++)r[t[i]]=!0;for(i=0;i<e.length;i++)r[e[i]]&&n.push(e[i]);return n}},{}],63:[function(e,t,n){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}t.exports=function(e){return null!=e&&(r(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}(e)||!!e._isBuffer)}},{}],64:[function(e,t,n){"use strict";var r=Function.prototype.toString,i=/^\s*class\b/,o=function(e){try{var t=r.call(e);return i.test(t)}catch(e){return!1}},a=Object.prototype.toString,s="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;t.exports=function(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(s)return function(e){try{return!o(e)&&(r.call(e),!0)}catch(e){return!1}}(e);if(o(e))return!1;var t=a.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t}},{}],65:[function(e,t,n){t.exports=function(e){var t=r.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var r=Object.prototype.toString},{}],66:[function(e,t,n){var r=e("util"),i=e("extend-object"),o=e("jingle-session"),a=(e("webrtc-adapter"),e("rtcpeerconnection")),s=e("filetransfer/hashed");function c(e){o.call(this,e),this.pc=new a({iceServers:e.iceServers||[],useJingle:!0},e.constraints||{}),this.pc.on("ice",this.onIceCandidate.bind(this)),this.pc.on("iceConnectionStateChange",this.onIceStateChange.bind(this)),this.pc.on("addChannel",this.onChannelAdded.bind(this)),this.sender=null,this.receiver=null}r.inherits(c,o),c.prototype=i(c.prototype,{start:function(e){var t=this;this.state="pending",this.pc.isInitiator=!0,this.sender=new s.Sender,this.sender.on("progress",function(e,n){t._log("info","Send progress "+e+"/"+n)}),this.sender.on("sentFile",function(e){t._log("info","Sent file",e.name);var n=t.pc.localDescription.contents[0];delete n.transport,n.application={applicationType:"filetransfer",offer:{hash:{algo:e.algo,value:e.hash}}},t.send("description-info",{contents:[n]}),t.emit("sentFile",t,e)});var n=this.pc.createDataChannel("filetransfer");n.onopen=function(){t.sender.send(e,n)};this.pc.offer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},function(n,r){if(n)return t._log("error","Could not create WebRTC offer",n),t.end("failed-application",!0);r.jingle.contents[0].application={applicationType:"filetransfer",offer:{date:e.lastModifiedDate,name:e.name,size:e.size,hash:{algo:"sha-1",value:""}}},t.send("session-initiate",r.jingle)})},accept:function(){var e=this;this._log("info","Accepted incoming session"),this.state="active",this.pc.answer(function(t,n){if(t)return e._log("error","Could not create WebRTC answer",t),e.end("failed-application");e.send("session-accept",n.jingle)})},end:function(e,t){this.pc.close(),o.prototype.end.call(this,e,t)},maybeReceivedFile:function(){this.receiver.metadata.hash.value&&(this.receiver.metadata.hash.value===this.receiver.metadata.actualhash?(this._log("info","File hash matches"),this.emit("receivedFile",this,this.receivedFile,this.receiver.metadata),this.end("success")):(this._log("error","File hash does not match"),this.end("media-error")))},onIceCandidate:function(e){this._log("info","Discovered new ICE candidate",e.jingle),this.send("transport-info",e.jingle)},onIceStateChange:function(){switch(this.pc.iceConnectionState){case"checking":this.connectionState="connecting";break;case"completed":case"connected":this.connectionState="connected";break;case"disconnected":"stable"===this.pc.signalingState?this.connectionState="interrupted":this.connectionState="disconnected";break;case"failed":this.connectionState="failed",this.end("failed-transport");break;case"closed":this.connectionState="disconnected"}},onChannelAdded:function(e){this.receiver.receive(null,e)},onSessionInitiate:function(e,t){var n=this;this._log("info","Initiating incoming session"),this.state="pending",this.pc.isInitiator=!1;var r=e.contents[0].application;this.receiver=new s.Receiver({hash:r.offer.hash.algo}),this.receiver.on("progress",function(e,t){n._log("info","Receive progress "+e+"/"+t)}),this.receiver.on("receivedFile",function(e){n.receivedFile=e,n.maybeReceivedFile()}),this.receiver.metadata=r.offer,e.contents[0].application={applicationType:"datachannel"},this.pc.handleOffer({type:"offer",jingle:e},function(e){if(e)return n._log("error","Could not create WebRTC answer"),t({condition:"general-error"});t()})},onSessionAccept:function(e,t){var n=this;this.state="active",e.contents[0].application={applicationType:"datachannel"},this.pc.handleAnswer({type:"answer",jingle:e},function(e){if(e)return n._log("error","Could not process WebRTC answer"),t({condition:"general-error"});n.emit("accepted",n),t()})},onSessionTerminate:function(e,t){this._log("info","Terminating session"),this.pc.close(),o.prototype.end.call(this,e.reason,!0),t()},onDescriptionInfo:function(e,t){var n=e.contents[0].application.offer.hash;this.receiver.metadata.hash=n,this.receiver.metadata.actualhash&&this.maybeReceivedFile(),t()},onTransportInfo:function(e,t){this.pc.processIce(e,function(){t()})}}),t.exports=c},{"extend-object":45,"filetransfer/hashed":47,"jingle-session":68,rtcpeerconnection:69,util:331,"webrtc-adapter":70}],67:[function(e,t,n){(function(e,r,i){!function(e,r){"object"==typeof n&&void 0!==t?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r(e.async=e.async||{})}(this,function(n){"use strict";function o(e,t){t|=0;for(var n=Math.max(e.length-t,0),r=Array(n),i=0;i<n;i++)r[i]=e[t+i];return r}var a=function(e){var t=o(arguments,1);return function(){var n=o(arguments);return e.apply(null,t.concat(n))}},s=function(e){return function(){var t=o(arguments),n=t.pop();e.call(this,t,n)}};function c(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var u="function"==typeof i&&i,l="object"==typeof e&&"function"==typeof e.nextTick;function d(e){setTimeout(e,0)}function p(e){return function(t){var n=o(arguments,1);e(function(){t.apply(null,n)})}}var f=p(u?i:l?e.nextTick:d);function h(e){return s(function(t,n){var r;try{r=e.apply(this,t)}catch(e){return n(e)}c(r)&&"function"==typeof r.then?r.then(function(e){m(n,null,e)},function(e){m(n,e.message?e:new Error(e))}):n(null,r)})}function m(e,t,n){try{e(t,n)}catch(e){f(v,e)}}function v(e){throw e}var y="function"==typeof Symbol;function g(e){return y&&"AsyncFunction"===e[Symbol.toStringTag]}function S(e){return g(e)?h(e):e}function _(e){return function(t){var n=o(arguments,1),r=s(function(n,r){var i=this;return e(t,function(e,t){S(e).apply(i,n.concat(t))},r)});return n.length?r.apply(this,n):r}}var b="object"==typeof r&&r&&r.Object===Object&&r,C="object"==typeof self&&self&&self.Object===Object&&self,w=b||C||Function("return this")(),E=w.Symbol,R=Object.prototype,P=R.hasOwnProperty,L=R.toString,T=E?E.toStringTag:void 0;var x=Object.prototype.toString;var M="[object Null]",A="[object Undefined]",I=E?E.toStringTag:void 0;function O(e){return null==e?void 0===e?A:M:I&&I in Object(e)?function(e){var t=P.call(e,T),n=e[T];try{e[T]=void 0;var r=!0}catch(e){}var i=L.call(e);return r&&(t?e[T]=n:delete e[T]),i}(e):function(e){return x.call(e)}(e)}var D="[object AsyncFunction]",k="[object Function]",j="[object GeneratorFunction]",N="[object Proxy]";var V=9007199254740991;function U(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=V}function B(e){return null!=e&&U(e.length)&&!function(e){if(!c(e))return!1;var t=O(e);return t==k||t==j||t==D||t==N}(e)}var F={};function G(){}function W(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}var J="function"==typeof Symbol&&Symbol.iterator,q=function(e){return J&&e[J]&&e[J]()};function H(e){return null!=e&&"object"==typeof e}var z="[object Arguments]";function X(e){return H(e)&&O(e)==z}var $=Object.prototype,Y=$.hasOwnProperty,K=$.propertyIsEnumerable,Q=X(function(){return arguments}())?X:function(e){return H(e)&&Y.call(e,"callee")&&!K.call(e,"callee")},Z=Array.isArray;var ee="object"==typeof n&&n&&!n.nodeType&&n,te=ee&&"object"==typeof t&&t&&!t.nodeType&&t,ne=te&&te.exports===ee?w.Buffer:void 0,re=(ne?ne.isBuffer:void 0)||function(){return!1},ie=9007199254740991,oe=/^(?:0|[1-9]\d*)$/;function ae(e,t){var n=typeof e;return!!(t=null==t?ie:t)&&("number"==n||"symbol"!=n&&oe.test(e))&&e>-1&&e%1==0&&e<t}var se={};se["[object Float32Array]"]=se["[object Float64Array]"]=se["[object Int8Array]"]=se["[object Int16Array]"]=se["[object Int32Array]"]=se["[object Uint8Array]"]=se["[object Uint8ClampedArray]"]=se["[object Uint16Array]"]=se["[object Uint32Array]"]=!0,se["[object Arguments]"]=se["[object Array]"]=se["[object ArrayBuffer]"]=se["[object Boolean]"]=se["[object DataView]"]=se["[object Date]"]=se["[object Error]"]=se["[object Function]"]=se["[object Map]"]=se["[object Number]"]=se["[object Object]"]=se["[object RegExp]"]=se["[object Set]"]=se["[object String]"]=se["[object WeakMap]"]=!1;var ce,ue="object"==typeof n&&n&&!n.nodeType&&n,le=ue&&"object"==typeof t&&t&&!t.nodeType&&t,de=le&&le.exports===ue&&b.process,pe=function(){try{var e=le&&le.require&&le.require("util").types;return e||de&&de.binding&&de.binding("util")}catch(e){}}(),fe=pe&&pe.isTypedArray,he=fe?(ce=fe,function(e){return ce(e)}):function(e){return H(e)&&U(e.length)&&!!se[O(e)]},me=Object.prototype.hasOwnProperty;function ve(e,t){var n=Z(e),r=!n&&Q(e),i=!n&&!r&&re(e),o=!n&&!r&&!i&&he(e),a=n||r||i||o,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=s.length;for(var u in e)!t&&!me.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ae(u,c))||s.push(u);return s}var ye=Object.prototype;var ge=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),Se=Object.prototype.hasOwnProperty;function _e(e){if(n=(t=e)&&t.constructor,t!==("function"==typeof n&&n.prototype||ye))return ge(e);var t,n,r=[];for(var i in Object(e))Se.call(e,i)&&"constructor"!=i&&r.push(i);return r}function be(e){return B(e)?ve(e):_e(e)}function Ce(e){if(B(e))return function(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}(e);var t,n,r,i,o=q(e);return o?function(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}(o):(n=be(t=e),r=-1,i=n.length,function(){var e=n[++r];return r<i?{value:t[e],key:e}:null})}function we(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function Ee(e){return function(t,n,r){if(r=W(r||G),e<=0||!t)return r(null);var i=Ce(t),o=!1,a=0,s=!1;function c(e,t){if(a-=1,e)o=!0,r(e);else{if(t===F||o&&a<=0)return o=!0,r(null);s||u()}}function u(){for(s=!0;a<e&&!o;){var t=i();if(null===t)return o=!0,void(a<=0&&r(null));a+=1,n(t.value,t.key,we(c))}s=!1}u()}}function Re(e,t,n,r){Ee(t)(e,S(n),r)}function Pe(e,t){return function(n,r,i){return e(n,t,r,i)}}function Le(e,t,n){n=W(n||G);var r=0,i=0,o=e.length;function a(e,t){e?n(e):++i!==o&&t!==F||n(null)}for(0===o&&n(null);r<o;r++)t(e[r],r,we(a))}var Te=Pe(Re,1/0),xe=function(e,t,n){(B(e)?Le:Te)(e,S(t),n)};function Me(e){return function(t,n,r){return e(xe,t,S(n),r)}}function Ae(e,t,n,r){r=r||G,t=t||[];var i=[],o=0,a=S(n);e(t,function(e,t,n){var r=o++;a(e,function(e,t){i[r]=t,n(e)})},function(e){r(e,i)})}var Ie=Me(Ae),Oe=_(Ie);function De(e){return function(t,n,r,i){return e(Ee(n),t,S(r),i)}}var ke=De(Ae),je=Pe(ke,1),Ne=_(je);function Ve(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}var Ue,Be=function(e,t,n){for(var r=-1,i=Object(e),o=n(e),a=o.length;a--;){var s=o[Ue?a:++r];if(!1===t(i[s],s,i))break}return e};function Fe(e,t){return e&&Be(e,t,be)}function Ge(e){return e!=e}function We(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,Ge,n)}var Je=function(e,t,n){"function"==typeof t&&(n=t,t=null),n=W(n||G);var r=be(e).length;if(!r)return n(null);t||(t=r);var i={},a=0,s=!1,c=Object.create(null),u=[],l=[],d={};function p(e,t){u.push(function(){!function(e,t){if(s)return;var r=we(function(t,r){if(a--,arguments.length>2&&(r=o(arguments,1)),t){var u={};Fe(i,function(e,t){u[t]=e}),u[e]=r,s=!0,c=Object.create(null),n(t,u)}else i[e]=r,Ve(c[e]||[],function(e){e()}),f()});a++;var u=S(t[t.length-1]);t.length>1?u(i,r):u(r)}(e,t)})}function f(){if(0===u.length&&0===a)return n(null,i);for(;u.length&&a<t;){u.shift()()}}function h(t){var n=[];return Fe(e,function(e,r){Z(e)&&We(e,t,0)>=0&&n.push(r)}),n}Fe(e,function(t,n){if(!Z(t))return p(n,[t]),void l.push(n);var r=t.slice(0,t.length-1),i=r.length;if(0===i)return p(n,t),void l.push(n);d[n]=i,Ve(r,function(o){if(!e[o])throw new Error("async.auto task `"+n+"` has a non-existent dependency `"+o+"` in "+r.join(", "));!function(e,t){var n=c[e];n||(n=c[e]=[]);n.push(t)}(o,function(){0===--i&&p(n,t)})})}),function(){var e,t=0;for(;l.length;)e=l.pop(),t++,Ve(h(e),function(e){0==--d[e]&&l.push(e)});if(t!==r)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),f()};function qe(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var He="[object Symbol]";var ze=1/0,Xe=E?E.prototype:void 0,$e=Xe?Xe.toString:void 0;function Ye(e){if("string"==typeof e)return e;if(Z(e))return qe(e,Ye)+"";if(function(e){return"symbol"==typeof e||H(e)&&O(e)==He}(e))return $e?$e.call(e):"";var t=e+"";return"0"==t&&1/e==-ze?"-0":t}function Ke(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}(e,t,n)}var Qe=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Ze="[\\ud800-\\udfff]",et="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",tt="\\ud83c[\\udffb-\\udfff]",nt="[^\\ud800-\\udfff]",rt="(?:\\ud83c[\\udde6-\\uddff]){2}",it="[\\ud800-\\udbff][\\udc00-\\udfff]",ot="(?:"+et+"|"+tt+")"+"?",at="[\\ufe0e\\ufe0f]?"+ot+("(?:\\u200d(?:"+[nt,rt,it].join("|")+")[\\ufe0e\\ufe0f]?"+ot+")*"),st="(?:"+[nt+et+"?",et,rt,it,Ze].join("|")+")",ct=RegExp(tt+"(?="+tt+")|"+st+at,"g");function ut(e){return function(e){return Qe.test(e)}(e)?function(e){return e.match(ct)||[]}(e):function(e){return e.split("")}(e)}var lt=/^\s+|\s+$/g;function dt(e,t,n){var r;if((e=null==(r=e)?"":Ye(r))&&(n||void 0===t))return e.replace(lt,"");if(!e||!(t=Ye(t)))return e;var i=ut(e),o=ut(t);return Ke(i,function(e,t){for(var n=-1,r=e.length;++n<r&&We(t,e[n],0)>-1;);return n}(i,o),function(e,t){for(var n=e.length;n--&&We(t,e[n],0)>-1;);return n}(i,o)+1).join("")}var pt=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,ft=/,/,ht=/(=.+)?(\s*)$/,mt=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function vt(e,t){var n={};Fe(e,function(e,t){var r,i,o=g(e),a=!o&&1===e.length||o&&0===e.length;if(Z(e))r=e.slice(0,-1),e=e[e.length-1],n[t]=r.concat(r.length>0?s:e);else if(a)n[t]=e;else{if(r=i=(i=(i=(i=(i=e).toString().replace(mt,"")).match(pt)[2].replace(" ",""))?i.split(ft):[]).map(function(e){return dt(e.replace(ht,""))}),0===e.length&&!o&&0===r.length)throw new Error("autoInject task functions require explicit parameters.");o||r.pop(),n[t]=r.concat(s)}function s(t,n){var i=qe(r,function(e){return t[e]});i.push(n),S(e).apply(null,i)}}),Je(n,t)}function yt(){this.head=this.tail=null,this.length=0}function gt(e,t){e.length=1,e.head=e.tail=t}function St(e,t,n){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var r=S(e),i=0,o=[],a=!1;function s(e,t,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(l.started=!0,Z(e)||(e=[e]),0===e.length&&l.idle())return f(function(){l.drain()});for(var r=0,i=e.length;r<i;r++){var o={data:e[r],callback:n||G};t?l._tasks.unshift(o):l._tasks.push(o)}a||(a=!0,f(function(){a=!1,l.process()}))}function c(e){return function(t){i-=1;for(var n=0,r=e.length;n<r;n++){var a=e[n],s=We(o,a,0);0===s?o.shift():s>0&&o.splice(s,1),a.callback.apply(a,arguments),null!=t&&l.error(t,a.data)}i<=l.concurrency-l.buffer&&l.unsaturated(),l.idle()&&l.drain(),l.process()}}var u=!1,l={_tasks:new yt,concurrency:t,payload:n,saturated:G,unsaturated:G,buffer:t/4,empty:G,drain:G,error:G,started:!1,paused:!1,push:function(e,t){s(e,!1,t)},kill:function(){l.drain=G,l._tasks.empty()},unshift:function(e,t){s(e,!0,t)},remove:function(e){l._tasks.remove(e)},process:function(){if(!u){for(u=!0;!l.paused&&i<l.concurrency&&l._tasks.length;){var e=[],t=[],n=l._tasks.length;l.payload&&(n=Math.min(n,l.payload));for(var a=0;a<n;a++){var s=l._tasks.shift();e.push(s),o.push(s),t.push(s.data)}i+=1,0===l._tasks.length&&l.empty(),i===l.concurrency&&l.saturated();var d=we(c(e));r(t,d)}u=!1}},length:function(){return l._tasks.length},running:function(){return i},workersList:function(){return o},idle:function(){return l._tasks.length+i===0},pause:function(){l.paused=!0},resume:function(){!1!==l.paused&&(l.paused=!1,f(l.process))}};return l}function _t(e,t){return St(e,1,t)}yt.prototype.removeLink=function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e},yt.prototype.empty=function(){for(;this.head;)this.shift();return this},yt.prototype.insertAfter=function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1},yt.prototype.insertBefore=function(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1},yt.prototype.unshift=function(e){this.head?this.insertBefore(this.head,e):gt(this,e)},yt.prototype.push=function(e){this.tail?this.insertAfter(this.tail,e):gt(this,e)},yt.prototype.shift=function(){return this.head&&this.removeLink(this.head)},yt.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},yt.prototype.toArray=function(){for(var e=Array(this.length),t=this.head,n=0;n<this.length;n++)e[n]=t.data,t=t.next;return e},yt.prototype.remove=function(e){for(var t=this.head;t;){var n=t.next;e(t)&&this.removeLink(t),t=n}return this};var bt=Pe(Re,1);function Ct(e,t,n,r){r=W(r||G);var i=S(n);bt(e,function(e,n,r){i(t,e,function(e,n){t=n,r(e)})},function(e){r(e,t)})}function wt(){var e=qe(arguments,S);return function(){var t=o(arguments),n=this,r=t[t.length-1];"function"==typeof r?t.pop():r=G,Ct(e,t,function(e,t,r){t.apply(n,e.concat(function(e){var t=o(arguments,1);r(e,t)}))},function(e,t){r.apply(n,[e].concat(t))})}}var Et=function(){return wt.apply(null,o(arguments).reverse())},Rt=Array.prototype.concat,Pt=function(e,t,n,r){r=r||G;var i=S(n);ke(e,t,function(e,t){i(e,function(e){return e?t(e):t(null,o(arguments,1))})},function(e,t){for(var n=[],i=0;i<t.length;i++)t[i]&&(n=Rt.apply(n,t[i]));return r(e,n)})},Lt=Pe(Pt,1/0),Tt=Pe(Pt,1),xt=function(){var e=o(arguments),t=[null].concat(e);return function(){return arguments[arguments.length-1].apply(this,t)}};function Mt(e){return e}function At(e,t){return function(n,r,i,o){o=o||G;var a,s=!1;n(r,function(n,r,o){i(n,function(r,i){r?o(r):e(i)&&!a?(s=!0,a=t(!0,n),o(null,F)):o()})},function(e){e?o(e):o(null,s?a:t(!1))})}}function It(e,t){return t}var Ot=Me(At(Mt,It)),Dt=De(At(Mt,It)),kt=Pe(Dt,1);function jt(e){return function(t){var n=o(arguments,1);n.push(function(t){var n=o(arguments,1);"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&Ve(n,function(t){console[e](t)}))}),S(t).apply(null,n)}}var Nt=jt("dir");function Vt(e,t,n){n=we(n||G);var r=S(e),i=S(t);function a(e){if(e)return n(e);var t=o(arguments,1);t.push(s),i.apply(this,t)}function s(e,t){return e?n(e):t?void r(a):n(null)}s(null,!0)}function Ut(e,t,n){n=we(n||G);var r=S(e),i=function(e){if(e)return n(e);var a=o(arguments,1);if(t.apply(this,a))return r(i);n.apply(null,[null].concat(a))};r(i)}function Bt(e,t,n){Ut(e,function(){return!t.apply(this,arguments)},n)}function Ft(e,t,n){n=we(n||G);var r=S(t),i=S(e);function o(e){if(e)return n(e);i(a)}function a(e,t){return e?n(e):t?void r(o):n(null)}i(a)}function Gt(e){return function(t,n,r){return e(t,r)}}function Wt(e,t,n){xe(e,Gt(S(t)),n)}function Jt(e,t,n,r){Ee(t)(e,Gt(S(n)),r)}var qt=Pe(Jt,1);function Ht(e){return g(e)?e:s(function(t,n){var r=!0;t.push(function(){var e=arguments;r?f(function(){n.apply(null,e)}):n.apply(null,e)}),e.apply(this,t),r=!1})}function zt(e){return!e}var Xt=Me(At(zt,zt)),$t=De(At(zt,zt)),Yt=Pe($t,1);function Kt(e){return function(t){return null==t?void 0:t[e]}}function Qt(e,t,n,r){var i=new Array(t.length);e(t,function(e,t,r){n(e,function(e,n){i[t]=!!n,r(e)})},function(e){if(e)return r(e);for(var n=[],o=0;o<t.length;o++)i[o]&&n.push(t[o]);r(null,n)})}function Zt(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(n,o){n?r(n):(o&&i.push({index:t,value:e}),r())})},function(e){e?r(e):r(null,qe(i.sort(function(e,t){return e.index-t.index}),Kt("value")))})}function en(e,t,n,r){(B(t)?Qt:Zt)(e,t,S(n),r||G)}var tn=Me(en),nn=De(en),rn=Pe(nn,1);function on(e,t){var n=we(t||G),r=S(Ht(e));!function e(t){if(t)return n(t);r(e)}()}var an=function(e,t,n,r){r=r||G;var i=S(n);ke(e,t,function(e,t){i(e,function(n,r){return n?t(n):t(null,{key:r,val:e})})},function(e,t){for(var n={},i=Object.prototype.hasOwnProperty,o=0;o<t.length;o++)if(t[o]){var a=t[o].key,s=t[o].val;i.call(n,a)?n[a].push(s):n[a]=[s]}return r(e,n)})},sn=Pe(an,1/0),cn=Pe(an,1),un=jt("log");function ln(e,t,n,r){r=W(r||G);var i={},o=S(n);Re(e,t,function(e,t,n){o(e,t,function(e,r){if(e)return n(e);i[t]=r,n()})},function(e){r(e,i)})}var dn=Pe(ln,1/0),pn=Pe(ln,1);function fn(e,t){return t in e}function hn(e,t){var n=Object.create(null),r=Object.create(null);t=t||Mt;var i=S(e),a=s(function(e,a){var s=t.apply(null,e);fn(n,s)?f(function(){a.apply(null,n[s])}):fn(r,s)?r[s].push(a):(r[s]=[a],i.apply(null,e.concat(function(){var e=o(arguments);n[s]=e;var t=r[s];delete r[s];for(var i=0,a=t.length;i<a;i++)t[i].apply(null,e)})))});return a.memo=n,a.unmemoized=e,a}var mn=p(l?e.nextTick:u?i:d);function vn(e,t,n){n=n||G;var r=B(t)?[]:{};e(t,function(e,t,n){S(e)(function(e,i){arguments.length>2&&(i=o(arguments,1)),r[t]=i,n(e)})},function(e){n(e,r)})}function yn(e,t){vn(xe,e,t)}function gn(e,t,n){vn(Ee(t),e,n)}var Sn=function(e,t){var n=S(e);return St(function(e,t){n(e[0],t)},t,1)},_n=function(e,t){var n=Sn(e,t);return n.push=function(e,t,r){if(null==r&&(r=G),"function"!=typeof r)throw new Error("task callback must be a function");if(n.started=!0,Z(e)||(e=[e]),0===e.length)return f(function(){n.drain()});t=t||0;for(var i=n._tasks.head;i&&t>=i.priority;)i=i.next;for(var o=0,a=e.length;o<a;o++){var s={data:e[o],priority:t,callback:r};i?n._tasks.insertBefore(i,s):n._tasks.push(s)}f(n.process)},delete n.unshift,n};function bn(e,t){if(t=W(t||G),!Z(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var n=0,r=e.length;n<r;n++)S(e[n])(t)}function Cn(e,t,n,r){Ct(o(e).reverse(),t,n,r)}function wn(e){var t=S(e);return s(function(e,n){return e.push(function(e,t){var r;e?n(null,{error:e}):(r=arguments.length<=2?t:o(arguments,1),n(null,{value:r}))}),t.apply(this,e)})}function En(e){var t;return Z(e)?t=qe(e,wn):(t={},Fe(e,function(e,n){t[n]=wn.call(this,e)})),t}function Rn(e,t,n,r){en(e,t,function(e,t){n(e,function(e,n){t(e,!n)})},r)}var Pn=Me(Rn),Ln=De(Rn),Tn=Pe(Ln,1);function xn(e){return function(){return e}}function Mn(e,t,n){var r=5,i=0,o={times:r,intervalFunc:xn(i)};if(arguments.length<3&&"function"==typeof e?(n=t||G,t=e):(!function(e,t){if("object"==typeof t)e.times=+t.times||r,e.intervalFunc="function"==typeof t.interval?t.interval:xn(+t.interval||i),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||r}}(o,e),n=n||G),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var a=S(t),s=1;!function e(){a(function(t){t&&s++<o.times&&("function"!=typeof o.errorFilter||o.errorFilter(t))?setTimeout(e,o.intervalFunc(s)):n.apply(null,arguments)})}()}var An=function(e,t){t||(t=e,e=null);var n=S(t);return s(function(t,r){function i(e){n.apply(null,t.concat(e))}e?Mn(e,i,r):Mn(i,r)})};function In(e,t){vn(bt,e,t)}var On=Me(At(Boolean,Mt)),Dn=De(At(Boolean,Mt)),kn=Pe(Dn,1);function jn(e,t,n){var r=S(t);function i(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0}Ie(e,function(e,t){r(e,function(n,r){if(n)return t(n);t(null,{value:e,criteria:r})})},function(e,t){if(e)return n(e);n(null,qe(t.sort(i),Kt("value")))})}function Nn(e,t,n){var r=S(e);return s(function(i,o){var a,s=!1;i.push(function(){s||(o.apply(null,arguments),clearTimeout(a))}),a=setTimeout(function(){var t=e.name||"anonymous",r=new Error('Callback function "'+t+'" timed out.');r.code="ETIMEDOUT",n&&(r.info=n),s=!0,o(r)},t),r.apply(null,i)})}var Vn=Math.ceil,Un=Math.max;function Bn(e,t,n,r){var i=S(n);ke(function(e,t,n,r){for(var i=-1,o=Un(Vn((t-e)/(n||1)),0),a=Array(o);o--;)a[r?o:++i]=e,e+=n;return a}(0,e,1),t,i,r)}var Fn=Pe(Bn,1/0),Gn=Pe(Bn,1);function Wn(e,t,n,r){arguments.length<=3&&(r=n,n=t,t=Z(e)?[]:{}),r=W(r||G);var i=S(n);xe(e,function(e,n,r){i(t,e,n,r)},function(e){r(e,t)})}function Jn(e,t){var n,r=null;t=t||G,qt(e,function(e,t){S(e)(function(e,i){n=arguments.length>2?o(arguments,1):i,r=e,t(!e)})},function(){t(r,n)})}function qn(e){return function(){return(e.unmemoized||e).apply(null,arguments)}}function Hn(e,t,n){n=we(n||G);var r=S(t);if(!e())return n(null);var i=function(t){if(t)return n(t);if(e())return r(i);var a=o(arguments,1);n.apply(null,[null].concat(a))};r(i)}function zn(e,t,n){Hn(function(){return!e.apply(this,arguments)},t,n)}var Xn=function(e,t){if(t=W(t||G),!Z(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var n=0;function r(t){var r=S(e[n++]);t.push(we(i)),r.apply(null,t)}function i(i){if(i||n===e.length)return t.apply(null,arguments);r(o(arguments,1))}r([])},$n={apply:a,applyEach:Oe,applyEachSeries:Ne,asyncify:h,auto:Je,autoInject:vt,cargo:_t,compose:Et,concat:Lt,concatLimit:Pt,concatSeries:Tt,constant:xt,detect:Ot,detectLimit:Dt,detectSeries:kt,dir:Nt,doDuring:Vt,doUntil:Bt,doWhilst:Ut,during:Ft,each:Wt,eachLimit:Jt,eachOf:xe,eachOfLimit:Re,eachOfSeries:bt,eachSeries:qt,ensureAsync:Ht,every:Xt,everyLimit:$t,everySeries:Yt,filter:tn,filterLimit:nn,filterSeries:rn,forever:on,groupBy:sn,groupByLimit:an,groupBySeries:cn,log:un,map:Ie,mapLimit:ke,mapSeries:je,mapValues:dn,mapValuesLimit:ln,mapValuesSeries:pn,memoize:hn,nextTick:mn,parallel:yn,parallelLimit:gn,priorityQueue:_n,queue:Sn,race:bn,reduce:Ct,reduceRight:Cn,reflect:wn,reflectAll:En,reject:Pn,rejectLimit:Ln,rejectSeries:Tn,retry:Mn,retryable:An,seq:wt,series:In,setImmediate:f,some:On,someLimit:Dn,someSeries:kn,sortBy:jn,timeout:Nn,times:Fn,timesLimit:Bn,timesSeries:Gn,transform:Wn,tryEach:Jn,unmemoize:qn,until:zn,waterfall:Xn,whilst:Hn,all:Xt,allLimit:$t,allSeries:Yt,any:On,anyLimit:Dn,anySeries:kn,find:Ot,findLimit:Dt,findSeries:kt,forEach:Wt,forEachSeries:qt,forEachLimit:Jt,forEachOf:xe,forEachOfSeries:bt,forEachOfLimit:Re,inject:Ct,foldl:Ct,foldr:Cn,select:tn,selectLimit:nn,selectSeries:rn,wrapSync:h};n.default=$n,n.apply=a,n.applyEach=Oe,n.applyEachSeries=Ne,n.asyncify=h,n.auto=Je,n.autoInject=vt,n.cargo=_t,n.compose=Et,n.concat=Lt,n.concatLimit=Pt,n.concatSeries=Tt,n.constant=xt,n.detect=Ot,n.detectLimit=Dt,n.detectSeries=kt,n.dir=Nt,n.doDuring=Vt,n.doUntil=Bt,n.doWhilst=Ut,n.during=Ft,n.each=Wt,n.eachLimit=Jt,n.eachOf=xe,n.eachOfLimit=Re,n.eachOfSeries=bt,n.eachSeries=qt,n.ensureAsync=Ht,n.every=Xt,n.everyLimit=$t,n.everySeries=Yt,n.filter=tn,n.filterLimit=nn,n.filterSeries=rn,n.forever=on,n.groupBy=sn,n.groupByLimit=an,n.groupBySeries=cn,n.log=un,n.map=Ie,n.mapLimit=ke,n.mapSeries=je,n.mapValues=dn,n.mapValuesLimit=ln,n.mapValuesSeries=pn,n.memoize=hn,n.nextTick=mn,n.parallel=yn,n.parallelLimit=gn,n.priorityQueue=_n,n.queue=Sn,n.race=bn,n.reduce=Ct,n.reduceRight=Cn,n.reflect=wn,n.reflectAll=En,n.reject=Pn,n.rejectLimit=Ln,n.rejectSeries=Tn,n.retry=Mn,n.retryable=An,n.seq=wt,n.series=In,n.setImmediate=f,n.some=On,n.someLimit=Dn,n.someSeries=kn,n.sortBy=jn,n.timeout=Nn,n.times=Fn,n.timesLimit=Bn,n.timesSeries=Gn,n.transform=Wn,n.tryEach=Jn,n.unmemoize=qn,n.until=zn,n.waterfall=Xn,n.whilst=Hn,n.all=Xt,n.allLimit=$t,n.allSeries=Yt,n.any=On,n.anyLimit=Dn,n.anySeries=kn,n.find=Ot,n.findLimit=Dt,n.findSeries=kt,n.forEach=Wt,n.forEachSeries=qt,n.forEachLimit=Jt,n.forEachOf=xe,n.forEachOfSeries=bt,n.forEachOfLimit=Re,n.inject=Ct,n.foldl=Ct,n.foldr=Cn,n.select=tn,n.selectLimit=nn,n.selectSeries=rn,n.wrapSync=h,Object.defineProperty(n,"__esModule",{value:!0})})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{_process:8,timers:326}],68:[function(e,t,n){var r=e("util"),i=e("uuid"),o=e("async"),a=e("extend-object"),s=e("wildemitter"),c={"content-accept":"onContentAccept","content-add":"onContentAdd","content-modify":"onContentModify","content-reject":"onContentReject","content-remove":"onContentRemove","description-info":"onDescriptionInfo","security-info":"onSecurityInfo","session-accept":"onSessionAccept","session-info":"onSessionInfo","session-initiate":"onSessionInitiate","session-terminate":"onSessionTerminate","transport-accept":"onTransportAccept","transport-info":"onTransportInfo","transport-reject":"onTransportReject","transport-replace":"onTransportReplace","source-add":"onSourceAdd","source-remove":"onSourceRemove"};function u(e){s.call(this);var t=this;this.sid=e.sid||i.v4(),this.peer=e.peer,this.peerID=e.peerID||this.peer.full||this.peer,this.isInitiator=e.initiator||!1,this.parent=e.parent,this.state="starting",this.connectionState="starting",this.pendingApplicationTypes=e.applicationTypes||[],this.pendingAction=!1,this.processingQueue=o.queue(function(e,n){if(t.ended)return n();var r=e.action,i=e.changes,o=e.cb;if(t._log("debug",r),!c[r])return t._log("error","Invalid action: "+r),o({condition:"bad-request"}),n();t[c[r]](i,function(e,t){return o(e,t),n()})})}r.inherits(u,s),Object.keys(c).forEach(function(e){var t=c[e];u.prototype[t]=function(t,n){this._log("error","Unsupported action: "+e),n()}}),Object.defineProperties(u.prototype,{state:{get:function(){return this._sessionState},set:function(e){if(e!==this._sessionState){var t=this._sessionState;this._log("info","Changing session state to: "+e),this._sessionState=e,this.emit("change:sessionState",this,e),this.emit("change:"+e,this,!0),t&&this.emit("change:"+t,this,!1)}}},connectionState:{get:function(){return this._connectionState},set:function(e){if(e!==this._connectionState){var t=this._connectionState;this._log("info","Changing connection state to: "+e),this._connectionState=e,this.emit("change:connectionState",this,e),this.emit("change:"+e,this,!0),t&&this.emit("change:"+t,this,!1)}}},starting:{get:function(){return"starting"===this._sessionState}},pending:{get:function(){return"pending"===this._sessionState}},active:{get:function(){return"active"===this._sessionState}},ended:{get:function(){return"ended"===this._sessionState}},connected:{get:function(){return"connected"===this._connectionState}},connecting:{get:function(){return"connecting"===this._connectionState}},disconnected:{get:function(){return"disconnected"===this._connectionState}},interrupted:{get:function(){return"interrupted"===this._connectionState}}}),u.prototype=a(u.prototype,{_log:function(e,t){t=this.sid+": "+t,this.emit("log:"+e,t)},send:function(e,t){(t=t||{}).sid=this.sid,t.action=e;this.pendingAction=!!{"session-inititate":!0,"session-accept":!0,"content-add":!0,"content-remove":!0,"content-reject":!0,"content-accept":!0,"content-modify":!0,"transport-replace":!0,"transport-reject":!0,"transport-accept":!0,"source-add":!0,"source-remove":!0}[e]&&e,this.emit("send",{to:this.peer,id:i.v4(),type:"set",jingle:t})},process:function(e,t,n){this.processingQueue.push({action:e,changes:t,cb:n})},start:function(){this._log("error","Can not start base sessions"),this.end("unsupported-applications",!0)},accept:function(){this._log("error","Can not accept base sessions"),this.end("unsupported-applications")},cancel:function(){this.end("cancel")},decline:function(){this.end("decline")},end:function(e,t){this.state="ended",this.processingQueue.kill(),e||(e="success"),"string"==typeof e&&(e={condition:e}),t||this.send("session-terminate",{reason:e}),this.emit("terminated",this,e)},onSessionTerminate:function(e,t){this.end(e.reason,!0),t()},onSessionInfo:function(e,t){var n={sid:!0,action:!0,initiator:!0,responder:!0},r=!1;Object.keys(e).forEach(function(e){n[e]||(r=!0)}),r?t({type:"modify",condition:"feature-not-implemented",jingleCondition:"unsupported-info"}):t()},onDescriptionInfo:function(e,t){t({type:"modify",condition:"feature-not-implemented",jingleCondition:"unsupported-info"})},onTransportInfo:function(e,t){t({type:"modify",condition:"feature-not-implemented",jingleCondition:"unsupported-info"})},onContentAdd:function(e,t){t(),this.send("content-reject",{reason:{condition:"failed-application",text:"content-add is not supported"}})},onTransportReplace:function(e,t){t(),this.send("transport-reject",{reason:{condition:"failed-application",text:"transport-replace is not supported"}})}}),t.exports=u},{async:67,"extend-object":45,util:331,uuid:332,wildemitter:80}],69:[function(e,t,n){var r=e("util"),i=e("sdp-jingle-json"),o=e("wildemitter"),a=e("webrtc-adapter"),s=e("lodash.clonedeep");function c(e,t){var n,r=this;o.call(this),(e=e||{}).iceServers=e.iceServers||[];var i=a.browserDetails.browser;for(n in this.enableChromeNativeSimulcast=!1,t&&t.optional&&"chrome"===i&&null===navigator.appVersion.match(/Chromium\//)&&t.optional.forEach(function(e){e.enableChromeNativeSimulcast&&(r.enableChromeNativeSimulcast=!0)}),this.enableMultiStreamHacks=!1,t&&t.optional&&"chrome"===i&&t.optional.forEach(function(e){e.enableMultiStreamHacks&&(r.enableMultiStreamHacks=!0)}),this.restrictBandwidth=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetRestrictBandwidth&&(r.restrictBandwidth=e.andyetRestrictBandwidth)}),this.batchIceCandidates=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetBatchIce&&(r.batchIceCandidates=e.andyetBatchIce)}),this.batchedIceCandidates=[],t&&t.optional&&"chrome"===i&&t.optional.forEach(function(e){e.andyetFasterICE&&(r.eliminateDuplicateCandidates=e.andyetFasterICE)}),t&&t.optional&&t.optional.forEach(function(e){e.andyetDontSignalCandidates&&(r.dontSignalCandidates=e.andyetDontSignalCandidates)}),this.assumeSetLocalSuccess=!1,t&&t.optional&&t.optional.forEach(function(e){e.andyetAssumeSetLocalSuccess&&(r.assumeSetLocalSuccess=e.andyetAssumeSetLocalSuccess)}),"firefox"===i&&t&&t.optional&&(this.wtFirefox=0,t.optional.forEach(function(e){e.andyetFirefoxMakesMeSad&&(r.wtFirefox=e.andyetFirefoxMakesMeSad,r.wtFirefox>0&&(r.firefoxcandidatebuffer=[]))})),this.pc=new RTCPeerConnection(e,t),this.getLocalStreams=this.pc.getLocalStreams.bind(this.pc),this.getRemoteStreams=this.pc.getRemoteStreams.bind(this.pc),this.addStream=this.pc.addStream.bind(this.pc),this.removeStream=function(e){"function"==typeof r.pc.removeStream?r.pc.removeStream.apply(r.pc,arguments):"function"==typeof r.pc.removeTrack&&e.getTracks().forEach(function(e){r.pc.removeTrack(e)})},"function"==typeof this.pc.removeTrack&&(this.removeTrack=this.pc.removeTrack.bind(this.pc)),this.pc.onremovestream=this.emit.bind(this,"removeStream"),this.pc.onremovetrack=this.emit.bind(this,"removeTrack"),this.pc.onaddstream=this.emit.bind(this,"addStream"),this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded"),this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange"),this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange"),this.pc.onicecandidate=this._onIce.bind(this),this.pc.ondatachannel=this._onDataChannel.bind(this),this.localDescription={contents:[]},this.remoteDescription={contents:[]},this.config={debug:!1,sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1},this.iceCredentials={local:{},remote:{}},e)this.config[n]=e[n];this.config.debug&&this.on("*",function(){(e.logger||console).log("PeerConnection event:",arguments)}),this.hadLocalStunCandidate=!1,this.hadRemoteStunCandidate=!1,this.hadLocalRelayCandidate=!1,this.hadRemoteRelayCandidate=!1,this.hadLocalIPv6Candidate=!1,this.hadRemoteIPv6Candidate=!1,this._remoteDataChannels=[],this._localDataChannels=[],this._candidateBuffer=[]}r.inherits(c,o),Object.defineProperty(c.prototype,"signalingState",{get:function(){return this.pc.signalingState}}),Object.defineProperty(c.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}}),c.prototype._role=function(){return this.isInitiator?"initiator":"responder"},c.prototype.addStream=function(e){this.localStream=e,this.pc.addStream(e)},c.prototype._checkLocalCandidate=function(e){var t=i.toCandidateJSON(e);"srflx"==t.type?this.hadLocalStunCandidate=!0:"relay"==t.type&&(this.hadLocalRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)},c.prototype._checkRemoteCandidate=function(e){var t=i.toCandidateJSON(e);"srflx"==t.type?this.hadRemoteStunCandidate=!0:"relay"==t.type&&(this.hadRemoteRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)},c.prototype.processIce=function(e,t){t=t||function(){};var n=this;if("closed"===this.pc.signalingState)return t();if(e.contents||e.jingle&&e.jingle.contents){var r=this.remoteDescription.contents.map(function(e){return e.name});(e.contents||e.jingle.contents).forEach(function(e){var o=e.transport||{},a=o.candidates||[],s=r.indexOf(e.name),c=e.name,u=n.remoteDescription.contents.find(function(t){return t.name===e.name}),l=function(){a.forEach(function(e){var t=i.toCandidateSDP(e)+"\r\n";n.pc.addIceCandidate(new RTCIceCandidate({candidate:t,sdpMLineIndex:s,sdpMid:c}),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(t)}),t()};if(n.iceCredentials.remote[e.name]&&o.ufrag&&n.iceCredentials.remote[e.name].ufrag!==o.ufrag)if(u){u.transport.ufrag=o.ufrag,u.transport.pwd=o.pwd;var d={type:"offer",jingle:n.remoteDescription};d.sdp=i.toSessionSDP(d.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.pc.setRemoteDescription(new RTCSessionDescription(d),function(){l()},function(e){n.emit("error",e)})}else n.emit("error","ice restart failed to find matching content");else l()})}else{if(e.candidate&&0!==e.candidate.candidate.indexOf("a=")&&(e.candidate.candidate="a="+e.candidate.candidate),this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(e.candidate),t();n.pc.addIceCandidate(new RTCIceCandidate(e.candidate),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate.candidate),t()}},c.prototype.offer=function(e,t){var n=this,r=2===arguments.length,o=r&&e?e:{offerToReceiveAudio:1,offerToReceiveVideo:1};if(t=(t=r?t:e)||function(){},"closed"===this.pc.signalingState)return t("Already closed");this.pc.createOffer(function(e){var r={type:"offer",sdp:e.sdp};n.assumeSetLocalSuccess&&(n.emit("offer",r),t(null,r)),n._candidateBuffer=[],n.pc.setLocalDescription(e,function(){var o;n.config.useJingle&&((o=i.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"})).sid=n.config.sid,n.localDescription=o,o.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.local[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),r.jingle=o),r.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),n.assumeSetLocalSuccess||(n.emit("offer",r),t(null,r))},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},o)},c.prototype.handleOffer=function(e,t){t=t||function(){};var n=this;if(e.type="offer",e.jingle){if(this.enableChromeNativeSimulcast&&e.jingle.contents.forEach(function(e){"video"===e.name&&(e.application.googConferenceFlag=!0)}),this.enableMultiStreamHacks&&e.jingle.contents.forEach(function(e){if("video"===e.name){var t=e.application.sources||[];0!==t.length&&"3735928559"===t[0].ssrc||(t.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),e.application.sources=t)}}),n.restrictBandwidth>0&&e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name){var r=e.jingle.contents[1];r.application&&r.application.bandwidth&&r.application.bandwidth.bandwidth||(e.jingle.contents[1].application.bandwidth={type:"AS",bandwidth:n.restrictBandwidth.toString()},e.sdp=i.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"}))}e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),e.sdp=i.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle}e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e),function(){t()},t)},c.prototype.answerAudioOnly=function(e){this._answer({mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}},e)},c.prototype.answerBroadcastOnly=function(e){this._answer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},e)},c.prototype.answer=function(e,t){var n=2===arguments.length,r=n?t:e,i=n&&e?e:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};this._answer(i,r)},c.prototype.handleAnswer=function(e,t){t=t||function(){};var n=this;e.jingle&&(e.sdp=i.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle,e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})})),e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e),function(){n.wtFirefox&&window.setTimeout(function(){n.firefoxcandidatebuffer.forEach(function(e){n.pc.addIceCandidate(new RTCIceCandidate(e),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate)}),n.firefoxcandidatebuffer=null},n.wtFirefox),t(null)},t)},c.prototype.close=function(){this.pc.close(),this._localDataChannels=[],this._remoteDataChannels=[],this.emit("close")},c.prototype._answer=function(e,t){t=t||function(){};var n=this;if(!this.pc.remoteDescription)throw new Error("remoteDescription not set");if("closed"===this.pc.signalingState)return t("Already closed");n.pc.createAnswer(function(e){var r=[];if(n.enableChromeNativeSimulcast&&(e.jingle=i.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"}),e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name)){var o=e.jingle.contents[1].application.sourceGroups||[],a=!1;if(o.forEach(function(e){"SIM"==e.semantics&&(a=!0)}),!a&&e.jingle.contents[1].application.sources.length){var c=JSON.parse(JSON.stringify(e.jingle.contents[1].application.sources[0]));c.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].application.sources.push(c),r.push(e.jingle.contents[1].application.sources[0].ssrc),r.push(c.ssrc),o.push({semantics:"SIM",sources:r});var u=JSON.parse(JSON.stringify(c));u.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].application.sources.push(u),o.push({semantics:"FID",sources:[c.ssrc,u.ssrc]}),e.jingle.contents[1].application.sourceGroups=o,e.sdp=i.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"})}}var l={type:"answer",sdp:e.sdp};if(n.assumeSetLocalSuccess){var d=s(l);n.emit("answer",d),t(null,d)}n._candidateBuffer=[],n.pc.setLocalDescription(e,function(){if(n.config.useJingle){var r=i.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});r.sid=n.config.sid,n.localDescription=r,l.jingle=r}if(n.enableChromeNativeSimulcast&&(l.jingle||(l.jingle=i.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"})),l.jingle.contents[1].application.sources.forEach(function(e,t){e.parameters=e.parameters.map(function(e){return"msid"===e.key&&(e.value+="-"+Math.floor(t/2)),e})}),l.sdp=i.toSessionSDP(l.jingle,{sid:n.sdpSessionID,role:n._role(),direction:"outgoing"})),l.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),!n.assumeSetLocalSuccess){var o=s(l);n.emit("answer",o),t(null,o)}},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},e)},c.prototype._onIce=function(e){var t=this;if(e.candidate){if(this.dontSignalCandidates)return;var n=e.candidate,r={candidate:{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex}};this._checkLocalCandidate(n.candidate);var o,a,s=i.toCandidateJSON(n.candidate);if(this.eliminateDuplicateCandidates&&"relay"===s.type&&(a=(o=this._candidateBuffer.filter(function(e){return"relay"===e.type}).map(function(e){return e.foundation+":"+e.component})).indexOf(s.foundation+":"+s.component))>-1&&s.priority>>24>=o[a].priority>>24)return;if("max-bundle"===this.config.bundlePolicy&&(a=(o=this._candidateBuffer.filter(function(e){return s.type===e.type}).map(function(e){return e.address+":"+e.port})).indexOf(s.address+":"+s.port))>-1)return;if("require"===this.config.rtcpMuxPolicy&&"2"===s.component)return;if(this._candidateBuffer.push(s),t.config.useJingle){if(n.sdpMid||(t.pc.remoteDescription&&"offer"===t.pc.remoteDescription.type?n.sdpMid=t.remoteDescription.contents[n.sdpMLineIndex].name:n.sdpMid=t.localDescription.contents[n.sdpMLineIndex].name),!t.iceCredentials.local[n.sdpMid])i.toSessionJSON(t.pc.localDescription.sdp,{role:t._role(),direction:"outgoing"}).contents.forEach(function(e){var n=e.transport||{};n.ufrag&&(t.iceCredentials.local[e.name]={ufrag:n.ufrag,pwd:n.pwd})});if(r.jingle={contents:[{name:n.sdpMid,creator:t._role(),transport:{transportType:"iceUdp",ufrag:t.iceCredentials.local[n.sdpMid].ufrag,pwd:t.iceCredentials.local[n.sdpMid].pwd,candidates:[s]}}]},t.batchIceCandidates>0)return 0===t.batchedIceCandidates.length&&window.setTimeout(function(){var e={};t.batchedIceCandidates.forEach(function(t){t=t.contents[0],e[t.name]||(e[t.name]=t),e[t.name].transport.candidates.push(t.transport.candidates[0])});var n={jingle:{contents:[]}};Object.keys(e).forEach(function(t){n.jingle.contents.push(e[t])}),t.batchedIceCandidates=[],t.emit("ice",n)},t.batchIceCandidates),void t.batchedIceCandidates.push(r.jingle)}this.emit("ice",r)}else this.emit("endOfCandidates")},c.prototype._onDataChannel=function(e){var t=e.channel;this._remoteDataChannels.push(t),this.emit("addChannel",t)},c.prototype.createDataChannel=function(e,t){var n=this.pc.createDataChannel(e,t);return this._localDataChannels.push(n),n},c.prototype.getStats=function(){if("function"!=typeof arguments[0])return this.pc.getStats.apply(this.pc,arguments);var e=arguments[0];this.pc.getStats().then(function(t){e(null,t)},function(t){e(t)})},t.exports=c},{"lodash.clonedeep":180,"sdp-jingle-json":244,util:331,"webrtc-adapter":70,wildemitter:80}],70:[function(e,t,n){"use strict";!function(){var n=e("./utils"),r=n.log,i=n.browserDetails;t.exports.browserDetails=i,t.exports.extractVersion=n.extractVersion,t.exports.disableLog=n.disableLog;var o=e("./chrome/chrome_shim")||null,a=e("./edge/edge_shim")||null,s=e("./firefox/firefox_shim")||null,c=e("./safari/safari_shim")||null;switch(i.browser){case"chrome":if(!o||!o.shimPeerConnection)return void r("Chrome shim is not included in this adapter release.");r("adapter.js shimming chrome."),t.exports.browserShim=o,o.shimGetUserMedia(),o.shimMediaStream(),n.shimCreateObjectURL(),o.shimSourceObject(),o.shimPeerConnection(),o.shimOnTrack(),o.shimGetSendersWithDtmf();break;case"firefox":if(!s||!s.shimPeerConnection)return void r("Firefox shim is not included in this adapter release.");r("adapter.js shimming firefox."),t.exports.browserShim=s,s.shimGetUserMedia(),n.shimCreateObjectURL(),s.shimSourceObject(),s.shimPeerConnection(),s.shimOnTrack();break;case"edge":if(!a||!a.shimPeerConnection)return void r("MS edge shim is not included in this adapter release.");r("adapter.js shimming edge."),t.exports.browserShim=a,a.shimGetUserMedia(),n.shimCreateObjectURL(),a.shimPeerConnection(),a.shimReplaceTrack();break;case"safari":if(!c)return void r("Safari shim is not included in this adapter release.");r("adapter.js shimming safari."),t.exports.browserShim=c,c.shimCallbacksAPI(),c.shimAddStream(),c.shimOnAddStream(),c.shimGetUserMedia();break;default:r("Unsupported browser!")}}()},{"./chrome/chrome_shim":71,"./edge/edge_shim":73,"./firefox/firefox_shim":76,"./safari/safari_shim":78,"./utils":79}],71:[function(e,t,n){"use strict";var r=e("../utils.js").log,i=e("../utils.js").browserDetails,o={shimMediaStream:function(){window.MediaStream=window.MediaStream||window.webkitMediaStream},shimOnTrack:function(){"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){var t=this;this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.addEventListener("addtrack",function(n){var r;r=RTCPeerConnection.prototype.getReceivers?t.getReceivers().find(function(e){return e.track.id===n.track.id}):{track:n.track};var i=new Event("track");i.track=n.track,i.receiver=r,i.streams=[e.stream],t.dispatchEvent(i)}),e.stream.getTracks().forEach(function(n){var r;r=RTCPeerConnection.prototype.getReceivers?t.getReceivers().find(function(e){return e.track.id===n.id}):{track:n};var i=new Event("track");i.track=n,i.receiver=r,i.streams=[e.stream],this.dispatchEvent(i)}.bind(this))}.bind(this))}})},shimGetSendersWithDtmf:function(){if("object"==typeof window&&window.RTCPeerConnection&&!("getSenders"in RTCPeerConnection.prototype)&&"createDTMFSender"in RTCPeerConnection.prototype){RTCPeerConnection.prototype.getSenders=function(){return this._senders||[]};var e=RTCPeerConnection.prototype.addStream,t=RTCPeerConnection.prototype.removeStream;RTCPeerConnection.prototype.addTrack||(RTCPeerConnection.prototype.addTrack=function(e,t){var n=this;if("closed"===n.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(function(t){return t===e}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(n._senders=n._senders||[],n._senders.find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError");n._streams=n._streams||{};var i=n._streams[t.id];if(i)i.addTrack(e),n.removeStream(i),n.addStream(i);else{var o=new MediaStream([e]);n._streams[t.id]=o,n.addStream(o)}var a={track:e,get dtmf(){return void 0===this._dtmf&&("audio"===e.kind?this._dtmf=n.createDTMFSender(e):this._dtmf=null),this._dtmf}};return n._senders.push(a),a}),RTCPeerConnection.prototype.addStream=function(t){var n=this;n._senders=n._senders||[],e.apply(n,[t]),t.getTracks().forEach(function(e){n._senders.push({track:e,get dtmf(){return void 0===this._dtmf&&("audio"===e.kind?this._dtmf=n.createDTMFSender(e):this._dtmf=null),this._dtmf}})})},RTCPeerConnection.prototype.removeStream=function(e){var n=this;n._senders=n._senders||[],t.apply(n,[e]),e.getTracks().forEach(function(e){var t=n._senders.find(function(t){return t.track===e});t&&n._senders.splice(n._senders.indexOf(t),1)})}}},shimSourceObject:function(){"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var t=this;this._srcObject=e,this.src&&URL.revokeObjectURL(this.src),e?(this.src=URL.createObjectURL(e),e.addEventListener("addtrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)}),e.addEventListener("removetrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)})):this.src=""}}))},shimPeerConnection:function(){if(window.RTCPeerConnection){var e=RTCPeerConnection;window.RTCPeerConnection=function(t,n){if(t&&t.iceServers){for(var r=[],i=0;i<t.iceServers.length;i++){var o=t.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(console.warn("RTCIceServer.url is deprecated! Use urls instead."),(o=JSON.parse(JSON.stringify(o))).urls=o.url,r.push(o)):r.push(t.iceServers[i])}t.iceServers=r}return new e(t,n)},window.RTCPeerConnection.prototype=e.prototype,Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return e.generateCertificate}})}else window.RTCPeerConnection=function(e,t){return r("PeerConnection"),e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy),new webkitRTCPeerConnection(e,t)},window.RTCPeerConnection.prototype=webkitRTCPeerConnection.prototype,webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return webkitRTCPeerConnection.generateCertificate}});var t=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(e,n,r){var i=this,o=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof arguments[0]))return t.apply(this,[]);var a=function(e){var t={};return e.result().forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(arguments.length>=2){return t.apply(this,[function(e){o[1](s(a(e)))},arguments[0]])}return new Promise(function(e,n){t.apply(i,[function(t){e(s(a(t)))},n])}).then(n,r)},i.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){var e=arguments,n=this,r=new Promise(function(r,i){t.apply(n,[e[0],r,i])});return e.length<2?r:r.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}}),i.version<52&&["createOffer","createAnswer"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var n=1===arguments.length?arguments[0]:void 0;return new Promise(function(r,i){t.apply(e,[r,i,n])})}return t.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var n=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};t.exports={shimMediaStream:o.shimMediaStream,shimOnTrack:o.shimOnTrack,shimGetSendersWithDtmf:o.shimGetSendersWithDtmf,shimSourceObject:o.shimSourceObject,shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils.js":79,"./getusermedia":72}],72:[function(e,t,n){"use strict";var r=e("../utils.js").log,i=e("../utils.js").browserDetails;t.exports=function(){var e=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var o={};"number"==typeof r.ideal?(o[i("min",n)]=r.ideal,t.optional.push(o),(o={})[i("max",n)]=r.ideal,t.optional.push(o)):(o[i("",n)]=r.ideal,t.optional.push(o))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},t=function(t,n){if((t=JSON.parse(JSON.stringify(t)))&&t.audio&&(t.audio=e(t.audio)),t&&"object"==typeof t.video){var o=t.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});var a,s=i.version<61;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!navigator.mediaDevices.getSupportedConstraints||!navigator.mediaDevices.getSupportedConstraints().facingMode||s))if(delete t.video.facingMode,"environment"===o.exact||"environment"===o.ideal?a=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(a=["front"]),a)return navigator.mediaDevices.enumerateDevices().then(function(i){var s=(i=i.filter(function(e){return"videoinput"===e.kind})).find(function(e){return a.some(function(t){return-1!==e.label.toLowerCase().indexOf(t)})});return!s&&i.length&&-1!==a.indexOf("back")&&(s=i[i.length-1]),s&&(t.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),t.video=e(t.video),r("chrome: "+JSON.stringify(t)),n(t)});t.video=e(t.video)}return r("chrome: "+JSON.stringify(t)),n(t)},n=function(e){return{name:{ConstraintNotSatisfiedError:"OverconstrainedError",PermissionDeniedError:"NotAllowedError",TrackStartError:"NotReadableError"}[e.name]||e.name,message:e.message,constraint:e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};navigator.getUserMedia=function(e,r,i){t(e,function(e){navigator.webkitGetUserMedia(e,r,function(e){i(n(e))})})};var o=function(e){return new Promise(function(t,n){navigator.getUserMedia(e,t,n)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:o,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(n){e(n.map(function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),navigator.mediaDevices.getUserMedia){var a=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return t(e,function(e){return a(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(n(e))})})}}else navigator.mediaDevices.getUserMedia=function(e){return o(e)};void 0===navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){r("Dummy mediaDevices.addEventListener called.")}),void 0===navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){r("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":79}],73:[function(e,t,n){"use strict";var r=e("../utils").browserDetails,i=e("./rtcpeerconnection_shim");t.exports={shimGetUserMedia:e("./getusermedia"),shimPeerConnection:function(){if(window.RTCIceGatherer&&(window.RTCIceCandidate||(window.RTCIceCandidate=function(e){return e}),window.RTCSessionDescription||(window.RTCSessionDescription=function(e){return e}),r.version<15025)){var e=Object.getOwnPropertyDescriptor(MediaStreamTrack.prototype,"enabled");Object.defineProperty(MediaStreamTrack.prototype,"enabled",{set:function(t){e.set.call(this,t);var n=new Event("enabled");n.enabled=t,this.dispatchEvent(n)}})}window.RTCPeerConnection=i(r.version)},shimReplaceTrack:function(){!window.RTCRtpSender||"replaceTrack"in RTCRtpSender.prototype||(RTCRtpSender.prototype.replaceTrack=RTCRtpSender.prototype.setTrack)}}},{"../utils":79,"./getusermedia":74,"./rtcpeerconnection_shim":75}],74:[function(e,t,n){"use strict";t.exports=function(){var e=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(t){return e(t).catch(function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}}},{}],75:[function(e,t,n){"use strict";var r=e("sdp");function i(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),a=r(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach(function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!i(r,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter(function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}}),n}function o(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}t.exports=function(e){var t=function(t){var n=this,r=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){n[e]=r[e].bind(r)}),this.needNegotiation=!1,this.onicecandidate=null,this.onaddstream=null,this.ontrack=null,this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onicegatheringstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.canTrickleIceCandidates=null,this.localStreams=[],this.remoteStreams=[],this.getLocalStreams=function(){return n.localStreams},this.getRemoteStreams=function(){return n.remoteStreams},this.localDescription=new RTCSessionDescription({type:"",sdp:""}),this.remoteDescription=new RTCSessionDescription({type:"",sdp:""}),this.signalingState="stable",this.iceConnectionState="new",this.iceGatheringState="new",this.iceOptions={gatherPolicy:"all",iceServers:[]},t&&t.iceTransportPolicy)switch(t.iceTransportPolicy){case"all":case"relay":this.iceOptions.gatherPolicy=t.iceTransportPolicy}this.usingBundle=t&&"max-bundle"===t.bundlePolicy,t&&t.iceServers&&(this.iceOptions.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393:(n=!0,!0)}),delete e.url,e.urls=i?r[0]:r,!!r.length}return!1})}(t.iceServers,e)),this._config=t||{},this.transceivers=[],this._localIceCandidatesBuffer=[]};return t.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this.dispatchEvent(e),null!==this.onicegatheringstatechange&&this.onicegatheringstatechange(e)},t.prototype._emitBufferedCandidates=function(){var e=this,t=r.splitSections(e.localDescription.sdp);this._localIceCandidatesBuffer.forEach(function(n){if(!n.candidate||0===Object.keys(n.candidate).length)for(var r=1;r<t.length;r++)-1===t[r].indexOf("\r\na=end-of-candidates\r\n")&&(t[r]+="a=end-of-candidates\r\n");else t[n.candidate.sdpMLineIndex+1]+="a="+n.candidate.candidate+"\r\n";(e.localDescription.sdp=t.join(""),e.dispatchEvent(n),null!==e.onicecandidate&&e.onicecandidate(n),n.candidate||"complete"===e.iceGatheringState)||e.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state})&&"complete"!==e.iceGatheringStateChange&&(e.iceGatheringState="complete",e._emitGatheringStateChange())}),this._localIceCandidatesBuffer=[]},t.prototype.getConfiguration=function(){return this._config},t.prototype._createTransceiver=function(e){var t=this.transceivers.length>0,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,wantReceive:!0};if(this.usingBundle&&t)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var r=this._createIceAndDtlsTransports();n.iceTransport=r.iceTransport,n.dtlsTransport=r.dtlsTransport}return this.transceivers.push(n),n},t.prototype.addTrack=function(e,t){for(var n,r=0;r<this.transceivers.length;r++)this.transceivers[r].track||this.transceivers[r].kind!==e.kind||(n=this.transceivers[r]);return n||(n=this._createTransceiver(e.kind)),n.track=e,n.stream=t,n.rtpSender=new RTCRtpSender(e,n.dtlsTransport),this._maybeFireNegotiationNeeded(),n.rtpSender},t.prototype.addStream=function(t){var n=this;if(e>=15025)this.localStreams.push(t),t.getTracks().forEach(function(e){n.addTrack(e,t)});else{var r=t.clone();t.getTracks().forEach(function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),r.getTracks().forEach(function(e){n.addTrack(e,r)}),this.localStreams.push(r)}this._maybeFireNegotiationNeeded()},t.prototype.removeStream=function(e){var t=this.localStreams.indexOf(e);t>-1&&(this.localStreams.splice(t,1),this._maybeFireNegotiationNeeded())},t.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},t.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},t.prototype._createIceGatherer=function(e,t){var n=this,i=new RTCIceGatherer(n.iceOptions);return i.onlocalcandidate=function(o){var a=new Event("icecandidate");a.candidate={sdpMid:e,sdpMLineIndex:t};var s=o.candidate,c=!s||0===Object.keys(s).length;c?void 0===i.state&&(i.state="completed"):(s.component=1,a.candidate.candidate=r.writeCandidate(s));var u=r.splitSections(n.localDescription.sdp);u[a.candidate.sdpMLineIndex+1]+=c?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",n.localDescription.sdp=u.join("");var l=(n._pendingOffer?n._pendingOffer:n.transceivers).every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});switch(n.iceGatheringState){case"new":c||n._localIceCandidatesBuffer.push(a),c&&l&&n._localIceCandidatesBuffer.push(new Event("icecandidate"));break;case"gathering":n._emitBufferedCandidates(),c||(n.dispatchEvent(a),null!==n.onicecandidate&&n.onicecandidate(a)),l&&(n.dispatchEvent(new Event("icecandidate")),null!==n.onicecandidate&&n.onicecandidate(new Event("icecandidate")),n.iceGatheringState="complete",n._emitGatheringStateChange())}},i},t.prototype._createIceAndDtlsTransports=function(){var e=this,t=new RTCIceTransport(null);t.onicestatechange=function(){e._updateConnectionState()};var n=new RTCDtlsTransport(t);return n.ondtlsstatechange=function(){e._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:t,dtlsTransport:n}},t.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlssttatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},t.prototype._transceive=function(t,n,o){var a=i(t.localCapabilities,t.remoteCapabilities);n&&t.rtpSender&&(a.encodings=t.sendEncodingParameters,a.rtcp={cname:r.localCName,compound:t.rtcpParameters.compound},t.recvEncodingParameters.length&&(a.rtcp.ssrc=t.recvEncodingParameters[0].ssrc),t.rtpSender.send(a)),o&&t.rtpReceiver&&("video"===t.kind&&t.recvEncodingParameters&&e<15019&&t.recvEncodingParameters.forEach(function(e){delete e.rtx}),a.encodings=t.recvEncodingParameters,a.rtcp={cname:t.rtcpParameters.cname,compound:t.rtcpParameters.compound},t.sendEncodingParameters.length&&(a.rtcp.ssrc=t.sendEncodingParameters[0].ssrc),t.rtpReceiver.receive(a))},t.prototype.setLocalDescription=function(e){var t,n,a=this;if(!o("setLocalDescription",e.type,this.signalingState)){var s=new Error("Can not set local "+e.type+" in state "+this.signalingState);return s.name="InvalidStateError",arguments.length>2&&"function"==typeof arguments[2]&&window.setTimeout(arguments[2],0,s),Promise.reject(s)}if("offer"===e.type)this._pendingOffer&&(t=r.splitSections(e.sdp),n=t.shift(),t.forEach(function(e,t){var n=r.parseRtpParameters(e);a._pendingOffer[t].localCapabilities=n}),this.transceivers=this._pendingOffer,delete this._pendingOffer);else if("answer"===e.type){t=r.splitSections(a.remoteDescription.sdp),n=t.shift();var c=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach(function(e,t){var o=a.transceivers[t],s=o.iceGatherer,u=o.iceTransport,l=o.dtlsTransport,d=o.localCapabilities,p=o.remoteCapabilities;if(!r.isRejected(e)&&!o.isDatachannel){var f=r.getIceParameters(e,n),h=r.getDtlsParameters(e,n);c&&(h.role="server"),a.usingBundle&&0!==t||(u.start(s,f,c?"controlling":"controlled"),l.start(h));var m=i(d,p);a._transceive(o,m.codecs.length>0,!1)}})}switch(this.localDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}var u=arguments.length>1&&"function"==typeof arguments[1];if(u){var l=arguments[1];window.setTimeout(function(){l(),"new"===a.iceGatheringState&&(a.iceGatheringState="gathering",a._emitGatheringStateChange()),a._emitBufferedCandidates()},0)}var d=Promise.resolve();return d.then(function(){u||("new"===a.iceGatheringState&&(a.iceGatheringState="gathering",a._emitGatheringStateChange()),window.setTimeout(a._emitBufferedCandidates.bind(a),500))}),d},t.prototype.setRemoteDescription=function(t){var n=this;if(!o("setRemoteDescription",t.type,this.signalingState)){var i=new Error("Can not set remote "+t.type+" in state "+this.signalingState);return i.name="InvalidStateError",arguments.length>2&&"function"==typeof arguments[2]&&window.setTimeout(arguments[2],0,i),Promise.reject(i)}var a={},s=[],c=r.splitSections(t.sdp),u=c.shift(),l=r.matchPrefix(u,"a=ice-lite").length>0,d=r.matchPrefix(u,"a=group:BUNDLE ").length>0;this.usingBundle=d;var p=r.matchPrefix(u,"a=ice-options:")[0];switch(this.canTrickleIceCandidates=!!p&&p.substr(14).split(" ").indexOf("trickle")>=0,c.forEach(function(i,o){var c=r.splitLines(i),p=r.getKind(i),f=r.isRejected(i),h=c[0].substr(2).split(" ")[2],m=r.getDirection(i,u),v=r.parseMsid(i),y=r.getMid(i)||r.generateIdentifier();if("application"!==p||"DTLS/SCTP"!==h){var g,S,_,b,C,w,E,R,P,L,T,x=r.parseRtpParameters(i);f||(L=r.getIceParameters(i,u),(T=r.getDtlsParameters(i,u)).role="client"),E=r.parseRtpEncodingParameters(i);var M=r.parseRtcpParameters(i),A=r.matchPrefix(i,"a=end-of-candidates",u).length>0,I=r.matchPrefix(i,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return"1"===e.component||1===e.component});"offer"!==t.type||f?"answer"!==t.type||f||(d&&o>0&&(n._disposeIceAndDtlsTransports(o),n.transceivers[o].iceGatherer=n.transceivers[0].iceGatherer,n.transceivers[o].iceTransport=n.transceivers[0].iceTransport,n.transceivers[o].dtlsTransport=n.transceivers[0].dtlsTransport,n.transceivers[o].rtpSender&&n.transceivers[o].rtpSender.setTransport(n.transceivers[0].dtlsTransport),n.transceivers[o].rtpReceiver&&n.transceivers[o].rtpReceiver.setTransport(n.transceivers[0].dtlsTransport)),S=(g=n.transceivers[o]).iceGatherer,_=g.iceTransport,b=g.dtlsTransport,C=g.rtpReceiver,w=g.sendEncodingParameters,R=g.localCapabilities,n.transceivers[o].recvEncodingParameters=E,n.transceivers[o].remoteCapabilities=x,n.transceivers[o].rtcpParameters=M,(l||A)&&I.length&&_.setRemoteCandidates(I),d&&0!==o||(_.start(S,L,"controlling"),b.start(T)),n._transceive(g,"sendrecv"===m||"recvonly"===m,"sendrecv"===m||"sendonly"===m),!C||"sendrecv"!==m&&"sendonly"!==m?delete g.rtpReceiver:(P=C.track,v?(a[v.stream]||(a[v.stream]=new MediaStream),a[v.stream].addTrack(P),s.push([P,C,a[v.stream]])):(a.default||(a.default=new MediaStream),a.default.addTrack(P),s.push([P,C,a.default])))):((g=n.transceivers[o]||n._createTransceiver(p)).mid=y,g.iceGatherer||(g.iceGatherer=d&&o>0?n.transceivers[0].iceGatherer:n._createIceGatherer(y,o)),!A||d&&0!==o||g.iceTransport.setRemoteCandidates(I),R=RTCRtpReceiver.getCapabilities(p),e<15019&&(R.codecs=R.codecs.filter(function(e){return"rtx"!==e.name})),w=[{ssrc:1001*(2*o+2)}],"sendrecv"!==m&&"sendonly"!==m||(P=(C=new RTCRtpReceiver(g.dtlsTransport,p)).track,v?(a[v.stream]||(a[v.stream]=new MediaStream,Object.defineProperty(a[v.stream],"id",{get:function(){return v.stream}})),Object.defineProperty(P,"id",{get:function(){return v.track}}),a[v.stream].addTrack(P),s.push([P,C,a[v.stream]])):(a.default||(a.default=new MediaStream),a.default.addTrack(P),s.push([P,C,a.default]))),g.localCapabilities=R,g.remoteCapabilities=x,g.rtpReceiver=C,g.rtcpParameters=M,g.sendEncodingParameters=w,g.recvEncodingParameters=E,n._transceive(n.transceivers[o],!1,"sendrecv"===m||"sendonly"===m))}else n.transceivers[o]={mid:y,isDatachannel:!0}}),this.remoteDescription={type:t.type,sdp:t.sdp},t.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+t.type+'"')}return Object.keys(a).forEach(function(e){var t=a[e];if(t.getTracks().length){n.remoteStreams.push(t);var r=new Event("addstream");r.stream=t,n.dispatchEvent(r),null!==n.onaddstream&&window.setTimeout(function(){n.onaddstream(r)},0),s.forEach(function(e){var r=e[0],i=e[1];if(t.id===e[2].id){var o=new Event("track");o.track=r,o.receiver=i,o.streams=[t],n.dispatchEvent(o),null!==n.ontrack&&window.setTimeout(function(){n.ontrack(o)},0)}})}}),window.setTimeout(function(){n&&n.transceivers&&n.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},t.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._updateSignalingState("closed")},t.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this.dispatchEvent(t),null!==this.onsignalingstatechange&&this.onsignalingstatechange(t)},t.prototype._maybeFireNegotiationNeeded=function(){var e=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,window.setTimeout(function(){if(!1!==e.needNegotiation){e.needNegotiation=!1;var t=new Event("negotiationneeded");e.dispatchEvent(t),null!==e.onnegotiationneeded&&e.onnegotiationneeded(t)}},0))},t.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};if(this.transceivers.forEach(function(e){t[e.iceTransport.state]++,t[e.dtlsTransport.state]++}),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0||t.checking>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":(t.connected>0||t.completed>0)&&(e="connected"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this.dispatchEvent(n),null!==this.oniceconnectionstatechange&&this.oniceconnectionstatechange(n)}},t.prototype.createOffer=function(){var t,n=this;if(this._pendingOffer)throw new Error("createOffer called while there is a pending offer.");1===arguments.length&&"function"!=typeof arguments[0]?t=arguments[0]:3===arguments.length&&(t=arguments[2]);var i=this.transceivers.filter(function(e){return"audio"===e.kind}).length,o=this.transceivers.filter(function(e){return"video"===e.kind}).length;if(t){if(t.mandatory||t.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==t.offerToReceiveAudio&&(i=!0===t.offerToReceiveAudio?1:!1===t.offerToReceiveAudio?0:t.offerToReceiveAudio),void 0!==t.offerToReceiveVideo&&(o=!0===t.offerToReceiveVideo?1:!1===t.offerToReceiveVideo?0:t.offerToReceiveVideo)}for(this.transceivers.forEach(function(e){"audio"===e.kind?--i<0&&(e.wantReceive=!1):"video"===e.kind&&--o<0&&(e.wantReceive=!1)});i>0||o>0;)i>0&&(this._createTransceiver("audio"),i--),o>0&&(this._createTransceiver("video"),o--);var a=function(e){var t=e.filter(function(e){return"audio"===e.kind}),n=e.filter(function(e){return"video"===e.kind});for(e=[];t.length||n.length;)t.length&&e.push(t.shift()),n.length&&e.push(n.shift());return e}(this.transceivers),s=r.writeSessionBoilerplate();a.forEach(function(t,i){var o=t.track,s=t.kind,c=r.generateIdentifier();t.mid=c,t.iceGatherer||(t.iceGatherer=n.usingBundle&&i>0?a[0].iceGatherer:n._createIceGatherer(c,i));var u=RTCRtpSender.getCapabilities(s);e<15019&&(u.codecs=u.codecs.filter(function(e){return"rtx"!==e.name})),u.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1")});var l=[{ssrc:1001*(2*i+1)}];o&&e>=15019&&"video"===s&&(l[0].rtx={ssrc:1001*(2*i+1)+1}),t.wantReceive&&(t.rtpReceiver=new RTCRtpReceiver(t.dtlsTransport,s)),t.localCapabilities=u,t.sendEncodingParameters=l}),"max-compat"!==this._config.bundlePolicy&&(s+="a=group:BUNDLE "+a.map(function(e){return e.mid}).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n",a.forEach(function(e,t){s+=r.writeMediaSection(e,e.localCapabilities,"offer",e.stream),s+="a=rtcp-rsize\r\n"}),this._pendingOffer=a;var c=new RTCSessionDescription({type:"offer",sdp:s});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,c),Promise.resolve(c)},t.prototype.createAnswer=function(){var t=r.writeSessionBoilerplate();this.usingBundle&&(t+="a=group:BUNDLE "+this.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),this.transceivers.forEach(function(n,o){if(n.isDatachannel)t+="m=application 0 DTLS/SCTP 5000\r\nc=IN IP4 0.0.0.0\r\na=mid:"+n.mid+"\r\n";else{var a;if(n.stream)"audio"===n.kind?a=n.stream.getAudioTracks()[0]:"video"===n.kind&&(a=n.stream.getVideoTracks()[0]),a&&e>=15019&&"video"===n.kind&&(n.sendEncodingParameters[0].rtx={ssrc:1001*(2*o+2)+1});var s=i(n.localCapabilities,n.remoteCapabilities);!s.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&n.sendEncodingParameters[0].rtx&&delete n.sendEncodingParameters[0].rtx,t+=r.writeMediaSection(n,s,"answer",n.stream),n.rtcpParameters&&n.rtcpParameters.reducedSize&&(t+="a=rtcp-rsize\r\n")}});var n=new RTCSessionDescription({type:"answer",sdp:t});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,n),Promise.resolve(n)},t.prototype.addIceCandidate=function(e){if(e){var t=e.sdpMLineIndex;if(e.sdpMid)for(var n=0;n<this.transceivers.length;n++)if(this.transceivers[n].mid===e.sdpMid){t=n;break}var i=this.transceivers[t];if(i){var o=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===o.protocol&&(0===o.port||9===o.port))return Promise.resolve();if(o.component&&"1"!==o.component&&1!==o.component)return Promise.resolve();i.iceTransport.addRemoteCandidate(o);var a=r.splitSections(this.remoteDescription.sdp);a[t+1]+=(o.type?e.candidate.trim():"a=end-of-candidates")+"\r\n",this.remoteDescription.sdp=a.join("")}}else for(var s=0;s<this.transceivers.length;s++)if(this.transceivers[s].iceTransport.addRemoteCandidate({}),this.usingBundle)return Promise.resolve();return arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},t.prototype.getStats=function(){var e=[];this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(n){t[n]&&e.push(t[n].getStats())})});var t=arguments.length>1&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(n){var r=new Map;Promise.all(e).then(function(e){e.forEach(function(e){Object.keys(e).forEach(function(t){var n;e[t].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(n=e[t]).type]||n.type,r.set(t,e[t])})}),t&&window.setTimeout(t,0,r),n(r)})})},t}},{sdp:249}],76:[function(e,t,n){"use strict";var r=e("../utils").browserDetails,i={shimOnTrack:function(){"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(){if("object"==typeof window&&(window.RTCPeerConnection||window.mozRTCPeerConnection)){window.RTCPeerConnection||(window.RTCPeerConnection=function(e,t){if(r.version<38&&e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];if(o.hasOwnProperty("urls"))for(var a=0;a<o.urls.length;a++){var s={url:o.urls[a]};0===o.urls[a].indexOf("turn")&&(s.username=o.username,s.credential=o.credential),n.push(s)}else n.push(e.iceServers[i])}e.iceServers=n}return new mozRTCPeerConnection(e,t)},window.RTCPeerConnection.prototype=mozRTCPeerConnection.prototype,mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return mozRTCPeerConnection.generateCertificate}}),window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(e,i,o){return n.apply(this,[e||null]).then(function(e){if(r.version<48&&(e=function(e){var t=new Map;return Object.keys(e).forEach(function(n){t.set(n,e[n]),t[n]=e[n]}),t}(e)),r.version<53&&!i)try{e.forEach(function(e){e.type=t[e.type]||e.type})}catch(n){if("TypeError"!==n.name)throw n;e.forEach(function(n,r){e.set(r,Object.assign({},n,{type:t[n.type]||n.type}))})}return e}).then(i,o)}}}};t.exports={shimOnTrack:i.shimOnTrack,shimSourceObject:i.shimSourceObject,shimPeerConnection:i.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":79,"./getusermedia":77}],77:[function(e,t,n){"use strict";var r=e("../utils").log,i=e("../utils").browserDetails;t.exports=function(){var e=function(e){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},t=function(t,n,o){var a=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r=e[n]="object"==typeof e[n]?e[n]:{ideal:e[n]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||t.push(n),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var i={};"number"==typeof r.ideal?i[n]={min:r.ideal,max:r.ideal}:i[n]=r.ideal,e.advanced.push(i),delete r.ideal,Object.keys(r).length||delete e[n]}}}),t.length&&(e.require=t),e};return t=JSON.parse(JSON.stringify(t)),i.version<38&&(r("spec: "+JSON.stringify(t)),t.audio&&(t.audio=a(t.audio)),t.video&&(t.video=a(t.video)),r("ff37: "+JSON.stringify(t))),navigator.mozGetUserMedia(t,n,function(t){o(e(t))})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:function(e){return new Promise(function(n,r){t(e,n,r)})},addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},i.version<41){var n=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return n().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(i.version<49){var o=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(t){return o(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("The object can not be found here.","NotFoundError");return e},function(t){return Promise.reject(e(t))})}}navigator.getUserMedia=function(e,n,r){if(i.version<44)return t(e,n,r);console.warn("navigator.getUserMedia has been replaced by navigator.mediaDevices.getUserMedia"),navigator.mediaDevices.getUserMedia(e).then(n,r)}}},{"../utils":79}],78:[function(e,t,n){"use strict";var r={shimAddStream:function(){"object"!=typeof window||!window.RTCPeerConnection||"addStream"in window.RTCPeerConnection.prototype||(RTCPeerConnection.prototype.addStream=function(e){var t=this;e.getTracks().forEach(function(n){t.addTrack(n,e)})})},shimOnAddStream:function(){"object"!=typeof window||!window.RTCPeerConnection||"onaddstream"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){var t=e.streams[0];if(this._streams||(this._streams=[]),!(this._streams.indexOf(t)>=0)){this._streams.push(t);var n=new Event("addstream");n.stream=e.streams[0],this.dispatchEvent(n)}}.bind(this))}})},shimCallbacksAPI:function(){if("object"==typeof window&&window.RTCPeerConnection){var e=RTCPeerConnection.prototype,t=e.createOffer,n=e.createAnswer,r=e.setLocalDescription,i=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(e,n){var r=arguments.length>=2?arguments[2]:arguments[0],i=t.apply(this,[r]);return n?(i.then(e,n),Promise.resolve()):i},e.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};var a=function(e,t,n){var i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};e.setLocalDescription=a,a=function(e,t,n){var r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},e.setRemoteDescription=a,a=function(e,t,n){var r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},e.addIceCandidate=a}},shimGetUserMedia:function(){navigator.getUserMedia||(navigator.webkitGetUserMedia?navigator.getUserMedia=navigator.webkitGetUserMedia.bind(navigator):navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&(navigator.getUserMedia=function(e,t,n){navigator.mediaDevices.getUserMedia(e).then(t,n)}.bind(navigator)))}};t.exports={shimCallbacksAPI:r.shimCallbacksAPI,shimAddStream:r.shimAddStream,shimOnAddStream:r.shimOnAddStream,shimGetUserMedia:r.shimGetUserMedia}},{}],79:[function(e,t,n){"use strict";var r=!0,i={disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(r=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},log:function(){if("object"==typeof window){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)},detectBrowser:function(){var e={browser:null,version:null};if("undefined"==typeof window||!window.navigator)return e.browser="Not a browser.",e;if(navigator.mozGetUserMedia)e.browser="firefox",e.version=this.extractVersion(navigator.userAgent,/Firefox\/(\d+)\./,1);else if(navigator.webkitGetUserMedia)if(window.webkitRTCPeerConnection)e.browser="chrome",e.version=this.extractVersion(navigator.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!navigator.userAgent.match(/Version\/(\d+).(\d+)/))return e.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",e;e.browser="safari",e.version=this.extractVersion(navigator.userAgent,/AppleWebKit\/(\d+)\./,1)}else if(navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))e.browser="edge",e.version=this.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!navigator.mediaDevices||!navigator.userAgent.match(/AppleWebKit\/(\d+)\./))return e.browser="Not a supported browser.",e;e.browser="safari",e.version=this.extractVersion(navigator.userAgent,/AppleWebKit\/(\d+)\./,1)}return e},shimCreateObjectURL:function(){if("object"==typeof window&&window.HTMLMediaElement&&"srcObject"in window.HTMLMediaElement.prototype){var e=URL.createObjectURL.bind(URL),t=URL.revokeObjectURL.bind(URL),n=new Map,r=0;URL.createObjectURL=function(t){if("getTracks"in t){var i="polyblob:"+ ++r;return n.set(i,t),console.log("URL.createObjectURL(stream) is deprecated! Use elem.srcObject = stream instead!"),i}return e(t)},URL.revokeObjectURL=function(e){t(e),n.delete(e)};var i=Object.getOwnPropertyDescriptor(window.HTMLMediaElement.prototype,"src");Object.defineProperty(window.HTMLMediaElement.prototype,"src",{get:function(){return i.get.apply(this)},set:function(e){return this.srcObject=n.get(e)||null,i.set.apply(this,[e])}});var o=HTMLMediaElement.prototype.setAttribute;HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=n.get(arguments[1])||null),o.apply(this,arguments)}}}};t.exports={log:i.log,disableLog:i.disableLog,browserDetails:i.detectBrowser(),extractVersion:i.extractVersion,shimCreateObjectURL:i.shimCreateObjectURL,detectBrowser:i.detectBrowser.bind(i)}},{}],80:[function(e,t,n){arguments[4][48][0].apply(n,arguments)},{dup:48}],81:[function(e,t,n){var r=e("util"),i=e("extend-object"),o=e("jingle-session"),a=e("rtcpeerconnection"),s=e("lodash");e("async");function c(e){e.signalEndOfCandidates=!0,this.waitForEndOfCandidates=!0,this.candidates=[],o.call(this,e),this.pc=new a({iceServers:e.iceServers||[],useJingle:!0,sdpSemantics:"plan-b"},e.constraints||{}),this.pc.on("ice",this.onIceCandidate.bind(this,e)),this.pc.on("endOfCandidates",this.onIceEndOfCandidates.bind(this,e)),this.pc.on("iceConnectionStateChange",this.onIceStateChange.bind(this)),this.pc.on("addStream",this.onAddStream.bind(this)),this.pc.on("removeStream",this.onRemoveStream.bind(this)),this.pc.on("addChannel",this.onAddChannel.bind(this)),e.stream&&this.addStream(e.stream),this._ringing=!1,this._afterConstruction&&this._afterConstruction()}function u(){console.warn("Please move `"+u.caller.name+"` to JingleMediaSession.ts if you are adding code that uses it")}c.Extend=function(e){s.extend(c.prototype,e),c.prototype._super=o.prototype},r.inherits(c,o),Object.defineProperties(c.prototype,{ringing:{get:function(){return this._ringing},set:function(e){e!==this._ringing&&(this._ringing=e,this.emit("change:ringing",e))}},streams:{get:function(){return"closed"!==this.pc.signalingState?this.pc.getRemoteStreams():[]}}}),c.prototype=i(c.prototype,{accept:function(e,t){u();var n=this;this._candidates=[],1===arguments.length&&"function"==typeof e&&(t=e,e={}),t=t||function(){},e=e||{},n.constraints=e.constraints||{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},this._log("info","Accepted incoming session"),this.state="active",this.pc.answer(n.constraints,function(e,r){if(e)return n._log("error","Could not create WebRTC answer",e),n.end("failed-application");r.jingle.contents.forEach(n._helpers.filterUnusedLabels),n.waitForEndOfCandidates?n.once("endOfCandidates",function(e){n.addAccumulatedCandidates(r.jingle),n.send("session-accept",r.jingle)}):n.send("session-accept",r.jingle),t()})},ring:function(){u(),this._log("info","Ringing on incoming session"),this.ringing=!0,this.send("session-info",{ringing:!0})},mute:function(e,t){u(),this._log("info","Muting",t),this.send("session-info",{mute:{creator:e,name:t}})},unmute:function(e,t){u(),this._log("info","Unmuting",t),this.send("session-info",{unmute:{creator:e,name:t}})},hold:function(){u(),this._log("info","Placing on hold"),this.send("session-info",{hold:!0})},resume:function(){u(),this._log("info","Resuming from hold"),this.send("session-info",{active:!0})},addStream2:function(e,t){u(),this.addStream(e,!0,t)},removeStream2:function(e,t){u(),this.removeStream(e,!0,t)},switchStream:function(e,t,n){u();var r=this;n=n||function(){};var i=this.pc.localDescription;i.contents.forEach(function(e){delete e.transport,delete e.application.payloads}),this.pc.removeStream(e),this.send("source-remove",i),this.pc.addStream(t),this.pc.handleOffer({type:"offer",jingle:this.pc.remoteDescription},function(e){if(e)return r._log("error","Could not process offer for switching streams"),n(e);r.pc.answer(r.constraints,function(e,t){if(e)return r._log("error","Could not process answer for switching streams"),n(e);t.jingle.contents.forEach(function(e){delete e.transport,delete e.application.payloads}),r.send("content-add",t.jingle),n()})})},muteAudio:function(e){u();this._history=this._history||{};var t=this._history.lastContentModify;t&&(t.contents.forEach(function(t){"audio"===t.name&&t.application.sources.forEach(function(t){t.parameters=t.parameters?t.parameters:[],t.parameters.slice().reverse().forEach(function(e,n,r){"pause"===e.name&&t.parameters.splice(r.length-1-n,1)}),t.parameters.push({name:"pause",value:e.toString()})})}),this.send("content-modify",t))},onSessionInitiate:function(e,t){u();var n=this;this._log("info","Initiating incoming session"),this.state="pending",this.pc.isInitiator=!1,this.pc.handleOffer({type:"offer",jingle:e},function(e){if(e)return n._log("error","Could not create WebRTC answer"),t({condition:"general-error"});t()})},onSessionTerminate:function(e,t){u();var n=this;this._log("info","Terminating session"),this.streams.forEach(function(e){n.onRemoveStream({stream:e})}),this.pc.close(),o.prototype.end.call(this,e.reason,!0),t()},onTransportInfo:function(e,t){u(),this.pc.processIce(e,function(){t()})},onAddChannel:function(e){u(),this.emit("addChannel",e)}}),t.exports=c},{async:82,"extend-object":45,"jingle-session":83,lodash:84,rtcpeerconnection:85,util:331}],82:[function(e,t,n){(function(e,r,i){!function(e,r){"object"==typeof n&&void 0!==t?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r(e.async=e.async||{})}(this,function(n){"use strict";function o(e,t){t|=0;for(var n=Math.max(e.length-t,0),r=Array(n),i=0;i<n;i++)r[i]=e[t+i];return r}var a=function(e){var t=o(arguments,1);return function(){var n=o(arguments);return e.apply(null,t.concat(n))}},s=function(e){return function(){var t=o(arguments),n=t.pop();e.call(this,t,n)}};function c(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var u="function"==typeof i&&i,l="object"==typeof e&&"function"==typeof e.nextTick;function d(e){setTimeout(e,0)}function p(e){return function(t){var n=o(arguments,1);e(function(){t.apply(null,n)})}}var f=p(u?i:l?e.nextTick:d);function h(e){return s(function(t,n){var r;try{r=e.apply(this,t)}catch(e){return n(e)}c(r)&&"function"==typeof r.then?r.then(function(e){m(n,null,e)},function(e){m(n,e.message?e:new Error(e))}):n(null,r)})}function m(e,t,n){try{e(t,n)}catch(e){f(v,e)}}function v(e){throw e}var y="function"==typeof Symbol;function g(e){return y&&"AsyncFunction"===e[Symbol.toStringTag]}function S(e){return g(e)?h(e):e}function _(e){return function(t){var n=o(arguments,1),r=s(function(n,r){var i=this;return e(t,function(e,t){S(e).apply(i,n.concat(t))},r)});return n.length?r.apply(this,n):r}}var b="object"==typeof r&&r&&r.Object===Object&&r,C="object"==typeof self&&self&&self.Object===Object&&self,w=b||C||Function("return this")(),E=w.Symbol,R=Object.prototype,P=R.hasOwnProperty,L=R.toString,T=E?E.toStringTag:void 0;var x=Object.prototype.toString;var M="[object Null]",A="[object Undefined]",I=E?E.toStringTag:void 0;function O(e){return null==e?void 0===e?A:M:I&&I in Object(e)?function(e){var t=P.call(e,T),n=e[T];try{e[T]=void 0;var r=!0}catch(e){}var i=L.call(e);return r&&(t?e[T]=n:delete e[T]),i}(e):function(e){return x.call(e)}(e)}var D="[object AsyncFunction]",k="[object Function]",j="[object GeneratorFunction]",N="[object Proxy]";var V=9007199254740991;function U(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=V}function B(e){return null!=e&&U(e.length)&&!function(e){if(!c(e))return!1;var t=O(e);return t==k||t==j||t==D||t==N}(e)}var F={};function G(){}function W(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}var J="function"==typeof Symbol&&Symbol.iterator,q=function(e){return J&&e[J]&&e[J]()};function H(e){return null!=e&&"object"==typeof e}var z="[object Arguments]";function X(e){return H(e)&&O(e)==z}var $=Object.prototype,Y=$.hasOwnProperty,K=$.propertyIsEnumerable,Q=X(function(){return arguments}())?X:function(e){return H(e)&&Y.call(e,"callee")&&!K.call(e,"callee")},Z=Array.isArray;var ee="object"==typeof n&&n&&!n.nodeType&&n,te=ee&&"object"==typeof t&&t&&!t.nodeType&&t,ne=te&&te.exports===ee?w.Buffer:void 0,re=(ne?ne.isBuffer:void 0)||function(){return!1},ie=9007199254740991,oe=/^(?:0|[1-9]\d*)$/;function ae(e,t){var n=typeof e;return!!(t=null==t?ie:t)&&("number"==n||"symbol"!=n&&oe.test(e))&&e>-1&&e%1==0&&e<t}var se={};se["[object Float32Array]"]=se["[object Float64Array]"]=se["[object Int8Array]"]=se["[object Int16Array]"]=se["[object Int32Array]"]=se["[object Uint8Array]"]=se["[object Uint8ClampedArray]"]=se["[object Uint16Array]"]=se["[object Uint32Array]"]=!0,se["[object Arguments]"]=se["[object Array]"]=se["[object ArrayBuffer]"]=se["[object Boolean]"]=se["[object DataView]"]=se["[object Date]"]=se["[object Error]"]=se["[object Function]"]=se["[object Map]"]=se["[object Number]"]=se["[object Object]"]=se["[object RegExp]"]=se["[object Set]"]=se["[object String]"]=se["[object WeakMap]"]=!1;var ce,ue="object"==typeof n&&n&&!n.nodeType&&n,le=ue&&"object"==typeof t&&t&&!t.nodeType&&t,de=le&&le.exports===ue&&b.process,pe=function(){try{var e=le&&le.require&&le.require("util").types;return e||de&&de.binding&&de.binding("util")}catch(e){}}(),fe=pe&&pe.isTypedArray,he=fe?(ce=fe,function(e){return ce(e)}):function(e){return H(e)&&U(e.length)&&!!se[O(e)]},me=Object.prototype.hasOwnProperty;function ve(e,t){var n=Z(e),r=!n&&Q(e),i=!n&&!r&&re(e),o=!n&&!r&&!i&&he(e),a=n||r||i||o,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=s.length;for(var u in e)!t&&!me.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ae(u,c))||s.push(u);return s}var ye=Object.prototype;var ge=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),Se=Object.prototype.hasOwnProperty;function _e(e){if(n=(t=e)&&t.constructor,t!==("function"==typeof n&&n.prototype||ye))return ge(e);var t,n,r=[];for(var i in Object(e))Se.call(e,i)&&"constructor"!=i&&r.push(i);return r}function be(e){return B(e)?ve(e):_e(e)}function Ce(e){if(B(e))return function(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}(e);var t,n,r,i,o=q(e);return o?function(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}(o):(n=be(t=e),r=-1,i=n.length,function(){var e=n[++r];return r<i?{value:t[e],key:e}:null})}function we(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function Ee(e){return function(t,n,r){if(r=W(r||G),e<=0||!t)return r(null);var i=Ce(t),o=!1,a=0,s=!1;function c(e,t){if(a-=1,e)o=!0,r(e);else{if(t===F||o&&a<=0)return o=!0,r(null);s||u()}}function u(){for(s=!0;a<e&&!o;){var t=i();if(null===t)return o=!0,void(a<=0&&r(null));a+=1,n(t.value,t.key,we(c))}s=!1}u()}}function Re(e,t,n,r){Ee(t)(e,S(n),r)}function Pe(e,t){return function(n,r,i){return e(n,t,r,i)}}function Le(e,t,n){n=W(n||G);var r=0,i=0,o=e.length;function a(e,t){e?n(e):++i!==o&&t!==F||n(null)}for(0===o&&n(null);r<o;r++)t(e[r],r,we(a))}var Te=Pe(Re,1/0),xe=function(e,t,n){(B(e)?Le:Te)(e,S(t),n)};function Me(e){return function(t,n,r){return e(xe,t,S(n),r)}}function Ae(e,t,n,r){r=r||G,t=t||[];var i=[],o=0,a=S(n);e(t,function(e,t,n){var r=o++;a(e,function(e,t){i[r]=t,n(e)})},function(e){r(e,i)})}var Ie=Me(Ae),Oe=_(Ie);function De(e){return function(t,n,r,i){return e(Ee(n),t,S(r),i)}}var ke=De(Ae),je=Pe(ke,1),Ne=_(je);function Ve(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}var Ue,Be=function(e,t,n){for(var r=-1,i=Object(e),o=n(e),a=o.length;a--;){var s=o[Ue?a:++r];if(!1===t(i[s],s,i))break}return e};function Fe(e,t){return e&&Be(e,t,be)}function Ge(e){return e!=e}function We(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,Ge,n)}var Je=function(e,t,n){"function"==typeof t&&(n=t,t=null),n=W(n||G);var r=be(e).length;if(!r)return n(null);t||(t=r);var i={},a=0,s=!1,c=Object.create(null),u=[],l=[],d={};function p(e,t){u.push(function(){!function(e,t){if(s)return;var r=we(function(t,r){if(a--,arguments.length>2&&(r=o(arguments,1)),t){var u={};Fe(i,function(e,t){u[t]=e}),u[e]=r,s=!0,c=Object.create(null),n(t,u)}else i[e]=r,Ve(c[e]||[],function(e){e()}),f()});a++;var u=S(t[t.length-1]);t.length>1?u(i,r):u(r)}(e,t)})}function f(){if(0===u.length&&0===a)return n(null,i);for(;u.length&&a<t;){u.shift()()}}function h(t){var n=[];return Fe(e,function(e,r){Z(e)&&We(e,t,0)>=0&&n.push(r)}),n}Fe(e,function(t,n){if(!Z(t))return p(n,[t]),void l.push(n);var r=t.slice(0,t.length-1),i=r.length;if(0===i)return p(n,t),void l.push(n);d[n]=i,Ve(r,function(o){if(!e[o])throw new Error("async.auto task `"+n+"` has a non-existent dependency `"+o+"` in "+r.join(", "));!function(e,t){var n=c[e];n||(n=c[e]=[]);n.push(t)}(o,function(){0===--i&&p(n,t)})})}),function(){var e,t=0;for(;l.length;)e=l.pop(),t++,Ve(h(e),function(e){0==--d[e]&&l.push(e)});if(t!==r)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),f()};function qe(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var He="[object Symbol]";var ze=1/0,Xe=E?E.prototype:void 0,$e=Xe?Xe.toString:void 0;function Ye(e){if("string"==typeof e)return e;if(Z(e))return qe(e,Ye)+"";if(function(e){return"symbol"==typeof e||H(e)&&O(e)==He}(e))return $e?$e.call(e):"";var t=e+"";return"0"==t&&1/e==-ze?"-0":t}function Ke(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}(e,t,n)}var Qe=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Ze="[\\ud800-\\udfff]",et="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",tt="\\ud83c[\\udffb-\\udfff]",nt="[^\\ud800-\\udfff]",rt="(?:\\ud83c[\\udde6-\\uddff]){2}",it="[\\ud800-\\udbff][\\udc00-\\udfff]",ot="(?:"+et+"|"+tt+")"+"?",at="[\\ufe0e\\ufe0f]?"+ot+("(?:\\u200d(?:"+[nt,rt,it].join("|")+")[\\ufe0e\\ufe0f]?"+ot+")*"),st="(?:"+[nt+et+"?",et,rt,it,Ze].join("|")+")",ct=RegExp(tt+"(?="+tt+")|"+st+at,"g");function ut(e){return function(e){return Qe.test(e)}(e)?function(e){return e.match(ct)||[]}(e):function(e){return e.split("")}(e)}var lt=/^\s+|\s+$/g;function dt(e,t,n){var r;if((e=null==(r=e)?"":Ye(r))&&(n||void 0===t))return e.replace(lt,"");if(!e||!(t=Ye(t)))return e;var i=ut(e),o=ut(t);return Ke(i,function(e,t){for(var n=-1,r=e.length;++n<r&&We(t,e[n],0)>-1;);return n}(i,o),function(e,t){for(var n=e.length;n--&&We(t,e[n],0)>-1;);return n}(i,o)+1).join("")}var pt=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,ft=/,/,ht=/(=.+)?(\s*)$/,mt=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function vt(e,t){var n={};Fe(e,function(e,t){var r,i,o=g(e),a=!o&&1===e.length||o&&0===e.length;if(Z(e))r=e.slice(0,-1),e=e[e.length-1],n[t]=r.concat(r.length>0?s:e);else if(a)n[t]=e;else{if(r=i=(i=(i=(i=(i=e).toString().replace(mt,"")).match(pt)[2].replace(" ",""))?i.split(ft):[]).map(function(e){return dt(e.replace(ht,""))}),0===e.length&&!o&&0===r.length)throw new Error("autoInject task functions require explicit parameters.");o||r.pop(),n[t]=r.concat(s)}function s(t,n){var i=qe(r,function(e){return t[e]});i.push(n),S(e).apply(null,i)}}),Je(n,t)}function yt(){this.head=this.tail=null,this.length=0}function gt(e,t){e.length=1,e.head=e.tail=t}function St(e,t,n){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var r=S(e),i=0,o=[],a=!1;function s(e,t,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(l.started=!0,Z(e)||(e=[e]),0===e.length&&l.idle())return f(function(){l.drain()});for(var r=0,i=e.length;r<i;r++){var o={data:e[r],callback:n||G};t?l._tasks.unshift(o):l._tasks.push(o)}a||(a=!0,f(function(){a=!1,l.process()}))}function c(e){return function(t){i-=1;for(var n=0,r=e.length;n<r;n++){var a=e[n],s=We(o,a,0);0===s?o.shift():s>0&&o.splice(s,1),a.callback.apply(a,arguments),null!=t&&l.error(t,a.data)}i<=l.concurrency-l.buffer&&l.unsaturated(),l.idle()&&l.drain(),l.process()}}var u=!1,l={_tasks:new yt,concurrency:t,payload:n,saturated:G,unsaturated:G,buffer:t/4,empty:G,drain:G,error:G,started:!1,paused:!1,push:function(e,t){s(e,!1,t)},kill:function(){l.drain=G,l._tasks.empty()},unshift:function(e,t){s(e,!0,t)},remove:function(e){l._tasks.remove(e)},process:function(){if(!u){for(u=!0;!l.paused&&i<l.concurrency&&l._tasks.length;){var e=[],t=[],n=l._tasks.length;l.payload&&(n=Math.min(n,l.payload));for(var a=0;a<n;a++){var s=l._tasks.shift();e.push(s),o.push(s),t.push(s.data)}i+=1,0===l._tasks.length&&l.empty(),i===l.concurrency&&l.saturated();var d=we(c(e));r(t,d)}u=!1}},length:function(){return l._tasks.length},running:function(){return i},workersList:function(){return o},idle:function(){return l._tasks.length+i===0},pause:function(){l.paused=!0},resume:function(){!1!==l.paused&&(l.paused=!1,f(l.process))}};return l}function _t(e,t){return St(e,1,t)}yt.prototype.removeLink=function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e},yt.prototype.empty=function(){for(;this.head;)this.shift();return this},yt.prototype.insertAfter=function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1},yt.prototype.insertBefore=function(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1},yt.prototype.unshift=function(e){this.head?this.insertBefore(this.head,e):gt(this,e)},yt.prototype.push=function(e){this.tail?this.insertAfter(this.tail,e):gt(this,e)},yt.prototype.shift=function(){return this.head&&this.removeLink(this.head)},yt.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},yt.prototype.toArray=function(){for(var e=Array(this.length),t=this.head,n=0;n<this.length;n++)e[n]=t.data,t=t.next;return e},yt.prototype.remove=function(e){for(var t=this.head;t;){var n=t.next;e(t)&&this.removeLink(t),t=n}return this};var bt=Pe(Re,1);function Ct(e,t,n,r){r=W(r||G);var i=S(n);bt(e,function(e,n,r){i(t,e,function(e,n){t=n,r(e)})},function(e){r(e,t)})}function wt(){var e=qe(arguments,S);return function(){var t=o(arguments),n=this,r=t[t.length-1];"function"==typeof r?t.pop():r=G,Ct(e,t,function(e,t,r){t.apply(n,e.concat(function(e){var t=o(arguments,1);r(e,t)}))},function(e,t){r.apply(n,[e].concat(t))})}}var Et=function(){return wt.apply(null,o(arguments).reverse())},Rt=Array.prototype.concat,Pt=function(e,t,n,r){r=r||G;var i=S(n);ke(e,t,function(e,t){i(e,function(e){return e?t(e):t(null,o(arguments,1))})},function(e,t){for(var n=[],i=0;i<t.length;i++)t[i]&&(n=Rt.apply(n,t[i]));return r(e,n)})},Lt=Pe(Pt,1/0),Tt=Pe(Pt,1),xt=function(){var e=o(arguments),t=[null].concat(e);return function(){return arguments[arguments.length-1].apply(this,t)}};function Mt(e){return e}function At(e,t){return function(n,r,i,o){o=o||G;var a,s=!1;n(r,function(n,r,o){i(n,function(r,i){r?o(r):e(i)&&!a?(s=!0,a=t(!0,n),o(null,F)):o()})},function(e){e?o(e):o(null,s?a:t(!1))})}}function It(e,t){return t}var Ot=Me(At(Mt,It)),Dt=De(At(Mt,It)),kt=Pe(Dt,1);function jt(e){return function(t){var n=o(arguments,1);n.push(function(t){var n=o(arguments,1);"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&Ve(n,function(t){console[e](t)}))}),S(t).apply(null,n)}}var Nt=jt("dir");function Vt(e,t,n){n=we(n||G);var r=S(e),i=S(t);function a(e){if(e)return n(e);var t=o(arguments,1);t.push(s),i.apply(this,t)}function s(e,t){return e?n(e):t?void r(a):n(null)}s(null,!0)}function Ut(e,t,n){n=we(n||G);var r=S(e),i=function(e){if(e)return n(e);var a=o(arguments,1);if(t.apply(this,a))return r(i);n.apply(null,[null].concat(a))};r(i)}function Bt(e,t,n){Ut(e,function(){return!t.apply(this,arguments)},n)}function Ft(e,t,n){n=we(n||G);var r=S(t),i=S(e);function o(e){if(e)return n(e);i(a)}function a(e,t){return e?n(e):t?void r(o):n(null)}i(a)}function Gt(e){return function(t,n,r){return e(t,r)}}function Wt(e,t,n){xe(e,Gt(S(t)),n)}function Jt(e,t,n,r){Ee(t)(e,Gt(S(n)),r)}var qt=Pe(Jt,1);function Ht(e){return g(e)?e:s(function(t,n){var r=!0;t.push(function(){var e=arguments;r?f(function(){n.apply(null,e)}):n.apply(null,e)}),e.apply(this,t),r=!1})}function zt(e){return!e}var Xt=Me(At(zt,zt)),$t=De(At(zt,zt)),Yt=Pe($t,1);function Kt(e){return function(t){return null==t?void 0:t[e]}}function Qt(e,t,n,r){var i=new Array(t.length);e(t,function(e,t,r){n(e,function(e,n){i[t]=!!n,r(e)})},function(e){if(e)return r(e);for(var n=[],o=0;o<t.length;o++)i[o]&&n.push(t[o]);r(null,n)})}function Zt(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(n,o){n?r(n):(o&&i.push({index:t,value:e}),r())})},function(e){e?r(e):r(null,qe(i.sort(function(e,t){return e.index-t.index}),Kt("value")))})}function en(e,t,n,r){(B(t)?Qt:Zt)(e,t,S(n),r||G)}var tn=Me(en),nn=De(en),rn=Pe(nn,1);function on(e,t){var n=we(t||G),r=S(Ht(e));!function e(t){if(t)return n(t);r(e)}()}var an=function(e,t,n,r){r=r||G;var i=S(n);ke(e,t,function(e,t){i(e,function(n,r){return n?t(n):t(null,{key:r,val:e})})},function(e,t){for(var n={},i=Object.prototype.hasOwnProperty,o=0;o<t.length;o++)if(t[o]){var a=t[o].key,s=t[o].val;i.call(n,a)?n[a].push(s):n[a]=[s]}return r(e,n)})},sn=Pe(an,1/0),cn=Pe(an,1),un=jt("log");function ln(e,t,n,r){r=W(r||G);var i={},o=S(n);Re(e,t,function(e,t,n){o(e,t,function(e,r){if(e)return n(e);i[t]=r,n()})},function(e){r(e,i)})}var dn=Pe(ln,1/0),pn=Pe(ln,1);function fn(e,t){return t in e}function hn(e,t){var n=Object.create(null),r=Object.create(null);t=t||Mt;var i=S(e),a=s(function(e,a){var s=t.apply(null,e);fn(n,s)?f(function(){a.apply(null,n[s])}):fn(r,s)?r[s].push(a):(r[s]=[a],i.apply(null,e.concat(function(){var e=o(arguments);n[s]=e;var t=r[s];delete r[s];for(var i=0,a=t.length;i<a;i++)t[i].apply(null,e)})))});return a.memo=n,a.unmemoized=e,a}var mn=p(l?e.nextTick:u?i:d);function vn(e,t,n){n=n||G;var r=B(t)?[]:{};e(t,function(e,t,n){S(e)(function(e,i){arguments.length>2&&(i=o(arguments,1)),r[t]=i,n(e)})},function(e){n(e,r)})}function yn(e,t){vn(xe,e,t)}function gn(e,t,n){vn(Ee(t),e,n)}var Sn=function(e,t){var n=S(e);return St(function(e,t){n(e[0],t)},t,1)},_n=function(e,t){var n=Sn(e,t);return n.push=function(e,t,r){if(null==r&&(r=G),"function"!=typeof r)throw new Error("task callback must be a function");if(n.started=!0,Z(e)||(e=[e]),0===e.length)return f(function(){n.drain()});t=t||0;for(var i=n._tasks.head;i&&t>=i.priority;)i=i.next;for(var o=0,a=e.length;o<a;o++){var s={data:e[o],priority:t,callback:r};i?n._tasks.insertBefore(i,s):n._tasks.push(s)}f(n.process)},delete n.unshift,n};function bn(e,t){if(t=W(t||G),!Z(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var n=0,r=e.length;n<r;n++)S(e[n])(t)}function Cn(e,t,n,r){Ct(o(e).reverse(),t,n,r)}function wn(e){var t=S(e);return s(function(e,n){return e.push(function(e,t){var r;e?n(null,{error:e}):(r=arguments.length<=2?t:o(arguments,1),n(null,{value:r}))}),t.apply(this,e)})}function En(e){var t;return Z(e)?t=qe(e,wn):(t={},Fe(e,function(e,n){t[n]=wn.call(this,e)})),t}function Rn(e,t,n,r){en(e,t,function(e,t){n(e,function(e,n){t(e,!n)})},r)}var Pn=Me(Rn),Ln=De(Rn),Tn=Pe(Ln,1);function xn(e){return function(){return e}}function Mn(e,t,n){var r=5,i=0,o={times:r,intervalFunc:xn(i)};if(arguments.length<3&&"function"==typeof e?(n=t||G,t=e):(!function(e,t){if("object"==typeof t)e.times=+t.times||r,e.intervalFunc="function"==typeof t.interval?t.interval:xn(+t.interval||i),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||r}}(o,e),n=n||G),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var a=S(t),s=1;!function e(){a(function(t){t&&s++<o.times&&("function"!=typeof o.errorFilter||o.errorFilter(t))?setTimeout(e,o.intervalFunc(s)):n.apply(null,arguments)})}()}var An=function(e,t){t||(t=e,e=null);var n=S(t);return s(function(t,r){function i(e){n.apply(null,t.concat(e))}e?Mn(e,i,r):Mn(i,r)})};function In(e,t){vn(bt,e,t)}var On=Me(At(Boolean,Mt)),Dn=De(At(Boolean,Mt)),kn=Pe(Dn,1);function jn(e,t,n){var r=S(t);function i(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0}Ie(e,function(e,t){r(e,function(n,r){if(n)return t(n);t(null,{value:e,criteria:r})})},function(e,t){if(e)return n(e);n(null,qe(t.sort(i),Kt("value")))})}function Nn(e,t,n){var r=S(e);return s(function(i,o){var a,s=!1;i.push(function(){s||(o.apply(null,arguments),clearTimeout(a))}),a=setTimeout(function(){var t=e.name||"anonymous",r=new Error('Callback function "'+t+'" timed out.');r.code="ETIMEDOUT",n&&(r.info=n),s=!0,o(r)},t),r.apply(null,i)})}var Vn=Math.ceil,Un=Math.max;function Bn(e,t,n,r){var i=S(n);ke(function(e,t,n,r){for(var i=-1,o=Un(Vn((t-e)/(n||1)),0),a=Array(o);o--;)a[r?o:++i]=e,e+=n;return a}(0,e,1),t,i,r)}var Fn=Pe(Bn,1/0),Gn=Pe(Bn,1);function Wn(e,t,n,r){arguments.length<=3&&(r=n,n=t,t=Z(e)?[]:{}),r=W(r||G);var i=S(n);xe(e,function(e,n,r){i(t,e,n,r)},function(e){r(e,t)})}function Jn(e,t){var n,r=null;t=t||G,qt(e,function(e,t){S(e)(function(e,i){n=arguments.length>2?o(arguments,1):i,r=e,t(!e)})},function(){t(r,n)})}function qn(e){return function(){return(e.unmemoized||e).apply(null,arguments)}}function Hn(e,t,n){n=we(n||G);var r=S(t);if(!e())return n(null);var i=function(t){if(t)return n(t);if(e())return r(i);var a=o(arguments,1);n.apply(null,[null].concat(a))};r(i)}function zn(e,t,n){Hn(function(){return!e.apply(this,arguments)},t,n)}var Xn=function(e,t){if(t=W(t||G),!Z(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var n=0;function r(t){var r=S(e[n++]);t.push(we(i)),r.apply(null,t)}function i(i){if(i||n===e.length)return t.apply(null,arguments);r(o(arguments,1))}r([])},$n={apply:a,applyEach:Oe,applyEachSeries:Ne,asyncify:h,auto:Je,autoInject:vt,cargo:_t,compose:Et,concat:Lt,concatLimit:Pt,concatSeries:Tt,constant:xt,detect:Ot,detectLimit:Dt,detectSeries:kt,dir:Nt,doDuring:Vt,doUntil:Bt,doWhilst:Ut,during:Ft,each:Wt,eachLimit:Jt,eachOf:xe,eachOfLimit:Re,eachOfSeries:bt,eachSeries:qt,ensureAsync:Ht,every:Xt,everyLimit:$t,everySeries:Yt,filter:tn,filterLimit:nn,filterSeries:rn,forever:on,groupBy:sn,groupByLimit:an,groupBySeries:cn,log:un,map:Ie,mapLimit:ke,mapSeries:je,mapValues:dn,mapValuesLimit:ln,mapValuesSeries:pn,memoize:hn,nextTick:mn,parallel:yn,parallelLimit:gn,priorityQueue:_n,queue:Sn,race:bn,reduce:Ct,reduceRight:Cn,reflect:wn,reflectAll:En,reject:Pn,rejectLimit:Ln,rejectSeries:Tn,retry:Mn,retryable:An,seq:wt,series:In,setImmediate:f,some:On,someLimit:Dn,someSeries:kn,sortBy:jn,timeout:Nn,times:Fn,timesLimit:Bn,timesSeries:Gn,transform:Wn,tryEach:Jn,unmemoize:qn,until:zn,waterfall:Xn,whilst:Hn,all:Xt,allLimit:$t,allSeries:Yt,any:On,anyLimit:Dn,anySeries:kn,find:Ot,findLimit:Dt,findSeries:kt,forEach:Wt,forEachSeries:qt,forEachLimit:Jt,forEachOf:xe,forEachOfSeries:bt,forEachOfLimit:Re,inject:Ct,foldl:Ct,foldr:Cn,select:tn,selectLimit:nn,selectSeries:rn,wrapSync:h};n.default=$n,n.apply=a,n.applyEach=Oe,n.applyEachSeries=Ne,n.asyncify=h,n.auto=Je,n.autoInject=vt,n.cargo=_t,n.compose=Et,n.concat=Lt,n.concatLimit=Pt,n.concatSeries=Tt,n.constant=xt,n.detect=Ot,n.detectLimit=Dt,n.detectSeries=kt,n.dir=Nt,n.doDuring=Vt,n.doUntil=Bt,n.doWhilst=Ut,n.during=Ft,n.each=Wt,n.eachLimit=Jt,n.eachOf=xe,n.eachOfLimit=Re,n.eachOfSeries=bt,n.eachSeries=qt,n.ensureAsync=Ht,n.every=Xt,n.everyLimit=$t,n.everySeries=Yt,n.filter=tn,n.filterLimit=nn,n.filterSeries=rn,n.forever=on,n.groupBy=sn,n.groupByLimit=an,n.groupBySeries=cn,n.log=un,n.map=Ie,n.mapLimit=ke,n.mapSeries=je,n.mapValues=dn,n.mapValuesLimit=ln,n.mapValuesSeries=pn,n.memoize=hn,n.nextTick=mn,n.parallel=yn,n.parallelLimit=gn,n.priorityQueue=_n,n.queue=Sn,n.race=bn,n.reduce=Ct,n.reduceRight=Cn,n.reflect=wn,n.reflectAll=En,n.reject=Pn,n.rejectLimit=Ln,n.rejectSeries=Tn,n.retry=Mn,n.retryable=An,n.seq=wt,n.series=In,n.setImmediate=f,n.some=On,n.someLimit=Dn,n.someSeries=kn,n.sortBy=jn,n.timeout=Nn,n.times=Fn,n.timesLimit=Bn,n.timesSeries=Gn,n.transform=Wn,n.tryEach=Jn,n.unmemoize=qn,n.until=zn,n.waterfall=Xn,n.whilst=Hn,n.all=Xt,n.allLimit=$t,n.allSeries=Yt,n.any=On,n.anyLimit=Dn,n.anySeries=kn,n.find=Ot,n.findLimit=Dt,n.findSeries=kt,n.forEach=Wt,n.forEachSeries=qt,n.forEachLimit=Jt,n.forEachOf=xe,n.forEachOfSeries=bt,n.forEachOfLimit=Re,n.inject=Ct,n.foldl=Ct,n.foldr=Cn,n.select=tn,n.selectLimit=nn,n.selectSeries=rn,n.wrapSync=h,Object.defineProperty(n,"__esModule",{value:!0})})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{_process:8,timers:326}],83:[function(e,t,n){arguments[4][68][0].apply(n,arguments)},{async:82,dup:68,"extend-object":45,util:331,uuid:332,wildemitter:86}],84:[function(e,t,n){(function(e){(function(){var r,i=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",s="__lodash_hash_undefined__",c=500,u="__lodash_placeholder__",l=1,d=2,p=4,f=1,h=2,m=1,v=2,y=4,g=8,S=16,_=32,b=64,C=128,w=256,E=512,R=30,P="...",L=800,T=16,x=1,M=2,A=1/0,I=9007199254740991,O=1.7976931348623157e308,D=NaN,k=4294967295,j=k-1,N=k>>>1,V=[["ary",C],["bind",m],["bindKey",v],["curry",g],["curryRight",S],["flip",E],["partial",_],["partialRight",b],["rearg",w]],U="[object Arguments]",B="[object Array]",F="[object AsyncFunction]",G="[object Boolean]",W="[object Date]",J="[object DOMException]",q="[object Error]",H="[object Function]",z="[object GeneratorFunction]",X="[object Map]",$="[object Number]",Y="[object Null]",K="[object Object]",Q="[object Proxy]",Z="[object RegExp]",ee="[object Set]",te="[object String]",ne="[object Symbol]",re="[object Undefined]",ie="[object WeakMap]",oe="[object WeakSet]",ae="[object ArrayBuffer]",se="[object DataView]",ce="[object Float32Array]",ue="[object Float64Array]",le="[object Int8Array]",de="[object Int16Array]",pe="[object Int32Array]",fe="[object Uint8Array]",he="[object Uint8ClampedArray]",me="[object Uint16Array]",ve="[object Uint32Array]",ye=/\b__p \+= '';/g,ge=/\b(__p \+=) '' \+/g,Se=/(__e\(.*?\)|\b__t\)) \+\n'';/g,_e=/&(?:amp|lt|gt|quot|#39);/g,be=/[&<>"']/g,Ce=RegExp(_e.source),we=RegExp(be.source),Ee=/<%-([\s\S]+?)%>/g,Re=/<%([\s\S]+?)%>/g,Pe=/<%=([\s\S]+?)%>/g,Le=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Te=/^\w*$/,xe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Me=/[\\^$.*+?()[\]{}|]/g,Ae=RegExp(Me.source),Ie=/^\s+|\s+$/g,Oe=/^\s+/,De=/\s+$/,ke=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,je=/\{\n\/\* \[wrapped with (.+)\] \*/,Ne=/,? & /,Ve=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ue=/\\(\\)?/g,Be=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Fe=/\w*$/,Ge=/^[-+]0x[0-9a-f]+$/i,We=/^0b[01]+$/i,Je=/^\[object .+?Constructor\]$/,qe=/^0o[0-7]+$/i,He=/^(?:0|[1-9]\d*)$/,ze=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Xe=/($^)/,$e=/['\n\r\u2028\u2029\\]/g,Ye="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ke="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Qe="[\\ud800-\\udfff]",Ze="["+Ke+"]",et="["+Ye+"]",tt="\\d+",nt="[\\u2700-\\u27bf]",rt="[a-z\\xdf-\\xf6\\xf8-\\xff]",it="[^\\ud800-\\udfff"+Ke+tt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",ot="\\ud83c[\\udffb-\\udfff]",at="[^\\ud800-\\udfff]",st="(?:\\ud83c[\\udde6-\\uddff]){2}",ct="[\\ud800-\\udbff][\\udc00-\\udfff]",ut="[A-Z\\xc0-\\xd6\\xd8-\\xde]",lt="(?:"+rt+"|"+it+")",dt="(?:"+ut+"|"+it+")",pt="(?:"+et+"|"+ot+")"+"?",ft="[\\ufe0e\\ufe0f]?"+pt+("(?:\\u200d(?:"+[at,st,ct].join("|")+")[\\ufe0e\\ufe0f]?"+pt+")*"),ht="(?:"+[nt,st,ct].join("|")+")"+ft,mt="(?:"+[at+et+"?",et,st,ct,Qe].join("|")+")",vt=RegExp("[']","g"),yt=RegExp(et,"g"),gt=RegExp(ot+"(?="+ot+")|"+mt+ft,"g"),St=RegExp([ut+"?"+rt+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[Ze,ut,"$"].join("|")+")",dt+"+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[Ze,ut+lt,"$"].join("|")+")",ut+"?"+lt+"+(?:['](?:d|ll|m|re|s|t|ve))?",ut+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",tt,ht].join("|"),"g"),_t=RegExp("[\\u200d\\ud800-\\udfff"+Ye+"\\ufe0e\\ufe0f]"),bt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ct=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],wt=-1,Et={};Et[ce]=Et[ue]=Et[le]=Et[de]=Et[pe]=Et[fe]=Et[he]=Et[me]=Et[ve]=!0,Et[U]=Et[B]=Et[ae]=Et[G]=Et[se]=Et[W]=Et[q]=Et[H]=Et[X]=Et[$]=Et[K]=Et[Z]=Et[ee]=Et[te]=Et[ie]=!1;var Rt={};Rt[U]=Rt[B]=Rt[ae]=Rt[se]=Rt[G]=Rt[W]=Rt[ce]=Rt[ue]=Rt[le]=Rt[de]=Rt[pe]=Rt[X]=Rt[$]=Rt[K]=Rt[Z]=Rt[ee]=Rt[te]=Rt[ne]=Rt[fe]=Rt[he]=Rt[me]=Rt[ve]=!0,Rt[q]=Rt[H]=Rt[ie]=!1;var Pt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Lt=parseFloat,Tt=parseInt,xt="object"==typeof e&&e&&e.Object===Object&&e,Mt="object"==typeof self&&self&&self.Object===Object&&self,At=xt||Mt||Function("return this")(),It="object"==typeof n&&n&&!n.nodeType&&n,Ot=It&&"object"==typeof t&&t&&!t.nodeType&&t,Dt=Ot&&Ot.exports===It,kt=Dt&&xt.process,jt=function(){try{var e=Ot&&Ot.require&&Ot.require("util").types;return e||kt&&kt.binding&&kt.binding("util")}catch(e){}}(),Nt=jt&&jt.isArrayBuffer,Vt=jt&&jt.isDate,Ut=jt&&jt.isMap,Bt=jt&&jt.isRegExp,Ft=jt&&jt.isSet,Gt=jt&&jt.isTypedArray;function Wt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Jt(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function qt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Ht(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function zt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Xt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function $t(e,t){return!!(null==e?0:e.length)&&an(e,t,0)>-1}function Yt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Kt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function Qt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Zt(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function en(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function tn(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var nn=ln("length");function rn(e,t,n){var r;return n(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}function on(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function an(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):on(e,cn,n)}function sn(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function cn(e){return e!=e}function un(e,t){var n=null==e?0:e.length;return n?fn(e,t)/n:D}function ln(e){return function(t){return null==t?r:t[e]}}function dn(e){return function(t){return null==e?r:e[t]}}function pn(e,t,n,r,i){return i(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n}function fn(e,t){for(var n,i=-1,o=e.length;++i<o;){var a=t(e[i]);a!==r&&(n=n===r?a:n+a)}return n}function hn(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function mn(e){return function(t){return e(t)}}function vn(e,t){return Kt(t,function(t){return e[t]})}function yn(e,t){return e.has(t)}function gn(e,t){for(var n=-1,r=e.length;++n<r&&an(t,e[n],0)>-1;);return n}function Sn(e,t){for(var n=e.length;n--&&an(t,e[n],0)>-1;);return n}var _n=dn({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),bn=dn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Cn(e){return"\\"+Pt[e]}function wn(e){return _t.test(e)}function En(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function Rn(e,t){return function(n){return e(t(n))}}function Pn(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==u||(e[n]=u,o[i++]=n)}return o}function Ln(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function Tn(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function xn(e){return wn(e)?function(e){var t=gt.lastIndex=0;for(;gt.test(e);)++t;return t}(e):nn(e)}function Mn(e){return wn(e)?function(e){return e.match(gt)||[]}(e):function(e){return e.split("")}(e)}var An=dn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var In=function e(t){var n,Ye=(t=null==t?At:In.defaults(At.Object(),t,In.pick(At,Ct))).Array,Ke=t.Date,Qe=t.Error,Ze=t.Function,et=t.Math,tt=t.Object,nt=t.RegExp,rt=t.String,it=t.TypeError,ot=Ye.prototype,at=Ze.prototype,st=tt.prototype,ct=t["__core-js_shared__"],ut=at.toString,lt=st.hasOwnProperty,dt=0,pt=(n=/[^.]+$/.exec(ct&&ct.keys&&ct.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",ft=st.toString,ht=ut.call(tt),mt=At._,gt=nt("^"+ut.call(lt).replace(Me,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_t=Dt?t.Buffer:r,Pt=t.Symbol,xt=t.Uint8Array,Mt=_t?_t.allocUnsafe:r,It=Rn(tt.getPrototypeOf,tt),Ot=tt.create,kt=st.propertyIsEnumerable,jt=ot.splice,nn=Pt?Pt.isConcatSpreadable:r,dn=Pt?Pt.iterator:r,On=Pt?Pt.toStringTag:r,Dn=function(){try{var e=Uo(tt,"defineProperty");return e({},"",{}),e}catch(e){}}(),kn=t.clearTimeout!==At.clearTimeout&&t.clearTimeout,jn=Ke&&Ke.now!==At.Date.now&&Ke.now,Nn=t.setTimeout!==At.setTimeout&&t.setTimeout,Vn=et.ceil,Un=et.floor,Bn=tt.getOwnPropertySymbols,Fn=_t?_t.isBuffer:r,Gn=t.isFinite,Wn=ot.join,Jn=Rn(tt.keys,tt),qn=et.max,Hn=et.min,zn=Ke.now,Xn=t.parseInt,$n=et.random,Yn=ot.reverse,Kn=Uo(t,"DataView"),Qn=Uo(t,"Map"),Zn=Uo(t,"Promise"),er=Uo(t,"Set"),tr=Uo(t,"WeakMap"),nr=Uo(tt,"create"),rr=tr&&new tr,ir={},or=da(Kn),ar=da(Qn),sr=da(Zn),cr=da(er),ur=da(tr),lr=Pt?Pt.prototype:r,dr=lr?lr.valueOf:r,pr=lr?lr.toString:r;function fr(e){if(Ts(e)&&!ys(e)&&!(e instanceof yr)){if(e instanceof vr)return e;if(lt.call(e,"__wrapped__"))return pa(e)}return new vr(e)}var hr=function(){function e(){}return function(t){if(!Ls(t))return{};if(Ot)return Ot(t);e.prototype=t;var n=new e;return e.prototype=r,n}}();function mr(){}function vr(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=r}function yr(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=k,this.__views__=[]}function gr(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Sr(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function _r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function br(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new _r;++t<n;)this.add(e[t])}function Cr(e){var t=this.__data__=new Sr(e);this.size=t.size}function wr(e,t){var n=ys(e),r=!n&&vs(e),i=!n&&!r&&bs(e),o=!n&&!r&&!i&&js(e),a=n||r||i||o,s=a?hn(e.length,rt):[],c=s.length;for(var u in e)!t&&!lt.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ho(u,c))||s.push(u);return s}function Er(e){var t=e.length;return t?e[bi(0,t-1)]:r}function Rr(e,t){return ca(no(e),Dr(t,0,e.length))}function Pr(e){return ca(no(e))}function Lr(e,t,n){(n===r||fs(e[t],n))&&(n!==r||t in e)||Ir(e,t,n)}function Tr(e,t,n){var i=e[t];lt.call(e,t)&&fs(i,n)&&(n!==r||t in e)||Ir(e,t,n)}function xr(e,t){for(var n=e.length;n--;)if(fs(e[n][0],t))return n;return-1}function Mr(e,t,n,r){return Ur(e,function(e,i,o){t(r,e,n(e),o)}),r}function Ar(e,t){return e&&ro(t,ic(t),e)}function Ir(e,t,n){"__proto__"==t&&Dn?Dn(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Or(e,t){for(var n=-1,i=t.length,o=Ye(i),a=null==e;++n<i;)o[n]=a?r:Zs(e,t[n]);return o}function Dr(e,t,n){return e==e&&(n!==r&&(e=e<=n?e:n),t!==r&&(e=e>=t?e:t)),e}function kr(e,t,n,i,o,a){var s,c=t&l,u=t&d,f=t&p;if(n&&(s=o?n(e,i,o,a):n(e)),s!==r)return s;if(!Ls(e))return e;var h=ys(e);if(h){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&lt.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!c)return no(e,s)}else{var m=Go(e),v=m==H||m==z;if(bs(e))return Yi(e,c);if(m==K||m==U||v&&!o){if(s=u||v?{}:Jo(e),!c)return u?function(e,t){return ro(e,Fo(e),t)}(e,function(e,t){return e&&ro(t,oc(t),e)}(s,e)):function(e,t){return ro(e,Bo(e),t)}(e,Ar(s,e))}else{if(!Rt[m])return o?e:{};s=function(e,t,n){var r,i,o,a=e.constructor;switch(t){case ae:return Ki(e);case G:case W:return new a(+e);case se:return function(e,t){var n=t?Ki(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case ce:case ue:case le:case de:case pe:case fe:case he:case me:case ve:return Qi(e,n);case X:return new a;case $:case te:return new a(e);case Z:return(o=new(i=e).constructor(i.source,Fe.exec(i))).lastIndex=i.lastIndex,o;case ee:return new a;case ne:return r=e,dr?tt(dr.call(r)):{}}}(e,m,c)}}a||(a=new Cr);var y=a.get(e);if(y)return y;a.set(e,s),Os(e)?e.forEach(function(r){s.add(kr(r,t,n,r,e,a))}):xs(e)&&e.forEach(function(r,i){s.set(i,kr(r,t,n,i,e,a))});var g=h?r:(f?u?Io:Ao:u?oc:ic)(e);return qt(g||e,function(r,i){g&&(r=e[i=r]),Tr(s,i,kr(r,t,n,i,e,a))}),s}function jr(e,t,n){var i=n.length;if(null==e)return!i;for(e=tt(e);i--;){var o=n[i],a=t[o],s=e[o];if(s===r&&!(o in e)||!a(s))return!1}return!0}function Nr(e,t,n){if("function"!=typeof e)throw new it(a);return ia(function(){e.apply(r,n)},t)}function Vr(e,t,n,r){var o=-1,a=$t,s=!0,c=e.length,u=[],l=t.length;if(!c)return u;n&&(t=Kt(t,mn(n))),r?(a=Yt,s=!1):t.length>=i&&(a=yn,s=!1,t=new br(t));e:for(;++o<c;){var d=e[o],p=null==n?d:n(d);if(d=r||0!==d?d:0,s&&p==p){for(var f=l;f--;)if(t[f]===p)continue e;u.push(d)}else a(t,p,r)||u.push(d)}return u}fr.templateSettings={escape:Ee,evaluate:Re,interpolate:Pe,variable:"",imports:{_:fr}},fr.prototype=mr.prototype,fr.prototype.constructor=fr,vr.prototype=hr(mr.prototype),vr.prototype.constructor=vr,yr.prototype=hr(mr.prototype),yr.prototype.constructor=yr,gr.prototype.clear=function(){this.__data__=nr?nr(null):{},this.size=0},gr.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},gr.prototype.get=function(e){var t=this.__data__;if(nr){var n=t[e];return n===s?r:n}return lt.call(t,e)?t[e]:r},gr.prototype.has=function(e){var t=this.__data__;return nr?t[e]!==r:lt.call(t,e)},gr.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=nr&&t===r?s:t,this},Sr.prototype.clear=function(){this.__data__=[],this.size=0},Sr.prototype.delete=function(e){var t=this.__data__,n=xr(t,e);return!(n<0||(n==t.length-1?t.pop():jt.call(t,n,1),--this.size,0))},Sr.prototype.get=function(e){var t=this.__data__,n=xr(t,e);return n<0?r:t[n][1]},Sr.prototype.has=function(e){return xr(this.__data__,e)>-1},Sr.prototype.set=function(e,t){var n=this.__data__,r=xr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},_r.prototype.clear=function(){this.size=0,this.__data__={hash:new gr,map:new(Qn||Sr),string:new gr}},_r.prototype.delete=function(e){var t=No(this,e).delete(e);return this.size-=t?1:0,t},_r.prototype.get=function(e){return No(this,e).get(e)},_r.prototype.has=function(e){return No(this,e).has(e)},_r.prototype.set=function(e,t){var n=No(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},br.prototype.add=br.prototype.push=function(e){return this.__data__.set(e,s),this},br.prototype.has=function(e){return this.__data__.has(e)},Cr.prototype.clear=function(){this.__data__=new Sr,this.size=0},Cr.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Cr.prototype.get=function(e){return this.__data__.get(e)},Cr.prototype.has=function(e){return this.__data__.has(e)},Cr.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Sr){var r=n.__data__;if(!Qn||r.length<i-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new _r(r)}return n.set(e,t),this.size=n.size,this};var Ur=ao(zr),Br=ao(Xr,!0);function Fr(e,t){var n=!0;return Ur(e,function(e,r,i){return n=!!t(e,r,i)}),n}function Gr(e,t,n){for(var i=-1,o=e.length;++i<o;){var a=e[i],s=t(a);if(null!=s&&(c===r?s==s&&!ks(s):n(s,c)))var c=s,u=a}return u}function Wr(e,t){var n=[];return Ur(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function Jr(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=qo),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?Jr(s,t-1,n,r,i):Qt(i,s):r||(i[i.length]=s)}return i}var qr=so(),Hr=so(!0);function zr(e,t){return e&&qr(e,t,ic)}function Xr(e,t){return e&&Hr(e,t,ic)}function $r(e,t){return Xt(t,function(t){return Es(e[t])})}function Yr(e,t){for(var n=0,i=(t=Hi(t,e)).length;null!=e&&n<i;)e=e[la(t[n++])];return n&&n==i?e:r}function Kr(e,t,n){var r=t(e);return ys(e)?r:Qt(r,n(e))}function Qr(e){return null==e?e===r?re:Y:On&&On in tt(e)?function(e){var t=lt.call(e,On),n=e[On];try{e[On]=r;var i=!0}catch(e){}var o=ft.call(e);return i&&(t?e[On]=n:delete e[On]),o}(e):function(e){return ft.call(e)}(e)}function Zr(e,t){return e>t}function ei(e,t){return null!=e&&lt.call(e,t)}function ti(e,t){return null!=e&&t in tt(e)}function ni(e,t,n){for(var i=n?Yt:$t,o=e[0].length,a=e.length,s=a,c=Ye(a),u=1/0,l=[];s--;){var d=e[s];s&&t&&(d=Kt(d,mn(t))),u=Hn(d.length,u),c[s]=!n&&(t||o>=120&&d.length>=120)?new br(s&&d):r}d=e[0];var p=-1,f=c[0];e:for(;++p<o&&l.length<u;){var h=d[p],m=t?t(h):h;if(h=n||0!==h?h:0,!(f?yn(f,m):i(l,m,n))){for(s=a;--s;){var v=c[s];if(!(v?yn(v,m):i(e[s],m,n)))continue e}f&&f.push(m),l.push(h)}}return l}function ri(e,t,n){var i=null==(e=ta(e,t=Hi(t,e)))?e:e[la(wa(t))];return null==i?r:Wt(i,e,n)}function ii(e){return Ts(e)&&Qr(e)==U}function oi(e,t,n,i,o){return e===t||(null==e||null==t||!Ts(e)&&!Ts(t)?e!=e&&t!=t:function(e,t,n,i,o,a){var s=ys(e),c=ys(t),u=s?B:Go(e),l=c?B:Go(t),d=(u=u==U?K:u)==K,p=(l=l==U?K:l)==K,m=u==l;if(m&&bs(e)){if(!bs(t))return!1;s=!0,d=!1}if(m&&!d)return a||(a=new Cr),s||js(e)?xo(e,t,n,i,o,a):function(e,t,n,r,i,o,a){switch(n){case se:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ae:return!(e.byteLength!=t.byteLength||!o(new xt(e),new xt(t)));case G:case W:case $:return fs(+e,+t);case q:return e.name==t.name&&e.message==t.message;case Z:case te:return e==t+"";case X:var s=En;case ee:var c=r&f;if(s||(s=Ln),e.size!=t.size&&!c)return!1;var u=a.get(e);if(u)return u==t;r|=h,a.set(e,t);var l=xo(s(e),s(t),r,i,o,a);return a.delete(e),l;case ne:if(dr)return dr.call(e)==dr.call(t)}return!1}(e,t,u,n,i,o,a);if(!(n&f)){var v=d&&lt.call(e,"__wrapped__"),y=p&&lt.call(t,"__wrapped__");if(v||y){var g=v?e.value():e,S=y?t.value():t;return a||(a=new Cr),o(g,S,n,i,a)}}return!!m&&(a||(a=new Cr),function(e,t,n,i,o,a){var s=n&f,c=Ao(e),u=c.length,l=Ao(t).length;if(u!=l&&!s)return!1;for(var d=u;d--;){var p=c[d];if(!(s?p in t:lt.call(t,p)))return!1}var h=a.get(e);if(h&&a.get(t))return h==t;var m=!0;a.set(e,t),a.set(t,e);for(var v=s;++d<u;){p=c[d];var y=e[p],g=t[p];if(i)var S=s?i(g,y,p,t,e,a):i(y,g,p,e,t,a);if(!(S===r?y===g||o(y,g,n,i,a):S)){m=!1;break}v||(v="constructor"==p)}if(m&&!v){var _=e.constructor,b=t.constructor;_!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof b&&b instanceof b)&&(m=!1)}return a.delete(e),a.delete(t),m}(e,t,n,i,o,a))}(e,t,n,i,oi,o))}function ai(e,t,n,i){var o=n.length,a=o,s=!i;if(null==e)return!a;for(e=tt(e);o--;){var c=n[o];if(s&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<a;){var u=(c=n[o])[0],l=e[u],d=c[1];if(s&&c[2]){if(l===r&&!(u in e))return!1}else{var p=new Cr;if(i)var m=i(l,d,u,e,t,p);if(!(m===r?oi(d,l,f|h,i,p):m))return!1}}return!0}function si(e){return!(!Ls(e)||(t=e,pt&&pt in t))&&(Es(e)?gt:Je).test(da(e));var t}function ci(e){return"function"==typeof e?e:null==e?Mc:"object"==typeof e?ys(e)?hi(e[0],e[1]):fi(e):Uc(e)}function ui(e){if(!Ko(e))return Jn(e);var t=[];for(var n in tt(e))lt.call(e,n)&&"constructor"!=n&&t.push(n);return t}function li(e){if(!Ls(e))return function(e){var t=[];if(null!=e)for(var n in tt(e))t.push(n);return t}(e);var t=Ko(e),n=[];for(var r in e)("constructor"!=r||!t&&lt.call(e,r))&&n.push(r);return n}function di(e,t){return e<t}function pi(e,t){var n=-1,r=Ss(e)?Ye(e.length):[];return Ur(e,function(e,i,o){r[++n]=t(e,i,o)}),r}function fi(e){var t=Vo(e);return 1==t.length&&t[0][2]?Zo(t[0][0],t[0][1]):function(n){return n===e||ai(n,e,t)}}function hi(e,t){return Xo(e)&&Qo(t)?Zo(la(e),t):function(n){var i=Zs(n,e);return i===r&&i===t?ec(n,e):oi(t,i,f|h)}}function mi(e,t,n,i,o){e!==t&&qr(t,function(a,s){if(o||(o=new Cr),Ls(a))!function(e,t,n,i,o,a,s){var c=na(e,n),u=na(t,n),l=s.get(u);if(l)Lr(e,n,l);else{var d=a?a(c,u,n+"",e,t,s):r,p=d===r;if(p){var f=ys(u),h=!f&&bs(u),m=!f&&!h&&js(u);d=u,f||h||m?ys(c)?d=c:_s(c)?d=no(c):h?(p=!1,d=Yi(u,!0)):m?(p=!1,d=Qi(u,!0)):d=[]:As(u)||vs(u)?(d=c,vs(c)?d=Js(c):Ls(c)&&!Es(c)||(d=Jo(u))):p=!1}p&&(s.set(u,d),o(d,u,i,a,s),s.delete(u)),Lr(e,n,d)}}(e,t,s,n,mi,i,o);else{var c=i?i(na(e,s),a,s+"",e,t,o):r;c===r&&(c=a),Lr(e,s,c)}},oc)}function vi(e,t){var n=e.length;if(n)return Ho(t+=t<0?n:0,n)?e[t]:r}function yi(e,t,n){var r=-1;return t=Kt(t.length?t:[Mc],mn(jo())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(pi(e,function(e,n,i){return{criteria:Kt(t,function(t){return t(e)}),index:++r,value:e}}),function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var c=Zi(i[r],o[r]);if(c){if(r>=s)return c;var u=n[r];return c*("desc"==u?-1:1)}}return e.index-t.index}(e,t,n)})}function gi(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=Yr(e,a);n(s,a)&&Pi(o,Hi(a,e),s)}return o}function Si(e,t,n,r){var i=r?sn:an,o=-1,a=t.length,s=e;for(e===t&&(t=no(t)),n&&(s=Kt(e,mn(n)));++o<a;)for(var c=0,u=t[o],l=n?n(u):u;(c=i(s,l,c,r))>-1;)s!==e&&jt.call(s,c,1),jt.call(e,c,1);return e}function _i(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;Ho(i)?jt.call(e,i,1):Vi(e,i)}}return e}function bi(e,t){return e+Un($n()*(t-e+1))}function Ci(e,t){var n="";if(!e||t<1||t>I)return n;do{t%2&&(n+=e),(t=Un(t/2))&&(e+=e)}while(t);return n}function wi(e,t){return oa(ea(e,t,Mc),e+"")}function Ei(e){return Er(fc(e))}function Ri(e,t){var n=fc(e);return ca(n,Dr(t,0,n.length))}function Pi(e,t,n,i){if(!Ls(e))return e;for(var o=-1,a=(t=Hi(t,e)).length,s=a-1,c=e;null!=c&&++o<a;){var u=la(t[o]),l=n;if(o!=s){var d=c[u];(l=i?i(d,u,c):r)===r&&(l=Ls(d)?d:Ho(t[o+1])?[]:{})}Tr(c,u,l),c=c[u]}return e}var Li=rr?function(e,t){return rr.set(e,t),e}:Mc,Ti=Dn?function(e,t){return Dn(e,"toString",{configurable:!0,enumerable:!1,value:Lc(t),writable:!0})}:Mc;function xi(e){return ca(fc(e))}function Mi(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Ye(i);++r<i;)o[r]=e[r+t];return o}function Ai(e,t){var n;return Ur(e,function(e,r,i){return!(n=t(e,r,i))}),!!n}function Ii(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=N){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!ks(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return Oi(e,t,Mc,n)}function Oi(e,t,n,i){t=n(t);for(var o=0,a=null==e?0:e.length,s=t!=t,c=null===t,u=ks(t),l=t===r;o<a;){var d=Un((o+a)/2),p=n(e[d]),f=p!==r,h=null===p,m=p==p,v=ks(p);if(s)var y=i||m;else y=l?m&&(i||f):c?m&&f&&(i||!h):u?m&&f&&!h&&(i||!v):!h&&!v&&(i?p<=t:p<t);y?o=d+1:a=d}return Hn(a,j)}function Di(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!fs(s,c)){var c=s;o[i++]=0===a?0:a}}return o}function ki(e){return"number"==typeof e?e:ks(e)?D:+e}function ji(e){if("string"==typeof e)return e;if(ys(e))return Kt(e,ji)+"";if(ks(e))return pr?pr.call(e):"";var t=e+"";return"0"==t&&1/e==-A?"-0":t}function Ni(e,t,n){var r=-1,o=$t,a=e.length,s=!0,c=[],u=c;if(n)s=!1,o=Yt;else if(a>=i){var l=t?null:wo(e);if(l)return Ln(l);s=!1,o=yn,u=new br}else u=t?[]:c;e:for(;++r<a;){var d=e[r],p=t?t(d):d;if(d=n||0!==d?d:0,s&&p==p){for(var f=u.length;f--;)if(u[f]===p)continue e;t&&u.push(p),c.push(d)}else o(u,p,n)||(u!==c&&u.push(p),c.push(d))}return c}function Vi(e,t){return null==(e=ta(e,t=Hi(t,e)))||delete e[la(wa(t))]}function Ui(e,t,n,r){return Pi(e,t,n(Yr(e,t)),r)}function Bi(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?Mi(e,r?0:o,r?o+1:i):Mi(e,r?o+1:0,r?i:o)}function Fi(e,t){var n=e;return n instanceof yr&&(n=n.value()),Zt(t,function(e,t){return t.func.apply(t.thisArg,Qt([e],t.args))},n)}function Gi(e,t,n){var r=e.length;if(r<2)return r?Ni(e[0]):[];for(var i=-1,o=Ye(r);++i<r;)for(var a=e[i],s=-1;++s<r;)s!=i&&(o[i]=Vr(o[i]||a,e[s],t,n));return Ni(Jr(o,1),t,n)}function Wi(e,t,n){for(var i=-1,o=e.length,a=t.length,s={};++i<o;){var c=i<a?t[i]:r;n(s,e[i],c)}return s}function Ji(e){return _s(e)?e:[]}function qi(e){return"function"==typeof e?e:Mc}function Hi(e,t){return ys(e)?e:Xo(e,t)?[e]:ua(qs(e))}var zi=wi;function Xi(e,t,n){var i=e.length;return n=n===r?i:n,!t&&n>=i?e:Mi(e,t,n)}var $i=kn||function(e){return At.clearTimeout(e)};function Yi(e,t){if(t)return e.slice();var n=e.length,r=Mt?Mt(n):new e.constructor(n);return e.copy(r),r}function Ki(e){var t=new e.constructor(e.byteLength);return new xt(t).set(new xt(e)),t}function Qi(e,t){var n=t?Ki(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Zi(e,t){if(e!==t){var n=e!==r,i=null===e,o=e==e,a=ks(e),s=t!==r,c=null===t,u=t==t,l=ks(t);if(!c&&!l&&!a&&e>t||a&&s&&u&&!c&&!l||i&&s&&u||!n&&u||!o)return 1;if(!i&&!a&&!l&&e<t||l&&n&&o&&!i&&!a||c&&n&&o||!s&&o||!u)return-1}return 0}function eo(e,t,n,r){for(var i=-1,o=e.length,a=n.length,s=-1,c=t.length,u=qn(o-a,0),l=Ye(c+u),d=!r;++s<c;)l[s]=t[s];for(;++i<a;)(d||i<o)&&(l[n[i]]=e[i]);for(;u--;)l[s++]=e[i++];return l}function to(e,t,n,r){for(var i=-1,o=e.length,a=-1,s=n.length,c=-1,u=t.length,l=qn(o-s,0),d=Ye(l+u),p=!r;++i<l;)d[i]=e[i];for(var f=i;++c<u;)d[f+c]=t[c];for(;++a<s;)(p||i<o)&&(d[f+n[a]]=e[i++]);return d}function no(e,t){var n=-1,r=e.length;for(t||(t=Ye(r));++n<r;)t[n]=e[n];return t}function ro(e,t,n,i){var o=!n;n||(n={});for(var a=-1,s=t.length;++a<s;){var c=t[a],u=i?i(n[c],e[c],c,n,e):r;u===r&&(u=e[c]),o?Ir(n,c,u):Tr(n,c,u)}return n}function io(e,t){return function(n,r){var i=ys(n)?Jt:Mr,o=t?t():{};return i(n,e,jo(r,2),o)}}function oo(e){return wi(function(t,n){var i=-1,o=n.length,a=o>1?n[o-1]:r,s=o>2?n[2]:r;for(a=e.length>3&&"function"==typeof a?(o--,a):r,s&&zo(n[0],n[1],s)&&(a=o<3?r:a,o=1),t=tt(t);++i<o;){var c=n[i];c&&e(t,c,i,a)}return t})}function ao(e,t){return function(n,r){if(null==n)return n;if(!Ss(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=tt(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function so(e){return function(t,n,r){for(var i=-1,o=tt(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(!1===n(o[c],c,o))break}return t}}function co(e){return function(t){var n=wn(t=qs(t))?Mn(t):r,i=n?n[0]:t.charAt(0),o=n?Xi(n,1).join(""):t.slice(1);return i[e]()+o}}function uo(e){return function(t){return Zt(Ec(vc(t).replace(vt,"")),e,"")}}function lo(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=hr(e.prototype),r=e.apply(n,t);return Ls(r)?r:n}}function po(e){return function(t,n,i){var o=tt(t);if(!Ss(t)){var a=jo(n,3);t=ic(t),n=function(e){return a(o[e],e,o)}}var s=e(t,n,i);return s>-1?o[a?t[s]:s]:r}}function fo(e){return Mo(function(t){var n=t.length,i=n,o=vr.prototype.thru;for(e&&t.reverse();i--;){var s=t[i];if("function"!=typeof s)throw new it(a);if(o&&!c&&"wrapper"==Do(s))var c=new vr([],!0)}for(i=c?i:n;++i<n;){var u=Do(s=t[i]),l="wrapper"==u?Oo(s):r;c=l&&$o(l[0])&&l[1]==(C|g|_|w)&&!l[4].length&&1==l[9]?c[Do(l[0])].apply(c,l[3]):1==s.length&&$o(s)?c[u]():c.thru(s)}return function(){var e=arguments,r=e[0];if(c&&1==e.length&&ys(r))return c.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}})}function ho(e,t,n,i,o,a,s,c,u,l){var d=t&C,p=t&m,f=t&v,h=t&(g|S),y=t&E,_=f?r:lo(e);return function m(){for(var v=arguments.length,g=Ye(v),S=v;S--;)g[S]=arguments[S];if(h)var b=ko(m),C=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(g,b);if(i&&(g=eo(g,i,o,h)),a&&(g=to(g,a,s,h)),v-=C,h&&v<l){var w=Pn(g,b);return bo(e,t,ho,m.placeholder,n,g,w,c,u,l-v)}var E=p?n:this,R=f?E[e]:e;return v=g.length,c?g=function(e,t){for(var n=e.length,i=Hn(t.length,n),o=no(e);i--;){var a=t[i];e[i]=Ho(a,n)?o[a]:r}return e}(g,c):y&&v>1&&g.reverse(),d&&u<v&&(g.length=u),this&&this!==At&&this instanceof m&&(R=_||lo(R)),R.apply(E,g)}}function mo(e,t){return function(n,r){return function(e,t,n,r){return zr(e,function(e,i,o){t(r,n(e),i,o)}),r}(n,e,t(r),{})}}function vo(e,t){return function(n,i){var o;if(n===r&&i===r)return t;if(n!==r&&(o=n),i!==r){if(o===r)return i;"string"==typeof n||"string"==typeof i?(n=ji(n),i=ji(i)):(n=ki(n),i=ki(i)),o=e(n,i)}return o}}function yo(e){return Mo(function(t){return t=Kt(t,mn(jo())),wi(function(n){var r=this;return e(t,function(e){return Wt(e,r,n)})})})}function go(e,t){var n=(t=t===r?" ":ji(t)).length;if(n<2)return n?Ci(t,e):t;var i=Ci(t,Vn(e/xn(t)));return wn(t)?Xi(Mn(i),0,e).join(""):i.slice(0,e)}function So(e){return function(t,n,i){return i&&"number"!=typeof i&&zo(t,n,i)&&(n=i=r),t=Bs(t),n===r?(n=t,t=0):n=Bs(n),function(e,t,n,r){for(var i=-1,o=qn(Vn((t-e)/(n||1)),0),a=Ye(o);o--;)a[r?o:++i]=e,e+=n;return a}(t,n,i=i===r?t<n?1:-1:Bs(i),e)}}function _o(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=Ws(t),n=Ws(n)),e(t,n)}}function bo(e,t,n,i,o,a,s,c,u,l){var d=t&g;t|=d?_:b,(t&=~(d?b:_))&y||(t&=~(m|v));var p=[e,t,o,d?a:r,d?s:r,d?r:a,d?r:s,c,u,l],f=n.apply(r,p);return $o(e)&&ra(f,p),f.placeholder=i,aa(f,e,t)}function Co(e){var t=et[e];return function(e,n){if(e=Ws(e),(n=null==n?0:Hn(Fs(n),292))&&Gn(e)){var r=(qs(e)+"e").split("e");return+((r=(qs(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var wo=er&&1/Ln(new er([,-0]))[1]==A?function(e){return new er(e)}:kc;function Eo(e){return function(t){var n=Go(t);return n==X?En(t):n==ee?Tn(t):function(e,t){return Kt(t,function(t){return[t,e[t]]})}(t,e(t))}}function Ro(e,t,n,i,o,s,c,l){var d=t&v;if(!d&&"function"!=typeof e)throw new it(a);var p=i?i.length:0;if(p||(t&=~(_|b),i=o=r),c=c===r?c:qn(Fs(c),0),l=l===r?l:Fs(l),p-=o?o.length:0,t&b){var f=i,h=o;i=o=r}var E=d?r:Oo(e),R=[e,t,n,i,o,f,h,s,c,l];if(E&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<(m|v|C),a=r==C&&n==g||r==C&&n==w&&e[7].length<=t[8]||r==(C|w)&&t[7].length<=t[8]&&n==g;if(!o&&!a)return e;r&m&&(e[2]=t[2],i|=n&m?0:y);var s=t[3];if(s){var c=e[3];e[3]=c?eo(c,s,t[4]):s,e[4]=c?Pn(e[3],u):t[4]}(s=t[5])&&(c=e[5],e[5]=c?to(c,s,t[6]):s,e[6]=c?Pn(e[5],u):t[6]),(s=t[7])&&(e[7]=s),r&C&&(e[8]=null==e[8]?t[8]:Hn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(R,E),e=R[0],t=R[1],n=R[2],i=R[3],o=R[4],!(l=R[9]=R[9]===r?d?0:e.length:qn(R[9]-p,0))&&t&(g|S)&&(t&=~(g|S)),t&&t!=m)P=t==g||t==S?function(e,t,n){var i=lo(e);return function o(){for(var a=arguments.length,s=Ye(a),c=a,u=ko(o);c--;)s[c]=arguments[c];var l=a<3&&s[0]!==u&&s[a-1]!==u?[]:Pn(s,u);return(a-=l.length)<n?bo(e,t,ho,o.placeholder,r,s,l,r,r,n-a):Wt(this&&this!==At&&this instanceof o?i:e,this,s)}}(e,t,l):t!=_&&t!=(m|_)||o.length?ho.apply(r,R):function(e,t,n,r){var i=t&m,o=lo(e);return function t(){for(var a=-1,s=arguments.length,c=-1,u=r.length,l=Ye(u+s),d=this&&this!==At&&this instanceof t?o:e;++c<u;)l[c]=r[c];for(;s--;)l[c++]=arguments[++a];return Wt(d,i?n:this,l)}}(e,t,n,i);else var P=function(e,t,n){var r=t&m,i=lo(e);return function t(){return(this&&this!==At&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return aa((E?Li:ra)(P,R),e,t)}function Po(e,t,n,i){return e===r||fs(e,st[n])&&!lt.call(i,n)?t:e}function Lo(e,t,n,i,o,a){return Ls(e)&&Ls(t)&&(a.set(t,e),mi(e,t,r,Lo,a),a.delete(t)),e}function To(e){return As(e)?r:e}function xo(e,t,n,i,o,a){var s=n&f,c=e.length,u=t.length;if(c!=u&&!(s&&u>c))return!1;var l=a.get(e);if(l&&a.get(t))return l==t;var d=-1,p=!0,m=n&h?new br:r;for(a.set(e,t),a.set(t,e);++d<c;){var v=e[d],y=t[d];if(i)var g=s?i(y,v,d,t,e,a):i(v,y,d,e,t,a);if(g!==r){if(g)continue;p=!1;break}if(m){if(!tn(t,function(e,t){if(!yn(m,t)&&(v===e||o(v,e,n,i,a)))return m.push(t)})){p=!1;break}}else if(v!==y&&!o(v,y,n,i,a)){p=!1;break}}return a.delete(e),a.delete(t),p}function Mo(e){return oa(ea(e,r,ga),e+"")}function Ao(e){return Kr(e,ic,Bo)}function Io(e){return Kr(e,oc,Fo)}var Oo=rr?function(e){return rr.get(e)}:kc;function Do(e){for(var t=e.name+"",n=ir[t],r=lt.call(ir,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function ko(e){return(lt.call(fr,"placeholder")?fr:e).placeholder}function jo(){var e=fr.iteratee||Ac;return e=e===Ac?ci:e,arguments.length?e(arguments[0],arguments[1]):e}function No(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Vo(e){for(var t=ic(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Qo(i)]}return t}function Uo(e,t){var n=function(e,t){return null==e?r:e[t]}(e,t);return si(n)?n:r}var Bo=Bn?function(e){return null==e?[]:(e=tt(e),Xt(Bn(e),function(t){return kt.call(e,t)}))}:Gc,Fo=Bn?function(e){for(var t=[];e;)Qt(t,Bo(e)),e=It(e);return t}:Gc,Go=Qr;function Wo(e,t,n){for(var r=-1,i=(t=Hi(t,e)).length,o=!1;++r<i;){var a=la(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Ps(i)&&Ho(a,i)&&(ys(e)||vs(e))}function Jo(e){return"function"!=typeof e.constructor||Ko(e)?{}:hr(It(e))}function qo(e){return ys(e)||vs(e)||!!(nn&&e&&e[nn])}function Ho(e,t){var n=typeof e;return!!(t=null==t?I:t)&&("number"==n||"symbol"!=n&&He.test(e))&&e>-1&&e%1==0&&e<t}function zo(e,t,n){if(!Ls(n))return!1;var r=typeof t;return!!("number"==r?Ss(n)&&Ho(t,n.length):"string"==r&&t in n)&&fs(n[t],e)}function Xo(e,t){if(ys(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ks(e))||Te.test(e)||!Le.test(e)||null!=t&&e in tt(t)}function $o(e){var t=Do(e),n=fr[t];if("function"!=typeof n||!(t in yr.prototype))return!1;if(e===n)return!0;var r=Oo(n);return!!r&&e===r[0]}(Kn&&Go(new Kn(new ArrayBuffer(1)))!=se||Qn&&Go(new Qn)!=X||Zn&&"[object Promise]"!=Go(Zn.resolve())||er&&Go(new er)!=ee||tr&&Go(new tr)!=ie)&&(Go=function(e){var t=Qr(e),n=t==K?e.constructor:r,i=n?da(n):"";if(i)switch(i){case or:return se;case ar:return X;case sr:return"[object Promise]";case cr:return ee;case ur:return ie}return t});var Yo=ct?Es:Wc;function Ko(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||st)}function Qo(e){return e==e&&!Ls(e)}function Zo(e,t){return function(n){return null!=n&&n[e]===t&&(t!==r||e in tt(n))}}function ea(e,t,n){return t=qn(t===r?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=qn(r.length-t,0),a=Ye(o);++i<o;)a[i]=r[t+i];i=-1;for(var s=Ye(t+1);++i<t;)s[i]=r[i];return s[t]=n(a),Wt(e,this,s)}}function ta(e,t){return t.length<2?e:Yr(e,Mi(t,0,-1))}function na(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var ra=sa(Li),ia=Nn||function(e,t){return At.setTimeout(e,t)},oa=sa(Ti);function aa(e,t,n){var r=t+"";return oa(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ke,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return qt(V,function(n){var r="_."+n[0];t&n[1]&&!$t(e,r)&&e.push(r)}),e.sort()}(function(e){var t=e.match(je);return t?t[1].split(Ne):[]}(r),n)))}function sa(e){var t=0,n=0;return function(){var i=zn(),o=T-(i-n);if(n=i,o>0){if(++t>=L)return arguments[0]}else t=0;return e.apply(r,arguments)}}function ca(e,t){var n=-1,i=e.length,o=i-1;for(t=t===r?i:t;++n<t;){var a=bi(n,o),s=e[a];e[a]=e[n],e[n]=s}return e.length=t,e}var ua=function(e){var t=ss(e,function(e){return n.size===c&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(xe,function(e,n,r,i){t.push(r?i.replace(Ue,"$1"):n||e)}),t});function la(e){if("string"==typeof e||ks(e))return e;var t=e+"";return"0"==t&&1/e==-A?"-0":t}function da(e){if(null!=e){try{return ut.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function pa(e){if(e instanceof yr)return e.clone();var t=new vr(e.__wrapped__,e.__chain__);return t.__actions__=no(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var fa=wi(function(e,t){return _s(e)?Vr(e,Jr(t,1,_s,!0)):[]}),ha=wi(function(e,t){var n=wa(t);return _s(n)&&(n=r),_s(e)?Vr(e,Jr(t,1,_s,!0),jo(n,2)):[]}),ma=wi(function(e,t){var n=wa(t);return _s(n)&&(n=r),_s(e)?Vr(e,Jr(t,1,_s,!0),r,n):[]});function va(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Fs(n);return i<0&&(i=qn(r+i,0)),on(e,jo(t,3),i)}function ya(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=i-1;return n!==r&&(o=Fs(n),o=n<0?qn(i+o,0):Hn(o,i-1)),on(e,jo(t,3),o,!0)}function ga(e){return null!=e&&e.length?Jr(e,1):[]}function Sa(e){return e&&e.length?e[0]:r}var _a=wi(function(e){var t=Kt(e,Ji);return t.length&&t[0]===e[0]?ni(t):[]}),ba=wi(function(e){var t=wa(e),n=Kt(e,Ji);return t===wa(n)?t=r:n.pop(),n.length&&n[0]===e[0]?ni(n,jo(t,2)):[]}),Ca=wi(function(e){var t=wa(e),n=Kt(e,Ji);return(t="function"==typeof t?t:r)&&n.pop(),n.length&&n[0]===e[0]?ni(n,r,t):[]});function wa(e){var t=null==e?0:e.length;return t?e[t-1]:r}var Ea=wi(Ra);function Ra(e,t){return e&&e.length&&t&&t.length?Si(e,t):e}var Pa=Mo(function(e,t){var n=null==e?0:e.length,r=Or(e,t);return _i(e,Kt(t,function(e){return Ho(e,n)?+e:e}).sort(Zi)),r});function La(e){return null==e?e:Yn.call(e)}var Ta=wi(function(e){return Ni(Jr(e,1,_s,!0))}),xa=wi(function(e){var t=wa(e);return _s(t)&&(t=r),Ni(Jr(e,1,_s,!0),jo(t,2))}),Ma=wi(function(e){var t=wa(e);return t="function"==typeof t?t:r,Ni(Jr(e,1,_s,!0),r,t)});function Aa(e){if(!e||!e.length)return[];var t=0;return e=Xt(e,function(e){if(_s(e))return t=qn(e.length,t),!0}),hn(t,function(t){return Kt(e,ln(t))})}function Ia(e,t){if(!e||!e.length)return[];var n=Aa(e);return null==t?n:Kt(n,function(e){return Wt(t,r,e)})}var Oa=wi(function(e,t){return _s(e)?Vr(e,t):[]}),Da=wi(function(e){return Gi(Xt(e,_s))}),ka=wi(function(e){var t=wa(e);return _s(t)&&(t=r),Gi(Xt(e,_s),jo(t,2))}),ja=wi(function(e){var t=wa(e);return t="function"==typeof t?t:r,Gi(Xt(e,_s),r,t)}),Na=wi(Aa);var Va=wi(function(e){var t=e.length,n=t>1?e[t-1]:r;return n="function"==typeof n?(e.pop(),n):r,Ia(e,n)});function Ua(e){var t=fr(e);return t.__chain__=!0,t}function Ba(e,t){return t(e)}var Fa=Mo(function(e){var t=e.length,n=t?e[0]:0,i=this.__wrapped__,o=function(t){return Or(t,e)};return!(t>1||this.__actions__.length)&&i instanceof yr&&Ho(n)?((i=i.slice(n,+n+(t?1:0))).__actions__.push({func:Ba,args:[o],thisArg:r}),new vr(i,this.__chain__).thru(function(e){return t&&!e.length&&e.push(r),e})):this.thru(o)});var Ga=io(function(e,t,n){lt.call(e,n)?++e[n]:Ir(e,n,1)});var Wa=po(va),Ja=po(ya);function qa(e,t){return(ys(e)?qt:Ur)(e,jo(t,3))}function Ha(e,t){return(ys(e)?Ht:Br)(e,jo(t,3))}var za=io(function(e,t,n){lt.call(e,n)?e[n].push(t):Ir(e,n,[t])});var Xa=wi(function(e,t,n){var r=-1,i="function"==typeof t,o=Ss(e)?Ye(e.length):[];return Ur(e,function(e){o[++r]=i?Wt(t,e,n):ri(e,t,n)}),o}),$a=io(function(e,t,n){Ir(e,n,t)});function Ya(e,t){return(ys(e)?Kt:pi)(e,jo(t,3))}var Ka=io(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});var Qa=wi(function(e,t){if(null==e)return[];var n=t.length;return n>1&&zo(e,t[0],t[1])?t=[]:n>2&&zo(t[0],t[1],t[2])&&(t=[t[0]]),yi(e,Jr(t,1),[])}),Za=jn||function(){return At.Date.now()};function es(e,t,n){return t=n?r:t,t=e&&null==t?e.length:t,Ro(e,C,r,r,r,r,t)}function ts(e,t){var n;if("function"!=typeof t)throw new it(a);return e=Fs(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=r),n}}var ns=wi(function(e,t,n){var r=m;if(n.length){var i=Pn(n,ko(ns));r|=_}return Ro(e,r,t,n,i)}),rs=wi(function(e,t,n){var r=m|v;if(n.length){var i=Pn(n,ko(rs));r|=_}return Ro(t,r,e,n,i)});function is(e,t,n){var i,o,s,c,u,l,d=0,p=!1,f=!1,h=!0;if("function"!=typeof e)throw new it(a);function m(t){var n=i,a=o;return i=o=r,d=t,c=e.apply(a,n)}function v(e){var n=e-l;return l===r||n>=t||n<0||f&&e-d>=s}function y(){var e=Za();if(v(e))return g(e);u=ia(y,function(e){var n=t-(e-l);return f?Hn(n,s-(e-d)):n}(e))}function g(e){return u=r,h&&i?m(e):(i=o=r,c)}function S(){var e=Za(),n=v(e);if(i=arguments,o=this,l=e,n){if(u===r)return function(e){return d=e,u=ia(y,t),p?m(e):c}(l);if(f)return $i(u),u=ia(y,t),m(l)}return u===r&&(u=ia(y,t)),c}return t=Ws(t)||0,Ls(n)&&(p=!!n.leading,s=(f="maxWait"in n)?qn(Ws(n.maxWait)||0,t):s,h="trailing"in n?!!n.trailing:h),S.cancel=function(){u!==r&&$i(u),d=0,i=l=o=u=r},S.flush=function(){return u===r?c:g(Za())},S}var os=wi(function(e,t){return Nr(e,1,t)}),as=wi(function(e,t,n){return Nr(e,Ws(t)||0,n)});function ss(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new it(a);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(ss.Cache||_r),n}function cs(e){if("function"!=typeof e)throw new it(a);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}ss.Cache=_r;var us=zi(function(e,t){var n=(t=1==t.length&&ys(t[0])?Kt(t[0],mn(jo())):Kt(Jr(t,1),mn(jo()))).length;return wi(function(r){for(var i=-1,o=Hn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return Wt(e,this,r)})}),ls=wi(function(e,t){var n=Pn(t,ko(ls));return Ro(e,_,r,t,n)}),ds=wi(function(e,t){var n=Pn(t,ko(ds));return Ro(e,b,r,t,n)}),ps=Mo(function(e,t){return Ro(e,w,r,r,r,t)});function fs(e,t){return e===t||e!=e&&t!=t}var hs=_o(Zr),ms=_o(function(e,t){return e>=t}),vs=ii(function(){return arguments}())?ii:function(e){return Ts(e)&&lt.call(e,"callee")&&!kt.call(e,"callee")},ys=Ye.isArray,gs=Nt?mn(Nt):function(e){return Ts(e)&&Qr(e)==ae};function Ss(e){return null!=e&&Ps(e.length)&&!Es(e)}function _s(e){return Ts(e)&&Ss(e)}var bs=Fn||Wc,Cs=Vt?mn(Vt):function(e){return Ts(e)&&Qr(e)==W};function ws(e){if(!Ts(e))return!1;var t=Qr(e);return t==q||t==J||"string"==typeof e.message&&"string"==typeof e.name&&!As(e)}function Es(e){if(!Ls(e))return!1;var t=Qr(e);return t==H||t==z||t==F||t==Q}function Rs(e){return"number"==typeof e&&e==Fs(e)}function Ps(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=I}function Ls(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ts(e){return null!=e&&"object"==typeof e}var xs=Ut?mn(Ut):function(e){return Ts(e)&&Go(e)==X};function Ms(e){return"number"==typeof e||Ts(e)&&Qr(e)==$}function As(e){if(!Ts(e)||Qr(e)!=K)return!1;var t=It(e);if(null===t)return!0;var n=lt.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&ut.call(n)==ht}var Is=Bt?mn(Bt):function(e){return Ts(e)&&Qr(e)==Z};var Os=Ft?mn(Ft):function(e){return Ts(e)&&Go(e)==ee};function Ds(e){return"string"==typeof e||!ys(e)&&Ts(e)&&Qr(e)==te}function ks(e){return"symbol"==typeof e||Ts(e)&&Qr(e)==ne}var js=Gt?mn(Gt):function(e){return Ts(e)&&Ps(e.length)&&!!Et[Qr(e)]};var Ns=_o(di),Vs=_o(function(e,t){return e<=t});function Us(e){if(!e)return[];if(Ss(e))return Ds(e)?Mn(e):no(e);if(dn&&e[dn])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[dn]());var t=Go(e);return(t==X?En:t==ee?Ln:fc)(e)}function Bs(e){return e?(e=Ws(e))===A||e===-A?(e<0?-1:1)*O:e==e?e:0:0===e?e:0}function Fs(e){var t=Bs(e),n=t%1;return t==t?n?t-n:t:0}function Gs(e){return e?Dr(Fs(e),0,k):0}function Ws(e){if("number"==typeof e)return e;if(ks(e))return D;if(Ls(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ls(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Ie,"");var n=We.test(e);return n||qe.test(e)?Tt(e.slice(2),n?2:8):Ge.test(e)?D:+e}function Js(e){return ro(e,oc(e))}function qs(e){return null==e?"":ji(e)}var Hs=oo(function(e,t){if(Ko(t)||Ss(t))ro(t,ic(t),e);else for(var n in t)lt.call(t,n)&&Tr(e,n,t[n])}),zs=oo(function(e,t){ro(t,oc(t),e)}),Xs=oo(function(e,t,n,r){ro(t,oc(t),e,r)}),$s=oo(function(e,t,n,r){ro(t,ic(t),e,r)}),Ys=Mo(Or);var Ks=wi(function(e,t){e=tt(e);var n=-1,i=t.length,o=i>2?t[2]:r;for(o&&zo(t[0],t[1],o)&&(i=1);++n<i;)for(var a=t[n],s=oc(a),c=-1,u=s.length;++c<u;){var l=s[c],d=e[l];(d===r||fs(d,st[l])&&!lt.call(e,l))&&(e[l]=a[l])}return e}),Qs=wi(function(e){return e.push(r,Lo),Wt(sc,r,e)});function Zs(e,t,n){var i=null==e?r:Yr(e,t);return i===r?n:i}function ec(e,t){return null!=e&&Wo(e,t,ti)}var tc=mo(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ft.call(t)),e[t]=n},Lc(Mc)),nc=mo(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ft.call(t)),lt.call(e,t)?e[t].push(n):e[t]=[n]},jo),rc=wi(ri);function ic(e){return Ss(e)?wr(e):ui(e)}function oc(e){return Ss(e)?wr(e,!0):li(e)}var ac=oo(function(e,t,n){mi(e,t,n)}),sc=oo(function(e,t,n,r){mi(e,t,n,r)}),cc=Mo(function(e,t){var n={};if(null==e)return n;var r=!1;t=Kt(t,function(t){return t=Hi(t,e),r||(r=t.length>1),t}),ro(e,Io(e),n),r&&(n=kr(n,l|d|p,To));for(var i=t.length;i--;)Vi(n,t[i]);return n});var uc=Mo(function(e,t){return null==e?{}:function(e,t){return gi(e,t,function(t,n){return ec(e,n)})}(e,t)});function lc(e,t){if(null==e)return{};var n=Kt(Io(e),function(e){return[e]});return t=jo(t),gi(e,n,function(e,n){return t(e,n[0])})}var dc=Eo(ic),pc=Eo(oc);function fc(e){return null==e?[]:vn(e,ic(e))}var hc=uo(function(e,t,n){return t=t.toLowerCase(),e+(n?mc(t):t)});function mc(e){return wc(qs(e).toLowerCase())}function vc(e){return(e=qs(e))&&e.replace(ze,_n).replace(yt,"")}var yc=uo(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),gc=uo(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),Sc=co("toLowerCase");var _c=uo(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});var bc=uo(function(e,t,n){return e+(n?" ":"")+wc(t)});var Cc=uo(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),wc=co("toUpperCase");function Ec(e,t,n){return e=qs(e),(t=n?r:t)===r?function(e){return bt.test(e)}(e)?function(e){return e.match(St)||[]}(e):function(e){return e.match(Ve)||[]}(e):e.match(t)||[]}var Rc=wi(function(e,t){try{return Wt(e,r,t)}catch(e){return ws(e)?e:new Qe(e)}}),Pc=Mo(function(e,t){return qt(t,function(t){t=la(t),Ir(e,t,ns(e[t],e))}),e});function Lc(e){return function(){return e}}var Tc=fo(),xc=fo(!0);function Mc(e){return e}function Ac(e){return ci("function"==typeof e?e:kr(e,l))}var Ic=wi(function(e,t){return function(n){return ri(n,e,t)}}),Oc=wi(function(e,t){return function(n){return ri(e,n,t)}});function Dc(e,t,n){var r=ic(t),i=$r(t,r);null!=n||Ls(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=$r(t,ic(t)));var o=!(Ls(n)&&"chain"in n&&!n.chain),a=Es(e);return qt(i,function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=no(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Qt([this.value()],arguments))})}),e}function kc(){}var jc=yo(Kt),Nc=yo(zt),Vc=yo(tn);function Uc(e){return Xo(e)?ln(la(e)):function(e){return function(t){return Yr(t,e)}}(e)}var Bc=So(),Fc=So(!0);function Gc(){return[]}function Wc(){return!1}var Jc=vo(function(e,t){return e+t},0),qc=Co("ceil"),Hc=vo(function(e,t){return e/t},1),zc=Co("floor");var Xc,$c=vo(function(e,t){return e*t},1),Yc=Co("round"),Kc=vo(function(e,t){return e-t},0);return fr.after=function(e,t){if("function"!=typeof t)throw new it(a);return e=Fs(e),function(){if(--e<1)return t.apply(this,arguments)}},fr.ary=es,fr.assign=Hs,fr.assignIn=zs,fr.assignInWith=Xs,fr.assignWith=$s,fr.at=Ys,fr.before=ts,fr.bind=ns,fr.bindAll=Pc,fr.bindKey=rs,fr.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return ys(e)?e:[e]},fr.chain=Ua,fr.chunk=function(e,t,n){t=(n?zo(e,t,n):t===r)?1:qn(Fs(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var o=0,a=0,s=Ye(Vn(i/t));o<i;)s[a++]=Mi(e,o,o+=t);return s},fr.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},fr.concat=function(){var e=arguments.length;if(!e)return[];for(var t=Ye(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return Qt(ys(n)?no(n):[n],Jr(t,1))},fr.cond=function(e){var t=null==e?0:e.length,n=jo();return e=t?Kt(e,function(e){if("function"!=typeof e[1])throw new it(a);return[n(e[0]),e[1]]}):[],wi(function(n){for(var r=-1;++r<t;){var i=e[r];if(Wt(i[0],this,n))return Wt(i[1],this,n)}})},fr.conforms=function(e){return function(e){var t=ic(e);return function(n){return jr(n,e,t)}}(kr(e,l))},fr.constant=Lc,fr.countBy=Ga,fr.create=function(e,t){var n=hr(e);return null==t?n:Ar(n,t)},fr.curry=function e(t,n,i){var o=Ro(t,g,r,r,r,r,r,n=i?r:n);return o.placeholder=e.placeholder,o},fr.curryRight=function e(t,n,i){var o=Ro(t,S,r,r,r,r,r,n=i?r:n);return o.placeholder=e.placeholder,o},fr.debounce=is,fr.defaults=Ks,fr.defaultsDeep=Qs,fr.defer=os,fr.delay=as,fr.difference=fa,fr.differenceBy=ha,fr.differenceWith=ma,fr.drop=function(e,t,n){var i=null==e?0:e.length;return i?Mi(e,(t=n||t===r?1:Fs(t))<0?0:t,i):[]},fr.dropRight=function(e,t,n){var i=null==e?0:e.length;return i?Mi(e,0,(t=i-(t=n||t===r?1:Fs(t)))<0?0:t):[]},fr.dropRightWhile=function(e,t){return e&&e.length?Bi(e,jo(t,3),!0,!0):[]},fr.dropWhile=function(e,t){return e&&e.length?Bi(e,jo(t,3),!0):[]},fr.fill=function(e,t,n,i){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&zo(e,t,n)&&(n=0,i=o),function(e,t,n,i){var o=e.length;for((n=Fs(n))<0&&(n=-n>o?0:o+n),(i=i===r||i>o?o:Fs(i))<0&&(i+=o),i=n>i?0:Gs(i);n<i;)e[n++]=t;return e}(e,t,n,i)):[]},fr.filter=function(e,t){return(ys(e)?Xt:Wr)(e,jo(t,3))},fr.flatMap=function(e,t){return Jr(Ya(e,t),1)},fr.flatMapDeep=function(e,t){return Jr(Ya(e,t),A)},fr.flatMapDepth=function(e,t,n){return n=n===r?1:Fs(n),Jr(Ya(e,t),n)},fr.flatten=ga,fr.flattenDeep=function(e){return null!=e&&e.length?Jr(e,A):[]},fr.flattenDepth=function(e,t){return null!=e&&e.length?Jr(e,t=t===r?1:Fs(t)):[]},fr.flip=function(e){return Ro(e,E)},fr.flow=Tc,fr.flowRight=xc,fr.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},fr.functions=function(e){return null==e?[]:$r(e,ic(e))},fr.functionsIn=function(e){return null==e?[]:$r(e,oc(e))},fr.groupBy=za,fr.initial=function(e){return null!=e&&e.length?Mi(e,0,-1):[]},fr.intersection=_a,fr.intersectionBy=ba,fr.intersectionWith=Ca,fr.invert=tc,fr.invertBy=nc,fr.invokeMap=Xa,fr.iteratee=Ac,fr.keyBy=$a,fr.keys=ic,fr.keysIn=oc,fr.map=Ya,fr.mapKeys=function(e,t){var n={};return t=jo(t,3),zr(e,function(e,r,i){Ir(n,t(e,r,i),e)}),n},fr.mapValues=function(e,t){var n={};return t=jo(t,3),zr(e,function(e,r,i){Ir(n,r,t(e,r,i))}),n},fr.matches=function(e){return fi(kr(e,l))},fr.matchesProperty=function(e,t){return hi(e,kr(t,l))},fr.memoize=ss,fr.merge=ac,fr.mergeWith=sc,fr.method=Ic,fr.methodOf=Oc,fr.mixin=Dc,fr.negate=cs,fr.nthArg=function(e){return e=Fs(e),wi(function(t){return vi(t,e)})},fr.omit=cc,fr.omitBy=function(e,t){return lc(e,cs(jo(t)))},fr.once=function(e){return ts(2,e)},fr.orderBy=function(e,t,n,i){return null==e?[]:(ys(t)||(t=null==t?[]:[t]),ys(n=i?r:n)||(n=null==n?[]:[n]),yi(e,t,n))},fr.over=jc,fr.overArgs=us,fr.overEvery=Nc,fr.overSome=Vc,fr.partial=ls,fr.partialRight=ds,fr.partition=Ka,fr.pick=uc,fr.pickBy=lc,fr.property=Uc,fr.propertyOf=function(e){return function(t){return null==e?r:Yr(e,t)}},fr.pull=Ea,fr.pullAll=Ra,fr.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Si(e,t,jo(n,2)):e},fr.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Si(e,t,r,n):e},fr.pullAt=Pa,fr.range=Bc,fr.rangeRight=Fc,fr.rearg=ps,fr.reject=function(e,t){return(ys(e)?Xt:Wr)(e,cs(jo(t,3)))},fr.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=jo(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return _i(e,i),n},fr.rest=function(e,t){if("function"!=typeof e)throw new it(a);return wi(e,t=t===r?t:Fs(t))},fr.reverse=La,fr.sampleSize=function(e,t,n){return t=(n?zo(e,t,n):t===r)?1:Fs(t),(ys(e)?Rr:Ri)(e,t)},fr.set=function(e,t,n){return null==e?e:Pi(e,t,n)},fr.setWith=function(e,t,n,i){return i="function"==typeof i?i:r,null==e?e:Pi(e,t,n,i)},fr.shuffle=function(e){return(ys(e)?Pr:xi)(e)},fr.slice=function(e,t,n){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&zo(e,t,n)?(t=0,n=i):(t=null==t?0:Fs(t),n=n===r?i:Fs(n)),Mi(e,t,n)):[]},fr.sortBy=Qa,fr.sortedUniq=function(e){return e&&e.length?Di(e):[]},fr.sortedUniqBy=function(e,t){return e&&e.length?Di(e,jo(t,2)):[]},fr.split=function(e,t,n){return n&&"number"!=typeof n&&zo(e,t,n)&&(t=n=r),(n=n===r?k:n>>>0)?(e=qs(e))&&("string"==typeof t||null!=t&&!Is(t))&&!(t=ji(t))&&wn(e)?Xi(Mn(e),0,n):e.split(t,n):[]},fr.spread=function(e,t){if("function"!=typeof e)throw new it(a);return t=null==t?0:qn(Fs(t),0),wi(function(n){var r=n[t],i=Xi(n,0,t);return r&&Qt(i,r),Wt(e,this,i)})},fr.tail=function(e){var t=null==e?0:e.length;return t?Mi(e,1,t):[]},fr.take=function(e,t,n){return e&&e.length?Mi(e,0,(t=n||t===r?1:Fs(t))<0?0:t):[]},fr.takeRight=function(e,t,n){var i=null==e?0:e.length;return i?Mi(e,(t=i-(t=n||t===r?1:Fs(t)))<0?0:t,i):[]},fr.takeRightWhile=function(e,t){return e&&e.length?Bi(e,jo(t,3),!1,!0):[]},fr.takeWhile=function(e,t){return e&&e.length?Bi(e,jo(t,3)):[]},fr.tap=function(e,t){return t(e),e},fr.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new it(a);return Ls(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),is(e,t,{leading:r,maxWait:t,trailing:i})},fr.thru=Ba,fr.toArray=Us,fr.toPairs=dc,fr.toPairsIn=pc,fr.toPath=function(e){return ys(e)?Kt(e,la):ks(e)?[e]:no(ua(qs(e)))},fr.toPlainObject=Js,fr.transform=function(e,t,n){var r=ys(e),i=r||bs(e)||js(e);if(t=jo(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:Ls(e)&&Es(o)?hr(It(e)):{}}return(i?qt:zr)(e,function(e,r,i){return t(n,e,r,i)}),n},fr.unary=function(e){return es(e,1)},fr.union=Ta,fr.unionBy=xa,fr.unionWith=Ma,fr.uniq=function(e){return e&&e.length?Ni(e):[]},fr.uniqBy=function(e,t){return e&&e.length?Ni(e,jo(t,2)):[]},fr.uniqWith=function(e,t){return t="function"==typeof t?t:r,e&&e.length?Ni(e,r,t):[]},fr.unset=function(e,t){return null==e||Vi(e,t)},fr.unzip=Aa,fr.unzipWith=Ia,fr.update=function(e,t,n){return null==e?e:Ui(e,t,qi(n))},fr.updateWith=function(e,t,n,i){return i="function"==typeof i?i:r,null==e?e:Ui(e,t,qi(n),i)},fr.values=fc,fr.valuesIn=function(e){return null==e?[]:vn(e,oc(e))},fr.without=Oa,fr.words=Ec,fr.wrap=function(e,t){return ls(qi(t),e)},fr.xor=Da,fr.xorBy=ka,fr.xorWith=ja,fr.zip=Na,fr.zipObject=function(e,t){return Wi(e||[],t||[],Tr)},fr.zipObjectDeep=function(e,t){return Wi(e||[],t||[],Pi)},fr.zipWith=Va,fr.entries=dc,fr.entriesIn=pc,fr.extend=zs,fr.extendWith=Xs,Dc(fr,fr),fr.add=Jc,fr.attempt=Rc,fr.camelCase=hc,fr.capitalize=mc,fr.ceil=qc,fr.clamp=function(e,t,n){return n===r&&(n=t,t=r),n!==r&&(n=(n=Ws(n))==n?n:0),t!==r&&(t=(t=Ws(t))==t?t:0),Dr(Ws(e),t,n)},fr.clone=function(e){return kr(e,p)},fr.cloneDeep=function(e){return kr(e,l|p)},fr.cloneDeepWith=function(e,t){return kr(e,l|p,t="function"==typeof t?t:r)},fr.cloneWith=function(e,t){return kr(e,p,t="function"==typeof t?t:r)},fr.conformsTo=function(e,t){return null==t||jr(e,t,ic(t))},fr.deburr=vc,fr.defaultTo=function(e,t){return null==e||e!=e?t:e},fr.divide=Hc,fr.endsWith=function(e,t,n){e=qs(e),t=ji(t);var i=e.length,o=n=n===r?i:Dr(Fs(n),0,i);return(n-=t.length)>=0&&e.slice(n,o)==t},fr.eq=fs,fr.escape=function(e){return(e=qs(e))&&we.test(e)?e.replace(be,bn):e},fr.escapeRegExp=function(e){return(e=qs(e))&&Ae.test(e)?e.replace(Me,"\\$&"):e},fr.every=function(e,t,n){var i=ys(e)?zt:Fr;return n&&zo(e,t,n)&&(t=r),i(e,jo(t,3))},fr.find=Wa,fr.findIndex=va,fr.findKey=function(e,t){return rn(e,jo(t,3),zr)},fr.findLast=Ja,fr.findLastIndex=ya,fr.findLastKey=function(e,t){return rn(e,jo(t,3),Xr)},fr.floor=zc,fr.forEach=qa,fr.forEachRight=Ha,fr.forIn=function(e,t){return null==e?e:qr(e,jo(t,3),oc)},fr.forInRight=function(e,t){return null==e?e:Hr(e,jo(t,3),oc)},fr.forOwn=function(e,t){return e&&zr(e,jo(t,3))},fr.forOwnRight=function(e,t){return e&&Xr(e,jo(t,3))},fr.get=Zs,fr.gt=hs,fr.gte=ms,fr.has=function(e,t){return null!=e&&Wo(e,t,ei)},fr.hasIn=ec,fr.head=Sa,fr.identity=Mc,fr.includes=function(e,t,n,r){e=Ss(e)?e:fc(e),n=n&&!r?Fs(n):0;var i=e.length;return n<0&&(n=qn(i+n,0)),Ds(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&an(e,t,n)>-1},fr.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Fs(n);return i<0&&(i=qn(r+i,0)),an(e,t,i)},fr.inRange=function(e,t,n){return t=Bs(t),n===r?(n=t,t=0):n=Bs(n),function(e,t,n){return e>=Hn(t,n)&&e<qn(t,n)}(e=Ws(e),t,n)},fr.invoke=rc,fr.isArguments=vs,fr.isArray=ys,fr.isArrayBuffer=gs,fr.isArrayLike=Ss,fr.isArrayLikeObject=_s,fr.isBoolean=function(e){return!0===e||!1===e||Ts(e)&&Qr(e)==G},fr.isBuffer=bs,fr.isDate=Cs,fr.isElement=function(e){return Ts(e)&&1===e.nodeType&&!As(e)},fr.isEmpty=function(e){if(null==e)return!0;if(Ss(e)&&(ys(e)||"string"==typeof e||"function"==typeof e.splice||bs(e)||js(e)||vs(e)))return!e.length;var t=Go(e);if(t==X||t==ee)return!e.size;if(Ko(e))return!ui(e).length;for(var n in e)if(lt.call(e,n))return!1;return!0},fr.isEqual=function(e,t){return oi(e,t)},fr.isEqualWith=function(e,t,n){var i=(n="function"==typeof n?n:r)?n(e,t):r;return i===r?oi(e,t,r,n):!!i},fr.isError=ws,fr.isFinite=function(e){return"number"==typeof e&&Gn(e)},fr.isFunction=Es,fr.isInteger=Rs,fr.isLength=Ps,fr.isMap=xs,fr.isMatch=function(e,t){return e===t||ai(e,t,Vo(t))},fr.isMatchWith=function(e,t,n){return n="function"==typeof n?n:r,ai(e,t,Vo(t),n)},fr.isNaN=function(e){return Ms(e)&&e!=+e},fr.isNative=function(e){if(Yo(e))throw new Qe(o);return si(e)},fr.isNil=function(e){return null==e},fr.isNull=function(e){return null===e},fr.isNumber=Ms,fr.isObject=Ls,fr.isObjectLike=Ts,fr.isPlainObject=As,fr.isRegExp=Is,fr.isSafeInteger=function(e){return Rs(e)&&e>=-I&&e<=I},fr.isSet=Os,fr.isString=Ds,fr.isSymbol=ks,fr.isTypedArray=js,fr.isUndefined=function(e){return e===r},fr.isWeakMap=function(e){return Ts(e)&&Go(e)==ie},fr.isWeakSet=function(e){return Ts(e)&&Qr(e)==oe},fr.join=function(e,t){return null==e?"":Wn.call(e,t)},fr.kebabCase=yc,fr.last=wa,fr.lastIndexOf=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=i;return n!==r&&(o=(o=Fs(n))<0?qn(i+o,0):Hn(o,i-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):on(e,cn,o,!0)},fr.lowerCase=gc,fr.lowerFirst=Sc,fr.lt=Ns,fr.lte=Vs,fr.max=function(e){return e&&e.length?Gr(e,Mc,Zr):r},fr.maxBy=function(e,t){return e&&e.length?Gr(e,jo(t,2),Zr):r},fr.mean=function(e){return un(e,Mc)},fr.meanBy=function(e,t){return un(e,jo(t,2))},fr.min=function(e){return e&&e.length?Gr(e,Mc,di):r},fr.minBy=function(e,t){return e&&e.length?Gr(e,jo(t,2),di):r},fr.stubArray=Gc,fr.stubFalse=Wc,fr.stubObject=function(){return{}},fr.stubString=function(){return""},fr.stubTrue=function(){return!0},fr.multiply=$c,fr.nth=function(e,t){return e&&e.length?vi(e,Fs(t)):r},fr.noConflict=function(){return At._===this&&(At._=mt),this},fr.noop=kc,fr.now=Za,fr.pad=function(e,t,n){e=qs(e);var r=(t=Fs(t))?xn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return go(Un(i),n)+e+go(Vn(i),n)},fr.padEnd=function(e,t,n){e=qs(e);var r=(t=Fs(t))?xn(e):0;return t&&r<t?e+go(t-r,n):e},fr.padStart=function(e,t,n){e=qs(e);var r=(t=Fs(t))?xn(e):0;return t&&r<t?go(t-r,n)+e:e},fr.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),Xn(qs(e).replace(Oe,""),t||0)},fr.random=function(e,t,n){if(n&&"boolean"!=typeof n&&zo(e,t,n)&&(t=n=r),n===r&&("boolean"==typeof t?(n=t,t=r):"boolean"==typeof e&&(n=e,e=r)),e===r&&t===r?(e=0,t=1):(e=Bs(e),t===r?(t=e,e=0):t=Bs(t)),e>t){var i=e;e=t,t=i}if(n||e%1||t%1){var o=$n();return Hn(e+o*(t-e+Lt("1e-"+((o+"").length-1))),t)}return bi(e,t)},fr.reduce=function(e,t,n){var r=ys(e)?Zt:pn,i=arguments.length<3;return r(e,jo(t,4),n,i,Ur)},fr.reduceRight=function(e,t,n){var r=ys(e)?en:pn,i=arguments.length<3;return r(e,jo(t,4),n,i,Br)},fr.repeat=function(e,t,n){return t=(n?zo(e,t,n):t===r)?1:Fs(t),Ci(qs(e),t)},fr.replace=function(){var e=arguments,t=qs(e[0]);return e.length<3?t:t.replace(e[1],e[2])},fr.result=function(e,t,n){var i=-1,o=(t=Hi(t,e)).length;for(o||(o=1,e=r);++i<o;){var a=null==e?r:e[la(t[i])];a===r&&(i=o,a=n),e=Es(a)?a.call(e):a}return e},fr.round=Yc,fr.runInContext=e,fr.sample=function(e){return(ys(e)?Er:Ei)(e)},fr.size=function(e){if(null==e)return 0;if(Ss(e))return Ds(e)?xn(e):e.length;var t=Go(e);return t==X||t==ee?e.size:ui(e).length},fr.snakeCase=_c,fr.some=function(e,t,n){var i=ys(e)?tn:Ai;return n&&zo(e,t,n)&&(t=r),i(e,jo(t,3))},fr.sortedIndex=function(e,t){return Ii(e,t)},fr.sortedIndexBy=function(e,t,n){return Oi(e,t,jo(n,2))},fr.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=Ii(e,t);if(r<n&&fs(e[r],t))return r}return-1},fr.sortedLastIndex=function(e,t){return Ii(e,t,!0)},fr.sortedLastIndexBy=function(e,t,n){return Oi(e,t,jo(n,2),!0)},fr.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=Ii(e,t,!0)-1;if(fs(e[n],t))return n}return-1},fr.startCase=bc,fr.startsWith=function(e,t,n){return e=qs(e),n=null==n?0:Dr(Fs(n),0,e.length),t=ji(t),e.slice(n,n+t.length)==t},fr.subtract=Kc,fr.sum=function(e){return e&&e.length?fn(e,Mc):0},fr.sumBy=function(e,t){return e&&e.length?fn(e,jo(t,2)):0},fr.template=function(e,t,n){var i=fr.templateSettings;n&&zo(e,t,n)&&(t=r),e=qs(e),t=Xs({},t,i,Po);var o,a,s=Xs({},t.imports,i.imports,Po),c=ic(s),u=vn(s,c),l=0,d=t.interpolate||Xe,p="__p += '",f=nt((t.escape||Xe).source+"|"+d.source+"|"+(d===Pe?Be:Xe).source+"|"+(t.evaluate||Xe).source+"|$","g"),h="//# sourceURL="+(lt.call(t,"sourceURL")?(t.sourceURL+"").replace(/[\r\n]/g," "):"lodash.templateSources["+ ++wt+"]")+"\n";e.replace(f,function(t,n,r,i,s,c){return r||(r=i),p+=e.slice(l,c).replace($e,Cn),n&&(o=!0,p+="' +\n__e("+n+") +\n'"),s&&(a=!0,p+="';\n"+s+";\n__p += '"),r&&(p+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=c+t.length,t}),p+="';\n";var m=lt.call(t,"variable")&&t.variable;m||(p="with (obj) {\n"+p+"\n}\n"),p=(a?p.replace(ye,""):p).replace(ge,"$1").replace(Se,"$1;"),p="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var v=Rc(function(){return Ze(c,h+"return "+p).apply(r,u)});if(v.source=p,ws(v))throw v;return v},fr.times=function(e,t){if((e=Fs(e))<1||e>I)return[];var n=k,r=Hn(e,k);t=jo(t),e-=k;for(var i=hn(r,t);++n<e;)t(n);return i},fr.toFinite=Bs,fr.toInteger=Fs,fr.toLength=Gs,fr.toLower=function(e){return qs(e).toLowerCase()},fr.toNumber=Ws,fr.toSafeInteger=function(e){return e?Dr(Fs(e),-I,I):0===e?e:0},fr.toString=qs,fr.toUpper=function(e){return qs(e).toUpperCase()},fr.trim=function(e,t,n){if((e=qs(e))&&(n||t===r))return e.replace(Ie,"");if(!e||!(t=ji(t)))return e;var i=Mn(e),o=Mn(t);return Xi(i,gn(i,o),Sn(i,o)+1).join("")},fr.trimEnd=function(e,t,n){if((e=qs(e))&&(n||t===r))return e.replace(De,"");if(!e||!(t=ji(t)))return e;var i=Mn(e);return Xi(i,0,Sn(i,Mn(t))+1).join("")},fr.trimStart=function(e,t,n){if((e=qs(e))&&(n||t===r))return e.replace(Oe,"");if(!e||!(t=ji(t)))return e;var i=Mn(e);return Xi(i,gn(i,Mn(t))).join("")},fr.truncate=function(e,t){var n=R,i=P;if(Ls(t)){var o="separator"in t?t.separator:o;n="length"in t?Fs(t.length):n,i="omission"in t?ji(t.omission):i}var a=(e=qs(e)).length;if(wn(e)){var s=Mn(e);a=s.length}if(n>=a)return e;var c=n-xn(i);if(c<1)return i;var u=s?Xi(s,0,c).join(""):e.slice(0,c);if(o===r)return u+i;if(s&&(c+=u.length-c),Is(o)){if(e.slice(c).search(o)){var l,d=u;for(o.global||(o=nt(o.source,qs(Fe.exec(o))+"g")),o.lastIndex=0;l=o.exec(d);)var p=l.index;u=u.slice(0,p===r?c:p)}}else if(e.indexOf(ji(o),c)!=c){var f=u.lastIndexOf(o);f>-1&&(u=u.slice(0,f))}return u+i},fr.unescape=function(e){return(e=qs(e))&&Ce.test(e)?e.replace(_e,An):e},fr.uniqueId=function(e){var t=++dt;return qs(e)+t},fr.upperCase=Cc,fr.upperFirst=wc,fr.each=qa,fr.eachRight=Ha,fr.first=Sa,Dc(fr,(Xc={},zr(fr,function(e,t){lt.call(fr.prototype,t)||(Xc[t]=e)}),Xc),{chain:!1}),fr.VERSION="4.17.15",qt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){fr[e].placeholder=fr}),qt(["drop","take"],function(e,t){yr.prototype[e]=function(n){n=n===r?1:qn(Fs(n),0);var i=this.__filtered__&&!t?new yr(this):this.clone();return i.__filtered__?i.__takeCount__=Hn(n,i.__takeCount__):i.__views__.push({size:Hn(n,k),type:e+(i.__dir__<0?"Right":"")}),i},yr.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),qt(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n==x||3==n;yr.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:jo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),qt(["head","last"],function(e,t){var n="take"+(t?"Right":"");yr.prototype[e]=function(){return this[n](1).value()[0]}}),qt(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");yr.prototype[e]=function(){return this.__filtered__?new yr(this):this[n](1)}}),yr.prototype.compact=function(){return this.filter(Mc)},yr.prototype.find=function(e){return this.filter(e).head()},yr.prototype.findLast=function(e){return this.reverse().find(e)},yr.prototype.invokeMap=wi(function(e,t){return"function"==typeof e?new yr(this):this.map(function(n){return ri(n,e,t)})}),yr.prototype.reject=function(e){return this.filter(cs(jo(e)))},yr.prototype.slice=function(e,t){e=Fs(e);var n=this;return n.__filtered__&&(e>0||t<0)?new yr(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==r&&(n=(t=Fs(t))<0?n.dropRight(-t):n.take(t-e)),n)},yr.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},yr.prototype.toArray=function(){return this.take(k)},zr(yr.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),o=fr[i?"take"+("last"==t?"Right":""):t],a=i||/^find/.test(t);o&&(fr.prototype[t]=function(){var t=this.__wrapped__,s=i?[1]:arguments,c=t instanceof yr,u=s[0],l=c||ys(t),d=function(e){var t=o.apply(fr,Qt([e],s));return i&&p?t[0]:t};l&&n&&"function"==typeof u&&1!=u.length&&(c=l=!1);var p=this.__chain__,f=!!this.__actions__.length,h=a&&!p,m=c&&!f;if(!a&&l){t=m?t:new yr(this);var v=e.apply(t,s);return v.__actions__.push({func:Ba,args:[d],thisArg:r}),new vr(v,p)}return h&&m?e.apply(this,s):(v=this.thru(d),h?i?v.value()[0]:v.value():v)})}),qt(["pop","push","shift","sort","splice","unshift"],function(e){var t=ot[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);fr.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(ys(i)?i:[],e)}return this[n](function(n){return t.apply(ys(n)?n:[],e)})}}),zr(yr.prototype,function(e,t){var n=fr[t];if(n){var r=n.name+"";lt.call(ir,r)||(ir[r]=[]),ir[r].push({name:t,func:n})}}),ir[ho(r,v).name]=[{name:"wrapper",func:r}],yr.prototype.clone=function(){var e=new yr(this.__wrapped__);return e.__actions__=no(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=no(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=no(this.__views__),e},yr.prototype.reverse=function(){if(this.__filtered__){var e=new yr(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},yr.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=ys(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=Hn(t,e+a);break;case"takeRight":e=qn(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,c=s-a,u=r?s:a-1,l=this.__iteratees__,d=l.length,p=0,f=Hn(c,this.__takeCount__);if(!n||!r&&i==c&&f==c)return Fi(e,this.__actions__);var h=[];e:for(;c--&&p<f;){for(var m=-1,v=e[u+=t];++m<d;){var y=l[m],g=y.iteratee,S=y.type,_=g(v);if(S==M)v=_;else if(!_){if(S==x)continue e;break e}}h[p++]=v}return h},fr.prototype.at=Fa,fr.prototype.chain=function(){return Ua(this)},fr.prototype.commit=function(){return new vr(this.value(),this.__chain__)},fr.prototype.next=function(){this.__values__===r&&(this.__values__=Us(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?r:this.__values__[this.__index__++]}},fr.prototype.plant=function(e){for(var t,n=this;n instanceof mr;){var i=pa(n);i.__index__=0,i.__values__=r,t?o.__wrapped__=i:t=i;var o=i;n=n.__wrapped__}return o.__wrapped__=e,t},fr.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof yr){var t=e;return this.__actions__.length&&(t=new yr(this)),(t=t.reverse()).__actions__.push({func:Ba,args:[La],thisArg:r}),new vr(t,this.__chain__)}return this.thru(La)},fr.prototype.toJSON=fr.prototype.valueOf=fr.prototype.value=function(){return Fi(this.__wrapped__,this.__actions__)},fr.prototype.first=fr.prototype.head,dn&&(fr.prototype[dn]=function(){return this}),fr}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(At._=In,define(function(){return In})):Ot?((Ot.exports=In)._=In,It._=In):At._=In}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],85:[function(e,t,n){var r=e("util"),i=e("sdp-jingle-json"),o=e("wildemitter"),a=e("lodash.clonedeep");function s(e,t){var n,r=this;for(n in o.call(this),(e=e||{}).iceServers=e.iceServers||[],this.enableChromeNativeSimulcast=!1,t&&t.optional&&window.chrome&&null===navigator.appVersion.match(/Chromium\//)&&t.optional.forEach(function(e){e.enableChromeNativeSimulcast&&(r.enableChromeNativeSimulcast=!0)}),this.enableMultiStreamHacks=!1,t&&t.optional&&window.chrome&&t.optional.forEach(function(e){e.enableMultiStreamHacks&&(r.enableMultiStreamHacks=!0)}),this.restrictBandwidth=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetRestrictBandwidth&&(r.restrictBandwidth=e.andyetRestrictBandwidth)}),this.batchIceCandidates=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetBatchIce&&(r.batchIceCandidates=e.andyetBatchIce)}),this.batchedIceCandidates=[],t&&t.optional&&window.chrome&&t.optional.forEach(function(e){e.andyetFasterICE&&(r.eliminateDuplicateCandidates=e.andyetFasterICE)}),t&&t.optional&&t.optional.forEach(function(e){e.andyetDontSignalCandidates&&(r.dontSignalCandidates=e.andyetDontSignalCandidates)}),this.assumeSetLocalSuccess=!1,t&&t.optional&&t.optional.forEach(function(e){e.andyetAssumeSetLocalSuccess&&(r.assumeSetLocalSuccess=e.andyetAssumeSetLocalSuccess)}),window.navigator.mozGetUserMedia&&t&&t.optional&&(this.wtFirefox=0,t.optional.forEach(function(e){e.andyetFirefoxMakesMeSad&&(r.wtFirefox=e.andyetFirefoxMakesMeSad,r.wtFirefox>0&&(r.firefoxcandidatebuffer=[]))})),this.pc=new RTCPeerConnection(e,t),"function"==typeof this.pc.getLocalStreams?this.getLocalStreams=this.pc.getLocalStreams.bind(this.pc):this.getLocalStreams=function(){return[]},"function"==typeof this.pc.getSenders?this.getSenders=this.pc.getSenders.bind(this.pc):this.getSenders=function(){return[]},"function"==typeof this.pc.getRemoteStreams?this.getRemoteStreams=this.pc.getRemoteStreams.bind(this.pc):this.getRemoteStreams=function(){return[]},"function"==typeof this.pc.getReceivers?this.getReceivers=this.pc.getReceivers.bind(this.pc):this.getReceivers=function(){return[]},this.addStream=this.pc.addStream.bind(this.pc),this.removeStream=function(e){"function"==typeof r.pc.removeStream?r.pc.removeStream.apply(r.pc,arguments):"function"==typeof r.pc.removeTrack&&e.getTracks().forEach(function(e){r.pc.removeTrack(e)})},"function"==typeof this.pc.removeTrack&&(this.removeTrack=this.pc.removeTrack.bind(this.pc)),this.pc.onremovestream=this.emit.bind(this,"removeStream"),this.pc.onremovetrack=this.emit.bind(this,"removeTrack"),this.pc.onaddstream=this.emit.bind(this,"addStream"),this.pc.ontrack=this.emit.bind(this,"addTrack"),this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded"),this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange"),this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange"),this.pc.onicecandidate=this._onIce.bind(this),this.pc.ondatachannel=this._onDataChannel.bind(this),this.localDescription={contents:[]},this.remoteDescription={contents:[]},this.config={debug:!1,sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1},this.iceCredentials={local:{},remote:{}},e)this.config[n]=e[n];this.config.debug&&this.on("*",function(){(e.logger||console).log("PeerConnection event:",arguments)}),this.hadLocalStunCandidate=!1,this.hadRemoteStunCandidate=!1,this.hadLocalRelayCandidate=!1,this.hadRemoteRelayCandidate=!1,this.hadLocalIPv6Candidate=!1,this.hadRemoteIPv6Candidate=!1,this._remoteDataChannels=[],this._localDataChannels=[],this._candidateBuffer=[]}r.inherits(s,o),Object.defineProperty(s.prototype,"signalingState",{get:function(){return this.pc.signalingState}}),Object.defineProperty(s.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}}),s.prototype._role=function(){return this.isInitiator?"initiator":"responder"},s.prototype.addStream=function(e){this.localStream=e,e.getTracks().forEach(function(t){this.pc.addTrack(t,e)})},s.prototype._checkLocalCandidate=function(e){var t=i.toCandidateJSON(e);"srflx"==t.type?this.hadLocalStunCandidate=!0:"relay"==t.type&&(this.hadLocalRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)},s.prototype._checkRemoteCandidate=function(e){var t=i.toCandidateJSON(e);"srflx"==t.type?this.hadRemoteStunCandidate=!0:"relay"==t.type&&(this.hadRemoteRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)},s.prototype.processIce=function(e,t){t=t||function(){};var n=this;if("closed"===this.pc.signalingState)return t();if(e.contents||e.jingle&&e.jingle.contents){var r=this.remoteDescription.contents.map(function(e){return e.name});(e.contents||e.jingle.contents).forEach(function(e){var o=e.transport||{},a=o.candidates||[],s=r.indexOf(e.name),c=e.name,u=n.remoteDescription.contents.find(function(t){return t.name===e.name}),l=function(){a.forEach(function(e){var t=i.toCandidateSDP(e);n.pc.addIceCandidate(new RTCIceCandidate({candidate:t,sdpMLineIndex:s,sdpMid:c})).then(function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(t)}),t()};if(n.iceCredentials.remote[e.name]&&o.ufrag&&n.iceCredentials.remote[e.name].ufrag!==o.ufrag)if(u){u.transport.ufrag=o.ufrag,u.transport.pwd=o.pwd;var d={type:"offer",jingle:n.remoteDescription};d.sdp=i.toSessionSDP(d.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.pc.setRemoteDescription(new RTCSessionDescription(d)).then(function(){l()},function(e){n.emit("error",e)})}else n.emit("error","ice restart failed to find matching content");else l()})}else{if(e.candidate&&0!==e.candidate.candidate.indexOf("a=")&&(e.candidate.candidate="a="+e.candidate.candidate),this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(e.candidate),t();n.pc.addIceCandidate(new RTCIceCandidate(e.candidate)).then(function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate.candidate),t()}},s.prototype.offer=function(e,t){var n=this,r=2===arguments.length,o=r&&e?e:{offerToReceiveAudio:1,offerToReceiveVideo:1};if(t=(t=r?t:e)||function(){},"closed"===this.pc.signalingState)return t("Already closed");this.pc.createOffer(o).then(function(e){var r={type:"offer",sdp:e.sdp};n.assumeSetLocalSuccess&&(n.emit("offer",r),t(null,r)),n._candidateBuffer=[],n.pc.setLocalDescription(e).then(function(){var o;n.config.useJingle&&((o=i.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"})).sid=n.config.sid,n.localDescription=o,o.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.local[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),r.jingle=o),r.sdp.split(/\r?\n/).forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),n.assumeSetLocalSuccess||(n.emit("offer",r),t(null,r))},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)})},s.prototype.handleOffer=function(e,t){t=t||function(){};var n=this;if(e.type="offer",e.jingle){if(this.enableChromeNativeSimulcast&&e.jingle.contents.forEach(function(e){"video"===e.name&&(e.application.googConferenceFlag=!0)}),this.enableMultiStreamHacks&&e.jingle.contents.forEach(function(e){if("video"===e.name){var t=e.application.sources||[];0!==t.length&&"3735928559"===t[0].ssrc||(t.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),e.application.sources=t)}}),n.restrictBandwidth>0&&e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name){var r=e.jingle.contents[1];r.application&&r.application.bandwidth&&r.application.bandwidth.bandwidth||(e.jingle.contents[1].application.bandwidth={type:"AS",bandwidth:n.restrictBandwidth.toString()},e.sdp=i.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"}))}e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),e.sdp=i.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle}e.sdp.split(/\r?\n/).forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e)).then(function(){t()},t)},s.prototype.answerAudioOnly=function(e){this._answer({mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}},e)},s.prototype.answerBroadcastOnly=function(e){this._answer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},e)},s.prototype.answer=function(e,t){var n=2===arguments.length,r=n?t:e,i=n&&e?e:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};this._answer(i,r)},s.prototype.handleAnswer=function(e,t){t=t||function(){};var n=this;e.jingle&&(e.sdp=i.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle,e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})})),e.sdp.split(/\r?\n/).forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e)).then(function(){n.wtFirefox&&window.setTimeout(function(){n.firefoxcandidatebuffer.forEach(function(e){n.pc.addIceCandidate(new RTCIceCandidate(e)).then(function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate)}),n.firefoxcandidatebuffer=null},n.wtFirefox),t(null)},t)},s.prototype.close=function(){this.pc.close(),this._localDataChannels=[],this._remoteDataChannels=[],this.emit("close")},s.prototype._answer=function(e,t){t=t||function(){};var n=this;if(!this.pc.remoteDescription)throw new Error("remoteDescription not set");if("closed"===this.pc.signalingState)return t("Already closed");n.pc.createAnswer(e).then(function(e){var r=[];if(n.enableChromeNativeSimulcast&&(e.jingle=i.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"}),e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name)){var o=e.jingle.contents[1].application.sourceGroups||[],s=!1;if(o.forEach(function(e){"SIM"==e.semantics&&(s=!0)}),!s&&e.jingle.contents[1].application.sources.length){var c=JSON.parse(JSON.stringify(e.jingle.contents[1].application.sources[0]));c.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].application.sources.push(c),r.push(e.jingle.contents[1].application.sources[0].ssrc),r.push(c.ssrc),o.push({semantics:"SIM",sources:r});var u=JSON.parse(JSON.stringify(c));u.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].application.sources.push(u),o.push({semantics:"FID",sources:[c.ssrc,u.ssrc]}),e.jingle.contents[1].application.sourceGroups=o,e.sdp=i.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"})}}var l={type:"answer",sdp:e.sdp};if(n.assumeSetLocalSuccess){var d=a(l);n.emit("answer",d),t(null,d)}n._candidateBuffer=[],n.pc.setLocalDescription(e).then(function(){if(n.config.useJingle){var r=i.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});r.sid=n.config.sid,n.localDescription=r,l.jingle=r}if(n.enableChromeNativeSimulcast&&(l.jingle||(l.jingle=i.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"})),l.jingle.contents[1].application.sources.forEach(function(e,t){e.parameters=e.parameters.map(function(e){return"msid"===e.key&&(e.value+="-"+Math.floor(t/2)),e})}),l.sdp=i.toSessionSDP(l.jingle,{sid:n.sdpSessionID,role:n._role(),direction:"outgoing"})),l.sdp.split(/\r?\n/).forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),!n.assumeSetLocalSuccess){var o=a(l);n.emit("answer",o),t(null,o)}},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)})},s.prototype._onIce=function(e){var t=this;if(e.candidate){if(this.dontSignalCandidates)return;var n=e.candidate,r={candidate:{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex}};this._checkLocalCandidate(n.candidate);var o,a,s=i.toCandidateJSON(n.candidate);if(this.eliminateDuplicateCandidates&&"relay"===s.type&&(a=(o=this._candidateBuffer.filter(function(e){return"relay"===e.type}).map(function(e){return e.foundation+":"+e.component})).indexOf(s.foundation+":"+s.component))>-1&&s.priority>>24>=o[a].priority>>24)return;if("max-bundle"===this.config.bundlePolicy&&(a=(o=this._candidateBuffer.filter(function(e){return s.type===e.type}).map(function(e){return e.address+":"+e.port})).indexOf(s.address+":"+s.port))>-1)return;if("require"===this.config.rtcpMuxPolicy&&"2"===s.component)return;if(this._candidateBuffer.push(s),t.config.useJingle){if(n.sdpMid||(t.pc.remoteDescription&&"offer"===t.pc.remoteDescription.type?n.sdpMid=t.remoteDescription.contents[n.sdpMLineIndex].name:n.sdpMid=t.localDescription.contents[n.sdpMLineIndex].name),!t.iceCredentials.local[n.sdpMid])i.toSessionJSON(t.pc.localDescription.sdp,{role:t._role(),direction:"outgoing"}).contents.forEach(function(e){var n=e.transport||{};n.ufrag&&(t.iceCredentials.local[e.name]={ufrag:n.ufrag,pwd:n.pwd})});if(r.jingle={contents:[{name:n.sdpMid,creator:t._role(),transport:{transportType:"iceUdp",ufrag:t.iceCredentials.local[n.sdpMid].ufrag,pwd:t.iceCredentials.local[n.sdpMid].pwd,candidates:[s]}}]},t.batchIceCandidates>0)return 0===t.batchedIceCandidates.length&&window.setTimeout(function(){var e={};t.batchedIceCandidates.forEach(function(t){t=t.contents[0],e[t.name]||(e[t.name]=t),e[t.name].transport.candidates.push(t.transport.candidates[0])});var n={jingle:{contents:[]}};Object.keys(e).forEach(function(t){n.jingle.contents.push(e[t])}),t.batchedIceCandidates=[],t.emit("ice",n)},t.batchIceCandidates),void t.batchedIceCandidates.push(r.jingle)}this.emit("ice",r)}else this.emit("endOfCandidates")},s.prototype._onDataChannel=function(e){var t=e.channel;this._remoteDataChannels.push(t),this.emit("addChannel",t)},s.prototype.createDataChannel=function(e,t){var n=this.pc.createDataChannel(e,t);return this._localDataChannels.push(n),n},s.prototype.getStats=function(){if("function"!=typeof arguments[0])return this.pc.getStats.apply(this.pc,arguments);var e=arguments[0];this.pc.getStats().then(function(t){e(null,t)},function(t){e(t)})},t.exports=s},{"lodash.clonedeep":180,"sdp-jingle-json":244,util:331,wildemitter:86}],86:[function(e,t,n){arguments[4][48][0].apply(n,arguments)},{dup:48}],87:[function(e,t,n){arguments[4][68][0].apply(n,arguments)},{async:88,dup:68,"extend-object":45,util:331,uuid:90,wildemitter:350}],88:[function(e,t,n){(function(e,n,r){!function(){var i,o={};function a(){}function s(e){return e}function c(e){return!!e}function u(e){return!e}var l="object"==typeof self&&self.self===self&&self||"object"==typeof n&&n.global===n&&n||this;function d(e){return function(){if(null===e)throw new Error("Callback was already called.");e.apply(this,arguments),e=null}}function p(e){return function(){null!==e&&(e.apply(this,arguments),e=null)}}null!=l&&(i=l.async),o.noConflict=function(){return l.async=i,o};var f=Object.prototype.toString,h=Array.isArray||function(e){return"[object Array]"===f.call(e)};function m(e){return h(e)||"number"==typeof e.length&&e.length>=0&&e.length%1==0}function v(e,t){for(var n=-1,r=e.length;++n<r;)t(e[n],n,e)}function y(e,t){for(var n=-1,r=e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function g(e){return y(Array(e),function(e,t){return t})}function S(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}var _=Object.keys||function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};function b(e){var t,n,r=-1;return m(e)?(t=e.length,function(){return++r<t?r:null}):(n=_(e),t=n.length,function(){return++r<t?n[r]:null})}function C(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r)}}}function w(e){return function(t,n,r){return e(t,r)}}var E="function"==typeof r&&r,R=E?function(e){E(e)}:function(e){setTimeout(e,0)};function P(e){return function(t,n,r){r=p(r||a);var i=b(t=t||[]);if(e<=0)return r(null);var o=!1,s=0,c=!1;!function a(){if(o&&s<=0)return r(null);for(;s<e&&!c;){var u=i();if(null===u)return o=!0,void(s<=0&&r(null));s+=1,n(t[u],u,d(function(e){s-=1,e?(r(e),c=!0):a()}))}}()}}function L(e){return function(t,n,r){return e(o.eachOf,t,n,r)}}function T(e){return function(t,n,r,i){return e(P(n),t,r,i)}}function x(e){return function(t,n,r){return e(o.eachOfSeries,t,n,r)}}function M(e,t,n,r){r=p(r||a);var i=m(t=t||[])?[]:{};e(t,function(e,t,r){n(e,function(e,n){i[t]=n,r(e)})},function(e){r(e,i)})}function A(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(n){n&&i.push({index:t,value:e}),r()})},function(){r(y(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})}function I(e,t,n,r){A(e,t,function(e,t){n(e,function(e){t(!e)})},r)}function O(e,t,n){return function(r,i,o,a){function s(){a&&a(n(!1,void 0))}function c(e,r,i){if(!a)return i();o(e,function(r){a&&t(r)&&(a(n(!0,e)),a=o=!1),i()})}arguments.length>3?e(r,i,c,s):(a=o,o=i,e(r,c,s))}}function D(e,t){return t}function k(e,t,n){n=n||a;var r=m(t)?[]:{};e(t,function(e,t,n){e(C(function(e,i){i.length<=1&&(i=i[0]),r[t]=i,n(e)}))},function(e){n(e,r)})}function j(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(e,t){i=i.concat(t||[]),r(e)})},function(e){r(e,i)})}function N(e,t,n){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");function r(e,t,n,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(e.started=!0,h(t)||(t=[t]),0===t.length&&e.idle())return o.setImmediate(function(){e.drain()});v(t,function(t){var i={data:t,callback:r||a};n?e.tasks.unshift(i):e.tasks.push(i),e.tasks.length===e.concurrency&&e.saturated()}),o.setImmediate(e.process)}function i(e,t){return function(){s-=1;var n=!1,r=arguments;v(t,function(e){v(c,function(t,r){t!==e||n||(c.splice(r,1),n=!0)}),e.callback.apply(e,r)}),e.tasks.length+s===0&&e.drain(),e.process()}}var s=0,c=[],u={tasks:[],concurrency:t,payload:n,saturated:a,empty:a,drain:a,started:!1,paused:!1,push:function(e,t){r(u,e,!1,t)},kill:function(){u.drain=a,u.tasks=[]},unshift:function(e,t){r(u,e,!0,t)},process:function(){for(;!u.paused&&s<u.concurrency&&u.tasks.length;){var t=u.payload?u.tasks.splice(0,u.payload):u.tasks.splice(0,u.tasks.length),n=y(t,function(e){return e.data});0===u.tasks.length&&u.empty(),s+=1,c.push(t[0]);var r=d(i(u,t));e(n,r)}},length:function(){return u.tasks.length},running:function(){return s},workersList:function(){return c},idle:function(){return u.tasks.length+s===0},pause:function(){u.paused=!0},resume:function(){if(!1!==u.paused){u.paused=!1;for(var e=Math.min(u.concurrency,u.tasks.length),t=1;t<=e;t++)o.setImmediate(u.process)}}};return u}function V(e){return C(function(t,n){t.apply(null,n.concat([C(function(t,n){"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&v(n,function(t){console[e](t)}))})]))})}function U(e){return function(t,n,r){e(g(t),n,r)}}function B(e){return C(function(t,n){var r=C(function(n){var r=this,i=n.pop();return e(t,function(e,t,i){e.apply(r,n.concat([i]))},i)});return n.length?r.apply(this,n):r})}function F(e){return C(function(t){var n=t.pop();t.push(function(){var e=arguments;r?o.setImmediate(function(){n.apply(null,e)}):n.apply(null,e)});var r=!0;e.apply(this,t),r=!1})}"object"==typeof e&&"function"==typeof e.nextTick?o.nextTick=e.nextTick:o.nextTick=R,o.setImmediate=E?R:o.nextTick,o.forEach=o.each=function(e,t,n){return o.eachOf(e,w(t),n)},o.forEachSeries=o.eachSeries=function(e,t,n){return o.eachOfSeries(e,w(t),n)},o.forEachLimit=o.eachLimit=function(e,t,n,r){return P(t)(e,w(n),r)},o.forEachOf=o.eachOf=function(e,t,n){n=p(n||a);for(var r,i=b(e=e||[]),o=0;null!=(r=i());)o+=1,t(e[r],r,d(s));function s(e){o--,e?n(e):null===r&&o<=0&&n(null)}0===o&&n(null)},o.forEachOfSeries=o.eachOfSeries=function(e,t,n){n=p(n||a);var r=b(e=e||[]),i=r();!function a(){var s=!0;if(null===i)return n(null);t(e[i],i,d(function(e){if(e)n(e);else{if(null===(i=r()))return n(null);s?o.setImmediate(a):a()}})),s=!1}()},o.forEachOfLimit=o.eachOfLimit=function(e,t,n,r){P(t)(e,n,r)},o.map=L(M),o.mapSeries=x(M),o.mapLimit=T(M),o.inject=o.foldl=o.reduce=function(e,t,n,r){o.eachOfSeries(e,function(e,r,i){n(t,e,function(e,n){t=n,i(e)})},function(e){r(e,t)})},o.foldr=o.reduceRight=function(e,t,n,r){var i=y(e,s).reverse();o.reduce(i,t,n,r)},o.transform=function(e,t,n,r){3===arguments.length&&(r=n,n=t,t=h(e)?[]:{}),o.eachOf(e,function(e,r,i){n(t,e,r,i)},function(e){r(e,t)})},o.select=o.filter=L(A),o.selectLimit=o.filterLimit=T(A),o.selectSeries=o.filterSeries=x(A),o.reject=L(I),o.rejectLimit=T(I),o.rejectSeries=x(I),o.any=o.some=O(o.eachOf,c,s),o.someLimit=O(o.eachOfLimit,c,s),o.all=o.every=O(o.eachOf,u,u),o.everyLimit=O(o.eachOfLimit,u,u),o.detect=O(o.eachOf,s,D),o.detectSeries=O(o.eachOfSeries,s,D),o.detectLimit=O(o.eachOfLimit,s,D),o.sortBy=function(e,t,n){function r(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0}o.map(e,function(e,n){t(e,function(t,r){t?n(t):n(null,{value:e,criteria:r})})},function(e,t){if(e)return n(e);n(null,y(t.sort(r),function(e){return e.value}))})},o.auto=function(e,t,n){"function"==typeof arguments[1]&&(n=t,t=null),n=p(n||a);var r=_(e),i=r.length;if(!i)return n(null);t||(t=i);var s={},c=0,u=!1,l=[];function d(e){l.unshift(e)}function f(){i--,v(l.slice(0),function(e){e()})}d(function(){i||n(null,s)}),v(r,function(r){if(!u){for(var i,a=h(e[r])?e[r]:[e[r]],p=C(function(e,t){if(c--,t.length<=1&&(t=t[0]),e){var i={};l=function(e,t){i[t]=e},v(_(a=s),function(e){l(a[e],e)}),i[r]=t,u=!0,n(e,i)}else s[r]=t,o.setImmediate(f);var a,l}),m=a.slice(0,a.length-1),y=m.length;y--;){if(!(i=e[m[y]]))throw new Error("Has nonexistent dependency in "+m.join(", "));if(h(i)&&S(i,r)>=0)throw new Error("Has cyclic dependencies")}g()?(c++,a[a.length-1](p,s)):d(function e(){g()&&(c++,(t=S(l,e))>=0&&l.splice(t,1),a[a.length-1](p,s));var t})}function g(){return c<t&&(e=function(e,t){return e&&s.hasOwnProperty(t)},n=!0,v(m,function(t,r,i){n=e(n,t,r,i)}),n)&&!s.hasOwnProperty(r);var e,n}})},o.retry=function(e,t,n){var r=5,i=0,a=[],s={times:r,interval:i};var c=arguments.length;if(c<1||c>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");function u(e,t){function n(e,n){return function(r){e(function(e,t){r(!e||n,{err:e,result:t})},t)}}function r(e){return function(t){setTimeout(function(){t(null)},e)}}for(;s.times;){var i=!(s.times-=1);a.push(n(s.task,i)),!i&&s.interval>0&&a.push(r(s.interval))}o.series(a,function(t,n){n=n[n.length-1],(e||s.callback)(n.err,n.result)})}return c<=2&&"function"==typeof e&&(n=t,t=e),"function"!=typeof e&&function(e,t){if("number"==typeof t)e.times=parseInt(t,10)||r;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);e.times=parseInt(t.times,10)||r,e.interval=parseInt(t.interval,10)||i}}(s,e),s.callback=n,s.task=t,s.callback?u():u},o.waterfall=function(e,t){if(t=p(t||a),!h(e)){var n=new Error("First argument to waterfall must be an array of functions");return t(n)}if(!e.length)return t();!function e(n){return C(function(r,i){if(r)t.apply(null,[r].concat(i));else{var o=n.next();o?i.push(e(o)):i.push(t),F(n).apply(null,i)}})}(o.iterator(e))()},o.parallel=function(e,t){k(o.eachOf,e,t)},o.parallelLimit=function(e,t,n){k(P(t),e,n)},o.series=function(e,t){k(o.eachOfSeries,e,t)},o.iterator=function(e){return function t(n){function r(){return e.length&&e[n].apply(null,arguments),r.next()}return r.next=function(){return n<e.length-1?t(n+1):null},r}(0)},o.apply=C(function(e,t){return C(function(n){return e.apply(null,t.concat(n))})}),o.concat=L(j),o.concatSeries=x(j),o.whilst=function(e,t,n){if(n=n||a,e()){var r=C(function(i,o){i?n(i):e.apply(this,o)?t(r):n.apply(null,[null].concat(o))});t(r)}else n(null)},o.doWhilst=function(e,t,n){var r=0;return o.whilst(function(){return++r<=1||t.apply(this,arguments)},e,n)},o.until=function(e,t,n){return o.whilst(function(){return!e.apply(this,arguments)},t,n)},o.doUntil=function(e,t,n){return o.doWhilst(e,function(){return!t.apply(this,arguments)},n)},o.during=function(e,t,n){n=n||a;var r=C(function(t,r){t?n(t):(r.push(i),e.apply(this,r))}),i=function(e,i){e?n(e):i?t(r):n(null)};e(i)},o.doDuring=function(e,t,n){var r=0;o.during(function(e){r++<1?e(null,!0):t.apply(this,arguments)},e,n)},o.queue=function(e,t){return N(function(t,n){e(t[0],n)},t,1)},o.priorityQueue=function(e,t){function n(e,t){return e.priority-t.priority}var r=o.queue(e,t);return r.push=function(e,t,i){!function(e,t,r,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");if(e.started=!0,h(t)||(t=[t]),0===t.length)return o.setImmediate(function(){e.drain()});v(t,function(t){var s={data:t,priority:r,callback:"function"==typeof i?i:a};e.tasks.splice(function(e,t,n){for(var r=-1,i=e.length-1;r<i;){var o=r+(i-r+1>>>1);n(t,e[o])>=0?r=o:i=o-1}return r}(e.tasks,s,n)+1,0,s),e.tasks.length===e.concurrency&&e.saturated(),o.setImmediate(e.process)})}(r,e,t,i)},delete r.unshift,r},o.cargo=function(e,t){return N(e,1,t)},o.log=V("log"),o.dir=V("dir"),o.memoize=function(e,t){var n={},r={},i=Object.prototype.hasOwnProperty;t=t||s;var a=C(function(a){var s=a.pop(),c=t.apply(null,a);i.call(n,c)?o.setImmediate(function(){s.apply(null,n[c])}):i.call(r,c)?r[c].push(s):(r[c]=[s],e.apply(null,a.concat([C(function(e){n[c]=e;var t=r[c];delete r[c];for(var i=0,o=t.length;i<o;i++)t[i].apply(null,e)})])))});return a.memo=n,a.unmemoized=e,a},o.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},o.times=U(o.map),o.timesSeries=U(o.mapSeries),o.timesLimit=function(e,t,n,r){return o.mapLimit(g(e),t,n,r)},o.seq=function(){var e=arguments;return C(function(t){var n=this,r=t[t.length-1];"function"==typeof r?t.pop():r=a,o.reduce(e,t,function(e,t,r){t.apply(n,e.concat([C(function(e,t){r(e,t)})]))},function(e,t){r.apply(n,[e].concat(t))})})},o.compose=function(){return o.seq.apply(null,Array.prototype.reverse.call(arguments))},o.applyEach=B(o.eachOf),o.applyEachSeries=B(o.eachOfSeries),o.forever=function(e,t){var n=d(t||a),r=F(e);!function e(t){if(t)return n(t);r(e)}()},o.ensureAsync=F,o.constant=C(function(e){var t=[null].concat(e);return function(e){return e.apply(this,t)}}),o.wrapSync=o.asyncify=function(e){return C(function(t){var n,r,i,o=t.pop();try{n=e.apply(this,t)}catch(e){return o(e)}("function"===(i=typeof(r=n))||"object"===i&&r)&&"function"==typeof n.then?n.then(function(e){o(null,e)}).catch(function(e){o(e.message?e:new Error(e))}):o(null,n)})},"object"==typeof t&&t.exports?t.exports=o:"function"==typeof define&&define.amd?define([],function(){return o}):l.async=o}()}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{_process:8,timers:326}],89:[function(e,t,n){(function(e){var n,r=e.crypto||e.msCrypto;if(r&&r.getRandomValues){var i=new Uint8Array(16);n=function(){return r.getRandomValues(i),i}}if(!n){var o=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],90:[function(e,t,n){for(var r=e("./rng"),i=[],o={},a=0;a<256;a++)i[a]=(a+256).toString(16).substr(1),o[i[a]]=a;function s(e,t){var n=t||0,r=i;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}var c=r(),u=[1|c[0],c[1],c[2],c[3],c[4],c[5]],l=16383&(c[6]<<8|c[7]),d=0,p=0;function f(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||r)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;a++)t[i+a]=o[a];return t||s(o)}var h=f;h.v1=function(e,t,n){var r=t&&n||0,i=t||[],o=void 0!==(e=e||{}).clockseq?e.clockseq:l,a=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:p+1,f=a-d+(c-p)/1e4;if(f<0&&void 0===e.clockseq&&(o=o+1&16383),(f<0||a>d)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");d=a,p=c,l=o;var h=(1e4*(268435455&(a+=122192928e5))+c)%4294967296;i[r++]=h>>>24&255,i[r++]=h>>>16&255,i[r++]=h>>>8&255,i[r++]=255&h;var m=a/4294967296*1e4&268435455;i[r++]=m>>>8&255,i[r++]=255&m,i[r++]=m>>>24&15|16,i[r++]=m>>>16&255,i[r++]=o>>>8|128,i[r++]=255&o;for(var v=e.node||u,y=0;y<6;y++)i[r+y]=v[y];return t||s(i)},h.v4=f,h.parse=function(e,t,n){var r=t&&n||0,i=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){i<16&&(t[r+i++]=o[e])});i<16;)t[r+i++]=0;return t},h.unparse=s,t.exports=h},{"./rng":89}],91:[function(e,t,n){var r=e("util"),i=e("intersect"),o=e("wildemitter"),a=e("webrtcsupport"),s=e("jingle-session"),c=e("jingle-media-session"),u=e("jingle-filetransfer-session");function l(e){for(var t in o.call(this),e=e||{},this.jid=e.jid,this.selfID=e.selfID||this.jid&&this.jid.full||this.jid||"",this.sessions={},this.peers={},this.prepareSession=e.prepareSession||function(e){return e.applicationTypes.indexOf("rtp")>=0?new c(e):e.applicationTypes.indexOf("filetransfer")>=0?new u(e):void 0},this.performTieBreak=e.performTieBreak||function(e,t){var n=t.jingle.contents.map(function(e){if(e.application)return e.application.applicationType});return i(e.pendingApplicationTypes,n).length>0},this.screenSharingSupport=a.screenSharing,this.capabilities=["urn:xmpp:jingle:1"],a.support&&(this.capabilities=["urn:xmpp:jingle:1","urn:xmpp:jingle:apps:rtp:1","urn:xmpp:jingle:apps:rtp:audio","urn:xmpp:jingle:apps:rtp:video","urn:xmpp:jingle:apps:rtp:rtcb-fb:0","urn:xmpp:jingle:apps:rtp:rtp-hdrext:0","urn:xmpp:jingle:apps:rtp:ssma:0","urn:xmpp:jingle:apps:dtls:0","urn:xmpp:jingle:apps:grouping:0","urn:xmpp:jingle:apps:file-transfer:3","urn:xmpp:jingle:transports:ice-udp:1","urn:xmpp:jingle:transports.dtls-sctp:1","urn:ietf:rfc:3264","urn:ietf:rfc:5576","urn:ietf:rfc:5888"]),this.config={debug:!1,peerConnectionConfig:{iceServers:e.iceServers||[{url:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[{DtlsSrtpKeyAgreement:!0},{RtpDataChannels:!1}]},media:{audio:!0,video:!0}},e)this.config[t]=e[t];this.iceServers=this.config.peerConnectionConfig.iceServers}r.inherits(l,o),l.prototype.addICEServer=function(e){"string"==typeof e&&(e={url:e}),this.iceServers.push(e)},l.prototype.addSession=function(e){var t=this,n=e.sid,r=e.peerID;return this.sessions[n]=e,this.peers[r]||(this.peers[r]=[]),this.peers[r].push(e),e.on("terminated",function(){var i=t.peers[r]||[];i.length&&i.splice(i.indexOf(e),1),delete t.sessions[n]}),e.on("*",function(n,r,i,o){if("send"===n){var a=r.jingle&&r.jingle.action;e.isInitiator&&"session-initiate"===a&&t.emit("outgoing",e)}!t.config.debug||"log:debug"!==n&&"log:error"!==n||console.log("Jingle:",r,i,o),0!==n.indexOf("change")&&t.emit(n,r,i,o)}),this.emit("createdSession",e),e},l.prototype.createMediaSession=function(e,t,n){var r=new c({sid:t,peer:e,initiator:!0,stream:n,parent:this,iceServers:this.iceServers,constraints:this.config.peerConnectionConstraints});return this.addSession(r),r},l.prototype.createFileTransferSession=function(e,t){var n=new u({sid:t,peer:e,initiator:!0,parent:this});return this.addSession(n),n},l.prototype.endPeerSessions=function(e,t,n){e=e.full||e;var r=this.peers[e]||[];delete this.peers[e],r.forEach(function(e){e.end(t||"gone",n)})},l.prototype.endAllSessions=function(e,t){var n=this;Object.keys(this.peers).forEach(function(r){n.endPeerSessions(r,e,t)})},l.prototype._createIncomingSession=function(e,t){var n;return this.prepareSession&&(n=this.prepareSession(e,t)),n||(n=new s(e)),this.addSession(n),n},l.prototype._sendError=function(e,t,n){n.type||(n.type="cancel"),this.emit("send",{to:e,id:t,type:"error",error:n})},l.prototype._log=function(e,t){this.emit("log:"+e,t)},l.prototype.process=function(e){var t=this,n=e.jingle?e.jingle.sid:null,r=this.sessions[n]||null,i=e.id,o=e.from.full||e.from;if("error"===e.type){var a=e.error&&"tie-break"===e.error.jingleCondition;return r&&r.pending&&a?r.end("alternative-session",!0):(r&&(r.pendingAction=!1),this.emit("error",e))}if("result"!==e.type){var s=e.jingle.action,c=e.jingle.contents||[],u=c.map(function(e){if(e.application)return e.application.applicationType}),l=c.map(function(e){if(e.transport)return e.transport.transportType});if("session-initiate"!==s){if(!r)return this._log("error","Unknown session",n),this._sendError(o,i,{condition:"item-not-found",jingleCondition:"unknown-session"});if(r.peerID!==o||r.ended)return this._log("error","Session has ended, or action has wrong sender"),this._sendError(o,i,{condition:"item-not-found",jingleCondition:"unknown-session"});if("session-accept"===s&&!r.pending)return this._log("error","Tried to accept session twice",n),this._sendError(o,i,{condition:"unexpected-request",jingleCondition:"out-of-order"});if("session-terminate"!==s&&s===r.pendingAction&&(this._log("error","Tie break during pending request"),r.isInitiator))return this._sendError(o,i,{condition:"conflict",jingleCondition:"tie-break"})}else if(r){if(r.peerID!==o)return this._log("error","Duplicate sid from new sender"),this._sendError(o,i,{condition:"service-unavailable"});if(!r.pending)return this._log("error","Someone is doing this wrong"),this._sendError(o,i,{condition:"unexpected-request",jingleCondition:"out-of-order"});if(this.selfID>r.peerID&&this.performTieBreak(r,e))return this._log("error","Tie break new session because of duplicate sids"),this._sendError(o,i,{condition:"conflict",jingleCondition:"tie-break"})}else if(this.peers[o]&&this.peers[o].length)for(var d=0,p=this.peers[o].length;d<p;d++){var f=this.peers[o][d];if(f&&f.pending&&f.sid>n&&this.performTieBreak(f,e))return this._log("info","Tie break session-initiate"),this._sendError(o,i,{condition:"conflict",jingleCondition:"tie-break"})}if("session-initiate"===s){if(!c.length)return t._sendError(o,i,{condition:"bad-request"});r=this._createIncomingSession({sid:n,peer:e.from,peerID:o,initiator:!1,parent:this,applicationTypes:u,transportTypes:l,iceServers:this.iceServers,constraints:this.config.peerConnectionConstraints},e)}r.process(s,e.jingle,function(n){n?(t._log("error","Could not process request",e,n),t._sendError(o,i,n)):(t.emit("send",{to:o,id:i,type:"result"}),"session-initiate"===s&&t.emit("incoming",r))})}else r&&(r.pendingAction=!1)},t.exports=l},{intersect:62,"jingle-filetransfer-session":66,"jingle-media-session":81,"jingle-session":87,util:331,webrtcsupport:349,wildemitter:350}],92:[function(e,t,n){function r(e){return!("object"!=typeof e||null==e||e instanceof Boolean||e instanceof Date||e instanceof Number||e instanceof RegExp||e instanceof String)}function i(e){var t=new n.WeakSet,i=new n.WeakMap;return function(e,n){if("$ref"!==e&&r(n)){if(t.has(n))return{$ref:(o=i.get(n),"#"+o.map(function(e){return e.toString().replace(/~/g,"~0").replace(/\//g,"~1")}).join("/"))};i.set(n,(i.get(this)||[]).concat([e])),t.add(n)}var o;return n}}function o(){var e=new n.WeakMap,t=new n.Set;return function(n,o){if("$ref"===n)t.add(this);else if(r(o)){""===n&&1===Object.keys(this).length?t.forEach(i,this):e.set(o,this)}return o};function i(t){for(var n,r=t.$ref.slice(1).split("/"),i=this,o=0;o<r.length;o++)i=i[n=r[o].replace(/~1/g,"/").replace(/~0/g,"~")];e.get(t)[n]=i}}n.WeakMap=WeakMap,n.WeakSet=WeakSet,n.Set=Set,n.decycle=i,n.retrocycle=o,n.extend=function(e){return Object.defineProperties(e,{decycle:{value:i},retrocycle:{value:o}})}},{}],93:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e("./shortcuts")),o=r(e("./types"));n.default=function(e){e.use(o.default),e.use(i.default)},t.exports=n.default},{"./shortcuts":94,"./types":95}],94:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i={client:r.Namespace.CLIENT,server:r.Namespace.SERVER,component:r.Namespace.COMPONENT};n.default=function(e){e.extendMessage=function(e,t){var n=this;this.withMessage(function(r){n.extend(r,e,t)})},e.extendPresence=function(e,t){var n=this;this.withPresence(function(r){n.extend(r,e,t)})},e.extendIQ=function(e,t){var n=this;this.withIQ(function(r){n.extend(r,e,t)})},e.extendStreamFeatures=function(e){var t=this;this.withStreamFeatures(function(n){t.extend(n,e)})},e.extendPubsubItem=function(e){var t=this;this.withPubsubItem(function(n){t.extend(n,e)})},e.withIQ=function(e){this.withDefinition("iq",r.Namespace.CLIENT,e),this.withDefinition("iq",r.Namespace.COMPONENT,e)},e.withMessage=function(e){this.withDefinition("message",r.Namespace.CLIENT,e),this.withDefinition("message",r.Namespace.COMPONENT,e)},e.withPresence=function(e){this.withDefinition("presence",r.Namespace.CLIENT,e),this.withDefinition("presence",r.Namespace.COMPONENT,e)},e.withStreamFeatures=function(e){this.withDefinition("features",r.Namespace.STREAM,e)},e.withStanzaError=function(e){this.withDefinition("error",r.Namespace.CLIENT,e),this.withDefinition("error",r.Namespace.COMPONENT,e)},e.withDataForm=function(e){this.withDefinition("x",r.Namespace.DATAFORM,e)},e.withPubsubItem=function(e){this.withDefinition("item",r.Namespace.PUBSUB,e),this.withDefinition("item",r.Namespace.PUBSUB_EVENT,e)},e.getMessage=function(){var e=void 0===arguments[0]?"client":arguments[0];return this.getDefinition("message",i[e])},e.getPresence=function(){var e=void 0===arguments[0]?"client":arguments[0];return this.getDefinition("presence",i[e])},e.getIQ=function(){var e=void 0===arguments[0]?"client":arguments[0];return this.getDefinition("iq",i[e])},e.getStreamError=function(){return this.getDefinition("error",r.Namespace.STREAM)},e.getIq=e.getIQ,e.withIq=e.withIQ},t.exports=n.default},{"xmpp-constants":352}],95:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-jid");n.default=function(e){var t=e.utils;t.jidAttribute=function(e,n){return{get:function(){var i=new r.JID(t.getAttribute(this.xml,e));return n&&(i.prepped=!0),i},set:function(n){t.setAttribute(this.xml,e,(n||"").toString())}}},t.jidSub=function(e,n,i){return{get:function(){var o=new r.JID(t.getSubText(this.xml,e,n));return i&&(o.prepped=!0),o},set:function(r){t.setSubText(this.xml,e,n,(r||"").toString())}}},t.tzoSub=t.field(function(e,n,r,i){var o,a=-1,s=t.getSubText(e,n,r);return s?("-"===s.charAt(0)&&(a=1,s=s.slice(1)),o=s.split(":"),(60*parseInt(o[0],10)+parseInt(o[1],10))*a):i},function(e,n,r,i){var o=void 0,a=void 0,s="-";"number"==typeof i?(i<0&&(i=-i,s="+"),s+=((o=i/60)<10?"0":"")+o+":"+((a=i%60)<10?"0":"")+a):s=i,t.setSubText(e,n,r,s)})},t.exports=n.default},{"xmpp-jid":358}],96:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"_address",namespace:r.Namespace.ADDRESS,element:"address",fields:{jid:t.jidAttribute("jid"),uri:t.attribute("uri"),node:t.attribute("node"),description:t.attribute("desc"),delivered:t.boolAttribute("delivered"),type:t.attribute("type")}}),i=t.subMultiExtension(r.Namespace.ADDRESS,"addresses",n);e.withMessage(function(t){e.add(t,"addresses",i)}),e.withPresence(function(t){e.add(t,"addresses",i)})},t.exports=n.default},{"xmpp-constants":352}],97:[function(e,t,n){"use strict";var r=e("babel-runtime/helpers/interop-require-default").default;Object.defineProperty(n,"__esModule",{value:!0});var i=e("xmpp-constants"),o=r(e("lodash.foreach"));n.default=function(e){var t=e.utils,n=e.define({name:"avatar",namespace:i.Namespace.AVATAR_METADATA,element:"info",fields:{id:t.attribute("id"),bytes:t.attribute("bytes"),height:t.attribute("height"),width:t.attribute("width"),type:t.attribute("type","image/png"),url:t.attribute("url")}}),r={get:function(){var e=t.find(this.xml,i.Namespace.AVATAR_METADATA,"metadata"),r=[];if(e.length){var a=t.find(e[0],i.Namespace.AVATAR_METADATA,"info");(0,o.default)(a,function(e){r.push(new n({},e))})}return r},set:function(e){var r=t.findOrCreate(this.xml,i.Namespace.AVATAR_METADATA,"metadata");t.setAttribute(r,"xmlns",i.Namespace.AVATAR_METADATA),(0,o.default)(e,function(e){var t=new n(e);r.appendChild(t.xml)})}};e.withPubsubItem(function(n){e.add(n,"avatars",r),e.add(n,"avatarData",t.textSub(i.Namespace.AVATAR_DATA,"data"))})},t.exports=n.default},{"babel-runtime/helpers/interop-require-default":4,"lodash.foreach":182,"xmpp-constants":352}],98:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"bind",namespace:r.Namespace.BIND,element:"bind",fields:{resource:t.textSub(r.Namespace.BIND,"resource"),jid:t.jidSub(r.Namespace.BIND,"jid")}});e.extendIQ(n),e.extendStreamFeatures(n)},t.exports=n.default},{"xmpp-constants":352}],99:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=e("xmpp-jid");n.default=function(e){var t=e.utils,n={get:function(){var e=[],n=t.find(this.xml,r.Namespace.BLOCKING,"item");return n.length?(n.forEach(function(n){e.push(new i.JID(t.getAttribute(n,"jid","")))}),e):e},set:function(e){var n=this;e.forEach(function(e){var i=t.createElement(r.Namespace.BLOCKING,"item",r.Namespace.BLOCKING);t.setAttribute(i,"jid",e.toString()),n.xml.appendChild(i)})}},o=e.define({name:"block",namespace:r.Namespace.BLOCKING,element:"block",fields:{jids:n}}),a=e.define({name:"unblock",namespace:r.Namespace.BLOCKING,element:"unblock",fields:{jids:n}}),s=e.define({name:"blockList",namespace:r.Namespace.BLOCKING,element:"blocklist",fields:{jids:n}});e.extendIQ(o),e.extendIQ(a),e.extendIQ(s)},t.exports=n.default},{"xmpp-constants":352,"xmpp-jid":358}],100:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"bob",namespace:r.Namespace.BOB,element:"data",fields:{cid:t.attribute("cid"),maxAge:t.numberAttribute("max-age"),type:t.attribute("type"),data:t.text()}});e.extendIQ(n),e.extendMessage(n),e.extendPresence(n)},t.exports=n.default},{"xmpp-constants":352}],101:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"_conference",namespace:r.Namespace.BOOKMARKS,element:"conference",fields:{name:t.attribute("name"),autoJoin:t.boolAttribute("autojoin"),jid:t.jidAttribute("jid"),nick:t.textSub(r.Namespace.BOOKMARKS,"nick")}}),i=e.define({name:"bookmarks",namespace:r.Namespace.BOOKMARKS,element:"storage"});e.extend(i,n,"conferences"),e.withDefinition("query",r.Namespace.PRIVATE,function(t){e.extend(t,i)})},t.exports=n.default},{"xmpp-constants":352}],102:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils;e.define({name:"bosh",namespace:r.Namespace.BOSH,element:"body",prefixes:{xmpp:r.Namespace.BOSH_XMPP},fields:{accept:t.attribute("accept"),ack:t.numberAttribute("ack"),authid:t.attribute("authid"),charsets:t.attribute("charsets"),condition:t.attribute("condition"),content:t.attribute("content"),from:t.jidAttribute("from",!0),hold:t.numberAttribute("hold"),inactivity:t.numberAttribute("inactivity"),key:t.attribute("key"),maxpause:t.numberAttribute("maxpause"),newKey:t.attribute("newkey"),pause:t.numberAttribute("pause"),polling:t.numberAttribute("polling"),resport:t.numberAttribute("report"),requests:t.numberAttribute("requests"),rid:t.numberAttribute("rid"),sid:t.attribute("sid"),stream:t.attribute("stream"),time:t.attribute("time"),to:t.jidAttribute("to",!0),type:t.attribute("type"),ver:t.attribute("ver"),wait:t.numberAttribute("wait"),uri:t.textSub(r.Namespace.BOSH,"uri"),lang:t.langAttribute(),version:t.attribute("xmpp:version","1.0"),restart:t.attribute("xmpp:restart"),restartLogic:t.boolAttribute("xmpp:restartLogic"),payload:{get:function(){for(var t=[],n=0,r=this.xml.childNodes.length;n<r;n++){var i=e.build(this.xml.childNodes[n]);void 0!==i&&t.push(i)}return t},set:function(e){var t=this;e.forEach(function(e){t.xml.appendChild(e.xml)})}}}})},t.exports=n.default},{"xmpp-constants":352}],103:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.define({name:"carbonSent",eventName:"carbon:sent",namespace:r.Namespace.CARBONS_2,element:"sent"}),n=e.define({name:"carbonReceived",eventName:"carbon:received",namespace:r.Namespace.CARBONS_2,element:"received"}),i=e.define({name:"carbonPrivate",eventName:"carbon:private",namespace:r.Namespace.CARBONS_2,element:"private"}),o=e.define({name:"enableCarbons",namespace:r.Namespace.CARBONS_2,element:"enable"}),a=e.define({name:"disableCarbons",namespace:r.Namespace.CARBONS_2,element:"disable"});e.withDefinition("forwarded",r.Namespace.FORWARD_0,function(r){e.extend(t,r),e.extend(n,r)}),e.extendMessage(t),e.extendMessage(n),e.extendMessage(i),e.extendIQ(o),e.extendIQ(a)},t.exports=n.default},{"xmpp-constants":352}],104:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["next","prev","complete","cancel"],o=["bad-action","bad-locale","bad-payload","bad-sessionid","malformed-action","session-expired"];n.default=function(e){var t=e.utils,n=e.define({name:"command",namespace:r.Namespace.ADHOC_COMMANDS,element:"command",fields:{action:t.attribute("action"),node:t.attribute("node"),sessionid:t.attribute("sessionid"),status:t.attribute("status"),execute:t.subAttribute(r.Namespace.ADHOC_COMMANDS,"actions","execute"),actions:{get:function(){var e=[],n=t.find(this.xml,r.Namespace.ADHOC_COMMANDS,"actions");return n.length?(i.forEach(function(i){t.find(n[0],r.Namespace.ADHOC_COMMANDS,i).length&&e.push(i)}),e):[]},set:function(e){for(var n=t.findOrCreate(this.xml,r.Namespace.ADHOC_COMMANDS,"actions"),i=0,o=n.childNodes.length;i<o;i++)n.removeChild(n.childNodes[i]);e.forEach(function(e){n.appendChild(t.createElement(r.Namespace.ADHOC_COMMANDS,e.toLowerCase(),r.Namespace.ADHOC_COMMANDS))})}}}}),a=e.define({name:"_commandNote",namespace:r.Namespace.ADHOC_COMMANDS,element:"note",fields:{type:t.attribute("type"),value:t.text()}});e.extend(n,a,"notes"),e.extendIQ(n),e.withStanzaError(function(n){e.add(n,"adhocCommandCondition",t.enumSub(r.Namespace.ADHOC_COMMANDS,o))}),e.withDataForm(function(t){e.extend(n,t)})},t.exports=n.default},{"xmpp-constants":352}],105:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.define({name:"clientStateIndication",namespace:r.Namespace.CSI,element:"csi"});e.define({name:"csiActive",eventName:"csi:active",namespace:r.Namespace.CSI,element:"active",topLevel:!0}),e.define({name:"csiInactive",eventName:"csi:inactive",namespace:r.Namespace.CSI,element:"inactive",topLevel:!0}),e.extendStreamFeatures(t)},t.exports=n.default},{"xmpp-constants":352}],106:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=e("xmpp-jid"),o=["text-single","text-private","list-single","jid-single"];n.default=function(e){var t=e.utils,n=e.define({name:"_field",namespace:r.Namespace.DATAFORM,element:"field",init:function(e){this._type=(e||{}).type||this.type},fields:{type:{get:function(){return t.getAttribute(this.xml,"type","text-single")},set:function(e){this._type=e,t.setAttribute(this.xml,"type",e)}},name:t.attribute("var"),desc:t.textSub(r.Namespace.DATAFORM,"desc"),required:t.boolSub(r.Namespace.DATAFORM,"required"),label:t.attribute("label"),value:{get:function(){var e=t.getMultiSubText(this.xml,r.Namespace.DATAFORM,"value");return"boolean"===this._type?"1"===e[0]||"true"===e[0]:e.length>1?"text-multi"===this._type?e.join("\n"):"jid-multi"===this._type?e.map(function(e){return new i.JID(e)}):e:o.indexOf(this._type)>=0?"jid-single"===this._type?new i.JID(e[0]):e[0]:e},set:function(e){if("boolean"===this._type||!0===e||!1===e){var n=!0===e||"true"===e||"1"===e,i=t.createElement(r.Namespace.DATAFORM,"value",r.Namespace.DATAFORM);i.textContent=n?"1":"0",this.xml.appendChild(i)}else"text-multi"===this._type&&"string"==typeof e&&(e=e.split("\n")),t.setMultiSubText(this.xml,r.Namespace.DATAFORM,"value",e,function(e){var n=t.createElement(r.Namespace.DATAFORM,"value",r.Namespace.DATAFORM);n.textContent=e,this.xml.appendChild(n)}.bind(this))}}}}),a=e.define({name:"_formoption",namespace:r.Namespace.DATAFORM,element:"option",fields:{label:t.attribute("label"),value:t.textSub(r.Namespace.DATAFORM,"value")}}),s=e.define({name:"_formitem",namespace:r.Namespace.DATAFORM,element:"item"}),c=e.define({name:"media",element:"media",namespace:r.Namespace.DATAFORM_MEDIA,fields:{height:t.numberAttribute("height"),width:t.numberAttribute("width")}}),u=e.define({name:"_mediaURI",element:"uri",namespace:r.Namespace.DATAFORM_MEDIA,fields:{uri:t.text(),type:t.attribute("type")}}),l=e.define({name:"validation",element:"validate",namespace:r.Namespace.DATAFORM_VALIDATION,fields:{dataType:t.attribute("datatype"),basic:t.boolSub(r.Namespace.DATAFORM_VALIDATION,"basic"),open:t.boolSub(r.Namespace.DATAFORM_VALIDATION,"open"),regex:t.textSub(r.Namespace.DATAFORM_VALIDATION,"regex")}}),d=e.define({name:"range",element:"range",namespace:r.Namespace.DATAFORM_VALIDATION,fields:{min:t.attribute("min"),max:t.attribute("max")}}),p=e.define({name:"select",element:"list-range",namespace:r.Namespace.DATAFORM_VALIDATION,fields:{min:t.numberAttribute("min"),max:t.numberAttribute("max")}}),f={get:function(){for(var e=[],t=0,n=this.xml.childNodes.length;t<n;t++){var i=this.xml.childNodes[t];if(i.namespaceURI===r.Namespace.DATAFORM_LAYOUT)switch(i.localName){case"text":e.push({text:i.textContent});break;case"fieldref":e.push({field:i.getAttribute("var")});break;case"reportedref":e.push({reported:!0});break;case"section":e.push({section:new h(null,i,this).toJSON()})}}return e},set:function(e){for(var n=0,i=e.length;n<i;n++){var o=e[n];if(o.text){var a=t.createElement(r.Namespace.DATAFORM_LAYOUT,"text",r.Namespace.DATAFORM_LAYOUT);a.textContent=o.text,this.xml.appendChild(a)}if(o.field){var s=t.createElement(r.Namespace.DATAFORM_LAYOUT,"fieldref",r.Namespace.DATAFORM_LAYOUT);s.setAttribute("var",o.field),this.xml.appendChild(s)}if(o.reported&&this.xml.appendChild(t.createElement(r.Namespace.DATAFORM_LAYOUT,"reportedref",r.Namespace.DATAFORM_LAYOUT)),o.section){var c=t.createElement(r.Namespace.DATAFORM_LAYOUT,"section",r.Namespace.DATAFORM_LAYOUT);this.xml.appendChild(c);var u=new h(null,c);u.label=o.section.label,u.contents=o.section.contents}}}},h=e.define({name:"_section",element:"section",namespace:r.Namespace.DATAFORM_LAYOUT,fields:{label:t.attribute("label"),contents:f}}),m=e.define({name:"_page",element:"page",namespace:r.Namespace.DATAFORM_LAYOUT,fields:{label:t.attribute("label"),contents:f}}),v=e.define({name:"form",namespace:r.Namespace.DATAFORM,element:"x",init:function(){if(this.reportedFields.length){var e={};this.reportedFields.forEach(function(t){e[t.name]=t.type}),this.items.forEach(function(t){t.fields.forEach(function(t){t.type=t._type=e[t.name]})})}},fields:{title:t.textSub(r.Namespace.DATAFORM,"title"),instructions:t.multiTextSub(r.Namespace.DATAFORM,"instructions"),type:t.attribute("type","form"),reportedFields:t.subMultiExtension(r.Namespace.DATAFORM,"reported",n)}});e.extend(v,n,"fields"),e.extend(v,s,"items"),e.extend(v,m,"layout"),e.extend(n,c),e.extend(n,l),e.extend(n,a,"options"),e.extend(s,n,"fields"),e.extend(c,u,"uris"),e.extend(l,d),e.extend(l,p),e.extendMessage(v)},t.exports=n.default},{"xmpp-constants":352,"xmpp-jid":358}],107:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"delay",namespace:r.Namespace.DELAY,element:"delay",fields:{from:t.jidAttribute("from"),stamp:t.dateAttribute("stamp"),reason:t.text()}});e.extendMessage(n),e.extendPresence(n)},t.exports=n.default},{"xmpp-constants":352}],108:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"caps",namespace:r.Namespace.CAPS,element:"c",fields:{ver:t.attribute("ver"),node:t.attribute("node"),hash:t.attribute("hash"),ext:t.attribute("ext")}}),i=e.define({name:"discoInfo",namespace:r.Namespace.DISCO_INFO,element:"query",fields:{node:t.attribute("node"),features:t.multiSubAttribute(r.Namespace.DISCO_INFO,"feature","var")}}),o=e.define({name:"_discoIdentity",namespace:r.Namespace.DISCO_INFO,element:"identity",fields:{category:t.attribute("category"),type:t.attribute("type"),name:t.attribute("name"),lang:t.langAttribute()}}),a=e.define({name:"discoItems",namespace:r.Namespace.DISCO_ITEMS,element:"query",fields:{node:t.attribute("node")}}),s=e.define({name:"_discoItem",namespace:r.Namespace.DISCO_ITEMS,element:"item",fields:{jid:t.jidAttribute("jid"),node:t.attribute("node"),name:t.attribute("name")}});e.extend(a,s,"items"),e.extend(i,o,"identities"),e.extendIQ(i),e.extendIQ(a),e.extendPresence(n),e.extendStreamFeatures(n),e.withDataForm(function(t){e.extend(i,t,"extensions")}),e.withDefinition("set",r.Namespace.RSM,function(t){e.extend(a,t)})},t.exports=n.default},{"xmpp-constants":352}],109:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["bad-request","conflict","feature-not-implemented","forbidden","gone","internal-server-error","item-not-found","jid-malformed","not-acceptable","not-allowed","not-authorized","payment-required","recipient-unavailable","redirect","registration-required","remote-server-not-found","remote-server-timeout","resource-constraint","service-unavailable","subscription-required","undefined-condition","unexpected-request"];n.default=function(e){var t=e.utils,n=e.define({name:"error",namespace:r.Namespace.CLIENT,element:"error",fields:{lang:{get:function(){return(this.parent||{}).lang||""}},condition:t.enumSub(r.Namespace.STANZA_ERROR,i),gone:{get:function(){return t.getSubText(this.xml,r.Namespace.STANZA_ERROR,"gone")},set:function(e){this.condition="gone",t.setSubText(this.xml,r.Namespace.STANZA_ERROR,"gone",e)}},redirect:{get:function(){return t.getSubText(this.xml,r.Namespace.STANZA_ERROR,"redirect")},set:function(e){this.condition="redirect",t.setSubText(this.xml,r.Namespace.STANZA_ERROR,"redirect",e)}},code:t.attribute("code"),type:t.attribute("type"),by:t.jidAttribute("by"),$text:{get:function(){return t.getSubLangText(this.xml,r.Namespace.STANZA_ERROR,"text",this.lang)}},text:{get:function(){return this.$text[this.lang]||""},set:function(e){t.setSubLangText(this.xml,r.Namespace.STANZA_ERROR,"text",e,this.lang)}}}});e.extendMessage(n),e.extendPresence(n),e.extendIQ(n)},t.exports=n.default},{"xmpp-constants":352}],110:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,i=n.Services=e.define({name:"services",namespace:r.Namespace.DISCO_EXTERNAL_1,element:"services",fields:{type:t.attribute("type")}}),o=n.Credentials=e.define({name:"credentials",namespace:r.Namespace.DISCO_EXTERNAL_1,element:"credentials"}),a=e.define({name:"service",namespace:r.Namespace.DISCO_EXTERNAL_1,element:"service",fields:{host:t.attribute("host"),port:t.attribute("port"),transport:t.attribute("transport"),type:t.attribute("type"),username:t.attribute("username"),password:t.attribute("password")}});e.extend(i,a,"services"),e.extend(o,a),e.extendIQ(i),e.extendIQ(o),e.withDataForm(function(t){e.extend(a,t)})},t.exports=n.default},{"xmpp-constants":352}],111:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=r.Namespace.FILE_TRANSFER_4;n.default=function(e){var t=e.utils,n=e.define({name:"file",namespace:i,element:"file",fields:{name:t.textSub(i,"name"),description:t.textSub(i,"desc"),mediaType:t.textSub(i,"media-type"),size:t.numberSub(i,"size"),date:t.dateSub(i,"date")}}),o=e.define({name:"range",namespace:i,element:"range",fields:{offset:t.numberAttribute("offset"),length:t.numberAttribute("length")}}),a=e.define({name:"_"+i,namespace:i,element:"description",tags:["jingle-application"],fields:{applicationType:{value:i}}}),s=e.define({name:"_{"+i+"}received",namespace:i,element:"received",tags:["jingle-info"],fields:{infoType:{value:"{"+i+"}received"},creator:t.attribute("creator"),name:t.attribute("name")}}),c=e.define({name:"_{"+i+"}checksum",namespace:i,element:"checksum",tags:["jingle-info"],fields:{infoType:{value:"{"+i+"}checksum"},creator:t.attribute("creator"),name:t.attribute("name")}});e.extend(n,o),e.extend(c,n),e.extend(a,n),e.withDefinition("hash",r.Namespace.HASHES_1,function(t){e.extend(n,t,"hashes"),e.extend(o,t,"hashes")}),e.withDefinition("content",r.Namespace.JINGLE_1,function(t){e.extend(t,a)}),e.withDefinition("jingle",r.Namespace.JINGLE_1,function(t){e.extend(t,s),e.extend(t,c)})},t.exports=n.default},{"xmpp-constants":352}],112:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=r.Namespace.FILE_TRANSFER_3;n.default=function(e){var t=e.utils,n=e.define({name:"_file",namespace:i,element:"file",fields:{name:t.textSub(i,"name"),desc:t.textSub(i,"desc"),size:t.numberSub(i,"size"),date:t.dateSub(i,"date")}}),o=e.define({name:"range",namespace:i,element:"range",fields:{offset:t.numberAttribute("offset")}}),a=e.define({name:"thumbnail",namespace:r.Namespace.THUMBS_0,element:"thumbnail",fields:{cid:t.attribute("cid"),mimeType:t.attribute("mime-type"),width:t.numberAttribute("width"),height:t.numberAttribute("height")}}),s=e.define({name:"_filetransfer",namespace:i,element:"description",tags:["jingle-application"],fields:{applicationType:{value:"filetransfer"},offer:t.subExtension("offer",i,"offer",n),request:t.subExtension("request",i,"request",n)}});e.extend(n,o),e.extend(n,a),e.withDefinition("hash",r.Namespace.HASHES_1,function(t){e.extend(n,t,"hashes")}),e.withDefinition("content",r.Namespace.JINGLE_1,function(t){e.extend(t,s)})},t.exports=n.default},{"xmpp-constants":352}],113:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.define({name:"forwarded",namespace:r.Namespace.FORWARD_0,element:"forwarded"});e.withMessage(function(n){e.extend(n,t),e.extend(t,n)}),e.withPresence(function(n){e.extend(n,t),e.extend(t,n)}),e.withIQ(function(n){e.extend(n,t),e.extend(t,n)}),e.withDefinition("delay",r.Namespace.DELAY,function(n){e.extend(t,n)})},t.exports=n.default},{"xmpp-constants":352}],114:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils;e.define({name:"openStream",namespace:r.Namespace.FRAMING,element:"open",topLevel:!0,fields:{lang:t.langAttribute(),id:t.attribute("id"),version:t.attribute("version","1.0"),to:t.jidAttribute("to",!0),from:t.jidAttribute("from",!0)}}),e.define({name:"closeStream",namespace:r.Namespace.FRAMING,element:"close",topLevel:!0,fields:{seeOtherURI:t.attribute("see-other-uri")}})},t.exports=n.default},{"xmpp-constants":352}],115:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"geoloc",namespace:r.Namespace.GEOLOC,element:"geoloc",fields:{accuracy:t.numberSub(r.Namespace.GEOLOC,"accuracy",!0),altitude:t.numberSub(r.Namespace.GEOLOC,"alt",!0),area:t.textSub(r.Namespace.GEOLOC,"area"),heading:t.numberSub(r.Namespace.GEOLOC,"bearing",!0),bearing:t.numberSub(r.Namespace.GEOLOC,"bearing",!0),building:t.textSub(r.Namespace.GEOLOC,"building"),country:t.textSub(r.Namespace.GEOLOC,"country"),countrycode:t.textSub(r.Namespace.GEOLOC,"countrycode"),datum:t.textSub(r.Namespace.GEOLOC,"datum"),description:t.textSub(r.Namespace.GEOLOC,"description"),error:t.numberSub(r.Namespace.GEOLOC,"error",!0),floor:t.textSub(r.Namespace.GEOLOC,"floor"),latitude:t.numberSub(r.Namespace.GEOLOC,"lat",!0),locality:t.textSub(r.Namespace.GEOLOC,"locality"),longitude:t.numberSub(r.Namespace.GEOLOC,"lon",!0),postalcode:t.textSub(r.Namespace.GEOLOC,"postalcode"),region:t.textSub(r.Namespace.GEOLOC,"region"),room:t.textSub(r.Namespace.GEOLOC,"room"),speed:t.numberSub(r.Namespace.GEOLOC,"speed",!0),street:t.textSub(r.Namespace.GEOLOC,"street"),text:t.textSub(r.Namespace.GEOLOC,"text"),timestamp:t.dateSub(r.Namespace.GEOLOC,"timestamp"),tzo:t.tzoSub(r.Namespace.GEOLOC,"tzo"),uri:t.textSub(r.Namespace.GEOLOC,"uri")}});e.extendPubsubItem(n)},t.exports=n.default},{"xmpp-constants":352}],116:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){e.define({name:"hash",namespace:r.Namespace.HASHES_1,element:"hash",fields:{algo:e.utils.attribute("algo"),value:e.utils.text()}})},t.exports=n.default},{"xmpp-constants":352}],117:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.define({name:"_hat",namespace:r.Namespace.HATS_0,element:"hat",fields:{lang:e.utils.langAttribute(),name:e.utils.attribute("name"),displayName:e.utils.attribute("displayName")}});e.withPresence(function(n){e.add(n,"hats",e.utils.subMultiExtension(r.Namespace.HATS_0,"hats",t))})},t.exports=n.default},{"xmpp-constants":352}],118:[function(e,t,n){(function(r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("xmpp-constants"),o="http://jabber.org/protocol/ibb",a="urn:xmpp:jingle:transports:ibb:1";n.default=function(e){var t=e.utils,n={get:function(){var e=t.find(this.xml,o,"data");if(e.length)return e=e[0],{action:"data",sid:t.getAttribute(e,"sid"),seq:parseInt(t.getAttribute(e,"seq")||"0",10),data:new r(t.getText(e),"base64")};var n=t.find(this.xml,o,"open");if(n.length){n=n[0];var i=t.getAttribute(n,"stanza");return i="message"!==i,{action:"open",sid:t.getAttribute(n,"sid"),blockSize:t.getAttribute(n,"block-size"),ack:i}}var a=t.find(this.xml,o,"close");return a.length?{action:"close",sid:t.getAttribute(a[0],"sid")}:void 0},set:function(e){if("data"===e.action){var n=t.createElement(o,"data");t.setAttribute(n,"sid",e.sid),t.setAttribute(n,"seq",e.seq.toString()),t.setText(n,e.data.toString("base64")),this.xml.appendChild(n)}if("open"===e.action){var r=t.createElement(o,"open");t.setAttribute(r,"sid",e.sid),t.setAttribute(r,"block-size",(e.blockSize||"4096").toString()),!1===e.ack?t.setAttribute(r,"stanza","message"):t.setAttribute(r,"stanza","iq"),this.xml.appendChild(r)}if("close"===e.action){var i=t.createElement(o,"close");t.setAttribute(i,"sid",e.sid),this.xml.appendChild(i)}}},s=e.define({name:"_"+a,namespace:a,element:"transport",tags:["jingle-transport"],fields:{transportType:{value:a},sid:t.attribute("sid"),blockSize:t.numberAttribute("block-size"),ack:{get:function(){return"message"!==t.getAttribute(this.xml,"stanza")},set:function(e){!1===e.ack?t.setAttribute(this.xml,"stanza","message"):t.setAttribute(this.xml,"stanza","iq")}}}});e.withDefinition("content",i.Namespace.JINGLE_1,function(t){e.extend(t,s)}),e.withIQ(function(t){e.add(t,"ibb",n)}),e.withMessage(function(t){e.add(t,"ibb",n)})},t.exports=n.default}).call(this,e("buffer").Buffer)},{buffer:10,"xmpp-constants":352}],119:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"_iceUdp",namespace:r.Namespace.JINGLE_ICE_UDP_1,element:"transport",tags:["jingle-transport"],fields:{transportType:{value:"iceUdp"},pwd:t.attribute("pwd"),ufrag:t.attribute("ufrag")}}),i=e.define({name:"remoteCandidate",namespace:r.Namespace.JINGLE_ICE_UDP_1,element:"remote-candidate",fields:{component:t.attribute("component"),ip:t.attribute("ip"),port:t.attribute("port")}}),o=e.define({name:"_iceUdpCandidate",namespace:r.Namespace.JINGLE_ICE_UDP_1,element:"candidate",fields:{component:t.attribute("component"),foundation:t.attribute("foundation"),generation:t.attribute("generation"),id:t.attribute("id"),ip:t.attribute("ip"),network:t.attribute("network"),port:t.attribute("port"),priority:t.attribute("priority"),protocol:t.attribute("protocol"),relAddr:t.attribute("rel-addr"),relPort:t.attribute("rel-port"),tcpType:t.attribute("tcptype"),type:t.attribute("type")}}),a=e.define({name:"_iceFingerprint",namespace:r.Namespace.JINGLE_DTLS_0,element:"fingerprint",fields:{hash:t.attribute("hash"),setup:t.attribute("setup"),value:t.text(),required:t.boolAttribute("required")}}),s=e.define({name:"_sctpMap",namespace:r.Namespace.DTLS_SCTP_1,element:"sctpmap",fields:{number:t.attribute("number"),protocol:t.attribute("protocol"),streams:t.attribute("streams")}});e.extend(n,o,"candidates"),e.extend(n,i),e.extend(n,a,"fingerprints"),e.extend(n,s,"sctp"),e.withDefinition("content",r.Namespace.JINGLE_1,function(t){e.extend(t,n)})},t.exports=n.default},{"xmpp-constants":352}],120:[function(e,t,n){"use strict";var r=e("babel-runtime/helpers/interop-require-default").default;Object.defineProperty(n,"__esModule",{value:!0});var i=r(e("./addresses")),o=r(e("./avatar")),a=r(e("./bind")),s=r(e("./blocking")),c=r(e("./bob")),u=r(e("./bookmarks")),l=r(e("./bosh")),d=r(e("./carbons")),p=r(e("./command")),f=r(e("./csi")),h=r(e("./dataforms")),m=r(e("./delayed")),v=r(e("./disco")),y=r(e("./error")),g=r(e("./extdisco")),S=r(e("./file")),_=r(e("./file3")),b=r(e("./forwarded")),C=r(e("./framing")),w=r(e("./geoloc")),E=r(e("./hash")),R=r(e("./hats")),P=r(e("./iceUdp")),L=r(e("./ibb")),T=r(e("./iq")),x=r(e("./jidprep")),M=r(e("./jingle")),A=r(e("./json")),I=r(e("./logging")),O=r(e("./mam")),D=r(e("./message")),k=r(e("./mood")),j=r(e("./muc")),N=r(e("./nick")),V=r(e("./oob")),U=r(e("./ping")),B=r(e("./presence")),F=r(e("./private")),G=r(e("./psa")),W=r(e("./pubsub")),J=r(e("./pubsubError")),q=r(e("./pubsubEvents")),H=r(e("./pubsubOwner")),z=r(e("./push")),X=r(e("./reach")),$=r(e("./register")),Y=r(e("./roster")),K=r(e("./rsm")),Q=r(e("./rtp")),Z=r(e("./rtt")),ee=r(e("./sasl")),te=r(e("./session")),ne=r(e("./shim")),re=r(e("./sm")),ie=r(e("./stream")),oe=r(e("./streamError")),ae=r(e("./streamFeatures")),se=r(e("./time")),ce=r(e("./tune")),ue=r(e("./vcard")),le=r(e("./version")),de=r(e("./visibility"));n.default=function(e){e.use(i.default),e.use(o.default),e.use(a.default),e.use(s.default),e.use(c.default),e.use(u.default),e.use(l.default),e.use(d.default),e.use(p.default),e.use(f.default),e.use(h.default),e.use(m.default),e.use(v.default),e.use(y.default),e.use(g.default),e.use(S.default),e.use(_.default),e.use(b.default),e.use(C.default),e.use(w.default),e.use(E.default),e.use(R.default),e.use(P.default),e.use(L.default),e.use(T.default),e.use(x.default),e.use(M.default),e.use(A.default),e.use(I.default),e.use(O.default),e.use(D.default),e.use(k.default),e.use(j.default),e.use(N.default),e.use(V.default),e.use(U.default),e.use(B.default),e.use(F.default),e.use(G.default),e.use(W.default),e.use(J.default),e.use(q.default),e.use(H.default),e.use(z.default),e.use(X.default),e.use($.default),e.use(Y.default),e.use(K.default),e.use(Q.default),e.use(Z.default),e.use(ee.default),e.use(te.default),e.use(ne.default),e.use(re.default),e.use(ie.default),e.use(oe.default),e.use(ae.default),e.use(se.default),e.use(ce.default),e.use(ue.default),e.use(le.default),e.use(de.default)},t.exports=n.default},{"./addresses":96,"./avatar":97,"./bind":98,"./blocking":99,"./bob":100,"./bookmarks":101,"./bosh":102,"./carbons":103,"./command":104,"./csi":105,"./dataforms":106,"./delayed":107,"./disco":108,"./error":109,"./extdisco":110,"./file":111,"./file3":112,"./forwarded":113,"./framing":114,"./geoloc":115,"./hash":116,"./hats":117,"./ibb":118,"./iceUdp":119,"./iq":121,"./jidprep":122,"./jingle":123,"./json":124,"./logging":125,"./mam":126,"./message":127,"./mood":128,"./muc":129,"./nick":130,"./oob":131,"./ping":132,"./presence":133,"./private":134,"./psa":135,"./pubsub":136,"./pubsubError":137,"./pubsubEvents":138,"./pubsubOwner":139,"./push":140,"./reach":141,"./register":142,"./roster":143,"./rsm":144,"./rtp":145,"./rtt":146,"./sasl":147,"./session":148,"./shim":149,"./sm":150,"./stream":151,"./streamError":152,"./streamFeatures":153,"./time":154,"./tune":155,"./vcard":156,"./version":157,"./visibility":158,"babel-runtime/helpers/interop-require-default":4}],121:[function(e,t,n){"use strict";var r=e("babel-runtime/core-js/object/assign").default;Object.defineProperty(n,"__esModule",{value:!0});var i=e("xmpp-constants"),o={defineIQ:function(e,t,n){var i=e.utils,o=e.define({name:t,namespace:n,element:"iq",topLevel:!0,fields:{lang:i.langAttribute(),id:i.attribute("id"),to:i.jidAttribute("to",!0),from:i.jidAttribute("from",!0),type:i.attribute("type")}}),a=o.prototype.toJSON;r(o.prototype,{toJSON:function(){var e=a.call(this);return e.resultReply=this.resultReply,e.errorReply=this.errorReply,e},resultReply:function(e){return(e=e||{}).to=this.from,e.id=this.id,e.type="result",new o(e)},errorReply:function(e){return(e=e||{}).to=this.from,e.id=this.id,e.type="error",new o(e)}})}};n.default=function(e){o.defineIQ(e,"iq",i.Namespace.CLIENT),o.defineIQ(e,"serverIQ",i.Namespace.SERVER),o.defineIQ(e,"componentIQ",i.Namespace.COMPONENT)},t.exports=n.default},{"babel-runtime/core-js/object/assign":3,"xmpp-constants":352}],122:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=e("xmpp-jid");n.default=function(e){e.withIQ(function(t){e.add(t,"jidPrep",{get:function(){var t=e.utils.getSubText(this.xml,r.Namespace.JID_PREP_0,"jid");if(t){var n=new i.JID(t);return n.prepped=!0,n}},set:function(t){e.utils.setSubText(this.xml,r.Namespace.JID_PREP_0,"jid",(t||"").toString())}})})},t.exports=n.default},{"xmpp-constants":352,"xmpp-jid":358}],123:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["out-of-order","tie-break","unknown-session","unsupported-info"],o=["alternative-session","busy","cancel","connectivity-error","decline","expired","failed-application","failed-transport","general-error","gone","incompatible-parameters","media-error","security-error","success","timeout","unsupported-applications","unsupported-transports"];n.default=function(e){var t=e.utils,n=e.define({name:"jingle",namespace:r.Namespace.JINGLE_1,element:"jingle",fields:{action:t.attribute("action"),initiator:t.attribute("initiator"),responder:t.attribute("responder"),sid:t.attribute("sid"),info:{get:function(){for(var n=e.tagged("jingle-info").map(function(e){return e.prototype._name}),r=0,i=n.length;r<i;r++)if(this._extensions[n[r]])return this._extensions[n[r]];if("session-info"===t.getAttribute(this.xml,"action"))return 0===this.xml.children.length?{infoType:"ping"}:{infoType:"unknown"}},set:function(e){"ping"!==e.infoType&&(this["_"+e.infoType]=e)}}}}),a=e.define({name:"_jingleContent",namespace:r.Namespace.JINGLE_1,element:"content",fields:{creator:t.attribute("creator"),disposition:t.attribute("disposition","session"),name:t.attribute("name"),senders:t.attribute("senders","both"),application:{get:function(){for(var t=e.tagged("jingle-application").map(function(e){return e.prototype._name}),n=0,r=t.length;n<r;n++)if(this._extensions[t[n]])return this._extensions[t[n]]},set:function(e){this["_"+e.applicationType]=e}},transport:{get:function(){for(var t=e.tagged("jingle-transport").map(function(e){return e.prototype._name}),n=0,r=t.length;n<r;n++)if(this._extensions[t[n]])return this._extensions[t[n]]},set:function(e){this["_"+e.transportType]=e}},security:{get:function(){for(var t=e.tagged("jingle-security").map(function(e){return Security.prototype._name}),n=0,r=t.length;n<r;n++)if(this._extensions[t[n]])return this._extensions[t[n]]},set:function(e){this["_"+e.securityType]=e}}}}),s=e.define({name:"reason",namespace:r.Namespace.JINGLE_1,element:"reason",fields:{condition:t.enumSub(r.Namespace.JINGLE_1,o),alternativeSession:{get:function(){return t.getSubText(this.xml,r.Namespace.JINGLE_1,"alternative-session")},set:function(e){this.condition="alternative-session",t.setSubText(this.xml,r.Namespace.JINGLE_1,"alternative-session",e)}},text:t.textSub(r.Namespace.JINGLE_1,"text")}});e.extend(n,a,"contents"),e.extend(n,s),e.extendIQ(n),e.withStanzaError(function(n){e.add(n,"jingleCondition",t.enumSub(r.Namespace.JINGLE_ERRORS_1,i))})},t.exports=n.default},{"xmpp-constants":352}],124:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t={get:function(){var t=e.utils.getSubText(this.xml,r.Namespace.JSON_0,"json");if(t)return JSON.parse(t)},set:function(t){(t=JSON.stringify(t))&&e.utils.setSubText(this.xml,r.Namespace.JSON_0,"json",t)}};e.withMessage(function(n){e.add(n,"json",t)}),e.withPubsubItem(function(n){e.add(n,"json",t)})},t.exports=n.default},{"xmpp-constants":352}],125:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"log",namespace:r.Namespace.EVENTLOG,element:"log",fields:{id:t.attribute("id"),timestamp:t.dateAttribute("timestamp"),type:t.attribute("type"),level:t.attribute("level"),object:t.attribute("object"),subject:t.attribute("subject"),facility:t.attribute("facility"),module:t.attribute("module"),message:t.textSub(r.Namespace.EVENTLOG,"message"),stackTrace:t.textSub(r.Namespace.EVENTLOG,"stackTrace")}}),i=e.define({name:"_logtag",namespace:r.Namespace.EVENTLOG,element:"tag",fields:{name:t.attribute("name"),value:t.attribute("value"),type:t.attribute("type")}});e.extend(n,i,"tags"),e.extendMessage(n),e.extendPubsubItem(n)},t.exports=n.default},{"xmpp-constants":352}],126:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=e("xmpp-jid");n.default=function(e){var t=e.utils,n=e.define({name:"mam",namespace:r.Namespace.MAM_0,element:"query",fields:{queryid:t.attribute("queryid")}}),o=e.define({name:"mamItem",namespace:r.Namespace.MAM_0,element:"result",fields:{queryid:t.attribute("queryid"),id:t.attribute("id")}}),a=e.define({name:"mamResult",namespace:r.Namespace.MAM_0,element:"fin",fields:{queryid:t.attribute("queryid"),complete:t.boolAttribute("complete"),stable:t.boolAttribute("stable")}}),s=e.define({name:"mamPrefs",namespace:r.Namespace.MAM_0,element:"prefs",fields:{defaultCondition:t.attribute("default"),always:{get:function(){var e=[],n=t.find(this.xml,r.Namespace.MAM_0,"always");return 0===n.length?e:(n=n[0],t.getMultiSubText(n,r.Namespace.MAM_0,"jid").forEach(function(t){e.push(new i.JID(t.textContent))}),e)},set:function(e){if(e.length>0){var n=t.findOrCreate(this.xml,r.Namespace.MAM_0,"always");t.setMultiSubText(n,r.Namespace.MAM_0,"jid",e)}}},never:{get:function(){var e=[],n=t.find(this.xml,r.Namespace.MAM_0,"always");return 0===n.length?e:(n=n[0],t.getMultiSubText(n,r.Namespace.MAM_0,"jid").forEach(function(t){e.push(new i.JID(t.textContent))}),e)},set:function(e){if(e.length>0){var n=t.findOrCreate(this.xml,r.Namespace.MAM_0,"never");t.setMultiSubText(n,r.Namespace.MAM_0,"jid",e)}}}}});e.extendMessage(o),e.extendMessage(a),e.extendIQ(n),e.extendIQ(s),e.withDataForm(function(t){e.extend(n,t)}),e.withDefinition("forwarded",r.Namespace.FORWARD_0,function(t){e.extend(o,t)}),e.withDefinition("set",r.Namespace.RSM,function(t){e.extend(n,t),e.extend(a,t)})},t.exports=n.default},{"xmpp-constants":352,"xmpp-jid":358}],127:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i={defineMessage:function(e,t,n){var i=e.utils;e.define({name:t,namespace:n,element:"message",topLevel:!0,fields:{lang:i.langAttribute(),id:i.attribute("id"),to:i.jidAttribute("to",!0),from:i.jidAttribute("from",!0),type:i.attribute("type","normal"),thread:i.textSub(n,"thread"),parentThread:i.subAttribute(n,"thread","parent"),subject:i.textSub(n,"subject"),$body:{get:function(){return i.getSubLangText(this.xml,n,"body",this.lang)}},body:{get:function(){return this.$body[this.lang]||""},set:function(e){i.setSubLangText(this.xml,n,"body",e,this.lang)}},attention:i.boolSub(r.Namespace.ATTENTION_0,"attention"),chatState:i.enumSub(r.Namespace.CHAT_STATES,["active","composing","paused","inactive","gone"]),replace:i.subAttribute(r.Namespace.CORRECTION_0,"replace","id"),requestReceipt:i.boolSub(r.Namespace.RECEIPTS,"request"),receipt:i.subAttribute(r.Namespace.RECEIPTS,"received","id")}})}};n.default=function(e){i.defineMessage(e,"message",r.Namespace.CLIENT),i.defineMessage(e,"serverMessage",r.Namespace.SERVER),i.defineMessage(e,"componentMessage",r.Namespace.COMPONENT)},t.exports=n.default},{"xmpp-constants":352}],128:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["afraid","amazed","amorous","angry","annoyed","anxious","aroused","ashamed","bored","brave","calm","cautious","cold","confident","confused","contemplative","contented","cranky","crazy","creative","curious","dejected","depressed","disappointed","disgusted","dismayed","distracted","embarrassed","envious","excited","flirtatious","frustrated","grateful","grieving","grumpy","guilty","happy","hopeful","hot","humbled","humiliated","hungry","hurt","impressed","in_awe","in_love","indignant","interested","intoxicated","invincible","jealous","lonely","lucky","mean","moody","nervous","neutral","offended","outraged","playful","proud","relaxed","relieved","remorseful","restless","sad","sarcastic","serious","shocked","shy","sick","sleepy","spontaneous","stressed","strong","surprised","thankful","thirsty","tired","undefined","weak","worried"];n.default=function(e){var t=e.define({name:"mood",namespace:r.Namespace.MOOD,element:"mood",fields:{text:e.utils.textSub(r.Namespace.MOOD,"text"),value:e.utils.enumSub(r.Namespace.MOOD,i)}});e.extendMessage(t),e.extendPubsubItem(t)},t.exports=n.default},{"xmpp-constants":352}],129:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");function i(e,t){return{get:function(){if(this._extensions[e])return this[e][t]},set:function(n){this[e][t]=n}}}n.default=function(e){var t=e.utils,n=e.define({name:"_mucUserItem",namespace:r.Namespace.MUC_USER,element:"item",fields:{affiliation:t.attribute("affiliation"),nick:t.attribute("nick"),jid:t.jidAttribute("jid"),role:t.attribute("role"),reason:t.textSub(r.Namespace.MUC_USER,"reason")}}),o=e.define({name:"_mucUserActor",namespace:r.Namespace.MUC_USER,element:"actor",fields:{nick:t.attribute("nick"),jid:t.jidAttribute("jid")}}),a=e.define({name:"destroyed",namespace:r.Namespace.MUC_USER,element:"destroy",fields:{jid:t.jidAttribute("jid"),reason:t.textSub(r.Namespace.MUC_USER,"reason")}}),s=e.define({name:"invite",namespace:r.Namespace.MUC_USER,element:"invite",fields:{to:t.jidAttribute("to"),from:t.jidAttribute("from"),reason:t.textSub(r.Namespace.MUC_USER,"reason"),thread:t.subAttribute(r.Namespace.MUC_USER,"continue","thread"),continue:t.boolSub(r.Namespace.MUC_USER,"continue")}}),c=e.define({name:"decline",namespace:r.Namespace.MUC_USER,element:"decline",fields:{to:t.jidAttribute("to"),from:t.jidAttribute("from"),reason:t.textSub(r.Namespace.MUC_USER,"reason")}}),u=e.define({name:"_mucAdminItem",namespace:r.Namespace.MUC_ADMIN,element:"item",fields:{affiliation:t.attribute("affiliation"),nick:t.attribute("nick"),jid:t.jidAttribute("jid"),role:t.attribute("role"),reason:t.textSub(r.Namespace.MUC_ADMIN,"reason")}}),l=e.define({name:"actor",namespace:r.Namespace.MUC_USER,element:"actor",fields:{nick:t.attribute("nick"),jid:t.jidAttribute("jid")}}),d=e.define({name:"destroy",namespace:r.Namespace.MUC_OWNER,element:"destroy",fields:{jid:t.jidAttribute("jid"),password:t.textSub(r.Namespace.MUC_OWNER,"password"),reason:t.textSub(r.Namespace.MUC_OWNER,"reason")}}),p=e.define({name:"muc",namespace:r.Namespace.MUC_USER,element:"x",fields:{affiliation:i("_mucUserItem","affiliation"),nick:i("_mucUserItem","nick"),jid:i("_mucUserItem","jid"),role:i("_mucUserItem","role"),actor:i("_mucUserItem","_mucUserActor"),reason:i("_mucUserItem","reason"),password:t.textSub(r.Namespace.MUC_USER,"password"),codes:{get:function(){return t.getMultiSubText(this.xml,r.Namespace.MUC_USER,"status",function(e){return t.getAttribute(e,"code")})},set:function(e){var n=this;t.setMultiSubText(this.xml,r.Namespace.MUC_USER,"status",e,function(e){var i=t.createElement(r.Namespace.MUC_USER,"status",r.Namespace.MUC_USER);t.setAttribute(i,"code",e),n.xml.appendChild(i)})}}}}),f=e.define({name:"mucAdmin",namespace:r.Namespace.MUC_ADMIN,element:"query",fields:{affiliation:i("_mucAdminItem","affiliation"),nick:i("_mucAdminItem","nick"),jid:i("_mucAdminItem","jid"),role:i("_mucAdminItem","role"),actor:i("_mucAdminItem","_mucAdminActor"),reason:i("_mucAdminItem","reason")}}),h=e.define({name:"mucOwner",namespace:r.Namespace.MUC_OWNER,element:"query"}),m=e.define({name:"joinMuc",namespace:r.Namespace.MUC,element:"x",fields:{password:t.textSub(r.Namespace.MUC,"password"),history:{get:function(){var e={},n=t.find(this.xml,r.Namespace.MUC,"history");if(!n.length)return{};var i=(n=n[0]).getAttribute("maxchars")||"",o=n.getAttribute("maxstanzas")||"",a=n.getAttribute("seconds")||"",s=n.getAttribute("since")||"";i&&(e.maxchars=parseInt(i,10)),o&&(e.maxstanzas=parseInt(o,10)),a&&(e.seconds=parseInt(a,10)),s&&(e.since=new Date(s))},set:function(e){var n=t.find(this.xml,r.Namespace.MUC,"history");if(n.length)for(var i=0;i<n.length;i++)this.xml.removeChild(n[i]);var o=t.createElement(r.Namespace.MUC,"history",r.Namespace.MUC);this.xml.appendChild(o),e.maxchars&&o.setAttribute("maxchars",""+e.maxchars),e.maxstanzas&&o.setAttribute("maxstanzas",""+e.maxstanzas),e.seconds&&o.setAttribute("seconds",""+e.seconds),e.since&&o.setAttribute("since",e.since.toISOString())}}}}),v=e.define({name:"mucInvite",namespace:r.Namespace.MUC_DIRECT_INVITE,element:"x",fields:{jid:t.jidAttribute("jid"),password:t.attribute("password"),reason:t.attribute("reason"),thread:t.attribute("thread"),continue:t.boolAttribute("continue")}});e.extend(n,o),e.extend(p,n),e.extend(p,s,"invites"),e.extend(p,c),e.extend(p,a),e.extend(u,l),e.extend(f,u,"items"),e.extend(h,d),e.extendPresence(p),e.extendPresence(m),e.extendMessage(p),e.extendMessage(v),e.withIQ(function(n){e.add(n,"mucUnique",t.textSub(r.Namespace.MUC_UNIQUE,"unique")),e.extend(n,f),e.extend(n,h)}),e.withDataForm(function(t){e.extend(h,t)})},t.exports=n.default},{"xmpp-constants":352}],130:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils.textSub(r.Namespace.NICK,"nick");e.withPubsubItem(function(n){e.add(n,"nick",t)}),e.withPresence(function(n){e.add(n,"nick",t)}),e.withMessage(function(n){e.add(n,"nick",t)})},t.exports=n.default},{"xmpp-constants":352}],131:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.define({name:"oob",element:"x",namespace:r.Namespace.OOB,fields:{url:e.utils.textSub(r.Namespace.OOB,"url"),desc:e.utils.textSub(r.Namespace.OOB,"desc")}});e.extendMessage(t,"oobURIs")},t.exports=n.default},{"xmpp-constants":352}],132:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.define({name:"ping",namespace:r.Namespace.PING,element:"ping"});e.extendIQ(t)},t.exports=n.default},{"xmpp-constants":352}],133:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i={definePresence:function(e,t,n){var i=e.utils;e.define({name:t,namespace:n,element:"presence",topLevel:!0,fields:{lang:i.langAttribute(),id:i.attribute("id"),to:i.jidAttribute("to",!0),from:i.jidAttribute("from",!0),priority:i.numberSub(n,"priority",!1,0),show:i.textSub(n,"show"),type:{get:function(){return i.getAttribute(this.xml,"type","available")},set:function(e){"available"===e&&(e=!1),i.setAttribute(this.xml,"type",e)}},$status:{get:function(){return i.getSubLangText(this.xml,n,"status",this.lang)}},status:{get:function(){return this.$status[this.lang]||""},set:function(e){i.setSubLangText(this.xml,n,"status",e,this.lang)}},idleSince:i.dateSubAttribute(r.Namespace.IDLE_1,"idle","since"),decloak:i.subAttribute(r.Namespace.DECLOAK_0,"decloak","reason"),avatarId:{get:function(){var e=i.find(this.xml,r.Namespace.VCARD_TEMP_UPDATE,"x");return e.length?i.getSubText(e[0],r.Namespace.VCARD_TEMP_UPDATE,"photo"):""},set:function(e){var t=i.findOrCreate(this.xml,r.Namespace.VCARD_TEMP_UPDATE,"x");if(""===e)i.setBoolSub(t,r.Namespace.VCARD_TEMP_UPDATE,"photo",!0);else{if(!0===e)return;e?i.setSubText(t,r.Namespace.VCARD_TEMP_UPDATE,"photo",e):this.xml.removeChild(t)}}}}})}};n.default=function(e){i.definePresence(e,"presence",r.Namespace.CLIENT),i.definePresence(e,"serverPresence",r.Namespace.SERVER),i.definePresence(e,"componentPresence",r.Namespace.COMPONENT)},t.exports=n.default},{"xmpp-constants":352}],134:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.define({name:"privateStorage",namespace:r.Namespace.PRIVATE,element:"query"});e.extendIQ(t)},t.exports=n.default},{"xmpp-constants":352}],135:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["server-unavailable","connection-paused"];n.default=function(e){var t=e.define({name:"state",namespace:r.Namespace.PSA,element:"state-annotation",fields:{from:e.utils.jidAttribute("from"),condition:e.utils.enumSub(r.Namespace.PSA,i),description:e.utils.textSub(r.Namespace.PSA,"description")}});e.extendPresence(t)},t.exports=n.default},{"xmpp-constants":352}],136:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"pubsub",namespace:r.Namespace.PUBSUB,element:"pubsub",fields:{create:{get:function(){var e=t.getSubAttribute(this.xml,r.Namespace.PUBSUB,"create","node");return e||t.getBoolSub(this.xml,r.Namespace.PUBSUB,"create")},set:function(e){!0!==e&&e?t.setSubAttribute(this.xml,r.Namespace.PUBSUB,"create","node",e):t.setBoolSub(this.xml,r.Namespace.PUBSUB,"create",e)}},publishOptions:{get:function(){var n=e.getDefinition("x",r.Namespace.DATAFORM),i=t.find(this.xml,r.Namespace.PUBSUB,"publish-options");if(i.length&&i[0].childNodes.length)return new n({},i[0].childNodes[0])},set:function(n){var i=e.getDefinition("x",r.Namespace.DATAFORM),o=t.findOrCreate(this.xml,r.Namespace.PUBSUB,"publish-options");if(n){var a=new i(n);o.appendChild(a.xml)}}}}}),i=e.define({name:"config",namespace:r.Namespace.PUBSUB,element:"configure"}),o=e.define({name:"subscribe",namespace:r.Namespace.PUBSUB,element:"subscribe",fields:{node:t.attribute("node"),jid:t.jidAttribute("jid")}}),a=e.define({name:"subscription",namespace:r.Namespace.PUBSUB,element:"subscription",fields:{node:t.attribute("node"),jid:t.jidAttribute("jid"),subid:t.attribute("subid"),type:t.attribute("subscription"),configurable:t.boolSub("subscribe-options"),configurationRequired:{get:function(){var e=t.find(this.xml,r.Namespace.PUBSUB,"subscribe-options");return!!e.length&&t.getBoolSub(e[0],r.Namespace.PUBSUB,"required")}}}}),s=e.define({name:"subscriptions",namespace:r.Namespace.PUBSUB,element:"subscriptions",fields:{node:t.attribute("node"),jid:t.jidAttribute("jid")}}),c=e.define({name:"affiliation",namespace:r.Namespace.PUBSUB,element:"affiliation",fields:{node:t.attribute("node"),type:t.attribute("affiliation")}}),u=e.define({name:"affiliations",namespace:r.Namespace.PUBSUB,element:"affiliations",fields:{node:t.attribute("node")}}),l=e.define({name:"subscriptionOptions",namespace:r.Namespace.PUBSUB,element:"options",fields:{node:t.attribute("node"),jid:t.jidAttribute("jid"),subid:t.attribute("subid")}}),d=e.define({name:"unsubscribe",namespace:r.Namespace.PUBSUB,element:"unsubscribe",fields:{node:t.attribute("node"),subid:t.attribute("subid"),jid:t.jidAttribute("jid")}}),p=e.define({name:"publish",namespace:r.Namespace.PUBSUB,element:"publish",fields:{node:t.attribute("node")}}),f=e.define({name:"retract",namespace:r.Namespace.PUBSUB,element:"retract",fields:{node:t.attribute("node"),notify:t.boolAttribute("notify"),id:t.subAttribute(r.Namespace.PUBSUB,"item","id")}}),h=e.define({name:"retrieve",namespace:r.Namespace.PUBSUB,element:"items",fields:{node:t.attribute("node"),max:t.attribute("max_items")}}),m=e.define({name:"item",namespace:r.Namespace.PUBSUB,element:"item",fields:{id:t.attribute("id"),publisher:t.jidAttribute("publisher")}});e.extend(n,i),e.extend(n,o),e.extend(n,d),e.extend(n,p),e.extend(n,f),e.extend(n,h),e.extend(n,a),e.extend(n,l),e.extend(n,s),e.extend(n,u),e.extend(p,m,"items"),e.extend(h,m,"items"),e.extend(s,a,"list"),e.extend(u,c,"list"),e.extendIQ(n),e.withDataForm(function(t){e.extend(l,t),e.extend(m,t),e.extend(i,t)}),e.withDefinition("set",r.Namespace.RSM,function(t){e.extend(n,t)})},t.exports=n.default},{"xmpp-constants":352}],137:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["closed-node","configuration-required","invalid-jid","invalid-options","invalid-payload","invalid-subid","item-forbidden","item-required","jid-required","max-items-exceeded","max-nodes-exceeded","nodeid-required","not-in-roster-group","not-subscribed","payload-too-big","payload-required","pending-subscription","presence-subscription-required","subid-required","too-many-subscriptions","unsupported","unsupported-access-model"];n.default=function(e){e.withStanzaError(function(t){e.add(t,"pubsubCondition",e.utils.enumSub(r.Namespace.PUBSUB_ERRORS,i)),e.add(t,"pubsubUnsupportedFeature",{get:function(){return e.utils.getSubAttribute(this.xml,r.Namespace.PUBSUB_ERRORS,"unsupported","feature")},set:function(t){t&&(this.pubsubCondition="unsupported"),e.utils.setSubAttribute(this.xml,r.Namespace.PUBSUB_ERRORS,"unsupported","feature",t)}})})},t.exports=n.default},{"xmpp-constants":352}],138:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"event",namespace:r.Namespace.PUBSUB_EVENT,element:"event"}),i=e.define({name:"purged",namespace:r.Namespace.PUBSUB_EVENT,element:"purge",fields:{node:t.attribute("node")}}),o=e.define({name:"deleted",namespace:r.Namespace.PUBSUB_EVENT,element:"delete",fields:{node:t.attribute("node"),redirect:t.subAttribute(r.Namespace.PUBSUB_EVENT,"redirect","uri")}}),a=e.define({name:"subscriptionChanged",namespace:r.Namespace.PUBSUB_EVENT,element:"subscription",fields:{node:t.attribute("node"),jid:t.jidAttribute("jid"),type:t.attribute("subscription"),subid:t.attribute("subid"),expiry:{get:function(){var e=t.getAttribute(this.xml,"expiry");return"presence"===e?e:e?new Date(e):void 0},set:function(e){e&&("string"!=typeof e&&(e=e.toISOString()),t.setAttribute(this.xml,"expiry",e))}}}}),s=e.define({name:"configurationChanged",namespace:r.Namespace.PUBSUB_EVENT,element:"configuration",fields:{node:t.attribute("node")}}),c=e.define({name:"updated",namespace:r.Namespace.PUBSUB_EVENT,element:"items",fields:{node:t.attribute("node"),retracted:{get:function(){var e=[];return t.find(this.xml,r.Namespace.PUBSUB_EVENT,"retract").forEach(function(t){e.push(t.getAttribute("id"))}),e},set:function(e){e.forEach(function(e){var n=t.createElement(r.Namespace.PUBSUB_EVENT,"retract",r.Namespace.PUBSUB_EVENT);n.setAttribute("id",e),this.xml.appendChild(n)})}}}}),u=e.define({name:"_eventItem",namespace:r.Namespace.PUBSUB_EVENT,element:"item",fields:{id:t.attribute("id"),node:t.attribute("node"),publisher:t.jidAttribute("publisher")}});e.extend(c,u,"published"),e.extend(n,c),e.extend(n,a),e.extend(n,s),e.extend(n,o),e.extend(n,i),e.extendMessage(n),e.withDataForm(function(t){e.extend(s,t)})},t.exports=n.default},{"xmpp-constants":352}],139:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"pubsubOwner",namespace:r.Namespace.PUBSUB_OWNER,element:"pubsub",fields:{purge:t.subAttribute(r.Namespace.PUBSUB_OWNER,"purge","node"),del:t.subAttribute(r.Namespace.PUBSUB_OWNER,"delete","node"),redirect:{get:function(){var e=t.find(this.xml,r.Namespace.PUBSUB_OWNER,"delete");return e.length?t.getSubAttribute(e[0],r.Namespace.PUBSUB_OWNER,"redirect","uri"):""},set:function(e){var n=t.findOrCreate(this.xml,r.Namespace.PUBSUB_OWNER,"delete");t.setSubAttribute(n,r.Namespace.PUBSUB_OWNER,"redirect","uri",e)}}}}),i=e.define({name:"subscription",namespace:r.Namespace.PUBSUB_OWNER,element:"subscription",fields:{node:t.attribute("node"),jid:t.jidAttribute("jid"),subid:t.attribute("subid"),type:t.attribute("subscription"),configurable:t.boolSub("subscribe-options"),configurationRequired:{get:function(){var e=t.find(this.xml,r.Namespace.PUBSUB_OWNER,"subscribe-options");return!!e.length&&t.getBoolSub(e[0],r.Namespace.PUBSUB_OWNER,"required")}}}}),o=e.define({name:"subscriptions",namespace:r.Namespace.PUBSUB_OWNER,element:"subscriptions",fields:{node:t.attribute("node")}}),a=e.define({name:"affiliation",namespace:r.Namespace.PUBSUB_OWNER,element:"affiliation",fields:{jid:t.jidAttribute("jid"),type:t.attribute("affiliation")}}),s=e.define({name:"affiliations",namespace:r.Namespace.PUBSUB_OWNER,element:"affiliations",fields:{node:t.attribute("node")}}),c=e.define({name:"config",namespace:r.Namespace.PUBSUB_OWNER,element:"configure",fields:{node:t.attribute("node")}});e.extend(n,c),e.extend(n,o),e.extend(n,s),e.extend(o,i,"list"),e.extend(s,a,"list"),e.extendIQ(n),e.withDataForm(function(t){e.extend(c,t)})},t.exports=n.default},{"xmpp-constants":352}],140:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"enablePush",element:"enable",namespace:r.Namespace.PUSH_0,fields:{jid:t.jidAttribute("jid"),node:t.attribute("node")}}),i=e.define({name:"disablePush",element:"disable",namespace:r.Namespace.PUSH_0,fields:{jid:t.jidAttribute("jid"),node:t.attribute("node")}}),o=e.define({name:"pushNotification",element:"notification",namespace:r.Namespace.PUSH_0});e.withDataForm(function(t){e.extend(o,t),e.extend(n,t)}),e.extendIQ(n),e.extendIQ(i)},t.exports=n.default},{"xmpp-constants":352}],141:[function(e,t,n){"use strict";var r=e("babel-runtime/helpers/interop-require-default").default;Object.defineProperty(n,"__esModule",{value:!0});var i=e("xmpp-constants"),o=r(e("lodash.foreach"));n.default=function(e){var t=e.utils,n=e.define({name:"_reachAddr",namespace:i.Namespace.REACH_0,element:"addr",fields:{uri:t.attribute("uri"),$desc:{get:function(){return t.getSubLangText(this.xml,i.Namespace.REACH_0,"desc",this.lang)}},desc:{get:function(){return this.$desc[this.lang]||""},set:function(e){t.setSubLangText(this.xml,i.Namespace.REACH_0,"desc",e,this.lang)}}}}),r={get:function(){var e=t.find(this.xml,i.Namespace.REACH_0,"reach"),r=[];if(e.length){var a=t.find(e[0],i.Namespace.REACH_0,"addr");(0,o.default)(a,function(e){r.push(new n({},e))})}return r},set:function(e){var r=t.findOrCreate(this.xml,i.Namespace.REACH_0,"reach");t.setAttribute(r,"xmlns",i.Namespace.REACH_0),(0,o.default)(e,function(e){var t=new n(e);r.appendChild(t.xml)})}};e.withPubsubItem(function(t){e.add(t,"reach",r)}),e.withPresence(function(t){e.add(t,"reach",r)})},t.exports=n.default},{"babel-runtime/helpers/interop-require-default":4,"lodash.foreach":182,"xmpp-constants":352}],142:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"register",namespace:r.Namespace.REGISTER,element:"query",fields:{instructions:t.textSub(r.Namespace.REGISTER,"instructions"),registered:t.boolSub(r.Namespace.REGISTER,"registered"),remove:t.boolSub(r.Namespace.REGISTER,"remove"),username:t.textSub(r.Namespace.REGISTER,"username"),nick:t.textSub(r.Namespace.REGISTER,"nick"),password:t.textSub(r.Namespace.REGISTER,"password"),name:t.textSub(r.Namespace.REGISTER,"name"),first:t.textSub(r.Namespace.REGISTER,"first"),last:t.textSub(r.Namespace.REGISTER,"last"),email:t.textSub(r.Namespace.REGISTER,"email"),address:t.textSub(r.Namespace.REGISTER,"address"),city:t.textSub(r.Namespace.REGISTER,"city"),state:t.textSub(r.Namespace.REGISTER,"state"),zip:t.textSub(r.Namespace.REGISTER,"zip"),phone:t.textSub(r.Namespace.REGISTER,"phone"),url:t.textSub(r.Namespace.REGISTER,"url"),date:t.textSub(r.Namespace.REGISTER,"date"),misc:t.textSub(r.Namespace.REGISTER,"misc"),text:t.textSub(r.Namespace.REGISTER,"text"),key:t.textSub(r.Namespace.REGISTER,"key")}});e.extendIQ(n),e.withDefinition("x",r.Namespace.OOB,function(t){e.extend(n,t)}),e.withDataForm(function(t){e.extend(n,t)})},t.exports=n.default},{"xmpp-constants":352}],143:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"roster",namespace:r.Namespace.ROSTER,element:"query",fields:{ver:{get:function(){return t.getAttribute(this.xml,"ver")},set:function(e){var n=""===e;t.setAttribute(this.xml,"ver",e,n)}}}}),i=e.define({name:"_rosterItem",namespace:r.Namespace.ROSTER,element:"item",fields:{jid:t.jidAttribute("jid",!0),name:t.attribute("name"),subscription:t.attribute("subscription","none"),subscriptionRequested:{get:function(){return"subscribe"===t.getAttribute(this.xml,"ask")}},preApproved:t.boolAttribute(r.Namespace.ROSTER,"approved"),groups:t.multiTextSub(r.Namespace.ROSTER,"group")}});e.extend(n,i,"items"),e.extendIQ(n)},t.exports=n.default},{"xmpp-constants":352}],144:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils;e.define({name:"rsm",namespace:r.Namespace.RSM,element:"set",fields:{after:t.textSub(r.Namespace.RSM,"after"),before:{get:function(){return t.getSubText(this.xml,r.Namespace.RSM,"before")},set:function(e){!0===e?t.findOrCreate(this.xml,r.Namespace.RSM,"before"):t.setSubText(this.xml,r.Namespace.RSM,"before",e)}},count:t.numberSub(r.Namespace.RSM,"count",!1,0),first:t.textSub(r.Namespace.RSM,"first"),firstIndex:t.subAttribute(r.Namespace.RSM,"first","index"),index:t.textSub(r.Namespace.RSM,"index"),last:t.textSub(r.Namespace.RSM,"last"),max:t.textSub(r.Namespace.RSM,"max")}})},t.exports=n.default},{"xmpp-constants":352}],145:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n={get:function(){var e=t.find(this.xml,r.Namespace.JINGLE_RTP_RTCP_FB_0,"rtcp-fb"),n=[];return e.forEach(function(e){n.push({type:t.getAttribute(e,"type"),subtype:t.getAttribute(e,"subtype")})}),(e=t.find(this.xml,r.Namespace.JINGLE_RTP_RTCP_FB_0,"rtcp-fb-trr-int")).forEach(function(e){n.push({type:t.getAttribute(e,"type"),value:t.getAttribute(e,"value")})}),n},set:function(e){var n=this,i=t.find(this.xml,r.Namespace.JINGLE_RTP_RTCP_FB_0,"rtcp-fb");i.forEach(function(e){n.xml.removeChild(e)}),(i=t.find(this.xml,r.Namespace.JINGLE_RTP_RTCP_FB_0,"rtcp-fb-trr-int")).forEach(function(e){n.xml.removeChild(e)}),e.forEach(function(e){var i=void 0;"trr-int"===e.type?(i=t.createElement(r.Namespace.JINGLE_RTP_RTCP_FB_0,"rtcp-fb-trr-int",r.Namespace.JINGLE_RTP_1),t.setAttribute(i,"type",e.type),t.setAttribute(i,"value",e.value)):(i=t.createElement(r.Namespace.JINGLE_RTP_RTCP_FB_0,"rtcp-fb",r.Namespace.JINGLE_RTP_1),t.setAttribute(i,"type",e.type),t.setAttribute(i,"subtype",e.subtype)),n.xml.appendChild(i)})}},i=e.define({name:"bandwidth",namespace:r.Namespace.JINGLE_RTP_1,element:"bandwidth",fields:{type:t.attribute("type"),bandwidth:t.text()}}),o=e.define({name:"_rtp",namespace:r.Namespace.JINGLE_RTP_1,element:"description",tags:["jingle-application"],fields:{applicationType:{value:"rtp"},media:t.attribute("media"),ssrc:t.attribute("ssrc"),mux:t.boolSub(r.Namespace.JINGLE_RTP_1,"rtcp-mux"),encryption:{get:function(){var e=t.find(this.xml,r.Namespace.JINGLE_RTP_1,"encryption");if(!e.length)return[];e=e[0];var n=this,i=t.find(e,r.Namespace.JINGLE_RTP_1,"crypto"),o=[];return i.forEach(function(e){o.push(new s({},e,n).toJSON())}),o},set:function(e){var n=t.find(this.xml,r.Namespace.JINGLE_RTP_1,"encryption");if(n.length&&this.xml.removeChild(n),e.length){t.setBoolSubAttribute(this.xml,r.Namespace.JINGLE_RTP_1,"encryption","required",!0),n=t.find(this.xml,r.Namespace.JINGLE_RTP_1,"encryption")[0];var i=this;e.forEach(function(e){var t=new s(e,null,i);n.appendChild(t.xml)})}}},feedback:n,headerExtensions:{get:function(){var e=t.find(this.xml,r.Namespace.JINGLE_RTP_HDREXT_0,"rtp-hdrext"),n=[];return e.forEach(function(e){n.push({id:t.getAttribute(e,"id"),uri:t.getAttribute(e,"uri"),senders:t.getAttribute(e,"senders")})}),n},set:function(e){var n=this;t.find(this.xml,r.Namespace.JINGLE_RTP_HDREXT_0,"rtp-hdrext").forEach(function(e){n.xml.removeChild(e)}),e.forEach(function(e){var i=t.createElement(r.Namespace.JINGLE_RTP_HDREXT_0,"rtp-hdrext",r.Namespace.JINGLE_RTP_1);t.setAttribute(i,"id",e.id),t.setAttribute(i,"uri",e.uri),t.setAttribute(i,"senders",e.senders),n.xml.appendChild(i)})}}}}),a=e.define({name:"_payloadType",namespace:r.Namespace.JINGLE_RTP_1,element:"payload-type",fields:{channels:t.attribute("channels"),clockrate:t.attribute("clockrate"),id:t.attribute("id"),maxptime:t.attribute("maxptime"),name:t.attribute("name"),ptime:t.attribute("ptime"),feedback:n,parameters:{get:function(){var e=[];return t.find(this.xml,r.Namespace.JINGLE_RTP_1,"parameter").forEach(function(n){e.push({key:t.getAttribute(n,"name"),value:t.getAttribute(n,"value")})}),e},set:function(e){var n=this;e.forEach(function(e){var i=t.createElement(r.Namespace.JINGLE_RTP_1,"parameter");t.setAttribute(i,"name",e.key),t.setAttribute(i,"value",e.value),n.xml.appendChild(i)})}}}}),s=e.define({name:"crypto",namespace:r.Namespace.JINGLE_RTP_1,element:"crypto",fields:{cipherSuite:t.attribute("crypto-suite"),keyParams:t.attribute("key-params"),sessionParams:t.attribute("session-params"),tag:t.attribute("tag")}}),c=e.define({name:"_group",namespace:r.Namespace.JINGLE_GROUPING_0,element:"group",fields:{semantics:t.attribute("semantics"),contents:t.multiSubAttribute(r.Namespace.JINGLE_GROUPING_0,"content","name")}}),u=e.define({name:"mute",namespace:r.Namespace.JINGLE_RTP_INFO_1,element:"mute",fields:{creator:t.attribute("creator"),name:t.attribute("name")}}),l=e.define({name:"unmute",namespace:r.Namespace.JINGLE_RTP_INFO_1,element:"unmute",fields:{creator:t.attribute("creator"),name:t.attribute("name")}});e.extend(o,i),e.extend(o,a,"payloads"),e.withDefinition("content",r.Namespace.JINGLE_1,function(t){e.extend(t,o)}),e.withDefinition("jingle",r.Namespace.JINGLE_1,function(n){e.extend(n,u),e.extend(n,l),e.extend(n,c,"groups"),e.add(n,"ringing",t.boolSub(r.Namespace.JINGLE_RTP_INFO_1,"ringing")),e.add(n,"hold",t.boolSub(r.Namespace.JINGLE_RTP_INFO_1,"hold")),e.add(n,"active",t.boolSub(r.Namespace.JINGLE_RTP_INFO_1,"active"))})},t.exports=n.default},{"xmpp-constants":352}],146:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i={insert:"t",erase:"e",wait:"w"},o={t:"insert",e:"erase",w:"wait"};n.default=function(e){var t=e.utils,n=e.define({name:"rtt",namespace:r.Namespace.RTT_0,element:"rtt",fields:{id:t.attribute("id"),event:t.attribute("event","edit"),seq:t.numberAttribute("seq"),actions:{get:function(){for(var e=[],n=0,i=this.xml.childNodes.length;n<i;n++){var a=this.xml.childNodes[n],s=a.localName,c={};if(a.namespaceURI===r.Namespace.RTT_0&&o[s]){c.type=o[s];var u=t.getAttribute(a,"p");u&&(c.pos=parseInt(u,10));var l=t.getAttribute(a,"n");l&&(c.num=parseInt(l,10));var d=t.getText(a);d&&"t"===s&&(c.text=d),e.push(c)}}return e},set:function(e){for(var n=this,o=0,a=this.xml.childNodes.length;o<a;o++)this.xml.removeChild(this.xml.childNodes[o]);e.forEach(function(e){if(i[e.type]){var o=t.createElement(r.Namespace.RTT_0,i[e.type],r.Namespace.RTT_0);void 0!==e.pos&&t.setAttribute(o,"p",e.pos.toString()),e.num&&t.setAttribute(o,"n",e.num.toString()),e.text&&t.setText(o,e.text),n.xml.appendChild(o)}})}}}});e.extendMessage(n)},t.exports=n.default},{"xmpp-constants":352}],147:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["aborted","account-disabled","credentials-expired","encryption-required","incorrect-encoding","invalid-authzid","invalid-mechanism","malformed-request","mechanism-too-weak","not-authorized","temporary-auth-failure"];n.default=function(e){var t=e.utils,n=e.define({name:"sasl",namespace:r.Namespace.SASL,element:"mechanisms",fields:{mechanisms:t.multiTextSub(r.Namespace.SASL,"mechanism")}});e.define({name:"saslAuth",eventName:"sasl:auth",namespace:r.Namespace.SASL,element:"auth",topLevel:!0,fields:{value:t.text(),mechanism:t.attribute("mechanism")}}),e.define({name:"saslChallenge",eventName:"sasl:challenge",namespace:r.Namespace.SASL,element:"challenge",topLevel:!0,fields:{value:t.text()}}),e.define({name:"saslResponse",eventName:"sasl:response",namespace:r.Namespace.SASL,element:"response",topLevel:!0,fields:{value:t.text()}}),e.define({name:"saslAbort",eventName:"sasl:abort",namespace:r.Namespace.SASL,element:"abort",topLevel:!0}),e.define({name:"saslSuccess",eventName:"sasl:success",namespace:r.Namespace.SASL,element:"success",topLevel:!0,fields:{value:t.text()}}),e.define({name:"saslFailure",eventName:"sasl:failure",namespace:r.Namespace.SASL,element:"failure",topLevel:!0,fields:{lang:{get:function(){return this._lang||""},set:function(e){this._lang=e}},condition:t.enumSub(r.Namespace.SASL,i),$text:{get:function(){return t.getSubLangText(this.xml,r.Namespace.SASL,"text",this.lang)}},text:{get:function(){return this.$text[this.lang]||""},set:function(e){t.setSubLangText(this.xml,r.Namespace.SASL,"text",e,this.lang)}}}}),e.extendStreamFeatures(n)},t.exports=n.default},{"xmpp-constants":352}],148:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.define({name:"session",namespace:r.Namespace.SESSION,element:"session",fields:{required:e.utils.boolSub(r.Namespace.SESSION,"required"),optional:e.utils.boolSub(r.Namespace.SESSION,"optional")}});e.extendIQ(t),e.extendStreamFeatures(t)},t.exports=n.default},{"xmpp-constants":352}],149:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n={get:function(){var e=t.find(this.xml,r.Namespace.SHIM,"headers");return e.length?t.getMultiSubText(e[0],r.Namespace.SHIM,"header",function(e){var n=t.getAttribute(e,"name");if(n)return{name:n,value:t.getText(e)}}):[]},set:function(n){var i=t.findOrCreate(this.xml,r.Namespace.SHIM,"headers");e.setMultiSubText(i,r.Namespace.SHIM,"header",n,function(e){var n=t.createElement(r.Namespace.SHIM,"header",r.Namespace.SHIM);t.setAttribute(n,"name",e.name),t.setText(n,e.value),i.appendChild(n)})}};e.withMessage(function(t){e.add(t,"headers",n)}),e.withPresence(function(t){e.add(t,"headers",n)})},t.exports=n.default},{"xmpp-constants":352}],150:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"streamManagement",namespace:r.Namespace.SMACKS_3,element:"sm"});e.define({name:"smEnable",eventName:"stream:management:enable",namespace:r.Namespace.SMACKS_3,element:"enable",topLevel:!0,fields:{resume:t.boolAttribute("resume")}}),e.define({name:"smEnabled",eventName:"stream:management:enabled",namespace:r.Namespace.SMACKS_3,element:"enabled",topLevel:!0,fields:{id:t.attribute("id"),resume:t.boolAttribute("resume")}}),e.define({name:"smResume",eventName:"stream:management:resume",namespace:r.Namespace.SMACKS_3,element:"resume",topLevel:!0,fields:{h:t.numberAttribute("h",!1,0),previd:t.attribute("previd")}}),e.define({name:"smResumed",eventName:"stream:management:resumed",namespace:r.Namespace.SMACKS_3,element:"resumed",topLevel:!0,fields:{h:t.numberAttribute("h",!1,0),previd:t.attribute("previd")}}),e.define({name:"smFailed",eventName:"stream:management:failed",namespace:r.Namespace.SMACKS_3,element:"failed",topLevel:!0}),e.define({name:"smAck",eventName:"stream:management:ack",namespace:r.Namespace.SMACKS_3,element:"a",topLevel:!0,fields:{h:t.numberAttribute("h",!1,0)}}),e.define({name:"smRequest",eventName:"stream:management:request",namespace:r.Namespace.SMACKS_3,element:"r",topLevel:!0}),e.extendStreamFeatures(n)},t.exports=n.default},{"xmpp-constants":352}],151:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils;e.define({name:"stream",namespace:r.Namespace.STREAM,element:"stream",fields:{lang:t.langAttribute(),id:t.attribute("id"),version:t.attribute("version","1.0"),to:t.jidAttribute("to",!0),from:t.jidAttribute("from",!0)}})},t.exports=n.default},{"xmpp-constants":352}],152:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["bad-format","bad-namespace-prefix","conflict","connection-timeout","host-gone","host-unknown","improper-addressing","internal-server-error","invalid-from","invalid-namespace","invalid-xml","not-authorized","not-well-formed","policy-violation","remote-connection-failed","reset","resource-constraint","restricted-xml","see-other-host","system-shutdown","undefined-condition","unsupported-encoding","unsupported-feature","unsupported-stanza-type","unsupported-version"];n.default=function(e){var t=e.utils;e.define({name:"streamError",namespace:r.Namespace.STREAM,element:"error",topLevel:!0,fields:{lang:{get:function(){return this._lang||""},set:function(e){this._lang=e}},condition:t.enumSub(r.Namespace.STREAM_ERROR,i),seeOtherHost:{get:function(){return t.getSubText(this.xml,r.Namespace.STREAM_ERROR,"see-other-host")},set:function(e){this.condition="see-other-host",t.setSubText(this.xml,r.Namespace.STREAM_ERROR,"see-other-host",e)}},$text:{get:function(){return t.getSubLangText(this.xml,r.Namespace.STREAM_ERROR,"text",this.lang)}},text:{get:function(){return this.$text[this.lang]||""},set:function(e){t.setSubLangText(this.xml,r.Namespace.STREAM_ERROR,"text",e,this.lang)}}}})},t.exports=n.default},{"xmpp-constants":352}],153:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){e.define({name:"streamFeatures",namespace:r.Namespace.STREAM,element:"features",topLevel:!0});var t=e.define({name:"rosterVersioning",namespace:r.Namespace.ROSTER_VERSIONING,element:"ver"}),n=e.define({name:"subscriptionPreApproval",namespace:r.Namespace.SUBSCRIPTION_PREAPPROVAL,element:"sub"});e.extendStreamFeatures(t),e.extendStreamFeatures(n)},t.exports=n.default},{"xmpp-constants":352}],154:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.define({name:"time",namespace:r.Namespace.TIME,element:"time",fields:{utc:e.utils.dateSub(r.Namespace.TIME,"utc"),tzo:e.utils.tzoSub(r.Namespace.TIME,"tzo",0)}});e.extendIQ(t)},t.exports=n.default},{"xmpp-constants":352}],155:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"tune",namespace:r.Namespace.TUNE,element:"tune",fields:{artist:t.textSub(r.Namespace.TUNE,"artist"),length:t.numberSub(r.Namespace.TUNE,"length"),rating:t.numberSub(r.Namespace.TUNE,"rating"),source:t.textSub(r.Namespace.TUNE,"source"),title:t.textSub(r.Namespace.TUNE,"title"),track:t.textSub(r.Namespace.TUNE,"track"),uri:t.textSub(r.Namespace.TUNE,"uri")}});e.extendPubsubItem(n),e.extendMessage(n)},t.exports=n.default},{"xmpp-constants":352}],156:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.utils,n=e.define({name:"vCardTemp",namespace:r.Namespace.VCARD_TEMP,element:"vCard",fields:{role:t.textSub(r.Namespace.VCARD_TEMP,"ROLE"),website:t.textSub(r.Namespace.VCARD_TEMP,"URL"),title:t.textSub(r.Namespace.VCARD_TEMP,"TITLE"),description:t.textSub(r.Namespace.VCARD_TEMP,"DESC"),fullName:t.textSub(r.Namespace.VCARD_TEMP,"FN"),birthday:t.dateSub(r.Namespace.VCARD_TEMP,"BDAY"),nicknames:t.multiTextSub(r.Namespace.VCARD_TEMP,"NICKNAME"),jids:t.multiTextSub(r.Namespace.VCARD_TEMP,"JABBERID")}}),i=e.define({name:"_email",namespace:r.Namespace.VCARD_TEMP,element:"EMAIL",fields:{email:t.textSub(r.Namespace.VCARD_TEMP,"USERID"),home:t.boolSub(r.Namespace.VCARD_TEMP,"HOME"),work:t.boolSub(r.Namespace.VCARD_TEMP,"WORK"),preferred:t.boolSub(r.Namespace.VCARD_TEMP,"PREF")}}),o=e.define({name:"_tel",namespace:r.Namespace.VCARD_TEMP,element:"TEL",fields:{number:t.textSub(r.Namespace.VCARD_TEMP,"NUMBER"),home:t.boolSub(r.Namespace.VCARD_TEMP,"HOME"),work:t.boolSub(r.Namespace.VCARD_TEMP,"WORK"),mobile:t.boolSub(r.Namespace.VCARD_TEMP,"CELL"),preferred:t.boolSub(r.Namespace.VCARD_TEMP,"PREF")}}),a=e.define({name:"_address",namespace:r.Namespace.VCARD_TEMP,element:"ADR",fields:{street:t.textSub(r.Namespace.VCARD_TEMP,"STREET"),street2:t.textSub(r.Namespace.VCARD_TEMP,"EXTADD"),country:t.textSub(r.Namespace.VCARD_TEMP,"CTRY"),city:t.textSub(r.Namespace.VCARD_TEMP,"LOCALITY"),region:t.textSub(r.Namespace.VCARD_TEMP,"REGION"),postalCode:t.textSub(r.Namespace.VCARD_TEMP,"PCODE"),pobox:t.textSub(r.Namespace.VCARD_TEMP,"POBOX"),home:t.boolSub(r.Namespace.VCARD_TEMP,"HOME"),work:t.boolSub(r.Namespace.VCARD_TEMP,"WORK"),preferred:t.boolSub(r.Namespace.VCARD_TEMP,"PREF")}}),s=e.define({name:"organization",namespace:r.Namespace.VCARD_TEMP,element:"ORG",fields:{name:t.textSub(r.Namespace.VCARD_TEMP,"ORGNAME"),unit:t.textSub(r.Namespace.VCARD_TEMP,"ORGUNIT")}}),c=e.define({name:"name",namespace:r.Namespace.VCARD_TEMP,element:"N",fields:{family:t.textSub(r.Namespace.VCARD_TEMP,"FAMILY"),given:t.textSub(r.Namespace.VCARD_TEMP,"GIVEN"),middle:t.textSub(r.Namespace.VCARD_TEMP,"MIDDLE"),prefix:t.textSub(r.Namespace.VCARD_TEMP,"PREFIX"),suffix:t.textSub(r.Namespace.VCARD_TEMP,"SUFFIX")}}),u=e.define({name:"photo",namespace:r.Namespace.VCARD_TEMP,element:"PHOTO",fields:{type:t.textSub(r.Namespace.VCARD_TEMP,"TYPE"),data:t.textSub(r.Namespace.VCARD_TEMP,"BINVAL"),url:t.textSub(r.Namespace.VCARD_TEMP,"EXTVAL")}});e.extend(n,i,"emails"),e.extend(n,a,"addresses"),e.extend(n,o,"phoneNumbers"),e.extend(n,s),e.extend(n,c),e.extend(n,u),e.extendIQ(n)},t.exports=n.default},{"xmpp-constants":352}],157:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){var t=e.define({name:"version",namespace:r.Namespace.VERSION,element:"query",fields:{name:e.utils.textSub(r.Namespace.VERSION,"name"),version:e.utils.textSub(r.Namespace.VERSION,"version"),os:e.utils.textSub(r.Namespace.VERSION,"os")}});e.extendIQ(t)},t.exports=n.default},{"xmpp-constants":352}],158:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n.default=function(e){e.withIQ(function(t){e.add(t,"visible",e.utils.boolSub(r.Namespace.INVISIBLE_0,"visible")),e.add(t,"invisible",e.utils.boolSub(r.Namespace.INVISIBLE_0,"invisible"))})},t.exports=n.default},{"xmpp-constants":352}],159:[function(e,t,n){"use strict";var r=e("lodash.assign"),i=e("uuid"),o=e("./lib/types"),a=e("./lib/helpers"),s=e("./lib/stanza");function c(){this._LOOKUP={},this._LOOKUP_EXT={},this._TAGS={},this._CB_DEFINITION={},this._CB_TAG={},this._ID=i.v4(),this.utils=r({},o,a)}c.prototype.use=function(e){return e&&"function"==typeof e?(e["__JXT_LOADED_"+this._ID]||(e(this),e["__JXT_LOADED_"+this._ID]=!0),this):this},c.prototype.getDefinition=function(e,t,n){var r=this._LOOKUP[t+"|"+e];if(n&&!r)throw new Error("Could not find definition for <"+e+' xmlns="'+t+'" />');return r},c.prototype.getExtensions=function(e,t){return this._LOOKUP_EXT[t+"|"+e]||{}},c.prototype.withDefinition=function(e,t,n){var r=t+"|"+e;this._CB_DEFINITION[r]||(this._CB_DEFINITION[r]=[]),this._CB_DEFINITION[r].push(n),this._LOOKUP[r]&&n(this._LOOKUP[r])},c.prototype.withTag=function(e,t){this._CB_TAG[e]||(this._CB_TAG[e]=[]),this._CB_TAG[e].push(t),this.tagged(e).forEach(function(e){t(e)})},c.prototype.tagged=function(e){return this._TAGS[e]||[]},c.prototype.build=function(e){var t=this.getDefinition(e.localName,e.namespaceURI);if(t)return new t(null,e)},c.prototype.parse=function(e){var t=a.parse(e);if(t)return this.build(t)},c.prototype.extend=function(e,t,n,r){var i=e.prototype._NS+"|"+e.prototype._EL,a=t.prototype._name,s=t.prototype._NS+"|"+t.prototype._EL;this._LOOKUP[s]=t,this._LOOKUP_EXT[s]||(this._LOOKUP_EXT[s]={}),this._LOOKUP_EXT[i]||(this._LOOKUP_EXT[i]={}),this._LOOKUP_EXT[i][a]=t,(!n||n&&!r)&&this.add(e,a,o.extension(t)),n&&this.add(e,n,o.multiExtension(t))},c.prototype.add=function(e,t,n){n.enumerable=!0,Object.defineProperty(e.prototype,t,n)},c.prototype.define=function(e){var t=this,n=s(this,e),r=n.prototype._NS,i=n.prototype._EL,o=n.prototype._TAGS,a=r+"|"+i;return this._LOOKUP[a]=n,o.forEach(function(e){t._TAGS[e]||(t._TAGS[e]=[]),t._TAGS[e].push(n)}),Object.keys(e.fields||{}).forEach(function(r){t.add(n,r,e.fields[r])}),this._CB_DEFINITION[a]&&this._CB_DEFINITION[a].forEach(function(e){e(n)}),o.forEach(function(e){t._CB_TAG[e]&&t._CB_TAG[e].forEach(function(e){e(n)})}),n},c.createRegistry=function(){return new c},r(c,a),r(c,o);var u=new c;c.define=u.define.bind(u),c.extend=u.extend.bind(u),c.add=u.add.bind(u),c.parse=u.parse.bind(u),c.build=u.build.bind(u),c.getExtensions=u.getExtensions.bind(u),c.getDefinition=u.getDefinition.bind(u),c.withDefinition=u.withDefinition.bind(u),c.withTag=u.withTag.bind(u),c.tagged=u.tagged.bind(u),c.getGlobalJXT=function(){return u},t.exports=c},{"./lib/helpers":160,"./lib/stanza":161,"./lib/types":162,"lodash.assign":179,uuid:332}],160:[function(e,t,n){"use strict";var r=e("ltx"),i=e("ltx/lib/DOMElement"),o=n.XML_NS="http://www.w3.org/XML/1998/namespace";n.parse=function(e){var t=r.parse(e,{Element:i});if(1===t.nodeType)return t},n.createElement=function(e,t,r){var o=new i(t);return r&&r===e||n.setAttribute(o,"xmlns",e),o};var a=n.find=function(e,t,n){for(var r=[],i=e.getElementsByTagName(n),o=0,a=i.length;o<a;o++){var s=i[o];s.namespaceURI===t&&s.parentNode===e&&r.push(s)}return r};n.findOrCreate=function(e,t,r){var i=n.find(e,t,r);if(i.length)return i[0];var o=n.createElement(t,r,e.namespaceURI);return e.appendChild(o),o},n.getAttribute=function(e,t,n){return e.getAttribute(t)||n||""},n.getAttributeNS=function(e,t,n,r){return e.getAttributeNS(t,n)||r||""},n.setAttribute=function(e,t,n,r){n||r?e.setAttribute(t,n):e.removeAttribute(t)},n.setAttributeNS=function(e,t,n,r,i){r||i?e.setAttributeNS(t,n,r):e.removeAttributeNS(t,n)},n.getBoolAttribute=function(e,t,n){var r=e.getAttribute(t)||n||"";return"true"===r||"1"===r},n.setBoolAttribute=function(e,t,n){n?e.setAttribute(t,"1"):e.removeAttribute(t)},n.getSubAttribute=function(e,t,n,r,i){var o=a(e,t,n);if(!o)return"";for(var s=0;s<o.length;s++)return o[s].getAttribute(r)||i||"";return""},n.setSubAttribute=function(e,t,r,i,o){var s=a(e,t,r);if(s.length)for(var c=0;c<s.length;c++){if(o)return void s[c].setAttribute(i,o);s[c].removeAttribute(i)}else o&&((r=n.createElement(t,r,e.namespaceURI)).setAttribute(i,o),e.appendChild(r))},n.getBoolSubAttribute=function(e,t,n,r,i){var o=e.getSubAttribute(t,n,r)||i||"";return"true"===o||"1"===o},n.setBoolSubAttribute=function(e,t,r,i,o){o=o?"1":"",n.setSubAttribute(e,t,r,i,o)},n.getText=function(e){return e.textContent},n.setText=function(e,t){e.textContent=t},n.getSubText=n.getTextSub=function(e,t,n,r){var i=a(e,t,n);return r=r||"",i.length&&i[0].textContent||r},n.setSubText=n.setTextSub=function(e,t,r,i){var o=a(e,t,r);if(o.length)for(var s=0;s<o.length;s++)e.removeChild(o[s]);if(i){var c=n.createElement(t,r,e.namespaceURI);!0!==i&&(c.textContent=i),e.appendChild(c)}},n.getMultiSubText=function(e,t,n,r){var i=a(e,t,n),o=[];r=r||function(e){return e.textContent||""};for(var s=0;s<i.length;s++)o.push(r(i[s]));return o},n.setMultiSubText=function(e,t,r,i,o){var s,c,u=a(e,t,r),l=[];for(o=o||function(i){if(i){var o=n.createElement(t,r,e.namespaceURI);o.textContent=i,e.appendChild(o)}},l="string"==typeof i?(i||"").split("\n"):i,s=0,c=u.length;s<c;s++)e.removeChild(u[s]);for(s=0,c=l.length;s<c;s++)o(l[s])},n.getMultiSubAttribute=function(e,t,r,i){return n.getMultiSubText(e,t,r,function(e){return n.getAttribute(e,i)})},n.setMultiSubAttribute=function(e,t,r,i,o){n.setMultiSubText(e,t,r,o,function(o){var a=n.createElement(t,r,e.namespaceURI);n.setAttribute(a,i,o),e.appendChild(a)})},n.getSubLangText=function(e,t,n,r){var i,s,c=a(e,t,n);if(!c.length)return{};for(var u={},l=[],d=0;d<c.length;d++)i=(s=c[d]).getAttributeNS(o,"lang")||r,l.push(i),u[i]=s.textContent||"";return u},n.setSubLangText=function(e,t,r,i,s){var c,u,l=a(e,t,r);if(l.length)for(var d=0;d<l.length;d++)e.removeChild(l[d]);if("string"==typeof i)(c=n.createElement(t,r,e.namespaceURI)).textContent=i,e.appendChild(c);else if("object"==typeof i)for(u in i)i.hasOwnProperty(u)&&(c=n.createElement(t,r,e.namespaceURI),u!==s&&c.setAttributeNS(o,"lang",u),c.textContent=i[u],e.appendChild(c))},n.getBoolSub=function(e,t,n){return!!a(e,t,n).length},n.setBoolSub=function(e,t,r,i){var o=a(e,t,r);if(o.length)for(var s=0;s<o.length;s++){if(i)return;e.removeChild(o[s])}else if(i){var c=n.createElement(t,r,e.namespaceURI);e.appendChild(c)}}},{ltx:190,"ltx/lib/DOMElement":191}],161:[function(e,t,n){"use strict";var r=e("./helpers"),i=e("lodash.assign"),o={constructor:!0,parent:!0,prototype:!0,toJSON:!0,toString:!0,xml:!0};t.exports=function(e,t){function n(n,o,a){var s=this,c=((o||{}).parentNode||(a||{}).xml||{}).namespaceURI;s.xml=o||r.createElement(s._NS,s._EL,c),Object.keys(s._PREFIXES).forEach(function(e){var t=s._PREFIXES[e];s.xml.setAttribute("xmlns:"+e,t)}),s._extensions={};for(var u=0,l=s.xml.childNodes.length;u<l;u++){var d=s.xml.childNodes[u],p=e.getDefinition(d.localName,d.namespaceURI);if(void 0!==p){var f=p.prototype._name;s._extensions[f]=new p(null,d),s._extensions[f].parent=s}}return i(s,n),t.init&&t.init.apply(s,[n]),s}return n.prototype._isJXT=!0,n.prototype._name=t.name,n.prototype._eventname=t.eventName,n.prototype._NS=t.namespace,n.prototype._EL=t.element||t.name,n.prototype._PREFIXES=t.prefixes||{},n.prototype._TAGS=t.tags||[],n.prototype.toString=function(){return this.xml.toString()},n.prototype.toJSON=function(){var t,n={};for(t in this._extensions)this._extensions[t].toJSON&&"_"!==t[0]&&(n[t]=this._extensions[t].toJSON());for(t in this){var r=!o[t]&&"_"!==t[0],i=e.getExtensions(this._EL,this._NS)[t];if(r&&!i){var a=this[t];if("function"==typeof a)continue;var s=Object.prototype.toString.call(a);if(s.indexOf("Object")>=0)Object.keys(a).length>0&&(a._isJXT?n[t]=a.toJSON():n[t]=a);else if(s.indexOf("Array")>=0){if(a.length>0){for(var c=[],u=a.length,l=0;l<u;l++){var d=a[l];void 0!==d&&(d._isJXT?c.push(d.toJSON()):c.push(d))}n[t]=c}}else void 0!==a&&!1!==a&&""!==a&&(n[t]=a)}}return n},n}},{"./helpers":160,"lodash.assign":179}],162:[function(e,t,n){(function(t){"use strict";var r=e("./helpers"),i=e("lodash.assign"),o=r.find,a=r.createElement,s=n.field=function(e,t){return function(){var n=Array.prototype.slice.call(arguments);return{get:function(){return e.apply(null,[this.xml].concat(n))},set:function(e){t.apply(null,[this.xml].concat(n).concat([e]))}}}};n.boolAttribute=s(r.getBoolAttribute,r.setBoolAttribute),n.subAttribute=s(r.getSubAttribute,r.setSubAttribute),n.boolSubAttribute=s(r.getSubBoolAttribute,r.setSubBoolAttribute),n.text=s(r.getText,r.setText),n.textSub=n.subText=s(r.getSubText,r.setSubText),n.multiTextSub=n.multiSubText=s(r.getMultiSubText,r.setMultiSubText),n.multiSubAttribute=s(r.getMultiSubAttribute,r.setMultiSubAttribute),n.langTextSub=n.subLangText=s(r.getSubLangText,r.setSubLangText),n.boolSub=s(r.getBoolSub,r.setBoolSub),n.langAttribute=s(function(e){return e.getAttributeNS(r.XML_NS,"lang")||""},function(e,t){e.setAttributeNS(r.XML_NS,"lang",t)}),n.b64Text=s(function(e){return e.textContent&&"="!==e.textContent?new t(e.textContent,"base64"):""},function(e,n){if("string"==typeof n){var r=new t(n).toString("base64");e.textContent=r||"="}else e.textContent=""}),n.dateAttribute=function(e,t){return{get:function(){var n=r.getAttribute(this.xml,e);return n?new Date(n):t?new Date(Date.now()):void 0},set:function(t){t&&("string"!=typeof t&&(t=t.toISOString()),r.setAttribute(this.xml,e,t))}}},n.dateSub=function(e,t,n){return{get:function(){var i=r.getSubText(this.xml,e,t);return i?new Date(i):n?new Date(Date.now()):void 0},set:function(n){n&&("string"!=typeof n&&(n=n.toISOString()),r.setSubText(this.xml,e,t,n))}}},n.dateSubAttribute=function(e,t,n,i){return{get:function(){var o=r.getSubAttribute(this.xml,e,t,n);return o?new Date(o):i?new Date(Date.now()):void 0},set:function(i){i&&("string"!=typeof i&&(i=i.toISOString()),r.setSubAttribute(this.xml,e,t,n,i))}}},n.numberAttribute=function(e,t,n){return{get:function(){var i=t?parseFloat:parseInt,o=r.getAttribute(this.xml,e,"");if(!o)return n;var a=i(o,10);return isNaN(a)?n:a},set:function(t){r.setAttribute(this.xml,e,t.toString())}}},n.numberSub=function(e,t,n,i){return{get:function(){var o=n?parseFloat:parseInt,a=r.getSubText(this.xml,e,t,"");if(!a)return i;var s=o(a,10);return isNaN(s)?i:s},set:function(n){r.setSubText(this.xml,e,t,n.toString())}}},n.numberSubAttribute=function(e,t,n,i,o){return{get:function(){var a=i?parseFloat:parseInt,s=r.getSubAttribute(this.xml,e,t,n,"");if(!s)return o;var c=a(s,10);return isNaN(c)?o:c},set:function(i){r.setSubAttribute(this.xml,e,t,n,i.toString())}}},n.attribute=function(e,t){return{get:function(){return r.getAttribute(this.xml,e,t)},set:function(t){r.setAttribute(this.xml,e,t)}}},n.attributeNS=function(e,t,n){return{get:function(){return r.getAttributeNS(this.xml,e,t,n)},set:function(n){r.setAttributeNS(this.xml,e,t,n)}}},n.extension=function(e){return{get:function(){var t=e.prototype._name;if(!this._extensions[t]){var n=o(this.xml,e.prototype._NS,e.prototype._EL);n.length?this._extensions[t]=new e(null,n[0],this):(this._extensions[t]=new e({},null,this),this.xml.appendChild(this._extensions[t].xml)),this._extensions[t].parent=this}return this._extensions[t]},set:function(t){if(t){var n=this[e.prototype._name];!0===t&&(t={}),i(n,t)}}}},n.multiExtension=function(e){return{get:function(){for(var t=o(this.xml,e.prototype._NS,e.prototype._EL),n=[],r=0,i=t.length;r<i;r++)n.push(new e({},t[r],this));return n},set:function(t){t=t||[];var n,r,i=o(this.xml,e.prototype._NS,e.prototype._EL);for(n=0,r=i.length;n<r;n++)this.xml.removeChild(i[n]);for(n=0,r=t.length;n<r;n++){var a=new e(t[n],null,this);this.xml.appendChild(a.xml)}}}},n.enumSub=function(e,t){return{get:function(){var n=this,r=[];return t.forEach(function(t){var i=o(n.xml,e,t);i.length&&r.push(i[0].nodeName)}),r[0]||""},set:function(n){var r=this,i=!1;if(t.forEach(function(t){var a=o(r.xml,e,t);a.length&&(t===n?i=!0:r.xml.removeChild(a[0]))}),n&&!i){var s=a(e,n);this.xml.appendChild(s)}}}},n.subExtension=function(e,t,n,r){return{get:function(){if(!this._extensions[e]){var i=o(this.xml,t,n);i.length?i=i[0]:(i=a(t,n,this._NS),this.xml.appendChild(i));var s=o(i,r.prototype._NS,r.prototype._EL);s.length?this._extensions[e]=new r(null,s[0],{xml:i}):(this._extensions[e]=new r({},null,{xml:i}),i.appendChild(this._extensions[e].xml)),this._extensions[e].parent=this}return this._extensions[e]},set:function(r){var a=o(this.xml,t,n);if(a.length&&!r&&this.xml.removeChild(a[0]),r){var s=this[e];!0===r&&(r={}),i(s,r)}}}},n.subMultiExtension=function(e,t,n){return{get:function(){var r=this,i=[],a=o(this.xml,e,t);return a.length?(a=a[0],o(a,n.prototype._NS,n.prototype._EL).forEach(function(e){i.push(new n({},e,r))}),i):i},set:function(r){var i=o(this.xml,e,t);i.length&&this.xml.removeChild(i[0]),r.length&&(i=a(e,t,this._NS),r.forEach(function(t){var r=new n(t,null,{xml:{namespaceURI:e}});i.appendChild(r.xml)}),this.xml.appendChild(i))}}}}).call(this,e("buffer").Buffer)},{"./helpers":160,buffer:10,"lodash.assign":179}],163:[function(e,t,n){t.exports=function(e,t){for(var n=-1,r=e.length;++n<r&&!1!==t(e[n],n,e););return e}},{}],164:[function(e,t,n){t.exports=function(e,t){for(var n=-1,r=e.length,i=-1,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[++i]=a)}return o}},{}],165:[function(e,t,n){var r=e("lodash._basecopy"),i=e("lodash.keys");t.exports=function(e,t){return null==t?e:r(t,i(t),e)}},{"lodash._basecopy":167,"lodash.keys":186}],166:[function(e,t,n){var r=e("lodash._baseisequal"),i=e("lodash._bindcallback"),o=e("lodash.isarray"),a=e("lodash.pairs"),s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,c=/^\w*$/,u=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,l=/\\(\\)?/g;function d(e,t,n){if(null!=e){void 0!==n&&n in h(e)&&(t=[n]);for(var r=0,i=t.length;null!=e&&r<i;)e=e[t[r++]];return r&&r==i?e:void 0}}function p(e,t){var n=typeof e;return!!("string"==n&&c.test(e)||"number"==n)||!o(e)&&(!s.test(e)||null!=t&&e in h(t))}function f(e){return e==e&&!v(e)}function h(e){return v(e)?e:Object(e)}function m(e){if(o(e))return e;var t=[];return function(e){return null==e?"":e+""}(e).replace(u,function(e,n,r,i){t.push(r?i.replace(l,"$1"):n||e)}),t}function v(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function y(e){return e}t.exports=function(e,t,n){var s,c,u=typeof e;return"function"==u?void 0===t?e:i(e,t,n):null==e?y:"object"==u?function(e){var t=function(e){for(var t=a(e),n=t.length;n--;)t[n][2]=f(t[n][1]);return t}(e);if(1==t.length&&t[0][2]){var n=t[0][0],i=t[0][1];return function(e){return null!=e&&e[n]===i&&(void 0!==i||n in h(e))}}return function(e){return function(e,t,n){var i=t.length,o=i,a=!n;if(null==e)return!o;for(e=h(e);i--;){var s=t[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var c=(s=t[i])[0],u=e[c],l=s[1];if(a&&s[2]){if(void 0===u&&!(c in e))return!1}else{var d=n?n(u,l,c):void 0;if(!(void 0===d?r(l,u,n,!0):d))return!1}}return!0}(e,t)}}(e):void 0===t?p(s=e)?(c=s,function(e){return null==e?void 0:e[c]}):function(e){var t=e+"";return e=m(e),function(n){return d(n,e,t)}}(s):function(e,t){var n=o(e),i=p(e)&&f(t),a=e+"";return e=m(e),function(o){if(null==o)return!1;var s,c,u=a;if(o=h(o),(n||!i)&&!(u in o)){if(null==(o=1==e.length?o:d(o,function(e,t,n){var r=-1,i=e.length;(t=null==t?0:+t||0)<0&&(t=-t>i?0:i+t),(n=void 0===n||n>i?i:+n||0)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}(e,0,-1))))return!1;u=(c=(s=e)?s.length:0)?s[c-1]:void 0,o=h(o)}return o[u]===t?void 0!==t||u in o:r(t,o[u],void 0,!0)}}(e,t)}},{"lodash._baseisequal":171,"lodash._bindcallback":173,"lodash.isarray":184,"lodash.pairs":187}],167:[function(e,t,n){t.exports=function(e,t,n){n||(n={});for(var r=-1,i=t.length;++r<i;){var o=t[r];n[o]=e[o]}return n}},{}],168:[function(e,t,n){var r,i,o=e("lodash.keys"),a=9007199254740991,s=(r=function(e,t){return c(e,t,o)},function(e,t){var n,o=e?l(e):0;if(!("number"==typeof(n=o)&&n>-1&&n%1==0&&n<=a))return r(e,t);for(var s=i?o:-1,c=d(e);(i?s--:++s<o)&&!1!==t(c[s],s,c););return e}),c=function(e){return function(t,n,r){for(var i=d(t),o=r(t),a=o.length,s=e?a:-1;e?s--:++s<a;){var c=o[s];if(!1===n(i[c],c,i))break}return t}}();var u,l=(u="length",function(e){return null==e?void 0:e[u]});function d(e){return function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?e:Object(e)}t.exports=s},{"lodash.keys":186}],169:[function(e,t,n){var r=e("lodash._baseeach");t.exports=function(e,t){var n=[];return r(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}},{"lodash._baseeach":168}],170:[function(e,t,n){t.exports=function(e,t,n){if(t!=t)return function(e,t,n){for(var r=e.length,i=t+(n?0:-1);n?i--:++i<r;){var o=e[i];if(o!=o)return i}return-1}(e,n);for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}},{}],171:[function(e,t,n){var r=e("lodash.isarray"),i=e("lodash.istypedarray"),o=e("lodash.keys"),a="[object Arguments]",s="[object Array]",c="[object Boolean]",u="[object Date]",l="[object Error]",d="[object Number]",p="[object Object]",f="[object RegExp]",h="[object String]";var m=Object.prototype,v=m.hasOwnProperty,y=m.toString;function g(e,t){for(var n=-1,r=e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}t.exports=function e(t,n,m,S,_,b){return t===n||(null==t||null==n||!function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(t)&&!function(e){return!!e&&"object"==typeof e}(n)?t!=t&&n!=n:function(e,t,n,m,S,_,b){var C=r(e),w=r(t),E=s,R=s;C||((E=y.call(e))==a?E=p:E!=p&&(C=i(e))),w||((R=y.call(t))==a?R=p:R!=p&&(w=i(t)));var P=E==p,L=R==p,T=E==R;if(T&&!C&&!P)return function(e,t,n){switch(n){case c:case u:return+e==+t;case l:return e.name==t.name&&e.message==t.message;case d:return e!=+e?t!=+t:e==+t;case f:case h:return e==t+""}return!1}(e,t,E);if(!S){var x=P&&v.call(e,"__wrapped__"),M=L&&v.call(t,"__wrapped__");if(x||M)return n(x?e.value():e,M?t.value():t,m,S,_,b)}if(!T)return!1;_||(_=[]),b||(b=[]);for(var A=_.length;A--;)if(_[A]==e)return b[A]==t;_.push(e),b.push(t);var I=(C?function(e,t,n,r,i,o,a){var s=-1,c=e.length,u=t.length;if(c!=u&&!(i&&u>c))return!1;for(;++s<c;){var l=e[s],d=t[s],p=r?r(i?d:l,i?l:d,s):void 0;if(void 0!==p){if(p)continue;return!1}if(i){if(!g(t,function(e){return l===e||n(l,e,r,i,o,a)}))return!1}else if(l!==d&&!n(l,d,r,i,o,a))return!1}return!0}:function(e,t,n,r,i,a,s){var c=o(e),u=c.length,l=o(t).length;if(u!=l&&!i)return!1;for(var d=u;d--;){var p=c[d];if(!(i?p in t:v.call(t,p)))return!1}for(var f=i;++d<u;){p=c[d];var h=e[p],m=t[p],y=r?r(i?m:h,i?h:m,p):void 0;if(!(void 0===y?n(h,m,r,i,a,s):y))return!1;f||(f="constructor"==p)}if(!f){var g=e.constructor,S=t.constructor;if(g!=S&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof S&&S instanceof S))return!1}return!0})(e,t,n,m,S,_,b);return _.pop(),b.pop(),I}(t,n,e,m,S,_,b))}},{"lodash.isarray":184,"lodash.istypedarray":185,"lodash.keys":186}],172:[function(e,t,n){var r=e("lodash._baseindexof"),i=e("lodash._cacheindexof"),o=e("lodash._createcache"),a=200;t.exports=function(e,t){var n=-1,s=r,c=e.length,u=!0,l=u&&c>=a,d=l?o():null,p=[];d?(s=i,u=!1):(l=!1,d=t?[]:p);e:for(;++n<c;){var f=e[n],h=t?t(f,n,e):f;if(u&&f==f){for(var m=d.length;m--;)if(d[m]===h)continue e;t&&d.push(h),p.push(f)}else s(d,h,0)<0&&((t||l)&&d.push(h),p.push(f))}return p}},{"lodash._baseindexof":170,"lodash._cacheindexof":174,"lodash._createcache":176}],173:[function(e,t,n){function r(e){return e}t.exports=function(e,t,n){if("function"!=typeof e)return r;if(void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,o){return e.call(t,n,r,i,o)};case 5:return function(n,r,i,o,a){return e.call(t,n,r,i,o,a)}}return function(){return e.apply(t,arguments)}}},{}],174:[function(e,t,n){t.exports=function(e,t){var n=e.data;return("string"==typeof t||function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(t)?n.set.has(t):n.hash[t])?0:-1}},{}],175:[function(e,t,n){var r=e("lodash._bindcallback"),i=e("lodash._isiterateecall"),o=e("lodash.restparam");t.exports=function(e){return o(function(t,n){var o=-1,a=null==t?0:n.length,s=a>2?n[a-2]:void 0,c=a>2?n[2]:void 0,u=a>1?n[a-1]:void 0;for("function"==typeof s?(s=r(s,u,5),a-=2):a-=(s="function"==typeof u?u:void 0)?1:0,c&&i(n[0],n[1],c)&&(s=a<3?void 0:s,a=1);++o<a;){var l=n[o];l&&e(t,l,s)}return t})}},{"lodash._bindcallback":173,"lodash._isiterateecall":178,"lodash.restparam":188}],176:[function(e,t,n){(function(n){var r=e("lodash._getnative"),i=r(n,"Set"),o=r(Object,"create");function a(e){var t=e?e.length:0;for(this.data={hash:o(null),set:new i};t--;)this.push(e[t])}a.prototype.push=function(e){var t=this.data;"string"==typeof e||function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?t.set.add(e):t.hash[e]=!0},t.exports=function(e){return o&&i?new a(e):null}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash._getnative":177}],177:[function(e,t,n){var r="[object Function]",i=/^\[object .+?Constructor\]$/;var o=Object.prototype,a=Function.prototype.toString,s=o.hasOwnProperty,c=o.toString,u=RegExp("^"+a.call(s).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(e,t){var n=null==e?void 0:e[t];return function(e){return null!=e&&(function(e){return function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)&&c.call(e)==r}(e)?u.test(a.call(e)):function(e){return!!e&&"object"==typeof e}(e)&&i.test(e))}(n)?n:void 0}},{}],178:[function(e,t,n){var r=/^\d+$/,i=9007199254740991;var o,a=(o="length",function(e){return null==e?void 0:e[o]});function s(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}(a(e))}t.exports=function(e,t,n){if(!function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(n))return!1;var o=typeof t;if("number"==o?s(n)&&function(e,t){return e="number"==typeof e||r.test(e)?+e:-1,t=null==t?i:t,e>-1&&e%1==0&&e<t}(t,n.length):"string"==o&&t in n){var a=n[t];return e==e?e===a:a!=a}return!1}},{}],179:[function(e,t,n){var r=e("lodash._baseassign"),i=e("lodash._createassigner"),o=e("lodash.keys");var a=i(function(e,t,n){return n?function(e,t,n){for(var r=-1,i=o(t),a=i.length;++r<a;){var s=i[r],c=e[s],u=n(c,t[s],s,e,t);(u==u?u===c:c!=c)&&(void 0!==c||s in e)||(e[s]=u)}return e}(e,t,n):r(e,t)});t.exports=a},{"lodash._baseassign":165,"lodash._createassigner":175,"lodash.keys":186}],180:[function(e,t,n){(function(e){var r=200,i="__lodash_hash_undefined__",o=9007199254740991,a="[object Arguments]",s="[object Boolean]",c="[object Date]",u="[object Function]",l="[object GeneratorFunction]",d="[object Map]",p="[object Number]",f="[object Object]",h="[object RegExp]",m="[object Set]",v="[object String]",y="[object Symbol]",g="[object ArrayBuffer]",S="[object DataView]",_="[object Float32Array]",b="[object Float64Array]",C="[object Int8Array]",w="[object Int16Array]",E="[object Int32Array]",R="[object Uint8Array]",P="[object Uint8ClampedArray]",L="[object Uint16Array]",T="[object Uint32Array]",x=/\w*$/,M=/^\[object .+?Constructor\]$/,A=/^(?:0|[1-9]\d*)$/,I={};I[a]=I["[object Array]"]=I[g]=I[S]=I[s]=I[c]=I[_]=I[b]=I[C]=I[w]=I[E]=I[d]=I[p]=I[f]=I[h]=I[m]=I[v]=I[y]=I[R]=I[P]=I[L]=I[T]=!0,I["[object Error]"]=I[u]=I["[object WeakMap]"]=!1;var O="object"==typeof e&&e&&e.Object===Object&&e,D="object"==typeof self&&self&&self.Object===Object&&self,k=O||D||Function("return this")(),j="object"==typeof n&&n&&!n.nodeType&&n,N=j&&"object"==typeof t&&t&&!t.nodeType&&t,V=N&&N.exports===j;function U(e,t){return e.set(t[0],t[1]),e}function B(e,t){return e.add(t),e}function F(e,t,n,r){var i=-1,o=e?e.length:0;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function G(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function W(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function J(e,t){return function(n){return e(t(n))}}function q(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var H,z=Array.prototype,X=Function.prototype,$=Object.prototype,Y=k["__core-js_shared__"],K=(H=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||""))?"Symbol(src)_1."+H:"",Q=X.toString,Z=$.hasOwnProperty,ee=$.toString,te=RegExp("^"+Q.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ne=V?k.Buffer:void 0,re=k.Symbol,ie=k.Uint8Array,oe=J(Object.getPrototypeOf,Object),ae=Object.create,se=$.propertyIsEnumerable,ce=z.splice,ue=Object.getOwnPropertySymbols,le=ne?ne.isBuffer:void 0,de=J(Object.keys,Object),pe=Ne(k,"DataView"),fe=Ne(k,"Map"),he=Ne(k,"Promise"),me=Ne(k,"Set"),ve=Ne(k,"WeakMap"),ye=Ne(Object,"create"),ge=Ge(pe),Se=Ge(fe),_e=Ge(he),be=Ge(me),Ce=Ge(ve),we=re?re.prototype:void 0,Ee=we?we.valueOf:void 0;function Re(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Pe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Le(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Te(e){this.__data__=new Pe(e)}function xe(e,t){var n=Je(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&qe(e)}(e)&&Z.call(e,"callee")&&(!se.call(e,"callee")||ee.call(e)==a)}(e)?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],r=n.length,i=!!r;for(var o in e)!t&&!Z.call(e,o)||i&&("length"==o||Be(o,r))||n.push(o);return n}function Me(e,t,n){var r=e[t];Z.call(e,t)&&We(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function Ae(e,t){for(var n=e.length;n--;)if(We(e[n][0],t))return n;return-1}function Ie(e,t,n,r,i,o,M){var A;if(r&&(A=o?r(e,i,o,M):r(e)),void 0!==A)return A;if(!Xe(e))return e;var O=Je(e);if(O){if(A=function(e){var t=e.length,n=e.constructor(t);t&&"string"==typeof e[0]&&Z.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!t)return function(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(e,A)}else{var D=Ue(e),k=D==u||D==l;if(He(e))return function(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}(e,t);if(D==f||D==a||k&&!o){if(G(e))return o?e:{};if(A=function(e){return"function"!=typeof e.constructor||Fe(e)?{}:(t=oe(e),Xe(t)?ae(t):{});var t}(k?{}:e),!t)return function(e,t){return ke(e,Ve(e),t)}(e,function(e,t){return e&&ke(t,$e(t),e)}(A,e))}else{if(!I[D])return o?e:{};A=function(e,t,n,r){var i=e.constructor;switch(t){case g:return De(e);case s:case c:return new i(+e);case S:return function(e,t){var n=t?De(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,r);case _:case b:case C:case w:case E:case R:case P:case L:case T:return function(e,t){var n=t?De(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(e,r);case d:return function(e,t,n){return F(t?n(W(e),!0):W(e),U,new e.constructor)}(e,r,n);case p:case v:return new i(e);case h:return(u=new(a=e).constructor(a.source,x.exec(a))).lastIndex=a.lastIndex,u;case m:return function(e,t,n){return F(t?n(q(e),!0):q(e),B,new e.constructor)}(e,r,n);case y:return o=e,Ee?Object(Ee.call(o)):{}}var o;var a,u}(e,D,Ie,t)}}M||(M=new Te);var j=M.get(e);if(j)return j;if(M.set(e,A),!O)var N=n?function(e){return function(e,t,n){var r=t(e);return Je(e)?r:function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}(r,n(e))}(e,$e,Ve)}(e):$e(e);return function(e,t){for(var n=-1,r=e?e.length:0;++n<r&&!1!==t(e[n],n,e););}(N||e,function(i,o){N&&(i=e[o=i]),Me(A,o,Ie(i,t,n,r,o,e,M))}),A}function Oe(e){return!(!Xe(e)||(t=e,K&&K in t))&&(ze(e)||G(e)?te:M).test(Ge(e));var t}function De(e){var t=new e.constructor(e.byteLength);return new ie(t).set(new ie(e)),t}function ke(e,t,n,r){n||(n={});for(var i=-1,o=t.length;++i<o;){var a=t[i],s=r?r(n[a],e[a],a,n,e):void 0;Me(n,a,void 0===s?e[a]:s)}return n}function je(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Ne(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Oe(n)?n:void 0}Re.prototype.clear=function(){this.__data__=ye?ye(null):{}},Re.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Re.prototype.get=function(e){var t=this.__data__;if(ye){var n=t[e];return n===i?void 0:n}return Z.call(t,e)?t[e]:void 0},Re.prototype.has=function(e){var t=this.__data__;return ye?void 0!==t[e]:Z.call(t,e)},Re.prototype.set=function(e,t){return this.__data__[e]=ye&&void 0===t?i:t,this},Pe.prototype.clear=function(){this.__data__=[]},Pe.prototype.delete=function(e){var t=this.__data__,n=Ae(t,e);return!(n<0||(n==t.length-1?t.pop():ce.call(t,n,1),0))},Pe.prototype.get=function(e){var t=this.__data__,n=Ae(t,e);return n<0?void 0:t[n][1]},Pe.prototype.has=function(e){return Ae(this.__data__,e)>-1},Pe.prototype.set=function(e,t){var n=this.__data__,r=Ae(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},Le.prototype.clear=function(){this.__data__={hash:new Re,map:new(fe||Pe),string:new Re}},Le.prototype.delete=function(e){return je(this,e).delete(e)},Le.prototype.get=function(e){return je(this,e).get(e)},Le.prototype.has=function(e){return je(this,e).has(e)},Le.prototype.set=function(e,t){return je(this,e).set(e,t),this},Te.prototype.clear=function(){this.__data__=new Pe},Te.prototype.delete=function(e){return this.__data__.delete(e)},Te.prototype.get=function(e){return this.__data__.get(e)},Te.prototype.has=function(e){return this.__data__.has(e)},Te.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Pe){var i=n.__data__;if(!fe||i.length<r-1)return i.push([e,t]),this;n=this.__data__=new Le(i)}return n.set(e,t),this};var Ve=ue?J(ue,Object):function(){return[]},Ue=function(e){return ee.call(e)};function Be(e,t){return!!(t=null==t?o:t)&&("number"==typeof e||A.test(e))&&e>-1&&e%1==0&&e<t}function Fe(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||$)}function Ge(e){if(null!=e){try{return Q.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function We(e,t){return e===t||e!=e&&t!=t}(pe&&Ue(new pe(new ArrayBuffer(1)))!=S||fe&&Ue(new fe)!=d||he&&"[object Promise]"!=Ue(he.resolve())||me&&Ue(new me)!=m||ve&&"[object WeakMap]"!=Ue(new ve))&&(Ue=function(e){var t=ee.call(e),n=t==f?e.constructor:void 0,r=n?Ge(n):void 0;if(r)switch(r){case ge:return S;case Se:return d;case _e:return"[object Promise]";case be:return m;case Ce:return"[object WeakMap]"}return t});var Je=Array.isArray;function qe(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}(e.length)&&!ze(e)}var He=le||function(){return!1};function ze(e){var t=Xe(e)?ee.call(e):"";return t==u||t==l}function Xe(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function $e(e){return qe(e)?xe(e):function(e){if(!Fe(e))return de(e);var t=[];for(var n in Object(e))Z.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}t.exports=function(e){return Ie(e,!0,!0)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],181:[function(e,t,n){var r=e("lodash._arrayfilter"),i=e("lodash._basecallback"),o=e("lodash._basefilter"),a=e("lodash.isarray");t.exports=function(e,t,n){return(a(e)?r:o)(e,t=i(t,n,3))}},{"lodash._arrayfilter":164,"lodash._basecallback":166,"lodash._basefilter":169,"lodash.isarray":184}],182:[function(e,t,n){var r=e("lodash._arrayeach"),i=e("lodash._baseeach"),o=e("lodash._bindcallback"),a=e("lodash.isarray");var s,c,u=(s=r,c=i,function(e,t,n){return"function"==typeof t&&void 0===n&&a(e)?s(e,t):c(e,o(t,n,3))});t.exports=u},{"lodash._arrayeach":163,"lodash._baseeach":168,"lodash._bindcallback":173,"lodash.isarray":184}],183:[function(e,t,n){var r=9007199254740991,i="[object Arguments]",o="[object Function]",a="[object GeneratorFunction]",s=Object.prototype,c=s.hasOwnProperty,u=s.toString,l=s.propertyIsEnumerable;t.exports=function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}(e.length)&&!function(e){var t=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?u.call(e):"";return t==o||t==a}(e)}(e)}(e)&&c.call(e,"callee")&&(!l.call(e,"callee")||u.call(e)==i)}},{}],184:[function(e,t,n){var r="[object Function]",i=/^\[object .+?Constructor\]$/;function o(e){return!!e&&"object"==typeof e}var a,s,c,u=Object.prototype,l=Function.prototype.toString,d=u.hasOwnProperty,p=u.toString,f=RegExp("^"+l.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),h=(a=Array,s="isArray",function(e){return null!=e&&(function(e){return function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)&&p.call(e)==r}(e)?f.test(l.call(e)):o(e)&&i.test(e))}(c=null==a?void 0:a[s])?c:void 0),m=9007199254740991;var v=h||function(e){return o(e)&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=m}(e.length)&&"[object Array]"==p.call(e)};t.exports=v},{}],185:[function(e,t,n){var r=9007199254740991,i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1;var o=Object.prototype.toString;t.exports=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}(e.length)&&!!i[o.call(e)]}},{}],186:[function(e,t,n){var r=e("lodash._getnative"),i=e("lodash.isarguments"),o=e("lodash.isarray"),a=/^\d+$/,s=Object.prototype.hasOwnProperty,c=r(Object,"keys"),u=9007199254740991;var l,d=(l="length",function(e){return null==e?void 0:e[l]});function p(e,t){return e="number"==typeof e||a.test(e)?+e:-1,t=null==t?u:t,e>-1&&e%1==0&&e<t}function f(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=u}function h(e){for(var t=function(e){if(null==e)return[];m(e)||(e=Object(e));var t=e.length;t=t&&f(t)&&(o(e)||i(e))&&t||0;var n=e.constructor,r=-1,a="function"==typeof n&&n.prototype===e,c=Array(t),u=t>0;for(;++r<t;)c[r]=r+"";for(var l in e)u&&p(l,t)||"constructor"==l&&(a||!s.call(e,l))||c.push(l);return c}(e),n=t.length,r=n&&e.length,a=!!r&&f(r)&&(o(e)||i(e)),c=-1,u=[];++c<n;){var l=t[c];(a&&p(l,r)||s.call(e,l))&&u.push(l)}return u}function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var v=c?function(e){var t,n=null==e?void 0:e.constructor;return"function"==typeof n&&n.prototype===e||"function"!=typeof e&&(null!=(t=e)&&f(d(t)))?h(e):m(e)?c(e):[]}:h;t.exports=v},{"lodash._getnative":177,"lodash.isarguments":183,"lodash.isarray":184}],187:[function(e,t,n){var r=e("lodash.keys");t.exports=function(e){var t;e=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(t=e)?t:Object(t);for(var n=-1,i=r(e),o=i.length,a=Array(o);++n<o;){var s=i[n];a[n]=[s,e[s]]}return a}},{"lodash.keys":186}],188:[function(e,t,n){var r="Expected a function",i=Math.max;t.exports=function(e,t){if("function"!=typeof e)throw new TypeError(r);return t=i(void 0===t?e.length-1:+t||0,0),function(){for(var n=arguments,r=-1,o=i(n.length-t,0),a=Array(o);++r<o;)a[r]=n[t+r];switch(t){case 0:return e.call(this,a);case 1:return e.call(this,n[0],a);case 2:return e.call(this,n[0],n[1],a)}var s=Array(t+1);for(r=-1;++r<t;)s[r]=n[r];return s[t]=a,e.apply(this,s)}}},{}],189:[function(e,t,n){var r=e("lodash._basecallback"),i=e("lodash._baseuniq"),o=e("lodash._isiterateecall");t.exports=function(e,t,n,a){return e&&e.length?(null!=t&&"boolean"!=typeof t&&(n=o(e,t,a=n)?void 0:t,t=!1),n=null==n?n:r(n,a,3),t?function(e,t){for(var n,r=-1,i=e.length,o=-1,a=[];++r<i;){var s=e[r],c=t?t(s,r,e):s;r&&n===c||(n=c,a[++o]=s)}return a}(e,n):i(e,n)):[]}},{"lodash._basecallback":166,"lodash._baseuniq":172,"lodash._isiterateecall":178}],190:[function(e,t,n){"use strict";var r=e("./lib/parse"),i=e("./lib/Parser"),o=e("./lib/escape"),a=e("./lib/Element"),s=e("./lib/equal"),c=e("./lib/createElement"),u=e("./lib/tag"),l=e("./lib/tagString"),d=e("./lib/is"),p=e("./lib/clone"),f=e("./lib/stringify");(n=t.exports=function(){return u.apply(null,arguments)}).Element=a,n.equal=s.equal,n.nameEqual=s.name,n.attrsEqual=s.attrs,n.childrenEqual=s.children,n.isNode=d.isNode,n.isElement=d.isElement,n.isText=d.isText,n.clone=p,n.createElement=c,n.escapeXML=o.escapeXML,n.unescapeXML=o.unescapeXML,n.escapeXMLText=o.escapeXMLText,n.unescapeXMLText=o.unescapeXMLText,n.Parser=i,n.parse=r,n.tag=u,n.tagString=l,n.stringify=f},{"./lib/Element":192,"./lib/Parser":193,"./lib/clone":194,"./lib/createElement":195,"./lib/equal":196,"./lib/escape":197,"./lib/is":198,"./lib/parse":199,"./lib/stringify":201,"./lib/tag":202,"./lib/tagString":203}],191:[function(e,t,n){"use strict";var r=e("inherits"),i=e("./Element");function o(e,t){i.call(this,e,t),this.nodeType=1,this.nodeName=this.localName}r(o,i),o.prototype._getElement=function(e,t){return new o(e,t)},Object.defineProperty(o.prototype,"localName",{get:function(){return this.getName()}}),Object.defineProperty(o.prototype,"namespaceURI",{get:function(){return this.getNS()}}),Object.defineProperty(o.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(o.prototype,"childNodes",{get:function(){return this.children}}),Object.defineProperty(o.prototype,"textContent",{get:function(){return this.getText()},set:function(e){this.children.push(e)}}),o.prototype.getElementsByTagName=function(e){return this.getChildren(e)},o.prototype.getAttribute=function(e){return this.getAttr(e)},o.prototype.setAttribute=function(e,t){this.attr(e,t)},o.prototype.getAttributeNS=function(e,t){return"http://www.w3.org/XML/1998/namespace"===e?this.getAttr(["xml",t].join(":")):this.getAttr(t,e)},o.prototype.setAttributeNS=function(e,t,n){var r;"http://www.w3.org/XML/1998/namespace"===e?r="xml":r=this.getXmlns()[e]||"";r&&this.attr([r,t].join(":"),n)},o.prototype.removeAttribute=function(e){this.attr(e,null)},o.prototype.removeAttributeNS=function(e,t){var n;"http://www.w3.org/XML/1998/namespace"===e?n="xml":n=this.getXmlns()[e]||"";n&&this.attr([n,t].join(":"),null)},o.prototype.appendChild=function(e){this.cnode(e)},o.prototype.removeChild=function(e){this.remove(e)},o.createElement=function(e,t){var n=new o(e,t);return Array.prototype.slice.call(arguments,2).forEach(function(e){n.appendChild(e)}),n},t.exports=o},{"./Element":192,inherits:61}],192:[function(e,t,n){"use strict";var r=e("./escape"),i=r.escapeXML,o=r.escapeXMLText,a=e("./equal"),s=a.equal,c=a.name,u=a.attrs,l=a.children,d=e("./clone");function p(e,t){this.name=e,this.parent=null,this.children=[],this.attrs={},this.setAttrs(t)}p.prototype.is=function(e,t){return this.getName()===e&&(!t||this.getNS()===t)},p.prototype.getName=function(){return this.name.indexOf(":")>=0?this.name.substr(this.name.indexOf(":")+1):this.name},p.prototype.getNS=function(){if(this.name.indexOf(":")>=0){var e=this.name.substr(0,this.name.indexOf(":"));return this.findNS(e)}return this.findNS()},p.prototype.findNS=function(e){if(e){var t="xmlns:"+e;if(this.attrs[t])return this.attrs[t];if(this.parent)return this.parent.findNS(e)}else{if(this.attrs.xmlns)return this.attrs.xmlns;if(this.parent)return this.parent.findNS()}},p.prototype.getXmlns=function(){var e={};for(var t in this.parent&&(e=this.parent.getXmlns()),this.attrs){var n=t.match("xmlns:?(.*)");this.attrs.hasOwnProperty(t)&&n&&(e[this.attrs[t]]=n[1])}return e},p.prototype.setAttrs=function(e){"string"==typeof e?this.attrs.xmlns=e:e&&Object.keys(e).forEach(function(t){this.attrs[t]=e[t]},this)},p.prototype.getAttr=function(e,t){if(!t)return this.attrs[e];var n=this.getXmlns();return n[t]?this.attrs[[n[t],e].join(":")]:null},p.prototype.getChild=function(e,t){return this.getChildren(e,t)[0]},p.prototype.getChildren=function(e,t){for(var n=[],r=0;r<this.children.length;r++){var i=this.children[r];!i.getName||i.getName()!==e||t&&i.getNS()!==t||n.push(i)}return n},p.prototype.getChildByAttr=function(e,t,n,r){return this.getChildrenByAttr(e,t,n,r)[0]},p.prototype.getChildrenByAttr=function(e,t,n,r){for(var i=[],o=0;o<this.children.length;o++){var a=this.children[o];!a.attrs||a.attrs[e]!==t||n&&a.getNS()!==n||i.push(a),r&&a.getChildrenByAttr&&i.push(a.getChildrenByAttr(e,t,n,!0))}return r&&(i=[].concat.apply([],i)),i},p.prototype.getChildrenByFilter=function(e,t){for(var n=[],r=0;r<this.children.length;r++){var i=this.children[r];e(i)&&n.push(i),t&&i.getChildrenByFilter&&n.push(i.getChildrenByFilter(e,!0))}return t&&(n=[].concat.apply([],n)),n},p.prototype.getText=function(){for(var e="",t=0;t<this.children.length;t++){var n=this.children[t];"string"!=typeof n&&"number"!=typeof n||(e+=n)}return e},p.prototype.getChildText=function(e,t){var n=this.getChild(e,t);return n?n.getText():null},p.prototype.getChildElements=function(){return this.getChildrenByFilter(function(e){return e instanceof p})},p.prototype.root=function(){return this.parent?this.parent.root():this},p.prototype.tree=p.prototype.root,p.prototype.up=function(){return this.parent?this.parent:this},p.prototype.c=function(e,t){return this.cnode(new p(e,t))},p.prototype.cnode=function(e){return this.children.push(e),"object"==typeof e&&(e.parent=this),e},p.prototype.t=function(e){return this.children.push(e),this},p.prototype.remove=function(e,t){var n;return n="string"==typeof e?function(n){return!(n.is&&n.is(e,t))}:function(t){return t!==e},this.children=this.children.filter(n),this},p.prototype.clone=function(){return d(this)},p.prototype.text=function(e){return e&&1===this.children.length?(this.children[0]=e,this):this.getText()},p.prototype.attr=function(e,t){return void 0!==t||null===t?(this.attrs||(this.attrs={}),this.attrs[e]=t,this):this.attrs[e]},p.prototype.toString=function(){var e="";return this.write(function(t){e+=t}),e},p.prototype.toJSON=function(){return{name:this.name,attrs:this.attrs,children:this.children.map(function(e){return e&&e.toJSON?e.toJSON():e})}},p.prototype._addChildren=function(e){e(">");for(var t=0;t<this.children.length;t++){var n=this.children[t];(n||0===n)&&(n.write?n.write(e):"string"==typeof n?e(o(n)):n.toString&&e(o(n.toString(10))))}e("</"),e(this.name),e(">")},p.prototype.write=function(e){for(var t in e("<"),e(this.name),this.attrs){var n=this.attrs[t];null!=n&&(e(" "),e(t),e('="'),"string"!=typeof n&&(n=n.toString()),e(i(n)),e('"'))}0===this.children.length?e("/>"):this._addChildren(e)},p.prototype.nameEquals=function(e){return c(this,e)},p.prototype.attrsEquals=function(e){return u(this,e)},p.prototype.childrenEquals=function(e){return l(this,e)},p.prototype.equals=function(e){return s(this,e)},t.exports=p},{"./clone":194,"./equal":196,"./escape":197}],193:[function(e,t,n){"use strict";var r=e("events").EventEmitter,i=e("inherits"),o=e("./Element"),a=e("./parsers/ltx"),s=function(e){r.call(this);var t,n=this.Parser=e&&e.Parser||this.DefaultParser,i=this.Element=e&&e.Element||this.DefaultElement;this.parser=new n;var o=this;this.parser.on("startElement",function(e,n){var r=new i(e,n);t=t?t.cnode(r):r}),this.parser.on("endElement",function(e){t&&e===t.name&&(t.parent?t=t.parent:o.tree||(o.tree=t,t=void 0))}),this.parser.on("text",function(e){t&&t.t(e)}),this.parser.on("error",function(e){o.error=e,o.emit("error",e)})};i(s,r),s.prototype.DefaultParser=a,s.prototype.DefaultElement=o,s.prototype.write=function(e){this.parser.write(e)},s.prototype.end=function(e){this.parser.end(e),this.error||(this.tree?this.emit("tree",this.tree):this.emit("error",new Error("Incomplete document")))},t.exports=s},{"./Element":192,"./parsers/ltx":200,events:44,inherits:61}],194:[function(e,t,n){"use strict";t.exports=function(e){for(var t=new e.constructor(e.name,e.attrs),n=0;n<e.children.length;n++){var r=e.children[n];t.cnode(r.clone?r.clone():r)}return t}},{}],195:[function(e,t,n){"use strict";var r=e("./Element");t.exports=function(e,t){for(var n=new r(e,t),i=2;i<arguments.length;i++){var o=arguments[i];o&&n.cnode(o)}return n}},{"./Element":192}],196:[function(e,t,n){"use strict";function r(e,t){return e.name===t.name}function i(e,t){var n=e.attrs,r=Object.keys(n),i=r.length;if(i!==Object.keys(t.attrs).length)return!1;for(var o=0,a=i;o<a;o++){var s=r[o],c=n[s];if(null==c||null==t.attrs[s]){if(c!==t.attrs[s])return!1}else if(c.toString()!==t.attrs[s].toString())return!1}return!0}function o(e,t){var n=e.children,r=n.length;if(r!==t.children.length)return!1;for(var i=0,o=r;i<o;i++){var a=n[i];if("string"==typeof a){if(a!==t.children[i])return!1}else if(!a.equals(t.children[i]))return!1}return!0}t.exports.name=r,t.exports.attrs=i,t.exports.children=o,t.exports.equal=function(e,t){return!!r(e,t)&&!!i(e,t)&&!!o(e,t)}},{}],197:[function(e,t,n){"use strict";var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"};function i(e){return r[e]}var o={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"};function a(e){if("#"===e[1]){var t;if(9===(t="x"===e[2]?parseInt(e.slice(3),16):parseInt(e.slice(2),10))||10===t||13===t||t>=32&&t<=55295||t>=57344&&t<=65533||t>=65536&&t<=1114111)return String.fromCodePoint(t);throw new Error("Illegal XML character 0x"+t.toString(16))}if(o[e])return o[e]||e;throw new Error("Illegal XML entity "+e)}n.escapeXML=function(e){return e.replace(/&|<|>|"|'/g,i)},n.unescapeXML=function(e){for(var t="",n=-1,r=-1,i=0;-1!==(n=e.indexOf("&",i))&&-1!==(r=e.indexOf(";",n+1));)t=t+e.substring(i,n)+a(e.substring(n,r+1)),i=r+1;return 0===i?e:t+=e.substring(i)},n.escapeXMLText=function(e){return e.replace(/&|<|>/g,i)},n.unescapeXMLText=function(e){return e.replace(/&(amp|#38|lt|#60|gt|#62);/g,a)}},{}],198:[function(e,t,n){"use strict";var r=e("./Element");t.exports.isNode=function(e){return e instanceof r||"string"==typeof e},t.exports.isElement=function(e){return e instanceof r},t.exports.isText=function(e){return"string"==typeof e}},{"./Element":192}],199:[function(e,t,n){"use strict";var r=e("./Parser");t.exports=function(e,t){var n;n="function"==typeof t?new t:new r(t);var i=null,o=null;if(n.on("tree",function(e){i=e}),n.on("error",function(e){o=e}),n.write(e),n.end(),o)throw o;return i}},{"./Parser":193}],200:[function(e,t,n){"use strict";var r=e("inherits"),i=e("events").EventEmitter,o=e("../escape").unescapeXML,a=t.exports=function(){i.call(this);var e,t,n,r,a,s,c,u,l=0,d=0;this._handleTagOpening=function(e,t,n){e?this.emit("endElement",t):(this.emit("startElement",t,n),a&&this.emit("endElement",t))},this.write=function(i){"string"!=typeof i&&(i=i.toString());var p=0;function f(){if("number"==typeof d){var e=i.substring(d,p);return d=void 0,e}}for(e&&(i=e+i,p+=e.length,e=null);p<i.length;p++){if(0===l){var h=i.indexOf("<",p);-1!==h&&p!==h&&(p=h)}else if(8===l){var m=i.indexOf(c,p);-1!==m&&(p=m)}else if(1===l){var v=i.indexOf("--\x3e",p);-1!==v&&(p=v+2)}var y=i.charCodeAt(p);switch(l){case 0:if(60===y){var g=f();g&&this.emit("text",o(g)),l=3,d=p+1,n={}}break;case 9:if(93===y&&"]>"===i.substr(p+1,2)){var S=f();S&&this.emit("text",S),l=1}break;case 3:47===y&&d===p?(d=p+1,r=!0):33===y?"[CDATA["===i.substr(p+1,7)?(d=p+8,l=9):(d=void 0,l=1):63===y?(d=void 0,l=2):(y<=32||47===y||62===y)&&(t=f(),p--,l=4);break;case 1:if(62===y){var _=i.charCodeAt(p-1),b=i.charCodeAt(p-2);(45===_&&45===b||93===_&&93===b)&&(l=0)}break;case 2:if(62===y)63===i.charCodeAt(p-1)&&(l=0);break;case 4:62===y?(this._handleTagOpening(r,t,n),t=void 0,n=void 0,r=void 0,a=void 0,l=0,d=p+1):47===y?a=!0:y>32&&(d=p,l=5);break;case 5:(y<=32||61===y)&&(u=f(),p--,l=6);break;case 6:61===y&&(l=7);break;case 7:34!==y&&39!==y||(s=y,c=34===y?'"':"'",l=8,d=p+1);break;case 8:if(y===s){var C=o(f());n[u]=C,u=void 0,l=4}}}"number"==typeof d&&d<=i.length&&(e=i.slice(d),d=0)}};r(a,i),a.prototype.end=function(e){e&&this.write(e),this.write=function(){}}},{"../escape":197,events:44,inherits:61}],201:[function(e,t,n){"use strict";t.exports=function e(t,n,r){"number"==typeof n&&(n=" ".repeat(n)),r||(r=1);var i="";return i+="<"+t.name,Object.keys(t.attrs).forEach(function(e){i+=" "+e+'="'+t.attrs[e]+'"'}),t.children.length?(i+=">",t.children.forEach(function(t,o){n&&(i+="\n"+n.repeat(r)),i+="string"==typeof t?t:e(t,n,r+1)}),n&&(i+="\n"+n.repeat(r-1)),i+="</"+t.name+">"):i+="/>",i}},{}],202:[function(e,t,n){"use strict";var r=e("./tagString"),i=e("./parse");t.exports=function(){return i(r.apply(null,arguments))}},{"./parse":199,"./tagString":203}],203:[function(e,t,n){"use strict";var r=e("./escape").escapeXML;t.exports=function(){for(var e=arguments[0],t="",n=1;n<arguments.length;n++)t+=e[n-1],t+=r(arguments[n]);return t+=e[e.length-1]}},{"./escape":197}],204:[function(e,t,n){"use strict";var r=e("inherits"),i=e("hash-base"),o=e("safe-buffer").Buffer,a=new Array(16);function s(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function c(e,t){return e<<t|e>>>32-t}function u(e,t,n,r,i,o,a){return c(e+(t&n|~t&r)+i+o|0,a)+t|0}function l(e,t,n,r,i,o,a){return c(e+(t&r|n&~r)+i+o|0,a)+t|0}function d(e,t,n,r,i,o,a){return c(e+(t^n^r)+i+o|0,a)+t|0}function p(e,t,n,r,i,o,a){return c(e+(n^(t|~r))+i+o|0,a)+t|0}r(s,i),s.prototype._update=function(){for(var e=a,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);var n=this._a,r=this._b,i=this._c,o=this._d;n=u(n,r,i,o,e[0],3614090360,7),o=u(o,n,r,i,e[1],3905402710,12),i=u(i,o,n,r,e[2],606105819,17),r=u(r,i,o,n,e[3],3250441966,22),n=u(n,r,i,o,e[4],4118548399,7),o=u(o,n,r,i,e[5],1200080426,12),i=u(i,o,n,r,e[6],2821735955,17),r=u(r,i,o,n,e[7],4249261313,22),n=u(n,r,i,o,e[8],1770035416,7),o=u(o,n,r,i,e[9],2336552879,12),i=u(i,o,n,r,e[10],4294925233,17),r=u(r,i,o,n,e[11],2304563134,22),n=u(n,r,i,o,e[12],1804603682,7),o=u(o,n,r,i,e[13],4254626195,12),i=u(i,o,n,r,e[14],2792965006,17),n=l(n,r=u(r,i,o,n,e[15],1236535329,22),i,o,e[1],4129170786,5),o=l(o,n,r,i,e[6],3225465664,9),i=l(i,o,n,r,e[11],643717713,14),r=l(r,i,o,n,e[0],3921069994,20),n=l(n,r,i,o,e[5],3593408605,5),o=l(o,n,r,i,e[10],38016083,9),i=l(i,o,n,r,e[15],3634488961,14),r=l(r,i,o,n,e[4],3889429448,20),n=l(n,r,i,o,e[9],568446438,5),o=l(o,n,r,i,e[14],3275163606,9),i=l(i,o,n,r,e[3],4107603335,14),r=l(r,i,o,n,e[8],1163531501,20),n=l(n,r,i,o,e[13],2850285829,5),o=l(o,n,r,i,e[2],4243563512,9),i=l(i,o,n,r,e[7],1735328473,14),n=d(n,r=l(r,i,o,n,e[12],2368359562,20),i,o,e[5],4294588738,4),o=d(o,n,r,i,e[8],2272392833,11),i=d(i,o,n,r,e[11],1839030562,16),r=d(r,i,o,n,e[14],4259657740,23),n=d(n,r,i,o,e[1],2763975236,4),o=d(o,n,r,i,e[4],1272893353,11),i=d(i,o,n,r,e[7],4139469664,16),r=d(r,i,o,n,e[10],3200236656,23),n=d(n,r,i,o,e[13],681279174,4),o=d(o,n,r,i,e[0],3936430074,11),i=d(i,o,n,r,e[3],3572445317,16),r=d(r,i,o,n,e[6],76029189,23),n=d(n,r,i,o,e[9],3654602809,4),o=d(o,n,r,i,e[12],3873151461,11),i=d(i,o,n,r,e[15],530742520,16),n=p(n,r=d(r,i,o,n,e[2],3299628645,23),i,o,e[0],4096336452,6),o=p(o,n,r,i,e[7],1126891415,10),i=p(i,o,n,r,e[14],2878612391,15),r=p(r,i,o,n,e[5],4237533241,21),n=p(n,r,i,o,e[12],1700485571,6),o=p(o,n,r,i,e[3],2399980690,10),i=p(i,o,n,r,e[10],4293915773,15),r=p(r,i,o,n,e[1],2240044497,21),n=p(n,r,i,o,e[8],1873313359,6),o=p(o,n,r,i,e[15],4264355552,10),i=p(i,o,n,r,e[6],2734768916,15),r=p(r,i,o,n,e[13],1309151649,21),n=p(n,r,i,o,e[4],4149444226,6),o=p(o,n,r,i,e[11],3174756917,10),i=p(i,o,n,r,e[2],718787259,15),r=p(r,i,o,n,e[9],3951481745,21),this._a=this._a+n|0,this._b=this._b+r|0,this._c=this._c+i|0,this._d=this._d+o|0},s.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=o.allocUnsafe(16);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e},t.exports=s},{"hash-base":54,inherits:61,"safe-buffer":230}],205:[function(e,t,n){"use strict";var r;if(!Object.keys){var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,a=e("./isArguments"),s=Object.prototype.propertyIsEnumerable,c=!s.call({toString:null},"toString"),u=s.call(function(){},"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=function(e){var t=e.constructor;return t&&t.prototype===e},p={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!p["$"+e]&&i.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{d(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();r=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===o.call(e),r=a(e),s=t&&"[object String]"===o.call(e),p=[];if(!t&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var h=u&&n;if(s&&e.length>0&&!i.call(e,0))for(var m=0;m<e.length;++m)p.push(String(m));if(r&&e.length>0)for(var v=0;v<e.length;++v)p.push(String(v));else for(var y in e)h&&"prototype"===y||!i.call(e,y)||p.push(String(y));if(c)for(var g=function(e){if("undefined"==typeof window||!f)return d(e);try{return d(e)}catch(e){return!1}}(e),S=0;S<l.length;++S)g&&"constructor"===l[S]||!i.call(e,l[S])||p.push(l[S]);return p}}t.exports=r},{"./isArguments":207}],206:[function(e,t,n){"use strict";var r=Array.prototype.slice,i=e("./isArguments"),o=Object.keys,a=o?function(e){return o(e)}:e("./implementation"),s=Object.keys;a.shim=function(){Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return i(e)?s(r.call(e)):s(e)}):Object.keys=a;return Object.keys||a},t.exports=a},{"./implementation":205,"./isArguments":207}],207:[function(e,t,n){"use strict";var r=Object.prototype.toString;t.exports=function(e){var t=r.call(e),n="[object Arguments]"===t;return n||(n="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===r.call(e.callee)),n}},{}],208:[function(e,t,n){n.endianness=function(){return"LE"},n.hostname=function(){return"undefined"!=typeof location?location.hostname:""},n.loadavg=function(){return[]},n.uptime=function(){return 0},n.freemem=function(){return Number.MAX_VALUE},n.totalmem=function(){return Number.MAX_VALUE},n.cpus=function(){return[]},n.type=function(){return"Browser"},n.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},n.networkInterfaces=n.getNetworkInterfaces=function(){return{}},n.arch=function(){return"javascript"},n.platform=function(){return"browser"},n.tmpdir=n.tmpDir=function(){return"/tmp"},n.EOL="\n"},{}],209:[function(e,t,n){var r=e("string.prototype.trim"),i=e("for-each");t.exports=function(e){if(!e)return{};var t={};return i(r(e).split("\n"),function(e){var n,i=e.indexOf(":"),o=r(e.slice(0,i)).toLowerCase(),a=r(e.slice(i+1));void 0===t[o]?t[o]=a:(n=t[o],"[object Array]"===Object.prototype.toString.call(n)?t[o].push(a):t[o]=[t[o],a])}),t}},{"for-each":49,"string.prototype.trim":322}],210:[function(e,t,n){(function(e){"use strict";void 0===e||!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,n,r,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,n)});case 3:return e.nextTick(function(){t.call(null,n,r)});case 4:return e.nextTick(function(){t.call(null,n,r,i)});default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return e.nextTick(function(){t.apply(null,o)})}}}:t.exports=e}).call(this,e("_process"))},{_process:8}],211:[function(e,t,n){(function(n,r){"use strict";var i=65536,o=4294967295;var a=e("safe-buffer").Buffer,s=r.crypto||r.msCrypto;s&&s.getRandomValues?t.exports=function(e,t){if(e>o)throw new RangeError("requested too many random bytes");var r=a.allocUnsafe(e);if(e>0)if(e>i)for(var c=0;c<e;c+=i)s.getRandomValues(r.slice(c,c+i));else s.getRandomValues(r);if("function"==typeof t)return n.nextTick(function(){t(null,r)});return r}:t.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:8,"safe-buffer":230}],212:[function(e,t,n){t.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":213}],213:[function(e,t,n){"use strict";var r=e("process-nextick-args"),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=d;var o=e("core-util-is");o.inherits=e("inherits");var a=e("./_stream_readable"),s=e("./_stream_writable");o.inherits(d,a);for(var c=i(s.prototype),u=0;u<c.length;u++){var l=c[u];d.prototype[l]||(d.prototype[l]=s.prototype[l])}function d(e){if(!(this instanceof d))return new d(e);a.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",p)}function p(){this.allowHalfOpen||this._writableState.ended||r.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),r.nextTick(t,e)}},{"./_stream_readable":215,"./_stream_writable":217,"core-util-is":27,inherits:61,"process-nextick-args":210}],214:[function(e,t,n){"use strict";t.exports=o;var r=e("./_stream_transform"),i=e("core-util-is");function o(e){if(!(this instanceof o))return new o(e);r.call(this,e)}i.inherits=e("inherits"),i.inherits(o,r),o.prototype._transform=function(e,t,n){n(null,e)}},{"./_stream_transform":216,"core-util-is":27,inherits:61}],215:[function(e,t,n){(function(n,r){"use strict";var i=e("process-nextick-args");t.exports=S;var o,a=e("isarray");S.ReadableState=g;e("events").EventEmitter;var s=function(e,t){return e.listeners(t).length},c=e("./internal/streams/stream"),u=e("safe-buffer").Buffer,l=r.Uint8Array||function(){};var d=e("core-util-is");d.inherits=e("inherits");var p=e("util"),f=void 0;f=p&&p.debuglog?p.debuglog("stream"):function(){};var h,m=e("./internal/streams/BufferList"),v=e("./internal/streams/destroy");d.inherits(S,c);var y=["error","close","destroy","pause","resume"];function g(t,n){t=t||{};var r=n instanceof(o=o||e("./_stream_duplex"));this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,a=t.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(a||0===a)?a:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(h||(h=e("string_decoder/").StringDecoder),this.decoder=new h(t.encoding),this.encoding=t.encoding)}function S(t){if(o=o||e("./_stream_duplex"),!(this instanceof S))return new S(t);this._readableState=new g(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),c.call(this)}function _(e,t,n,r,i){var o,a=e._readableState;null===t?(a.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,E(e)}(e,a)):(i||(o=function(e,t){var n;r=t,u.isBuffer(r)||r instanceof l||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));var r;return n}(a,t)),o?e.emit("error",o):a.objectMode||t&&t.length>0?("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===u.prototype||(t=function(e){return u.from(e)}(t)),r?a.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):b(e,a,t,!0):a.ended?e.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!n?(t=a.decoder.write(t),a.objectMode||0!==t.length?b(e,a,t,!1):P(e,a)):b(e,a,t,!1))):r||(a.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(a)}function b(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&E(e)),P(e,t)}Object.defineProperty(S.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=v.destroy,S.prototype._undestroy=v.undestroy,S.prototype._destroy=function(e,t){this.push(null),t(e)},S.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=u.from(e,t),t=""),n=!0),_(this,e,t,!1,n)},S.prototype.unshift=function(e){return _(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(t){return h||(h=e("string_decoder/").StringDecoder),this._readableState.decoder=new h(t),this._readableState.encoding=t,this};var C=8388608;function w(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=C?e=C:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function E(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(R,e):R(e))}function R(e){f("emit readable"),e.emit("readable"),M(e)}function P(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(L,e,t))}function L(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function T(e){f("readable nexttick read 0"),e.read(0)}function x(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),M(e),t.flowing&&!t.reading&&e.read(0)}function M(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function A(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,i=n.data;e-=i.length;for(;n=n.next;){var o=n.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0===(e-=a)){a===o.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(a));break}++r}return t.length-=r,i}(e,t):function(e,t){var n=u.allocUnsafe(e),r=t.head,i=1;r.data.copy(n),e-=r.data.length;for(;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,a),0===(e-=a)){a===o.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++i}return t.length-=i,n}(e,t);return r}(e,t.buffer,t.decoder),n);var n}function I(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(O,t,e))}function O(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function D(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}S.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?I(this):E(this),null;if(0===(e=w(e,t))&&t.ended)return 0===t.length&&I(this),null;var r,i=t.needReadable;return f("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",i=!0),t.ended||t.reading?f("reading or ended",i=!1):i&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=w(n,t))),null===(r=e>0?A(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&I(this)),null!==r&&this.emit("data",r),r},S.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},S.prototype.pipe=function(e,t){var r=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,f("pipe count=%d opts=%j",o.pipesCount,t);var c=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?l:S;function u(t,n){f("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,f("cleanup"),e.removeListener("close",y),e.removeListener("finish",g),e.removeListener("drain",d),e.removeListener("error",v),e.removeListener("unpipe",u),r.removeListener("end",l),r.removeListener("end",S),r.removeListener("data",m),p=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function l(){f("onend"),e.end()}o.endEmitted?i.nextTick(c):r.once("end",c),e.on("unpipe",u);var d=function(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,M(e))}}(r);e.on("drain",d);var p=!1;var h=!1;function m(t){f("ondata"),h=!1,!1!==e.write(t)||h||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==D(o.pipes,e))&&!p&&(f("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,h=!0),r.pause())}function v(t){f("onerror",t),S(),e.removeListener("error",v),0===s(e,"error")&&e.emit("error",t)}function y(){e.removeListener("finish",g),S()}function g(){f("onfinish"),e.removeListener("close",y),S()}function S(){f("unpipe"),r.unpipe(e)}return r.on("data",m),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?a(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",v),e.once("close",y),e.once("finish",g),e.emit("pipe",r),o.flowing||(f("pipe resume"),r.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n),this);if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var a=D(t.pipes,e);return-1===a?this:(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n),this)},S.prototype.on=function(e,t){var n=c.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&E(this):i.nextTick(T,this))}return n},S.prototype.addListener=S.prototype.on,S.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(x,e,t))}(this,e)),this},S.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},S.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",function(){if(f("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){(f("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<y.length;o++)e.on(y[o],this.emit.bind(this,y[o]));return this._read=function(t){f("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),S._fromList=A}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":213,"./internal/streams/BufferList":218,"./internal/streams/destroy":219,"./internal/streams/stream":220,_process:8,"core-util-is":27,events:44,inherits:61,isarray:221,"process-nextick-args":210,"safe-buffer":230,"string_decoder/":222,util:7}],216:[function(e,t,n){"use strict";t.exports=a;var r=e("./_stream_duplex"),i=e("core-util-is");function o(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function a(e){if(!(this instanceof a))return new a(e);r.call(this,e),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var e=this;"function"==typeof this._flush?this._flush(function(t,n){c(e,t,n)}):c(this,null,null)}function c(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=e("inherits"),i.inherits(a,r),a.prototype.push=function(e,t){return this._transformState.needTransform=!1,r.prototype.push.call(this,e,t)},a.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},a.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},a.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},a.prototype._destroy=function(e,t){var n=this;r.prototype._destroy.call(this,e,function(e){t(e),n.emit("close")})}},{"./_stream_duplex":213,"core-util-is":27,inherits:61}],217:[function(e,t,n){(function(n,r,i){"use strict";var o=e("process-nextick-args");function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}t.exports=g;var s,c=!n.browser&&["v0.10","v0.9."].indexOf(n.version.slice(0,5))>-1?i:o.nextTick;g.WritableState=y;var u=e("core-util-is");u.inherits=e("inherits");var l={deprecate:e("util-deprecate")},d=e("./internal/streams/stream"),p=e("safe-buffer").Buffer,f=r.Uint8Array||function(){};var h,m=e("./internal/streams/destroy");function v(){}function y(t,n){s=s||e("./_stream_duplex"),t=t||{};var r=n instanceof s;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,u=t.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(u||0===u)?u:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var d=!1===t.decodeStrings;this.decodeStrings=!d,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,i){--t.pendingcb,n?(o.nextTick(i,r),o.nextTick(E,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(i(r),e._writableState.errorEmitted=!0,e.emit("error",r),E(e,t))}(e,n,r,t,i);else{var a=C(n);a||n.corked||n.bufferProcessing||!n.bufferedRequest||b(e,n),r?c(_,e,n,a,i):_(e,n,a,i)}}(n,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function g(t){if(s=s||e("./_stream_duplex"),!(h.call(g,this)||this instanceof s))return new g(t);this._writableState=new y(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),d.call(this)}function S(e,t,n,r,i,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function _(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),E(e,t)}function b(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),o=t.corkedRequestsFree;o.entry=n;for(var s=0,c=!0;n;)i[s]=n,n.isBuf||(c=!1),n=n.next,s+=1;i.allBuffers=c,S(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,l=n.encoding,d=n.callback;if(S(e,t,!1,t.objectMode?1:u.length,u,l,d),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function C(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function w(e,t){e._final(function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),E(e,t)})}function E(e,t){var n=C(t);return n&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,o.nextTick(w,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}u.inherits(g,d),y.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(y.prototype,"buffer",{get:l.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(e){return!!h.call(this,e)||this===g&&(e&&e._writableState instanceof y)}})):h=function(e){return e instanceof this},g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},g.prototype.write=function(e,t,n){var r,i=this._writableState,a=!1,s=!i.objectMode&&(r=e,p.isBuffer(r)||r instanceof f);return s&&!p.isBuffer(e)&&(e=function(e){return p.from(e)}(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof n&&(n=v),i.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),o.nextTick(t,n)}(this,n):(s||function(e,t,n,r){var i=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),o.nextTick(r,a),i=!1),i}(this,i,e,n))&&(i.pendingcb++,a=function(e,t,n,r,i,o){if(!n){var a=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=p.from(t,n));return t}(t,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=t.objectMode?1:r.length;t.length+=s;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else S(e,t,!1,s,r,i,o);return c}(this,i,s,e,t,n)),a},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||b(this,e))},g.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},g.prototype._writev=null,g.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,E(e,t),n&&(t.finished?o.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,r,n)},Object.defineProperty(g.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),g.prototype.destroy=m.destroy,g.prototype._undestroy=m.undestroy,g.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{"./_stream_duplex":213,"./internal/streams/destroy":219,"./internal/streams/stream":220,_process:8,"core-util-is":27,inherits:61,"process-nextick-args":210,"safe-buffer":230,timers:326,"util-deprecate":328}],218:[function(e,t,n){"use strict";var r=e("safe-buffer").Buffer,i=e("util");t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var t,n,i,o=r.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,n=o,i=s,t.copy(n,i),s+=a.data.length,a=a.next;return o},e}(),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},{"safe-buffer":230,util:7}],219:[function(e,t,n){"use strict";var r=e("process-nextick-args");function i(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var n=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(r.nextTick(i,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":210}],220:[function(e,t,n){t.exports=e("events").EventEmitter},{events:44}],221:[function(e,t,n){arguments[4][11][0].apply(n,arguments)},{dup:11}],222:[function(e,t,n){"use strict";var r=e("safe-buffer").Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=u,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=l,this.end=d,t=3;break;default:return this.write=p,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function l(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function p(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}n.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=a(t[r]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=a(t[r]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=a(t[r]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":230}],223:[function(e,t,n){t.exports=e("./readable").PassThrough},{"./readable":224}],224:[function(e,t,n){(n=t.exports=e("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":213,"./lib/_stream_passthrough.js":214,"./lib/_stream_readable.js":215,"./lib/_stream_transform.js":216,"./lib/_stream_writable.js":217}],225:[function(e,t,n){t.exports=e("./readable").Transform},{"./readable":224}],226:[function(e,t,n){t.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":217}],227:[function(e,t,n){"use strict";var r=e("buffer").Buffer,i=e("inherits"),o=e("hash-base"),a=new Array(16),s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],c=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],u=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],l=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],d=[0,1518500249,1859775393,2400959708,2840853838],p=[1352829926,1548603684,1836072691,2053994217,0];function f(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function h(e,t){return e<<t|e>>>32-t}function m(e,t,n,r,i,o,a,s){return h(e+(t^n^r)+o+a|0,s)+i|0}function v(e,t,n,r,i,o,a,s){return h(e+(t&n|~t&r)+o+a|0,s)+i|0}function y(e,t,n,r,i,o,a,s){return h(e+((t|~n)^r)+o+a|0,s)+i|0}function g(e,t,n,r,i,o,a,s){return h(e+(t&r|n&~r)+o+a|0,s)+i|0}function S(e,t,n,r,i,o,a,s){return h(e+(t^(n|~r))+o+a|0,s)+i|0}i(f,o),f.prototype._update=function(){for(var e=a,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);for(var n=0|this._a,r=0|this._b,i=0|this._c,o=0|this._d,f=0|this._e,_=0|this._a,b=0|this._b,C=0|this._c,w=0|this._d,E=0|this._e,R=0;R<80;R+=1){var P,L;R<16?(P=m(n,r,i,o,f,e[s[R]],d[0],u[R]),L=S(_,b,C,w,E,e[c[R]],p[0],l[R])):R<32?(P=v(n,r,i,o,f,e[s[R]],d[1],u[R]),L=g(_,b,C,w,E,e[c[R]],p[1],l[R])):R<48?(P=y(n,r,i,o,f,e[s[R]],d[2],u[R]),L=y(_,b,C,w,E,e[c[R]],p[2],l[R])):R<64?(P=g(n,r,i,o,f,e[s[R]],d[3],u[R]),L=v(_,b,C,w,E,e[c[R]],p[3],l[R])):(P=S(n,r,i,o,f,e[s[R]],d[4],u[R]),L=m(_,b,C,w,E,e[c[R]],p[4],l[R])),n=f,f=o,o=h(i,10),i=r,r=P,_=E,E=w,w=h(C,10),C=b,b=L}var T=this._b+i+w|0;this._b=this._c+o+E|0,this._c=this._d+f+_|0,this._d=this._e+n+b|0,this._e=this._a+r+C|0,this._a=T},f.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=r.alloc?r.alloc(20):new r(20);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e.writeInt32LE(this._e,16),e},t.exports=f},{buffer:10,"hash-base":54,inherits:61}],228:[function(e,t,n){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},r.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach(function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);return{usernameFragment:(n=n.concat(r.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],a=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=r.parseRtpMap(a),c=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?r.parseFmtp(c[0]):{},s.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)});var i=0;return t.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=r.writeExtmap(e)}),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),n.push(r),o&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},n.push(r))}}),0===n.length&&c&&n.push({ssrc:c});var l=r.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=l})),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var i=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=r)},{}],229:[function(e,t,n){"use strict";var r=e("sdp");function i(e,t,n,i,o){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":o||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c="msid:"+(i?i.id:"-")+" "+s+"\r\n";a+="a="+c,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a}function o(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),a=r(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach(function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!i(r,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter(function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}}),n}function a(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function s(e,t){var n=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function u(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout(function(){t._dispatchEvent("track",o)})}var l=function(n){var i=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){i[e]=o[e].bind(o)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)}),delete e.url,e.urls=i?r[0]:r,!!r.length}})}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},l.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find(function(e){return e.track===t}))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},l.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach(function(t){n.addTrack(t,e)});else{var r=e.clone();e.getTracks().forEach(function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),r.getTracks().forEach(function(e){n.addTrack(e,r)})}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find(function(e){return e.rtpSender===t});if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var n=t.getSenders().find(function(t){return t.track===e});n&&t.removeTrack(n)})},l.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},l.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},l.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},l.prototype._gather=function(t,n){var i=this,o=this.transceivers[n].iceGatherer;if(!o.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),o.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,c=!s||0===Object.keys(s).length;if(c)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),s.component=1,s.ufrag=o.getLocalParameters().usernameFragment;var u=r.writeCandidate(s);a.candidate=Object.assign(a.candidate,r.parseCandidate(u)),a.candidate.candidate=u,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var l=r.getMediaSections(i._localDescription.sdp);l[a.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+l.join("");var d=i.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",a),d&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout(function(){a.forEach(function(e){o.onlocalcandidate(e)})},0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,n,i){var a=o(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),i&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},l.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach(function(e,t){var n=r.parseRtpParameters(e);i.transceivers[t].localCapabilities=n}),i.transceivers.forEach(function(e,t){i._gather(e.mid,t)});else if("answer"===e.type){t=r.splitSections(i._remoteDescription.sdp),n=t.shift();var s=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach(function(e,t){var a=i.transceivers[t],c=a.iceGatherer,u=a.iceTransport,l=a.dtlsTransport,d=a.localCapabilities,p=a.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length)&&!a.rejected){var f=r.getIceParameters(e,n),h=r.getDtlsParameters(e,n);s&&(h.role="server"),i.usingBundle&&0!==t||(i._gather(a.mid,t),"new"===u.state&&u.start(c,f,s?"controlling":"controlled"),"new"===l.state&&l.start(h));var m=o(d,p);i._transceive(a,m.codecs.length>0,!1)}})}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(i){var l=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!a("setRemoteDescription",i.type,l.signalingState)||l._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+l.signalingState));var d={};l.remoteStreams.forEach(function(e){d[e.id]=e});var p=[],f=r.splitSections(i.sdp),h=f.shift(),m=r.matchPrefix(h,"a=ice-lite").length>0,v=r.matchPrefix(h,"a=group:BUNDLE ").length>0;l.usingBundle=v;var y=r.matchPrefix(h,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!y&&y.substr(14).split(" ").indexOf("trickle")>=0,f.forEach(function(a,c){var u=r.splitLines(a),f=r.getKind(a),y=r.isRejected(a)&&0===r.matchPrefix(a,"a=bundle-only").length,g=u[0].substr(2).split(" ")[2],S=r.getDirection(a,h),_=r.parseMsid(a),b=r.getMid(a)||r.generateIdentifier();if(y||"application"===f&&("DTLS/SCTP"===g||"UDP/DTLS/SCTP"===g))l.transceivers[c]={mid:b,kind:f,protocol:g,rejected:!0};else{var C,w,E,R,P,L,T,x,M;!y&&l.transceivers[c]&&l.transceivers[c].rejected&&(l.transceivers[c]=l._createTransceiver(f,!0));var A,I,O=r.parseRtpParameters(a);y||(A=r.getIceParameters(a,h),(I=r.getDtlsParameters(a,h)).role="client"),T=r.parseRtpEncodingParameters(a);var D=r.parseRtcpParameters(a),k=r.matchPrefix(a,"a=end-of-candidates",h).length>0,j=r.matchPrefix(a,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===i.type||"answer"===i.type)&&!y&&v&&c>0&&l.transceivers[c]&&(l._disposeIceAndDtlsTransports(c),l.transceivers[c].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[c].iceTransport=l.transceivers[0].iceTransport,l.transceivers[c].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[c].rtpSender&&l.transceivers[c].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[c].rtpReceiver&&l.transceivers[c].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==i.type||y){if("answer"===i.type&&!y){w=(C=l.transceivers[c]).iceGatherer,E=C.iceTransport,R=C.dtlsTransport,P=C.rtpReceiver,L=C.sendEncodingParameters,x=C.localCapabilities,l.transceivers[c].recvEncodingParameters=T,l.transceivers[c].remoteCapabilities=O,l.transceivers[c].rtcpParameters=D,j.length&&"new"===E.state&&(!m&&!k||v&&0!==c?j.forEach(function(e){s(C.iceTransport,e)}):E.setRemoteCandidates(j)),v&&0!==c||("new"===E.state&&E.start(w,A,"controlling"),"new"===R.state&&R.start(I)),!o(C.localCapabilities,C.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&C.sendEncodingParameters[0].rtx&&delete C.sendEncodingParameters[0].rtx,l._transceive(C,"sendrecv"===S||"recvonly"===S,"sendrecv"===S||"sendonly"===S),!P||"sendrecv"!==S&&"sendonly"!==S?delete C.rtpReceiver:(M=P.track,_?(d[_.stream]||(d[_.stream]=new e.MediaStream),n(M,d[_.stream]),p.push([M,P,d[_.stream]])):(d.default||(d.default=new e.MediaStream),n(M,d.default),p.push([M,P,d.default])))}}else{(C=l.transceivers[c]||l._createTransceiver(f)).mid=b,C.iceGatherer||(C.iceGatherer=l._createIceGatherer(c,v)),j.length&&"new"===C.iceTransport.state&&(!k||v&&0!==c?j.forEach(function(e){s(C.iceTransport,e)}):C.iceTransport.setRemoteCandidates(j)),x=e.RTCRtpReceiver.getCapabilities(f),t<15019&&(x.codecs=x.codecs.filter(function(e){return"rtx"!==e.name})),L=C.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var N,V=!1;if("sendrecv"===S||"sendonly"===S){if(V=!C.rtpReceiver,P=C.rtpReceiver||new e.RTCRtpReceiver(C.dtlsTransport,f),V)M=P.track,_&&"-"===_.stream||(_?(d[_.stream]||(d[_.stream]=new e.MediaStream,Object.defineProperty(d[_.stream],"id",{get:function(){return _.stream}})),Object.defineProperty(M,"id",{get:function(){return _.track}}),N=d[_.stream]):(d.default||(d.default=new e.MediaStream),N=d.default)),N&&(n(M,N),C.associatedRemoteMediaStreams.push(N)),p.push([M,P,N])}else C.rtpReceiver&&C.rtpReceiver.track&&(C.associatedRemoteMediaStreams.forEach(function(t){var n,r,i=t.getTracks().find(function(e){return e.id===C.rtpReceiver.track.id});i&&(n=i,(r=t).removeTrack(n),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:n})))}),C.associatedRemoteMediaStreams=[]);C.localCapabilities=x,C.remoteCapabilities=O,C.rtpReceiver=P,C.rtcpParameters=D,C.sendEncodingParameters=L,C.recvEncodingParameters=T,l._transceive(l.transceivers[c],!1,V)}}}),void 0===l._dtlsRole&&(l._dtlsRole="offer"===i.type?"active":"passive"),l._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(d).forEach(function(t){var n=d[t];if(n.getTracks().length){if(-1===l.remoteStreams.indexOf(n)){l.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout(function(){l._dispatchEvent("addstream",r)})}p.forEach(function(e){var t=e[0],r=e[1];n.id===e[2].id&&u(l,t,r,[n])})}}),p.forEach(function(e){e[2]||u(l,e[0],e[1],[])}),e.setTimeout(function(){l&&l.transceivers&&l.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},l.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var o=n.transceivers.filter(function(e){return"audio"===e.kind}).length,a=n.transceivers.filter(function(e){return"video"===e.kind}).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(o=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(a=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(n.transceivers.forEach(function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)});o>0||a>0;)o>0&&(n._createTransceiver("audio"),o--),a>0&&(n._createTransceiver("video"),a--);var u=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach(function(i,o){var a=i.track,s=i.kind,c=i.mid||r.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(o,n.usingBundle));var u=e.RTCRtpSender.getCapabilities(s);t<15019&&(u.codecs=u.codecs.filter(function(e){return"rtx"!==e.name})),u.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach(function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)})}),u.headerExtensions.forEach(function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach(function(t){e.uri===t.uri&&(e.id=t.id)})});var l=i.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];a&&t>=15019&&"video"===s&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,s)),i.localCapabilities=u,i.sendEncodingParameters=l}),"max-compat"!==n._config.bundlePolicy&&(u+="a=group:BUNDLE "+n.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),u+="a=ice-options:trickle\r\n",n.transceivers.forEach(function(e,t){u+=i(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),u+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,u+="a="+r.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(u+="a=end-of-candidates\r\n"))});var l=new e.RTCSessionDescription({type:"offer",sdp:u});return Promise.resolve(l)},l.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var a=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+="a=group:BUNDLE "+n.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var s=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach(function(e,r){if(!(r+1>s)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;if(e.stream)"audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var u=o(e.localCapabilities,e.remoteCapabilities);!u.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=i(e,u,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}});var u=new e.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(u)},l.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(i,o){if(!n._remoteDescription)return o(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var u=0;u<n.transceivers.length;u++)if(n.transceivers[u].mid===e.sdpMid){a=u;break}var l=n.transceivers[a];if(!l)return o(c("OperationError","Can not add ICE candidate"));if(l.rejected)return i();var d=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===d.protocol&&(0===d.port||9===d.port))return i();if(d.component&&1!==d.component)return i();if((0===a||a>0&&l.iceTransport!==n.transceivers[0].iceTransport)&&!s(l.iceTransport,d))return o(c("OperationError","Can not add ICE candidate"));var p=e.candidate.trim();0===p.indexOf("a=")&&(p=p.substr(2)),(t=r.getMediaSections(n._remoteDescription.sdp))[a]+="a="+(d.type?p:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var f=0;f<n.transceivers.length&&(n.transceivers[f].rejected||(n.transceivers[f].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(n._remoteDescription.sdp))[f]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));f++);i()})},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)}),!n)throw c("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){e[t]&&r.push(e[t].getStats())})}),Promise.all(r).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then(function(e){var t=new Map;return Object.keys(e).forEach(function(n){var r;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(r=e[n]).type]||r.type,t.set(n,e[n])}),t})}}});var d=["createOffer","createAnswer"];return d.forEach(function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then(function(t){"function"==typeof e[0]&&e[0].apply(null,[t])},function(t){"function"==typeof e[1]&&e[1].apply(null,[t])}):t.apply(this,arguments)}}),(d=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)},function(t){"function"==typeof e[2]&&e[2].apply(null,[t])}):t.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),l}},{sdp:228}],230:[function(e,t,n){var r=e("buffer"),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,n),n.Buffer=a),o(i,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},{buffer:10}],231:[function(e,t,n){var r;r=function(e,t){function n(){}n.prototype.name="ANONYMOUS",n.prototype.clientFirst=!0,n.prototype.response=function(e){return e.trace||""},n.prototype.challenge=function(e){},t.exports=n},"object"==typeof n?r(0,t):"function"==typeof define&&define.amd&&define(["exports","module"],r)},{}],232:[function(e,t,n){var r;r=function(e,t,n){(t.exports=n).Mechanism=n},"object"==typeof n?r(0,t,e("./lib/mechanism")):"function"==typeof define&&define.amd&&define(["exports","module","./lib/mechanism"],r)},{"./lib/mechanism":231}],233:[function(e,t,n){var r;r=function(e,t){function n(){}n.prototype.name="EXTERNAL",n.prototype.clientFirst=!0,n.prototype.response=function(e){return e.authzid||""},n.prototype.challenge=function(e){},t.exports=n},"object"==typeof n?r(0,t):"function"==typeof define&&define.amd&&define(["exports","module"],r)},{}],234:[function(e,t,n){arguments[4][232][0].apply(n,arguments)},{"./lib/mechanism":233,dup:232}],235:[function(e,t,n){var r;r=function(e,t){function n(){}n.prototype.name="PLAIN",n.prototype.clientFirst=!0,n.prototype.response=function(e){var t="";return t+=e.authzid||"",t+="\0",t+=e.username,t+="\0",t+=e.password},n.prototype.challenge=function(e){return this},t.exports=n},"object"==typeof n?r(0,t):"function"==typeof define&&define.amd&&define(["exports","module"],r)},{}],236:[function(e,t,n){arguments[4][232][0].apply(n,arguments)},{"./lib/mechanism":235,dup:232}],237:[function(e,t,n){(function(n){var r=e("./lib/bitops"),i=e("./lib/utils"),o={};function a(e){e=e||{},this._genNonce=e.genNonce||i.genNonce,this._stage="initial"}a.Mechanism=a,a.prototype.name="SCRAM-SHA-1",a.prototype.clientFirst=!0,a.prototype.response=function(e){return o[this._stage](this,e)},a.prototype.challenge=function(e){var t=i.parse(e);return this._salt=new n(t.s||"","base64"),this._iterationCount=parseInt(t.i,10),this._nonce=t.r,this._verifier=t.v,this._error=t.e,this._challenge=e,this},o.initial=function(e,t){e._cnonce=e._genNonce();var n="";t.authzid&&(n="a="+i.saslname(t.authzid)),e._gs2Header="n,"+n+",";var r="r="+e._cnonce,o="n="+i.saslname(t.username||"");e._clientFirstMessageBare=o+","+r;var a=e._gs2Header+e._clientFirstMessageBare;return e._stage="challenge",a},o.challenge=function(e,t){var i,o,a,s=new n(e._gs2Header).toString("base64");e._clientFinalMessageWithoutProof="c="+s+",r="+e._nonce,t.salt&&0===n.compare(t.salt,e._salt)?t.clientKey&&t.serverKey?(o=t.clientKey,a=t.serverKey):t.saltedPassword&&(i=t.saltedPassword,o=r.HMAC(i,"Client Key"),a=r.HMAC(i,"Server Key")):(i=r.Hi(t.password||"",e._salt,e._iterationCount),o=r.HMAC(i,"Client Key"),a=r.HMAC(i,"Server Key"));var c=r.H(o),u=e._clientFirstMessageBare+","+e._challenge+","+e._clientFinalMessageWithoutProof,l=r.HMAC(c,u),d=r.XOR(o,l).toString("base64");e._serverSignature=r.HMAC(a,u);var p=e._clientFinalMessageWithoutProof+",p="+d;return e._stage="final",e.cache={salt:e._salt,saltedPassword:i,clientKey:o,serverKey:a},p},o.final=function(){return""},t.exports=a}).call(this,e("buffer").Buffer)},{"./lib/bitops":238,"./lib/utils":239,buffer:10}],238:[function(e,t,n){(function(t){var r=e("create-hash"),i=e("create-hmac"),o=e("bitwise-xor");n.XOR=o,n.H=function(e){return r("sha1").update(e).digest()},n.HMAC=function(e,t){return i("sha1",e).update(t).digest()},n.Hi=function(e,r,i){for(var o=n.HMAC(e,t.concat([r,new t([0,0,0,1],"binary")])),a=o,s=0;s<i-1;s++)o=n.HMAC(e,o),a=n.XOR(a,o);return a}}).call(this,e("buffer").Buffer)},{"bitwise-xor":6,buffer:10,"create-hash":28,"create-hmac":30}],239:[function(e,t,n){var r=e("randombytes").randomBytes||e("randombytes");n.parse=function(e){for(var t={},n=e.split(/,(?=(?:[^"]|"[^"]*")*$)/),r=0,i=n.length;r<i;r++){var o=/(\w+)=["]?([^"]+)["]?$/.exec(n[r]);o&&(t[o[1]]=o[2])}return t},n.saslname=function(e){for(var t=[],n="",r=0;r<e.length;r++)","===(n=e[r])?t.push("=2C"):"="===n?t.push("=3D"):t.push(n);return t.join("")},n.genNonce=function(e){return r((e||32)/2).toString("hex")}},{randombytes:211}],240:[function(e,t,n){var r;r=function(e,t){function n(){}n.prototype.name="X-OAUTH2",n.prototype.clientFirst=!0,n.prototype.response=function(e){var t="";return t+="\0",t+=e.username,t+="\0",t+=e.token},n.prototype.challenge=function(e){},t.exports=n},"object"==typeof n?r(0,t):"function"==typeof define&&define.amd&&define(["exports","module"],r)},{}],241:[function(e,t,n){arguments[4][232][0].apply(n,arguments)},{"./lib/mechanism":240,dup:232}],242:[function(e,t,n){var r;r=function(e,t){function n(){this._mechs=[]}n.prototype.use=function(e,t){return t||(e=(t=e).prototype.name),this._mechs.push({name:e,mech:t}),this},n.prototype.create=function(e){for(var t=0,n=this._mechs.length;t<n;t++)for(var r=0,i=e.length;r<i;r++){var o=this._mechs[t];if(o.name==e[r])return new o.mech}return null},t.exports=n},"object"==typeof n?r(0,t):"function"==typeof define&&define.amd&&define(["exports","module"],r)},{}],243:[function(e,t,n){var r;r=function(e,t,n){(t.exports=n).Factory=n},"object"==typeof n?r(0,t,e("./lib/factory")):"function"==typeof define&&define.amd&&define(["exports","module","./lib/factory"],r)},{"./lib/factory":242}],244:[function(e,t,n){var r=e("./lib/tosdp"),i=e("./lib/tojson");n.toIncomingSDPOffer=function(e){return r.toSessionSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingSDPOffer=function(e){return r.toSessionSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingSDPAnswer=function(e){return r.toSessionSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingSDPAnswer=function(e){return r.toSessionSDP(e,{role:"responder",direction:"outgoing"})},n.toIncomingMediaSDPOffer=function(e){return r.toMediaSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingMediaSDPOffer=function(e){return r.toMediaSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingMediaSDPAnswer=function(e){return r.toMediaSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingMediaSDPAnswer=function(e){return r.toMediaSDP(e,{role:"responder",direction:"outgoing"})},n.toCandidateSDP=r.toCandidateSDP,n.toMediaSDP=r.toMediaSDP,n.toSessionSDP=r.toSessionSDP,n.toIncomingJSONOffer=function(e,t){return i.toSessionJSON(e,{role:"responder",direction:"incoming",creators:t})},n.toOutgoingJSONOffer=function(e,t){return i.toSessionJSON(e,{role:"initiator",direction:"outgoing",creators:t})},n.toIncomingJSONAnswer=function(e,t){return i.toSessionJSON(e,{role:"initiator",direction:"incoming",creators:t})},n.toOutgoingJSONAnswer=function(e,t){return i.toSessionJSON(e,{role:"responder",direction:"outgoing",creators:t})},n.toIncomingMediaJSONOffer=function(e,t){return i.toMediaJSON(e,{role:"responder",direction:"incoming",creator:t})},n.toOutgoingMediaJSONOffer=function(e,t){return i.toMediaJSON(e,{role:"initiator",direction:"outgoing",creator:t})},n.toIncomingMediaJSONAnswer=function(e,t){return i.toMediaJSON(e,{role:"initiator",direction:"incoming",creator:t})},n.toOutgoingMediaJSONAnswer=function(e,t){return i.toMediaJSON(e,{role:"responder",direction:"outgoing",creator:t})},n.toCandidateJSON=i.toCandidateJSON,n.toMediaJSON=i.toMediaJSON,n.toSessionJSON=i.toSessionJSON},{"./lib/tojson":247,"./lib/tosdp":248}],245:[function(e,t,n){n.lines=function(e){return e.split("\r\n").filter(function(e){return e.length>0})},n.findLine=function(e,t,n){for(var r=e.length,i=0;i<t.length;i++)if(t[i].substr(0,r)===e)return t[i];if(!n)return!1;for(var o=0;o<n.length;o++)if(n[o].substr(0,r)===e)return n[o];return!1},n.findLines=function(e,t,n){for(var r=[],i=e.length,o=0;o<t.length;o++)t[o].substr(0,i)===e&&r.push(t[o]);if(r.length||!n)return r;for(var a=0;a<n.length;a++)n[a].substr(0,i)===e&&r.push(n[a]);return r},n.mline=function(e){for(var t=e.substr(2).split(" "),n={media:t[0],port:t[1],proto:t[2],formats:[]},r=3;r<t.length;r++)t[r]&&n.formats.push(t[r]);return n},n.rtpmap=function(e){var t=e.substr(9).split(" "),n={id:t.shift()};return t=t[0].split("/"),n.name=t[0],n.clockrate=t[1],n.channels=3==t.length?t[2]:"1",n},n.sctpmap=function(e){var t=e.substr(10).split(" ");return{number:t.shift(),protocol:t.shift(),streams:t.shift()}},n.fmtp=function(e){for(var t,n,r,i=e.substr(e.indexOf(" ")+1).split(";"),o=[],a=0;a<i.length;a++)n=(t=i[a].split("="))[0].trim(),r=t[1],n&&r?o.push({key:n,value:r}):n&&o.push({key:"",value:n});return o},n.crypto=function(e){var t=e.substr(9).split(" ");return{tag:t[0],cipherSuite:t[1],keyParams:t[2],sessionParams:t.slice(3).join(" ")}},n.fingerprint=function(e){var t=e.substr(14).split(" ");return{hash:t[0],value:t[1]}},n.extmap=function(e){var t=e.substr(9).split(" "),n={},r=t.shift(),i=r.indexOf("/");return i>=0?(n.id=r.substr(0,i),n.senders=r.substr(i+1)):(n.id=r,n.senders="sendrecv"),n.uri=t.shift()||"",n},n.rtcpfb=function(e){var t=e.substr(10).split(" "),n={};return n.id=t.shift(),n.type=t.shift(),"trr-int"===n.type?n.value=t.shift():n.subtype=t.shift()||"",n.parameters=t,n},n.candidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:t[1],protocol:t[2].toLowerCase(),priority:t[3],ip:t[4],port:t[5],type:t[7],generation:"0"},r=8;r<t.length;r+=2)"raddr"===t[r]?n.relAddr=t[r+1]:"rport"===t[r]?n.relPort=t[r+1]:"generation"===t[r]?n.generation=t[r+1]:"tcptype"===t[r]&&(n.tcpType=t[r+1]);return n.network="1",n},n.sourceGroups=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n].substr(13).split(" ");t.push({semantics:r.shift(),sources:r})}return t},n.sources=function(e){for(var t=[],n={},r=0;r<e.length;r++){var i=e[r].substr(7).split(" "),o=i.shift();if(!n[o]){var a={ssrc:o,parameters:[]};t.push(a),n[o]=a}var s=(i=i.join(" ").split(":")).shift(),c=i.join(":")||null;n[o].parameters.push({key:s,value:c})}return t},n.groups=function(e){for(var t,n=[],r=0;r<e.length;r++)t=e[r].substr(8).split(" "),n.push({semantics:t.shift(),contents:t});return n},n.bandwidth=function(e){var t=e.substr(2).split(":"),n={};return n.type=t.shift(),n.bandwidth=t.shift(),n},n.msid=function(e){var t=e.substr(7),n=t.split(" ");return{msid:t,mslabel:n[0],label:n[1]}}},{}],246:[function(e,t,n){t.exports={initiator:{incoming:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],247:[function(e,t,n){var r=e("./senders"),i=e("./parsers"),o=Math.random();n._setIdCounter=function(e){o=e},n.toSessionJSON=function(e,t){var r,o=t.creators||[],a=t.role||"initiator",s=t.direction||"outgoing",c=e.split("\r\nm=");for(r=1;r<c.length;r++)c[r]="m="+c[r],r!==c.length-1&&(c[r]+="\r\n");var u=c.shift()+"\r\n",l=i.lines(u),d={},p=[];for(r=0;r<c.length;r++)p.push(n.toMediaJSON(c[r],u,{role:a,direction:s,creator:o[r]||"initiator"}));d.contents=p;var f=i.findLines("a=group:",l);return f.length&&(d.groups=i.groups(f)),d},n.toMediaJSON=function(e,t,o){var a=o.creator||"initiator",s=o.role||"initiator",c=o.direction||"outgoing",u=i.lines(e),l=i.lines(t),d=i.mline(u[0]),p={creator:a,name:d.media,application:{applicationType:"rtp",media:d.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transportType:"iceUdp",candidates:[],fingerprints:[]}};"application"==d.media&&(p.application={applicationType:"datachannel"},p.transport.sctp=[]);var f=p.application,h=p.transport,m=i.findLine("a=mid:",u);if(m&&(p.name=m.substr(6)),i.findLine("a=sendrecv",u,l)?p.senders="both":i.findLine("a=sendonly",u,l)?p.senders=r[s][c].sendonly:i.findLine("a=recvonly",u,l)?p.senders=r[s][c].recvonly:i.findLine("a=inactive",u,l)&&(p.senders="none"),"rtp"==f.applicationType){var v=i.findLine("b=",u);v&&(f.bandwidth=i.bandwidth(v));var y=i.findLine("a=ssrc:",u);y&&(f.ssrc=y.substr(7).split(" ")[0]),i.findLines("a=rtpmap:",u).forEach(function(e){var t=i.rtpmap(e);t.parameters=[],t.feedback=[],i.findLines("a=fmtp:"+t.id,u).forEach(function(e){t.parameters=i.fmtp(e)}),i.findLines("a=rtcp-fb:"+t.id,u).forEach(function(e){t.feedback.push(i.rtcpfb(e))}),f.payloads.push(t)}),i.findLines("a=crypto:",u,l).forEach(function(e){f.encryption.push(i.crypto(e))}),i.findLines("a=rtcp-fb:*",u).forEach(function(e){f.feedback.push(i.rtcpfb(e))}),i.findLines("a=extmap:",u).forEach(function(e){var t=i.extmap(e);t.senders=r[s][c][t.senders],f.headerExtensions.push(t)});var g=i.findLines("a=ssrc-group:",u);f.sourceGroups=i.sourceGroups(g||[]);var S=i.findLines("a=ssrc:",u),_=f.sources=i.sources(S||[]),b=i.findLine("a=msid:",u);if(b){var C=i.msid(b);["msid","mslabel","label"].forEach(function(e){for(var t=0;t<_.length;t++){for(var n=!1,r=0;r<_[t].parameters.length;r++)_[t].parameters[r].key===e&&(n=!0);n||_[t].parameters.push({key:e,value:C[e]})}})}i.findLine("a=x-google-flag:conference",u,l)&&(f.googConferenceFlag=!0)}i.findLine("a=rtcp-mux",u)&&(h.usertcpmux="true");var w=i.findLines("a=fingerprint:",u,l),E=i.findLine("a=setup:",u,l);w.forEach(function(e){var t=i.fingerprint(e);E&&(t.setup=E.substr(8)),h.fingerprints.push(t)});var R=i.findLine("a=ice-ufrag:",u,l),P=i.findLine("a=ice-pwd:",u,l);R&&P&&(h.ufrag=R.substr(12),h.pwd=P.substr(10),h.candidates=[],i.findLines("a=candidate:",u,l).forEach(function(e){h.candidates.push(n.toCandidateJSON(e))}));"datachannel"==f.applicationType&&i.findLines("a=sctpmap:",u).forEach(function(e){var t=i.sctpmap(e);h.sctp.push(t)});return p},n.toCandidateJSON=function(e){var t=i.candidate(e.split("\r\n")[0]);return t.id=(o++).toString(36).substr(0,12),t}},{"./parsers":245,"./senders":246}],248:[function(e,t,n){var r=e("./senders");n.toSessionSDP=function(e,t){t.role,t.direction;var r=["v=0","o=- "+(t.sid||e.sid||Date.now())+" "+(t.time||Date.now())+" IN IP4 0.0.0.0","s=-","t=0 0"],i=e.contents||[],o=!1;return i.forEach(function(e){e.application.sources&&e.application.sources.length&&(o=!0)}),o&&r.push("a=msid-semantic: WMS *"),(e.groups||[]).forEach(function(e){r.push("a=group:"+e.semantics+" "+e.contents.join(" "))}),i.forEach(function(e){r.push(n.toMediaSDP(e,t))}),r.join("\r\n")+"\r\n"},n.toMediaSDP=function(e,t){var i=[],o=t.role||"initiator",a=t.direction||"outgoing",s=e.application,c=e.transport,u=s.payloads||[],l=c&&c.fingerprints||[],d=[];if("datachannel"==s.applicationType?(d.push("application"),d.push("1"),d.push("DTLS/SCTP"),c.sctp&&c.sctp.forEach(function(e){d.push(e.number)})):(d.push(s.media),d.push("1"),l.length>0?d.push("UDP/TLS/RTP/SAVPF"):s.encryption&&s.encryption.length>0?d.push("RTP/SAVPF"):d.push("RTP/AVPF"),u.forEach(function(e){d.push(e.id)})),i.push("m="+d.join(" ")),i.push("c=IN IP4 0.0.0.0"),s.bandwidth&&s.bandwidth.type&&s.bandwidth.bandwidth&&i.push("b="+s.bandwidth.type+":"+s.bandwidth.bandwidth),"rtp"==s.applicationType&&i.push("a=rtcp:1 IN IP4 0.0.0.0"),c){c.ufrag&&i.push("a=ice-ufrag:"+c.ufrag),c.pwd&&i.push("a=ice-pwd:"+c.pwd);l.forEach(function(e){i.push("a=fingerprint:"+e.hash+" "+e.value),e.setup&&i.push("a=setup:"+e.setup)}),c.sctp&&c.sctp.forEach(function(e){i.push("a=sctpmap:"+e.number+" "+e.protocol+" "+e.streams)}),"true"===c.usertcpmux&&i.push("a=rtcp-mux")}return"rtp"==s.applicationType&&i.push("a="+(r[o][a][e.senders]||"sendrecv")),i.push("a=mid:"+e.name),s.sources&&s.sources.length&&(s.sources[0].parameters||[]).forEach(function(e){"msid"===e.key&&i.push("a=msid:"+e.value)}),(s.encryption||[]).forEach(function(e){i.push("a=crypto:"+e.tag+" "+e.cipherSuite+" "+e.keyParams+(e.sessionParams?" "+e.sessionParams:""))}),s.googConferenceFlag&&i.push("a=x-google-flag:conference"),u.forEach(function(e){var t="a=rtpmap:"+e.id+" "+e.name+"/"+e.clockrate;if(e.channels&&"1"!=e.channels&&(t+="/"+e.channels),i.push(t),e.parameters&&e.parameters.length){var n=["a=fmtp:"+e.id],r=[];e.parameters.forEach(function(e){r.push((e.key?e.key+"=":"")+e.value)}),n.push(r.join(";")),i.push(n.join(" "))}e.feedback&&e.feedback.forEach(function(t){"trr-int"===t.type?i.push("a=rtcp-fb:"+e.id+" trr-int "+(t.value?t.value:"0")):i.push("a=rtcp-fb:"+e.id+" "+t.type+(t.subtype?" "+t.subtype:""))})}),s.feedback&&s.feedback.forEach(function(e){"trr-int"===e.type?i.push("a=rtcp-fb:* trr-int "+(e.value?e.value:"0")):i.push("a=rtcp-fb:* "+e.type+(e.subtype?" "+e.subtype:""))}),(s.headerExtensions||[]).forEach(function(e){i.push("a=extmap:"+e.id+(e.senders?"/"+r[o][a][e.senders]:"")+" "+e.uri)}),(s.sourceGroups||[]).forEach(function(e){i.push("a=ssrc-group:"+e.semantics+" "+e.sources.join(" "))}),(s.sources||[]).forEach(function(e){for(var t=0;t<e.parameters.length;t++){var n=e.parameters[t];i.push("a=ssrc:"+(e.ssrc||s.ssrc)+" "+n.key+(n.value?":"+n.value:""))}}),(c.candidates||[]).forEach(function(e){i.push(n.toCandidateSDP(e))}),i.join("\r\n")},n.toCandidateSDP=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"srflx"!==n&&"prflx"!==n&&"relay"!==n||e.relAddr&&e.relPort&&(t.push("raddr"),t.push(e.relAddr),t.push("rport"),t.push(e.relPort)),e.tcpType&&"TCP"==e.protocol.toUpperCase()&&(t.push("tcptype"),t.push(e.tcpType)),t.push("generation"),t.push(e.generation||"0"),"a=candidate:"+t.join(" ")}},{"./senders":246}],249:[function(e,t,n){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},r.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.numChannels=3===t.length?parseInt(t[2],10):1,n},r.writeRtpMap=function(e){var t=e.payloadType;return void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType),"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==e.numChannels?"/"+e.numChannels:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach(function(t){r.push(t+"="+e.parameters[t])}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);return{usernameFragment:(n=n.concat(r.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],a=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=r.parseRtpMap(a),c=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?r.parseFmtp(c[0]):{},s.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)});var i=0;return t.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions.forEach(function(e){n+=r.writeExtmap(e)}),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.split(" ");return t.shift(),t.map(function(e){return parseInt(e,10)})});u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10),rtx:{ssrc:t}};n.push(r),o&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:t,mechanism:a?"red+ulpfec":"red"},n.push(r))}}),0===n.length&&c&&n.push({ssrc:c});var l=r.matchPrefix(e,"b=");return l.length&&(0===l[0].indexOf("b=TIAS:")?l=parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")&&(l=parseInt(l[0].substr(5),10)),n.forEach(function(e){e.maxBitrate=l})),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},r.writeSessionBoilerplate=function(){return"v=0\r\no=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.exports=r},{}],250:[function(e,t,n){var r=e("safe-buffer").Buffer;function i(e,t){this._block=r.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}i.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=r.from(e,t));for(var n=this._block,i=this._blockSize,o=e.length,a=this._len,s=0;s<o;){for(var c=a%i,u=Math.min(o-s,i-c),l=0;l<u;l++)n[c+l]=e[s+l];s+=u,(a+=u)%i==0&&this._update(n)}return this._len+=o,this},i.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var r=(4294967295&n)>>>0,i=(n-r)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var o=this._hash();return e?o.toString(e):o},i.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t.exports=i},{"safe-buffer":230}],251:[function(e,t,n){(n=t.exports=function(e){e=e.toLowerCase();var t=n[e];if(!t)throw new Error(e+" is not supported (we accept pull requests)");return new t}).sha=e("./sha"),n.sha1=e("./sha1"),n.sha224=e("./sha224"),n.sha256=e("./sha256"),n.sha384=e("./sha384"),n.sha512=e("./sha512")},{"./sha":252,"./sha1":253,"./sha224":254,"./sha256":255,"./sha384":256,"./sha512":257}],252:[function(e,t,n){var r=e("inherits"),i=e("./hash"),o=e("safe-buffer").Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function c(){this.init(),this._w=s,i.call(this,64,56)}function u(e){return e<<30|e>>>2}function l(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}r(c,i),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,c=0|this._e,d=0;d<16;++d)n[d]=e.readInt32BE(4*d);for(;d<80;++d)n[d]=n[d-3]^n[d-8]^n[d-14]^n[d-16];for(var p=0;p<80;++p){var f=~~(p/20),h=0|((t=r)<<5|t>>>27)+l(f,i,o,s)+c+n[p]+a[f];c=s,s=o,o=u(i),i=r,r=h}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=c+this._e|0},c.prototype._hash=function(){var e=o.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=c},{"./hash":250,inherits:61,"safe-buffer":230}],253:[function(e,t,n){var r=e("inherits"),i=e("./hash"),o=e("safe-buffer").Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function c(){this.init(),this._w=s,i.call(this,64,56)}function u(e){return e<<5|e>>>27}function l(e){return e<<30|e>>>2}function d(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}r(c,i),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,c=0|this._e,p=0;p<16;++p)n[p]=e.readInt32BE(4*p);for(;p<80;++p)n[p]=(t=n[p-3]^n[p-8]^n[p-14]^n[p-16])<<1|t>>>31;for(var f=0;f<80;++f){var h=~~(f/20),m=u(r)+d(h,i,o,s)+c+n[f]+a[h]|0;c=s,s=o,o=l(i),i=r,r=m}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=c+this._e|0},c.prototype._hash=function(){var e=o.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=c},{"./hash":250,inherits:61,"safe-buffer":230}],254:[function(e,t,n){var r=e("inherits"),i=e("./sha256"),o=e("./hash"),a=e("safe-buffer").Buffer,s=new Array(64);function c(){this.init(),this._w=s,o.call(this,64,56)}r(c,i),c.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},c.prototype._hash=function(){var e=a.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},t.exports=c},{"./hash":250,"./sha256":255,inherits:61,"safe-buffer":230}],255:[function(e,t,n){var r=e("inherits"),i=e("./hash"),o=e("safe-buffer").Buffer,a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=new Array(64);function c(){this.init(),this._w=s,i.call(this,64,56)}function u(e,t,n){return n^e&(t^n)}function l(e,t,n){return e&t|n&(e|t)}function d(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function p(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function f(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}r(c,i),c.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},c.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,c=0|this._e,h=0|this._f,m=0|this._g,v=0|this._h,y=0;y<16;++y)n[y]=e.readInt32BE(4*y);for(;y<64;++y)n[y]=0|(((t=n[y-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+n[y-7]+f(n[y-15])+n[y-16];for(var g=0;g<64;++g){var S=v+p(c)+u(c,h,m)+a[g]+n[g]|0,_=d(r)+l(r,i,o)|0;v=m,m=h,h=c,c=s+S|0,s=o,o=i,i=r,r=S+_|0}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=c+this._e|0,this._f=h+this._f|0,this._g=m+this._g|0,this._h=v+this._h|0},c.prototype._hash=function(){var e=o.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},t.exports=c},{"./hash":250,inherits:61,"safe-buffer":230}],256:[function(e,t,n){var r=e("inherits"),i=e("./sha512"),o=e("./hash"),a=e("safe-buffer").Buffer,s=new Array(160);function c(){this.init(),this._w=s,o.call(this,128,112)}r(c,i),c.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},c.prototype._hash=function(){var e=a.allocUnsafe(48);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},t.exports=c},{"./hash":250,"./sha512":257,inherits:61,"safe-buffer":230}],257:[function(e,t,n){var r=e("inherits"),i=e("./hash"),o=e("safe-buffer").Buffer,a=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],s=new Array(160);function c(){this.init(),this._w=s,i.call(this,128,112)}function u(e,t,n){return n^e&(t^n)}function l(e,t,n){return e&t|n&(e|t)}function d(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function p(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function f(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function h(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function m(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function v(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function y(e,t){return e>>>0<t>>>0?1:0}r(c,i),c.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},c.prototype._update=function(e){for(var t=this._w,n=0|this._ah,r=0|this._bh,i=0|this._ch,o=0|this._dh,s=0|this._eh,c=0|this._fh,g=0|this._gh,S=0|this._hh,_=0|this._al,b=0|this._bl,C=0|this._cl,w=0|this._dl,E=0|this._el,R=0|this._fl,P=0|this._gl,L=0|this._hl,T=0;T<32;T+=2)t[T]=e.readInt32BE(4*T),t[T+1]=e.readInt32BE(4*T+4);for(;T<160;T+=2){var x=t[T-30],M=t[T-30+1],A=f(x,M),I=h(M,x),O=m(x=t[T-4],M=t[T-4+1]),D=v(M,x),k=t[T-14],j=t[T-14+1],N=t[T-32],V=t[T-32+1],U=I+j|0,B=A+k+y(U,I)|0;B=(B=B+O+y(U=U+D|0,D)|0)+N+y(U=U+V|0,V)|0,t[T]=B,t[T+1]=U}for(var F=0;F<160;F+=2){B=t[F],U=t[F+1];var G=l(n,r,i),W=l(_,b,C),J=d(n,_),q=d(_,n),H=p(s,E),z=p(E,s),X=a[F],$=a[F+1],Y=u(s,c,g),K=u(E,R,P),Q=L+z|0,Z=S+H+y(Q,L)|0;Z=(Z=(Z=Z+Y+y(Q=Q+K|0,K)|0)+X+y(Q=Q+$|0,$)|0)+B+y(Q=Q+U|0,U)|0;var ee=q+W|0,te=J+G+y(ee,q)|0;S=g,L=P,g=c,P=R,c=s,R=E,s=o+Z+y(E=w+Q|0,w)|0,o=i,w=C,i=r,C=b,r=n,b=_,n=Z+te+y(_=Q+ee|0,Q)|0}this._al=this._al+_|0,this._bl=this._bl+b|0,this._cl=this._cl+C|0,this._dl=this._dl+w|0,this._el=this._el+E|0,this._fl=this._fl+R|0,this._gl=this._gl+P|0,this._hl=this._hl+L|0,this._ah=this._ah+n+y(this._al,_)|0,this._bh=this._bh+r+y(this._bl,b)|0,this._ch=this._ch+i+y(this._cl,C)|0,this._dh=this._dh+o+y(this._dl,w)|0,this._eh=this._eh+s+y(this._el,E)|0,this._fh=this._fh+c+y(this._fl,R)|0,this._gh=this._gh+g+y(this._gl,P)|0,this._hh=this._hh+S+y(this._hl,L)|0},c.prototype._hash=function(){var e=o.allocUnsafe(64);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},t.exports=c},{"./hash":250,inherits:61,"safe-buffer":230}],258:[function(e,t,n){var r,i;r=this,i=function(e){"use strict";return function(e){if("number"!=typeof e)throw new TypeError("Expected a number");if(e>1e19)throw new RangeError("Input expected to be < 1e19");if(e<-1e19)throw new RangeError("Input expected to be > 1e19");if(Math.abs(e)<1e3)return e;var t,n,r,i=e<0?"-":"",o={K:6,M:9,B:12,T:16};for(var a in n=(r=(e=Math.abs(e)).toString().length)%3==0?r-3:r-r%3,t=Math.round(e/Math.pow(10,n)*10)/10,o)if(n<o[a]){t+=a;break}return i+t}},"object"==typeof n&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define(i):r.shortNumber=i()},{}],259:[function(e,t,n){"use strict";n.VERSION="8.1.1",n.JID=e("xmpp-jid").JID,n.Client=e("./lib/client"),n.createClient=function(t){var r=new n.Client(t);return r.use(e("./lib/plugins")),r}},{"./lib/client":260,"./lib/plugins":283,"xmpp-jid":358}],260:[function(e,t,n){"use strict";var r=e("lodash.foreach"),i=e("lodash.assign"),o=e("lodash.isarray"),a=e("jxt"),s=e("wildemitter"),c=e("util"),u=e("uuid"),l=e("xmpp-jid").JID,d=e("./sm"),p=e("hostmeta"),f=e("saslmechanisms"),h={external:e("sasl-external"),"scram-sha-1":e("sasl-scram-sha-1"),"digest-md5":e("alt-sasl-digest-md5"),"x-oauth2":e("sasl-x-oauth2"),plain:e("sasl-plain"),anonymous:e("sasl-anonymous")};function m(t){var n=this;s.call(this),t=t||{},this._initConfig(t),this.stanzas=a.getGlobalJXT(),this.jid=new l,this.stanzas=a.createRegistry(),this.stanzas.use(e("jxt-xmpp-types")),this.stanzas.use(e("jxt-xmpp")),this.use(e("./plugins/features")),this.use(e("./plugins/sasl")),this.use(e("./plugins/smacks")),this.use(e("./plugins/bind")),this.use(e("./plugins/session")),this.sm=new d(this),this.transports={},this.on("stream:data",function(e){var t=e.toJSON();if("iq"===e._name&&(t._xmlChildCount=0,r(e.xml.childNodes,function(e){1===e.nodeType&&(t._xmlChildCount+=1)})),n.emit(e._eventname||e._name,t),"message"===e._name||"presence"===e._name||"iq"===e._name)n.sm.handle(t),n.emit("stanza",t);else{if("smAck"===e._name)return n.sm.process(t);if("smRequest"===e._name)return n.sm.ack()}t.id&&(n.emit("id:"+t.id,t),n.emit(e._name+":id:"+t.id,t))}),this.on("disconnected",function(){n.transport&&(n.transport.off("*"),delete n.transport),n.releaseGroup("connection")}),this.on("iq",function(e){var t=e.type,r=e._xmlChildCount;delete e._xmlChildCount;var i=Object.keys(e).filter(function(e){return"id"!==e&&"to"!==e&&"from"!==e&&"lang"!==e&&"type"!==e&&"errorReply"!==e&&"resultReply"!==e});if("get"===e.type||"set"===e.type){if(1!==r)return n.sendIq(e.errorReply({error:{type:"modify",condition:"bad-request"}}));if(!i.length)return n.sendIq(e.errorReply({error:{type:"cancel",condition:"feature-not-implemented"}}));var o="iq:"+t+":"+i[0];n.callbacks[o]?n.emit(o,e):n.sendIq(e.errorReply({error:{type:"cancel",condition:"feature-not-implemented"}}))}}),this.on("message",function(e){Object.keys(e.$body||{}).length&&("chat"===e.type||"normal"===e.type?n.emit("chat",e):"groupchat"===e.type&&n.emit("groupchat",e)),"error"===e.type&&n.emit("message:error",e)}),this.on("presence",function(e){var t=e.type||"available";"error"===t&&(t="presence:error"),n.emit(t,e)})}c.inherits(m,s),Object.defineProperty(m.prototype,"stream",{get:function(){return this.transport?this.transport.stream:void 0}}),m.prototype._initConfig=function(e){var t=this,n=this.config||{};this.config=i({useStreamManagement:!0,transports:["websocket","bosh"],sasl:["external","scram-sha-1","digest-md5","plain","anonymous"]},n,e),o(this.config.sasl)||(this.config.sasl=[this.config.sasl]),this.SASLFactory=new f,this.config.sasl.forEach(function(e){if("string"==typeof e){var n=h[e.toLowerCase()];n&&t.SASLFactory.use(n)}else t.SASLFactory.use(e)}),this.config.jid=new l(this.config.jid),this.config.server||(this.config.server=this.config.jid.domain),this.config.password&&(this.config.credentials=this.config.credentials||{},this.config.credentials.password=this.config.password,delete this.config.password),this.config.transport&&(this.config.transports=[this.config.transport]),o(this.config.transports)||(this.config.transports=[this.config.transports])},m.prototype.use=function(e){e(this,this.stanzas,this.config)},m.prototype.nextId=function(){return u.v4()},m.prototype.discoverBindings=function(e,t){p(e,function(e,n){if(e)return t(e,[]);var r={websocket:[],bosh:[]};(n.links||[]).forEach(function(e){e.href&&"urn:xmpp:alt-connections:websocket"===e.rel&&r.websocket.push(e.href),e.href&&"urn:xmpp:altconnect:websocket"===e.rel&&r.websocket.push(e.href),e.href&&"urn:xmpp:alt-connections:xbosh"===e.rel&&r.bosh.push(e.href),e.href&&"urn:xmpp:altconnect:bosh"===e.rel&&r.bosh.push(e.href)}),t(!1,r)})},m.prototype._getConfiguredCredentials=function(){var e=this.config.credentials||{},t=new l(this.config.jid),n=e.username||t.local,r=e.server||t.domain,o={username:n,password:this.config.password,server:r,host:r,realm:r,serviceType:"xmpp",serviceName:r};return i(o,e)},m.prototype.getCredentials=function(e){return e(null,this._getConfiguredCredentials())},m.prototype.connect=function(t,n){var r=this;if(this._initConfig(t),n||1!==r.config.transports.length||((n={}).name=r.config.transports[0]),n&&n.name){"websocket"!==n.name&&"old-websocket"!==n.name||(this.use(e("./plugins/websocket")),this.use(e("./plugins/oldwebsocket"))),"bosh"===n.name&&this.use(e("./plugins/bosh"));var i=r.transport=new r.transports[n.name](r.sm,r.stanzas);return i.on("*",function(e,t){r.emit(e,t)}),i.connect(r.config)}return r.discoverBindings(r.config.server,function(e,t){if(e)return console.error("Could not find https://"+r.config.server+"/.well-known/host-meta file to discover connection endpoints for the requested transports."),r.disconnect();for(var n=0,i=r.config.transports.length;n<i;n++){var o=r.config.transports[n];console.log("Checking for %s endpoints",o);for(var a=0,s=(t[o]||[]).length;a<s;a++){var c=t[o][a];if(0===c.indexOf("wss://")||0===c.indexOf("https://"))return"websocket"===o?r.config.wsURL=c:r.config.boshURL=c,console.log("Using %s endpoint: %s",o,c),r.connect(null,{name:o,url:c});console.warn("Discovered unencrypted %s endpoint (%s). Ignoring",o,c)}}return console.error("No endpoints found for the requested transports."),r.disconnect()})},m.prototype.disconnect=function(){this.sessionStarted&&(this.releaseGroup("session"),this.sm.started||this.emit("session:end")),this.sessionStarted=!1,this.releaseGroup("connection"),this.transport?this.transport.disconnect():this.emit("disconnected")},m.prototype.send=function(e){this.sm.track(e),this.transport&&this.transport.send(e)},m.prototype.sendMessage=function(e){(e=e||{}).id||(e.id=this.nextId());var t=new(this.stanzas.getMessage())(e);return this.emit("message:sent",t.toJSON()),this.send(t),e.id},m.prototype.sendPresence=function(e){(e=e||{}).id||(e.id=this.nextId());var t=this.stanzas.getPresence();return this.send(new t(e)),e.id},m.prototype.sendIq=function(e,t){var n,r,i,o,a=this;(e=e||{}).id||(e.id=this.nextId());var s,c,u,d,p=this.stanzas.getIq(),f=e.toJSON?e:new p(e);if("error"!==e.type&&"result"!==e.type)return o=new l(e.to),(i={})[""]=!0,i[o.full]=!0,i[o.bare]=!0,i[o.domain]=!0,i[a.jid.bare]=!0,i[a.jid.domain]=!0,r="iq:id:"+e.id,n=new Promise(function(e,t){var n=function(o){i[o.from.full]&&("result"!==o.type&&"error"!==o.type||(a.off(r,n),o.error?t(o):e(o)))};a.on(r,"session",n)}),this.send(f),(s=n,c=e.id,u=1e3*(a.config.timeout||15),Promise.race([s,new Promise(function(e,t){d=setTimeout(function(){t({id:c,type:"error",error:{condition:"timeout"}})},u)})]).then(function(e){return clearTimeout(d),e})).then(function(e){return t&&t(null,e),e},function(e){if(t)return t(e);throw e});this.send(f)},m.prototype.sendStreamError=function(e){e=e||{};var t=new(this.stanzas.getStreamError())(e);this.emit("stream:error",t.toJSON()),this.send(t),this.disconnect()},t.exports=m},{"./plugins/bind":263,"./plugins/bosh":267,"./plugins/features":278,"./plugins/oldwebsocket":294,"./plugins/sasl":305,"./plugins/session":306,"./plugins/smacks":308,"./plugins/websocket":312,"./sm":313,"alt-sasl-digest-md5":1,hostmeta:55,jxt:159,"jxt-xmpp":120,"jxt-xmpp-types":93,"lodash.assign":179,"lodash.foreach":182,"lodash.isarray":184,"sasl-anonymous":232,"sasl-external":234,"sasl-plain":236,"sasl-scram-sha-1":237,"sasl-x-oauth2":241,saslmechanisms:243,util:331,uuid:319,wildemitter:350,"xmpp-jid":358}],261:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:attention:0"),e.getAttention=function(t,n){(n=n||{}).to=t,n.type="headline",n.attention=!0,e.sendMessage(n)},e.on("message",function(t){t.attention&&e.emit("attention",t)})}},{}],262:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:avatar:metadata+notify"),e.on("pubsub:event",function(t){t.event.updated&&"urn:xmpp:avatar:metadata"===t.event.updated.node&&e.emit("avatar",{jid:t.from,source:"pubsub",avatars:t.event.updated.published[0].avatars})}),e.on("presence",function(t){t.avatarId&&e.emit("avatar",{jid:t.from,source:"vcard",avatars:[{id:t.avatarId}]})}),e.publishAvatar=function(e,t,n){return this.publish("","urn:xmpp:avatar:data",{id:e,avatarData:t},n)},e.useAvatars=function(e,t){return this.publish("","urn:xmpp:avatar:metadata",{id:"current",avatars:e},t)},e.getAvatar=function(e,t,n){return this.getItem(e,"urn:xmpp:avatar:data",t,n)}}},{}],263:[function(e,t,n){"use strict";var r=e("xmpp-jid").JID;t.exports=function(e,t,n){e.registerFeature("bind",300,function(e,t){var r=this;r.sendIq({type:"set",bind:{resource:n.resource}},function(n,i){if(n)return r.emit("session:error",n),t("disconnect","JID binding failed");r.features.negotiated.bind=!0,r.emit("session:prebind",i.bind.jid);var o=!e.session||e.session&&e.session.optional;return!r.sessionStarted&&o&&r.emit("session:started",r.jid),t()})}),e.on("session:started",function(){e.sessionStarted=!0}),e.on("session:prebind",function(t){e.jid=new r(t),e.emit("session:bound",e.jid)}),e.on("disconnected",function(){e.sessionStarted=!1,e.features.negotiated.bind=!1})}},{"xmpp-jid":358}],264:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:blocking"),e.block=function(t,n){return e.sendIq({type:"set",block:{jids:[t]}},n)},e.unblock=function(t,n){return e.sendIq({type:"set",unblock:{jids:[t]}},n)},e.getBlocked=function(t){return e.sendIq({type:"get",blockList:!0},t)},e.on("iq:set:block",function(t){e.emit("block",{jids:t.block.jids||[]}),e.sendIq(t.resultReply())}),e.on("iq:set:unblock",function(t){e.emit("unblock",{jids:t.unblock.jids||[]}),e.sendIq(t.resultReply())})}},{}],265:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:bob"),e.getBits=function(t,n,r){return e.sendIq({to:t,type:"get",bob:{cid:n}},r)}}},{}],266:[function(e,t,n){"use strict";var r=e("lodash.assign"),i=e("lodash.filter"),o=e("xmpp-jid").JID;t.exports=function(e){e.getBookmarks=function(e){return this.getPrivateData({bookmarks:!0},e)},e.setBookmarks=function(e,t){return this.setPrivateData({bookmarks:e},t)},e.addBookmark=function(t,n){return t.jid=new o(t.jid),this.getBookmarks().then(function(n){var o=n.privateStorage.bookmarks.conferences||[],a=i(o,function(e){return e.jid.bare===t.jid.bare});return a.length?r(a[0],t):o.push(t),e.setBookmarks({conferences:o})}).then(function(e){return n&&n(null,e),e},function(e){if(!n)throw e;n(e)})},e.removeBookmark=function(t,n){return t=new o(t),this.getBookmarks().then(function(n){var r=n.privateStorage.bookmarks.conferences||[];return r=i(r,function(e){return t.bare!==e.jid.bare}),e.setBookmarks({conferences:r})}).then(function(e){n&&n(null,e)},function(e){if(!n)throw e;n(e)})}}},{"lodash.assign":179,"lodash.filter":181,"xmpp-jid":358}],267:[function(e,t,n){"use strict";var r=e("../transports/bosh");t.exports=function(e){e.transports.bosh=r}},{"../transports/bosh":314}],268:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:carbons:2"),e.enableCarbons=function(e){return this.sendIq({type:"set",enableCarbons:!0},e)},e.disableCarbons=function(e){return this.sendIq({type:"set",disableCarbons:!0},e)},e.on("message",function(t){return t.carbonSent?e.emit("carbon:sent",t):t.carbonReceived?e.emit("carbon:received",t):void 0}),e.on("carbon:*",function(t,n){var r,i,o=t.split(":")[1];n.from.bare===e.jid.bare&&("received"===o?(r=n.carbonReceived.forwarded.message,i=n.carbonReceived.forwarded.delay):(r=n.carbonSent.forwarded.message,i=n.carbonSent.forwarded.delay),r.delay||(r.delay={stamp:i?i.stamp:new Date(Date.now())}),r.carbon=!0,r.from.bare===e.jid.bare?e.emit("message:sent",r):e.emit("message",r))})}},{}],269:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("http://jabber.org/protocol/chatstates"),e.on("message",function(t){t.chatState&&(e.emit("chat:state",{to:t.to,from:t.from,chatState:t.chatState}),e.emit("chatState",{to:t.to,from:t.from,chatState:t.chatState}))})}},{}],270:[function(e,t,n){"use strict";var r="http://jabber.org/protocol/commands";t.exports=function(e){e.disco.addFeature(r),e.disco.addItem({name:"Ad-Hoc Commands",node:r}),e.getCommands=function(t,n){return e.getDiscoItems(t,r,n)}}},{}],271:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:message-correct:0"),e.on("message",function(t){t.replace&&(e.emit("replace",t),e.emit("replace:"+t.id,t))})}},{}],272:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t.getDefinition("active","urn:xmpp:csi"),r=t.getDefinition("inactive","urn:xmpp:csi");e.registerFeature("clientStateIndication",400,function(e,t){this.features.negotiated.clientStateIndication=!0,t()}),e.markActive=function(){this.features.negotiated.clientStateIndication&&this.send(new n)},e.markInactive=function(){this.features.negotiated.clientStateIndication&&this.send(new r)}}},{}],273:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("jabber:x:data"),e.disco.addFeature("urn:xmpp:media-element"),e.disco.addFeature("http://jabber.org/protocol/xdata-validate"),e.disco.addFeature("http://jabber.org/protocol/xdata-layout"),e.on("message",function(t){t.form&&e.emit("dataform",t)})}},{}],274:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:delay")}},{}],275:[function(e,t,n){(function(n){"use strict";var r=e("lodash.foreach"),i=e("lodash.uniq"),o=e("xmpp-jid").JID,a=e("iana-hashes");function s(e,t){var o="",s=e.features.sort(),c=[],u={},l=[];r(e.identities,function(e){c.push([e.category||"",e.type||"",e.lang||"",e.name||""].join("/"))}),c.sort();var d=c.length,p=s.length;if(c=i(c,!0),p!==(s=i(s,!0)).length||d!==c.length)return!1;o+=c.join("<")+"<",o+=s.join("<")+"<";var f=!1;if(r(e.extensions,function(e){for(var t=e.fields,n=0,r=t.length;n<r;n++)if("FORM_TYPE"===t[n].name&&"hidden"===t[n].type){var i=t[n].value;return u[i]?void(f=!0):(u[i]=e,void l.push(i))}}),f)return!1;l.sort(),r(l,function(e){var t=u[e],n={},i=[];o+="<"+e,r(t.fields,function(e){var t=e.name;if("FORM_TYPE"!==t){var r=e.value||"";"object"!=typeof r&&(r=r.split("\n")),n[t]=r.sort(),i.push(t)}}),i.sort(),r(i,function(e){o+="<"+e,r(n[e],function(e){o+="<"+e})})});var h=a.createHash(t).update(new n(o,"utf8")).digest("base64"),m=4-h.length%4;4===m&&(m=0);for(var v=0;v<m;v++)h+="=";return h}function c(e,t,n){var r=s(e,t);return r&&r===n}function u(){this.features={},this.identities={},this.extensions={},this.items={},this.caps={}}u.prototype={constructor:{value:u},addFeature:function(e,t){t=t||"",this.features[t]||(this.features[t]=[]),this.features[t].push(e)},addIdentity:function(e,t){t=t||"",this.identities[t]||(this.identities[t]=[]),this.identities[t].push(e)},addItem:function(e,t){t=t||"",this.items[t]||(this.items[t]=[]),this.items[t].push(e)},addExtension:function(e,t){t=t||"",this.extensions[t]||(this.extensions[t]=[]),this.extensions[t].push(e)}},t.exports=function(e){e.disco=new u(e),e.disco.addFeature("http://jabber.org/protocol/disco#info"),e.disco.addFeature("http://jabber.org/protocol/disco#items"),e.disco.addIdentity({category:"client",type:"web"}),e.registerFeature("caps",100,function(t,n){this.emit("disco:caps",{from:new o(e.jid.domain||e.config.server),caps:t.caps}),this.features.negotiated.caps=!0,n()}),e.getDiscoInfo=function(e,t,n){return this.sendIq({to:e,type:"get",discoInfo:{node:t}},n)},e.getDiscoItems=function(e,t,n){return this.sendIq({to:e,type:"get",discoItems:{node:t}},n)},e.updateCaps=function(){var t=this.config.capsNode||"https://stanza.io",n=JSON.parse(JSON.stringify({identities:this.disco.identities[""],features:this.disco.features[""],extensions:this.disco.extensions[""]})),r=s(n,"sha-1");return this.disco.caps={node:t,hash:"sha-1",ver:r},t=t+"#"+r,this.disco.features[t]=n.features,this.disco.identities[t]=n.identities,this.disco.extensions[t]=n.extensions,e.getCurrentCaps()},e.getCurrentCaps=function(){var t=e.disco.caps;if(!t.ver)return{ver:null,discoInfo:null};var n=t.node+"#"+t.ver;return{ver:t.ver,discoInfo:{identities:e.disco.identities[n],features:e.disco.features[n],extensions:e.disco.extensions[n]}}},e.on("presence",function(t){t.caps&&e.emit("disco:caps",t)}),e.on("iq:get:discoInfo",function(t){var n=t.discoInfo.node||"",r=t.discoInfo.node||"";n===e.disco.caps.node+"#"+e.disco.caps.ver&&(r=n,n=""),e.sendIq(t.resultReply({discoInfo:{node:r,identities:e.disco.identities[n]||[],features:e.disco.features[n]||[],extensions:e.disco.extensions[n]||[]}}))}),e.on("iq:get:discoItems",function(t){var n=t.discoItems.node;e.sendIq(t.resultReply({discoItems:{node:n,items:e.disco.items[n]||[]}}))}),e.verifyVerString=c,e.generateVerString=s,e.updateCaps()}}).call(this,e("buffer").Buffer)},{buffer:10,"iana-hashes":58,"lodash.foreach":182,"lodash.uniq":189,"xmpp-jid":358}],276:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("jid\\20escaping")}},{}],277:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:extdisco:1"),e.getServices=function(e,t,n){return this.sendIq({type:"get",to:e,services:{type:t}},n)},e.getServiceCredentials=function(e,t,n){return this.sendIq({type:"get",to:e,credentials:{service:{host:t}}},n)}}},{}],278:[function(e,t,n){"use strict";var r=e("async");t.exports=function(e){e.features={negotiated:{},order:[],handlers:{}},e.registerFeature=function(t,n,r){this.features.order.push({priority:n,name:t}),this.features.order.sort(function(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0}),this.features.handlers[t]=r.bind(e)},e.on("streamFeatures",function(t){var n=[],i=e.features.negotiated,o=e.features.handlers;e.features.order.forEach(function(e){var r=e.name;t[r]&&o[r]&&!i[r]&&n.push(function(e){i[r]?e():o[r](t,e)})}),r.series(n,function(t,n){"restart"===t?e.transport.restart():"disconnect"===t&&(e.emit("stream:error",{condition:"policy-violation",text:"Failed to negotiate stream features: "+n}),e.disconnect())})})}},{async:317}],279:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:forward:0")}},{}],280:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("http://jabber.org/protocol/geoloc"),e.disco.addFeature("http://jabber.org/protocol/geoloc+notify"),e.on("pubsub:event",function(t){t.event.updated&&"http://jabber.org/protocol/geoloc"===t.event.updated.node&&e.emit("geoloc",{jid:t.from,geoloc:t.event.updated.published[0].geoloc})}),e.publishGeoLoc=function(e,t){return this.publish("","http://jabber.org/protocol/geoloc",{geoloc:e},t)}}},{}],281:[function(e,t,n){"use strict";var r=e("iana-hashes");t.exports=function(e){e.disco.addFeature("urn:xmpp:hashes:1"),r.getHashes().forEach(function(t){e.disco.addFeature("urn:xmpp:hash-function-text-names:"+t)})}},{"iana-hashes":58}],282:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:idle:1")}},{}],283:[function(e,t,n){"use strict";t.exports=function(t){t.use(e("./disco")),t.use(e("./attention")),t.use(e("./avatar")),t.use(e("./blocking")),t.use(e("./bob")),t.use(e("./bookmarks")),t.use(e("./carbons")),t.use(e("./chatstates")),t.use(e("./command")),t.use(e("./correction")),t.use(e("./csi")),t.use(e("./dataforms")),t.use(e("./delayed")),t.use(e("./escaping")),t.use(e("./extdisco")),t.use(e("./forwarding")),t.use(e("./geoloc")),t.use(e("./hashes")),t.use(e("./idle")),t.use(e("./invisible")),t.use(e("./jidprep")),t.use(e("./jingle")),t.use(e("./json")),t.use(e("./keepalive")),t.use(e("./logging")),t.use(e("./mam")),t.use(e("./muc")),t.use(e("./mood")),t.use(e("./nick")),t.use(e("./oob")),t.use(e("./ping")),t.use(e("./private")),t.use(e("./psa")),t.use(e("./pubsub")),t.use(e("./reach")),t.use(e("./receipts")),t.use(e("./register")),t.use(e("./roster")),t.use(e("./rtt")),t.use(e("./shim")),t.use(e("./time")),t.use(e("./vcard")),t.use(e("./version"))}},{"./attention":261,"./avatar":262,"./blocking":264,"./bob":265,"./bookmarks":266,"./carbons":268,"./chatstates":269,"./command":270,"./correction":271,"./csi":272,"./dataforms":273,"./delayed":274,"./disco":275,"./escaping":276,"./extdisco":277,"./forwarding":279,"./geoloc":280,"./hashes":281,"./idle":282,"./invisible":284,"./jidprep":285,"./jingle":286,"./json":287,"./keepalive":288,"./logging":289,"./mam":290,"./mood":291,"./muc":292,"./nick":293,"./oob":295,"./ping":296,"./private":297,"./psa":298,"./pubsub":299,"./reach":300,"./receipts":301,"./register":302,"./roster":303,"./rtt":304,"./shim":307,"./time":309,"./vcard":310,"./version":311}],284:[function(e,t,n){"use strict";t.exports=function(e){e.goInvisible=function(e){return this.sendIq({type:"set",invisible:!0},e)},e.goVisible=function(e){return this.sendIq({type:"set",visible:!0},e)}}},{}],285:[function(e,t,n){"use strict";t.exports=function(e){e.prepJID=function(t,n){return e.sendIq({to:e.jid.domain,type:"get",jidPrep:t},n)}}},{}],286:[function(e,t,n){"use strict";var r=e("jingle");t.exports=function(e){var t=e.jingle=new r;t.capabilities.forEach(function(t){e.disco.addFeature(t)});["outgoing","incoming","accepted","terminated","ringing","mute","unmute","hold","resumed"].forEach(function(n){t.on(n,function(t,r){e.emit("jingle:"+n,t,r)})}),t.on("createdSession",function(t){e.emit("jingle:created",t)}),t.on("peerStreamAdded",function(t,n){e.emit("jingle:remotestream:added",t,n)}),t.on("peerStreamRemoved",function(t,n){e.emit("jingle:remotestream:removed",t,n)}),t.on("send",function(t){e.sendIq(t,function(t){t&&e.emit("jingle:error",t)})}),e.on("session:bound",function(e){t.jid=e,t.selfID=e.full}),e.on("iq:set:jingle",function(e){t.process(e)}),e.on("unavailable",function(e){var n=e.from.full;t.endPeerSessions(n,!0)}),e.discoverICEServers=function(t){return this.getServices(e.config.server).then(function(t){for(var n=t.services.services,r=[],i=0;i<n.length;i++){var o=n[i],a={};"stun"===o.type||"stuns"===o.type?(a.url=o.type+":"+o.host,o.port&&(a.url+=":"+o.port),r.push(a),e.jingle.addICEServer(a)):"turn"!==o.type&&"turns"!==o.type||(a.url=o.type+":"+o.host,o.port&&(a.url+=":"+o.port),o.transport&&"udp"!==o.transport&&(a.url+="?transport="+o.transport),o.username&&(a.username=o.username),o.password&&(a.credential=o.password),r.push(a),e.jingle.addICEServer(a))}return r}).then(function(e){return t&&t(null,e),e},function(e){if(!t)throw e;t(e)})}}},{jingle:91}],287:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:json:0")}},{}],288:[function(e,t,n){"use strict";function r(e,t){return n=new Promise(function(t,n){e.sm.started?(e.once("stream:management:ack",t),e.sm.request()):e.ping().then(t).catch(function(e){e.error&&"timeout"!==e.error.condition?t():n()})}),r=1e3*t||15e3,Promise.race([n,new Promise(function(e,t){i=setTimeout(function(){t()},r)})]).then(function(e){return clearTimeout(i),e});var n,r,i}t.exports=function(e){e.enableKeepAlive=function(t){(t=t||{}).interval=t.interval||300,t.timeout=t.timeout||15,e._keepAliveInterval=setInterval(function(){e.sessionStarted&&r(e,t.timeout).catch(function(){e.emit("stream:error",{condition:"connection-timeout",text:"Server did not respond in "+t.timeout+" seconds"}),e.transport&&(e.transport.hasStream=!1,e.transport.disconnect())})},1e3*t.interval)},e.disableKeepAlive=function(){e._keepAliveInterval&&(clearInterval(e._keepAliveInterval),delete e._keepAliveInterval)},e.on("disconnected",function(){e.disableKeepAlive()})}},{}],289:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("","urn:xmpp:eventlog"),e.sendLog=function(t,n){e.sendMessage({to:t,type:"normal",log:n})}}},{}],290:[function(e,t,n){"use strict";var r=e("xmpp-jid").JID;t.exports=function(e){e.disco.addFeature("urn:xmpp:mam:0"),e.getHistorySearchForm=function(t,n){return e.sendIq({to:t,type:"get",mam:!0},n)},e.searchHistory=function(t,n){var i=this,o=this.nextId();(t=t||{}).queryid=o;var a=t.jid||t.to||"";delete t.jid,delete t.to,t.form||(t.form={}),t.form.type="submit";var s=t.form.fields=t.form.fields||[];["FORM_TYPE","with","start","end"].forEach(function(e){if(t[e]||"FORM_TYPE"===e){var n=t[e];("start"===e||"end"===e)&&"string"!=typeof n&&(n=n.toISOString()),"FORM_TYPE"===e&&(n="urn:xmpp:mam:0");for(var r=0,i=s.length;r<i;r++)s[r].name;s.push({name:e,value:n}),delete t[e]}});var c=new r(a||e.jid.bare),u={"":!0};u[c.full]=!0,u[c.bare]=!0,u[c.domain]=!0,u[e.jid.bare]=!0,u[e.jid.domain]=!0;var l=[];this.on("mam:item:"+o,"session",function(e){u[e.from.full]&&l.push(e.mamItem)});var d=new Promise(function(e){i.once("mam:result:"+o,"session",function(t){u[t.from.full]&&(t.mamResult.items=l,e(t))})}),p=this.sendIq({type:"set",to:a,id:o,mam:t});(function(e,t,n){var r;return Promise.race([e,new Promise(function(e,i){r=setTimeout(function(){i({id:t,type:"error",error:{condition:"timeout"}})},n)})]).then(function(e){return clearTimeout(r),e})})(Promise.all([p,d]),o,1e3*i.config.timeout||15e3).then(function(e){var t=e[1];return i.off("mam:item:"+o),i.off("mam:result:"+o),n&&n(null,t),t},function(e){if(i.off("mam:item:"+o),i.off("mam:result:"+o),!n)throw e;n(e)})},e.getHistoryPreferences=function(e){return this.sendIq({type:"get",mamPrefs:!0},e)},e.setHistoryPreferences=function(e,t){return this.sendIq({type:"set",mamPrefs:e},t)},e.on("message",function(t){t.mamItem&&e.emit("mam:item:"+t.mamItem.queryid,t),t.mamResult&&e.emit("mam:result:"+t.mamResult.queryid,t)})}},{"xmpp-jid":358}],291:[function(e,t,n){"use strict";var r="http://jabber.org/protocol/mood";t.exports=function(e){e.disco.addFeature(r),e.disco.addFeature(r+"+notify"),e.on("pubsub:event",function(t){t.event.updated&&t.event.updated.node===r&&e.emit("mood",{jid:t.from,mood:t.event.updated.published[0].mood})}),e.publishMood=function(e,t,n){return this.publish("",r,{mood:{value:e,text:t}},n)}}},{}],292:[function(e,t,n){"use strict";var r=e("lodash.foreach"),i=e("xmpp-jid").JID;t.exports=function(e){function t(){r(e.joinedRooms,function(t,n){e.joinedRooms[n]=!1,e.joinRoom(n,t)})}e.disco.addFeature("http://jabber.org/protocol/muc"),e.disco.addFeature("jabber:x:conference"),e.disco.addFeature("urn:xmpp:hats:0"),e.joinedRooms={},e.on("session:started",t),e.on("stream:management:resumed",t),e.on("message",function(t){t.muc?(t.muc.invite&&e.emit("muc:invite",{from:t.muc.invite.from,room:t.from,reason:t.muc.invite.reason,password:t.muc.password,thread:t.muc.invite.thread,type:"mediated"}),t.muc.destroyed&&e.emit("muc:destroyed",{room:t.from,newRoom:t.muc.destroyed.jid,reason:t.muc.destroyed.reason,password:t.muc.destroyed.password}),t.muc.decline&&e.emit("muc:declined",{room:t.from,from:t.muc.decline.from,reason:t.muc.decline.reason})):t.mucInvite&&e.emit("muc:invite",{from:t.from,room:t.mucInvite.jid,reason:t.mucInvite.reason,password:t.mucInvite.password,thread:t.mucInvite.thread,type:"direct"}),"groupchat"===t.type&&t.subject&&e.emit("muc:subject",t)}),e.on("presence",function(t){if(t.joinMuc&&"error"===t.type)e.emit("muc:error",t);else if(t.muc){var n=t.muc.codes&&t.muc.codes.indexOf("110")>=0;"error"===t.type?e.emit("muc:error",t):"unavailable"===t.type?(e.emit("muc:unavailable",t),n&&(e.emit("muc:leave",t),delete e.joinedRooms[t.from.bare])):(e.emit("muc:available",t),n&&!e.joinedRooms[t.from.bare]&&(e.emit("muc:join",t),e.joinedRooms[t.from.bare]=t.from.resource))}}),e.joinRoom=function(e,t,n){(n=n||{}).to=e+"/"+t,n.caps=this.disco.caps,n.joinMuc=n.joinMuc||{},this.sendPresence(n)},e.leaveRoom=function(e,t,n){(n=n||{}).to=e+"/"+t,n.type="unavailable",this.sendPresence(n)},e.ban=function(t,n,r,i){e.setRoomAffiliation(t,n,"outcast",r,i)},e.kick=function(t,n,r,i){e.setRoomRole(t,n,"none",r,i)},e.invite=function(t,n){e.sendMessage({to:t,muc:{invites:n}})},e.directInvite=function(t,n){n.jid=t,e.sendMessage({to:n.to,mucInvite:n})},e.declineInvite=function(t,n,r){e.sendMessage({to:t,muc:{decline:{to:n,reason:r}}})},e.changeNick=function(t,n){e.sendPresence({to:new i(t).bare+"/"+n})},e.setSubject=function(t,n){e.sendMessage({to:t,type:"groupchat",subject:n})},e.discoverReservedNick=function(t,n){e.getDiscoInfo(t,"x-roomuser-item",function(e,t){if(e)return n(e);var r=t.discoInfo.identities[0]||{};n(null,r.name)})},e.requestRoomVoice=function(t){e.sendMessage({to:t,form:{fields:[{name:"FORM_TYPE",value:"http://jabber.org/protocol/muc#request"},{name:"muc#role",type:"text-single",value:"participant"}]}})},e.setRoomAffiliation=function(e,t,n,r,i){return this.sendIq({type:"set",to:e,mucAdmin:{jid:t,affiliation:n,reason:r}},i)},e.setRoomRole=function(e,t,n,r,i){return this.sendIq({type:"set",to:e,mucAdmin:{nick:t,role:n,reason:r}},i)},e.getRoomMembers=function(e,t,n){return this.sendIq({type:"get",to:e,mucAdmin:t},n)},e.getRoomConfig=function(e,t){return this.sendIq({to:e,type:"get",mucOwner:!0},t)},e.configureRoom=function(e,t,n){return t.type||(t.type="submit"),this.sendIq({to:e,type:"set",mucOwner:{form:t}},n)},e.destroyRoom=function(e,t,n){return this.sendIq({to:e,type:"set",mucOwner:{destroy:t}},n)},e.getUniqueRoomName=function(e,t){return this.sendIq({type:"get",to:e,mucUnique:!0},t)}}},{"lodash.foreach":182,"xmpp-jid":358}],293:[function(e,t,n){"use strict";var r="http://jabber.org/protocol/nick";t.exports=function(e){e.disco.addFeature(r),e.disco.addFeature(r+"+notify"),e.on("pubsub:event",function(t){t.event.updated&&t.event.updated.node===r&&e.emit("nick",{jid:t.from,nick:t.event.updated.published[0].nick})}),e.publishNick=function(e,t){return this.publish("",r,{nick:e},t)}}},{}],294:[function(e,t,n){"use strict";var r=e("../transports/old-websocket");t.exports=function(e){e.transports["old-websocket"]=r}},{"../transports/old-websocket":315}],295:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("jabber:x:oob")}},{}],296:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:ping"),e.on("iq:get:ping",function(t){e.sendIq(t.resultReply())}),e.ping=function(e,t){return this.sendIq({to:e,type:"get",ping:!0},t)}}},{}],297:[function(e,t,n){"use strict";t.exports=function(e){e.getPrivateData=function(e,t){return this.sendIq({type:"get",privateStorage:e},t)},e.setPrivateData=function(e,t){return this.sendIq({type:"set",privateStorage:e},t)}}},{}],298:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:psa")}},{}],299:[function(e,t,n){"use strict";t.exports=function(e){e.on("message",function(t){if(t.event){if(e.emit("pubsub:event",t),e.emit("pubsubEvent",t),t.event.updated){var n=t.event.updated.published,r=t.event.updated.retracted;n&&n.length&&e.emit("pubsub:published",t),r&&r.length&&e.emit("pubsub:retracted",t)}t.event.purged&&e.emit("pubsub:purged",t),t.event.deleted&&e.emit("pubsub:deleted",t),t.event.subscriptionChanged&&e.emit("pubsub:subscription",t),t.event.configurationChanged&&e.emit("pubsub:config",t)}t.pubsub&&t.pubsub.affiliations&&e.emit("pubsub:affiliation",t)}),e.subscribeToNode=function(t,n,r){return"string"==typeof n&&(n={node:n}),n.jid=n.jid||e.jid,this.sendIq({type:"set",to:t,pubsub:{subscribe:n}},r)},e.unsubscribeFromNode=function(t,n,r){return"string"==typeof n&&(n={node:n}),n.jid=n.jid||e.jid.bare,this.sendIq({type:"set",to:t,pubsub:{unsubscribe:n}},r)},e.publish=function(e,t,n,r){return this.sendIq({type:"set",to:e,pubsub:{publish:{node:t,item:n}}},r)},e.getItem=function(e,t,n,r){return this.sendIq({type:"get",to:e,pubsub:{retrieve:{node:t,item:n}}},r)},e.getItems=function(e,t,n,r){return(n=n||{}).node=t,this.sendIq({type:"get",to:e,pubsub:{retrieve:{node:t,max:n.max},rsm:n.rsm}},r)},e.retract=function(e,t,n,r,i){return this.sendIq({type:"set",to:e,pubsub:{retract:{node:t,notify:r,id:n}}},i)},e.purgeNode=function(e,t,n){return this.sendIq({type:"set",to:e,pubsubOwner:{purge:t}},n)},e.deleteNode=function(e,t,n){return this.sendIq({type:"set",to:e,pubsubOwner:{del:t}},n)},e.createNode=function(e,t,n,r){var i={type:"set",to:e,pubsub:{create:t}};return n&&(i.pubsub.config={form:n}),this.sendIq(i,r)},e.getSubscriptions=function(e,t,n){return t=t||{},this.sendIq({type:"get",to:e,pubsub:{subscriptions:t}},n)},e.getAffiliations=function(e,t,n){return t=t||{},this.sendIq({type:"get",to:e,pubsub:{affiliations:t}},n)},e.getNodeSubscribers=function(e,t,n,r){return(n=n||{}).node=t,this.sendIq({type:"get",to:e,pubsubOwner:{subscriptions:n}},r)},e.updateNodeSubscriptions=function(e,t,n,r){return this.sendIq({type:"set",to:e,pubsubOwner:{subscriptions:{node:t,list:n}}},r)},e.getNodeAffiliations=function(e,t,n,r){return(n=n||{}).node=t,this.sendIq({type:"get",to:e,pubsubOwner:{affiliations:n}},r)},e.updateNodeAffiliations=function(e,t,n,r){return this.sendIq({type:"set",to:e,pubsubOwner:{affiliations:{node:t,list:n}}},r)}}},{}],300:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:reach:0"),e.disco.addFeature("urn:xmpp:reach:0+notify"),e.on("pubsub:event",function(t){t.event.updated&&"urn:xmpp:reach:0"===t.event.updated.node&&e.emit("reachability",{jid:t.from,addresses:t.event.updated.published[0].reach})}),e.on("presence",function(t){t.reach&&t.reach.length&&e.emit("reachability",{jid:t.from,addresses:t.reach})}),e.publishReachability=function(e,t){return this.publish("","urn:xmpp:reach:0",{reach:e},t)}}},{}],301:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=!1!==n.sendReceipts;e.disco.addFeature("urn:xmpp:receipts"),e.on("message",function(t){r&&{normal:!0,chat:!0,headline:!0}[t.type]&&t.requestReceipt&&!t.receipt&&e.sendMessage({to:t.from,type:t.type,receipt:t.id,id:t.id}),t.receipt&&(e.emit("receipt",t),e.emit("receipt:"+t.receipt))})}},{}],302:[function(e,t,n){"use strict";t.exports=function(e){e.getAccountInfo=function(e,t){return this.sendIq({type:"get",to:e,register:!0},t)},e.updateAccount=function(e,t,n){return this.sendIq({type:"set",to:e,register:t},n)},e.deleteAccount=function(e,t){return this.sendIq({type:"set",to:e,register:{remove:!0}},t)}}},{}],303:[function(e,t,n){"use strict";t.exports=function(e){e.on("iq:set:roster",function(t){var n={"":!0};if(n[e.jid.bare]=!0,n[e.jid.domain]=!0,!n[t.from.full])return e.sendIq(t.errorReply({error:{type:"cancel",condition:"service-unavailable"}}));e.emit("roster:update",t),e.sendIq({id:t.id,type:"result"})}),e.getRoster=function(t){var n=this;return t=t||function(){},e.sendIq({type:"get",roster:{ver:n.config.rosterVer}}).then(function(e){if(e.roster){var t=e.roster.ver;t&&(n.config.rosterVer=t,n.emit("roster:ver",t))}return e}).then(function(e){return t&&t(null,e),e},function(e){if(!t)throw e;t(e)})},e.updateRosterItem=function(t,n){return e.sendIq({type:"set",roster:{items:[t]}},n)},e.removeRosterItem=function(t,n){return e.updateRosterItem({jid:t,subscription:"remove"},n)},e.subscribe=function(t){e.sendPresence({type:"subscribe",to:t})},e.unsubscribe=function(t){e.sendPresence({type:"unsubscribe",to:t})},e.acceptSubscription=function(t){e.sendPresence({type:"subscribed",to:t})},e.denySubscription=function(t){e.sendPresence({type:"unsubscribed",to:t})}}},{}],304:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:rtt:0"),e.on("message",function(t){t.rtt&&(e.emit("rtt",t),e.emit("rtt:"+t.rtt.event,t))})}},{}],305:[function(e,t,n){(function(e){"use strict";var n="urn:ietf:params:xml:ns:xmpp-sasl";t.exports=function(t,r){var i=r.getDefinition("auth",n),o=r.getDefinition("response",n),a=r.getDefinition("abort",n);t.registerFeature("sasl",100,function(t,n){var r=this,s=r.SASLFactory.create(t.sasl.mechanisms);if(!s)return r.releaseGroup("sasl"),r.emit("auth:failed"),n("disconnect","authentication failed");r.on("sasl:success","sasl",function(){r.features.negotiated.sasl=!0,r.releaseGroup("sasl"),r.emit("auth:success",r.config.credentials),n("restart")}),r.on("sasl:challenge","sasl",function(t){return s.challenge(new e(t.value,"base64").toString()),r.getCredentials(function(t,n){if(t)return r.send(new a);var i=s.response(n);i||""===i?r.send(new o({value:new e(i).toString("base64")})):r.send(new o),s.cache&&(Object.keys(s.cache).forEach(function(t){s.cache[t]&&(r.config.credentials[t]=new e(s.cache[t]))}),r.emit("credentials:update",r.config.credentials))})}),r.on("sasl:failure","sasl",function(){r.releaseGroup("sasl"),r.emit("auth:failed"),n("disconnect","authentication failed")}),r.on("sasl:abort","sasl",function(){r.releaseGroup("sasl"),r.emit("auth:failed"),n("disconnect","authentication failed")});var c={mechanism:s.name};if(s.clientFirst)return r.getCredentials(function(t,n){if(t)return r.send(new a);c.value=new e(s.response(n)).toString("base64"),r.send(new i(c))});r.send(new i(c))}),t.on("disconnected",function(){t.features.negotiated.sasl=!1,t.releaseGroup("sasl")})}}).call(this,e("buffer").Buffer)},{buffer:10}],306:[function(e,t,n){"use strict";t.exports=function(e){e.registerFeature("session",1e3,function(e,t){var n=this;if(e.session.optional||n.sessionStarted)return n.features.negotiated.session=!0,t();n.sendIq({type:"set",session:{}},function(e){if(e)return t("disconnect","session request failed");n.features.negotiated.session=!0,n.sessionStarted||(n.sessionStarted=!0,n.emit("session:started",n.jid)),t()})}),e.on("disconnected",function(){e.sessionStarted=!1,e.features.negotiated.session=!1})}},{}],307:[function(e,t,n){"use strict";var r="http://jabber.org/protocol/shim";t.exports=function(e){e.disco.addFeature(r),e.disco.addFeature(r+"#SubID",r)}},{}],308:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=function(e,t){var r=this;if(!n.useStreamManagement)return t();r.on("stream:management:enabled","sm",function(e){r.sm.enabled(e),r.features.negotiated.streamManagement=!0,r.releaseGroup("sm"),t()}),r.on("stream:management:resumed","sm",function(e){r.sm.resumed(e),r.features.negotiated.streamManagement=!0,r.features.negotiated.bind=!0,r.sessionStarted=!0,r.releaseGroup("sm"),t("break")}),r.on("stream:management:failed","sm",function(){r.sm.failed(),r.emit("session:end"),r.releaseGroup("session"),r.releaseGroup("sm"),t()}),r.sm.id?r.sm.id&&r.sm.allowResume?r.sm.resume():(r.releaseGroup("sm"),t()):r.features.negotiated.bind?r.sm.enable():(r.releaseGroup("sm"),t())};e.on("disconnected",function(){e.features.negotiated.streamManagement=!1}),e.registerFeature("streamManagement",200,r),e.registerFeature("streamManagement",500,r)}},{}],309:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:time"),e.getTime=function(e,t){return this.sendIq({to:e,type:"get",time:!0},t)},e.on("iq:get:time",function(t){var n=new Date;e.sendIq(t.resultReply({time:{utc:n,tzo:n.getTimezoneOffset()}}))})}},{}],310:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("vcard-temp"),e.getVCard=function(e,t){return this.sendIq({to:e,type:"get",vCardTemp:!0},t)},e.publishVCard=function(e,t){return this.sendIq({type:"set",vCardTemp:e},t)}}},{}],311:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("jabber:iq:version"),e.on("iq:get:version",function(t){e.sendIq(t.resultReply({version:e.config.softwareVersion||{name:"stanza.io"}}))}),e.getSoftwareVersion=function(e,t){return this.sendIq({to:e,type:"get",version:!0},t)}}},{}],312:[function(e,t,n){"use strict";var r=e("../transports/websocket");t.exports=function(e){e.transports.websocket=r}},{"../transports/websocket":316}],313:[function(e,t,n){"use strict";var r=Math.pow(2,32);function i(e,t){return(e%t+t)%t}function o(e){this.client=e,this.id=!1,this.allowResume=!0,this.started=!1,this.inboundStarted=!1,this.outboundStarted=!1,this.lastAck=0,this.handled=0,this.windowSize=1,this.unacked=[],this.pendingAck=!1;var t="urn:xmpp:sm:3";this.stanzas={Enable:e.stanzas.getDefinition("enable",t),Resume:e.stanzas.getDefinition("resume",t),Ack:e.stanzas.getDefinition("a",t),Request:e.stanzas.getDefinition("r",t)}}o.prototype={constructor:{value:o},enable:function(){var e=new this.stanzas.Enable;e.resume=this.allowResume,this.client.send(e),this.handled=0,this.outboundStarted=!0},resume:function(){var e=new this.stanzas.Resume({h:this.handled,previd:this.id});this.client.send(e),this.outboundStarted=!0},enabled:function(e){this.id=e.id,this.handled=0,this.inboundStarted=!0},resumed:function(e){this.id=e.previd,e.h&&this.process(e,!0),this.inboundStarted=!0},failed:function(){this.inboundStarted=!1,this.outboundStarted=!1,this.id=!1,this.lastAck=0,this.handled=0,this.unacked=[]},ack:function(){this.client.send(new this.stanzas.Ack({h:this.handled}))},request:function(){this.pendingAck=!0,this.client.send(new this.stanzas.Request)},process:function(e,t){var n=this,o=i(e.h-this.lastAck,r);this.pendingAck=!1;for(var a=0;a<o&&this.unacked.length>0;a++)this.client.emit("stanza:acked",this.unacked.shift());if(this.lastAck=e.h,t){var s=this.unacked;this.unacked=[],s.forEach(function(e){n.client.send(e)})}this.needAck()&&this.request()},track:function(e){var t=e._name;this.outboundStarted&&{message:!0,presence:!0,iq:!0}[t]&&(this.unacked.push(e),this.needAck()&&this.request())},handle:function(){this.inboundStarted&&(this.handled=i(this.handled+1,r))},needAck:function(){return!this.pendingAck&&this.unacked.length>=this.windowSize}},Object.defineProperties(o.prototype,{started:{get:function(){return this.outboundStarted&&this.inboundStarted},set:function(e){e||(this.outboundStarted=!1,this.inboundStarted=!1)}}}),t.exports=o},{}],314:[function(e,t,n){(function(n,r){"use strict";var i=e("lodash.assign"),o=e("lodash.filter"),a=e("util"),s=e("request"),c=e("wildemitter");function u(e,t,n){return(r=function(e){return new Promise(function(t,n){s(e,function(e,r,i){return e?n(e):t([r,i])})})}(e),i=1e3*(t||20),Promise.race([r,new Promise(function(e,t){o=setTimeout(function(){t()},i)})]).then(function(e){return clearTimeout(o),e})).then(function(e){var t=e[0],n=e[1];if(t.statusCode<200||t.statusCode>=400)throw new Error("HTTP Status Error"+t.statusCode);return n}).catch(function(){if(n>0)return(r=1e3,new Promise(function(e){setTimeout(function(){e()},r)})).then(function(){return u(e,t,n-1)});throw new Error("Dead Connection, exceeded retry limit");var r});var r,i,o}function l(e,t){var n=this;c.call(this),n.sm=e,n.stanzas={BOSH:t.getDefinition("body","http://jabber.org/protocol/httpbind"),StreamError:t.getStreamError()},n.sendQueue=[],n.requests=[],n.maxRequests=void 0,n.sid="",n.on("raw:incoming",function(e){if(""!==(e=e.trim())){var r,i;try{r=t.parse(e,n.stanzas.BOSH)}catch(e){return i=new n.stanzas.StreamError({condition:"invalid-xml"}),n.emit("stream:error",i,e),n.send(i),n.disconnect()}n.hasStream||(n.hasStream=!0,n.stream={id:r.sid||n.sid,lang:r.lang||"en",version:r.version||"1.0",to:r.to,from:r.from},n.sid=r.sid||n.sid,n.maxRequests=r.requests||n.maxRequests),r.payload.forEach(function(e){e.lang||(e.lang=n.stream.lang),n.emit("stream:data",e)}),"terminate"===r.type&&(n.rid=void 0,n.sid=void 0,n.emit("bosh:terminate",r),n.emit("stream:end"),n.emit("disconnected",n))}})}a.inherits(l,c),l.prototype.connect=function(e){if(this.config=i({rid:Math.ceil(9999999999*Math.random()),wait:30,maxRetries:5},e),this.hasStream=!1,this.sm.started=!1,this.url=e.boshURL,this.sid=this.config.sid,this.rid=this.config.rid,this.requests=[],this.sid)return this.hasStream=!0,this.stream={},this.emit("connected",this),this.emit("session:prebind",this.config.jid),void this.emit("session:started");this.rid++,this.request(new this.stanzas.BOSH({version:this.config.version||"1.0",to:this.config.server,lang:this.config.lang||"en",wait:this.config.wait,ver:"1.6",hold:1}))},l.prototype.disconnect=function(){this.hasStream?(this.rid++,this.request(new this.stanzas.BOSH({type:"terminate"}))):(this.stream=void 0,this.sid=void 0,this.rid=void 0,this.emit("disconnected",this))},l.prototype.restart=function(){this.rid++,this.request(new this.stanzas.BOSH({to:this.config.server,lang:this.config.lang||"en",restart:"true"}))},l.prototype.send=function(e){this.hasStream&&(this.sendQueue.push(e),n.nextTick(this.longPoll.bind(this)))},l.prototype.longPoll=function(){var e=!this.maxRequests||this.requests.length<this.maxRequests,t=!this.maxRequests||this.sendQueue.length>0&&this.requests.length<this.maxRequests;if(this.sid&&(e||t)){var n=this.sendQueue;this.sendQueue=[],this.rid++,this.request(new this.stanzas.BOSH({payload:n}))}},l.prototype.request=function(e){var t=this,i={id:t.rid,request:null};e.rid=t.rid,e.sid=t.sid;var a=new r(e.toString(),"utf8").toString();t.emit("raw:outgoing",a),t.requests.push(i);var s=u({uri:t.url,body:a,method:"POST",strictSSL:!0},1.5*t.config.wait,this.config.maxRetries).catch(function(e){t.hasStream=!1;var n=new t.stanzas.StreamError({condition:"connection-timeout"});t.emit("stream:error",n,e),t.disconnect()});return i.request=s,s.then(function(e){t.emit("raw:incoming",new r(e,"utf8").toString())}),s.then(function(){t.requests=o(t.requests,function(e){return e.id!==i.id}),"terminate"===e.type||t.requests.length||n.nextTick(function(){n.nextTick(t.longPoll.bind(t))})})},t.exports=l}).call(this,e("_process"),e("buffer").Buffer)},{_process:8,buffer:10,"lodash.assign":179,"lodash.filter":181,request:351,util:331,wildemitter:350}],315:[function(e,t,n){"use strict";var r=e("lodash.foreach"),i=e("./websocket");function o(e,t){i.call(this,e,t);var n=this;n.on("connected",function(){n.streamStart='<stream:stream xmlns:stream="http://etherx.jabber.org/streams">',n.streamEnd="</stream:stream>"}),n.off("raw:incoming"),n.on("raw:incoming",function(e){var i,o,a;if(""!==(e=(e=e.trim()).replace(/^(\s*<\?.*\?>\s*)*/,""))){if(e.match(n.streamEnd))return n.disconnect();if(n.hasStream)try{i=t.parse(function(e){return[n.streamStart,e,n.streamEnd].join("")}(e))}catch(e){return a=new this.stanzas.StreamError({condition:"invalid-xml"}),n.emit("stream:error",a,e),n.send(a),n.disconnect()}else{var s=e.match(/^<(\S+:)?(\S+) /);n.streamStart=e,n.streamEnd="</"+(s[1]||"")+s[2]+">",o=!1;try{i=t.parse(e+n.streamEnd)}catch(r){try{i=t.parse(e),o=!0}catch(e){return a=new this.stanzas.StreamError({condition:"invalid-xml"}),n.emit("stream:error",a,e),n.send(a),n.disconnect()}}n.hasStream=!0,n.stream=i,n.emit("stream:start",i)}r(i._extensions,function(e){!e.lang&&n.stream&&(e.lang=n.stream.lang),n.emit("stream:data",e)}),o&&n.emit("stream:end")}})}e("util").inherits(o,i),o.prototype.startHeader=function(){return["<stream:stream",'xmlns:stream="http://etherx.jabber.org/streams"','xmlns="jabber:client"','version="'+(this.config.version||"1.0")+'"','xml:lang="'+(this.config.lang||"en")+'"','to="'+this.config.server+'">'].join(" ")},o.prototype.closeHeader=function(){return"</stream:stream>"},t.exports=o},{"./websocket":316,"lodash.foreach":182,util:331}],316:[function(e,t,n){(function(n){"use strict";var r=e("util"),i=e("wildemitter"),o=e("async"),a=e("faye-websocket")&&e("faye-websocket").Client?e("faye-websocket").Client:window.WebSocket,s=1;function c(e,t){var r=this;i.call(this),r.sm=e,r.closing=!1,r.stanzas={Open:t.getDefinition("open","urn:ietf:params:xml:ns:xmpp-framing",!0),Close:t.getDefinition("close","urn:ietf:params:xml:ns:xmpp-framing",!0),StreamError:t.getStreamError()},r.sendQueue=o.queue(function(e,t){r.conn&&("string"!=typeof e&&(e=e.toString()),e=new n(e,"utf8").toString(),r.emit("raw:outgoing",e),r.conn.readyState===s&&r.conn.send(e)),t()},1),r.on("connected",function(){r.send(r.startHeader())}),r.on("raw:incoming",function(e){var n,i;if(""!==(e=e.trim())){try{n=t.parse(e)}catch(e){return i=new r.stanzas.StreamError({condition:"invalid-xml"}),r.emit("stream:error",i,e),r.send(i),r.disconnect()}if("openStream"===n._name)return r.hasStream=!0,r.stream=n,r.emit("stream:start",n.toJSON());if("closeStream"===n._name)return r.emit("stream:end"),r.disconnect();!n.lang&&r.stream&&(n.lang=r.stream.lang),r.emit("stream:data",n)}})}r.inherits(c,i),c.prototype.connect=function(e){var t=this;t.config=e,t.hasStream=!1,t.closing=!1,t.conn=new a(e.wsURL,"xmpp"),t.conn.onerror=function(e){e.preventDefault(),t.emit("disconnected",t)},t.conn.onclose=function(){t.emit("disconnected",t)},t.conn.onopen=function(){t.sm.started=!1,t.emit("connected",t)},t.conn.onmessage=function(e){t.emit("raw:incoming",new n(e.data,"utf8").toString())}},c.prototype.startHeader=function(){return new this.stanzas.Open({version:this.config.version||"1.0",lang:this.config.lang||"en",to:this.config.server})},c.prototype.closeHeader=function(){return new this.stanzas.Close},c.prototype.disconnect=function(){this.conn&&!this.closing&&this.hasStream?(this.closing=!0,this.send(this.closeHeader())):(this.hasStream=!1,this.stream=void 0,this.conn&&this.conn.readyState===s&&this.conn.close(),this.conn=void 0)},c.prototype.restart=function(){this.hasStream=!1,this.send(this.startHeader())},c.prototype.send=function(e){this.sendQueue.push(e)},t.exports=c}).call(this,e("buffer").Buffer)},{async:317,buffer:10,"faye-websocket":7,util:331,wildemitter:350}],317:[function(e,t,n){(function(e,n,r){!function(){var i,o={};function a(){}function s(e){return e}function c(e){return!!e}function u(e){return!e}var l="object"==typeof self&&self.self===self&&self||"object"==typeof n&&n.global===n&&n||this;function d(e){return function(){if(null===e)throw new Error("Callback was already called.");e.apply(this,arguments),e=null}}function p(e){return function(){null!==e&&(e.apply(this,arguments),e=null)}}null!=l&&(i=l.async),o.noConflict=function(){return l.async=i,o};var f=Object.prototype.toString,h=Array.isArray||function(e){return"[object Array]"===f.call(e)};function m(e){return h(e)||"number"==typeof e.length&&e.length>=0&&e.length%1==0}function v(e,t){for(var n=-1,r=e.length;++n<r;)t(e[n],n,e)}function y(e,t){for(var n=-1,r=e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function g(e){return y(Array(e),function(e,t){return t})}function S(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}var _=Object.keys||function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};function b(e){var t,n,r=-1;return m(e)?(t=e.length,function(){return++r<t?r:null}):(n=_(e),t=n.length,function(){return++r<t?n[r]:null})}function C(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r)}}}function w(e){return function(t,n,r){return e(t,r)}}var E="function"==typeof r&&r,R=E?function(e){E(e)}:function(e){setTimeout(e,0)};function P(e){return function(t,n,r){r=p(r||a);var i=b(t=t||[]);if(e<=0)return r(null);var o=!1,s=0,c=!1;!function a(){if(o&&s<=0)return r(null);for(;s<e&&!c;){var u=i();if(null===u)return o=!0,void(s<=0&&r(null));s+=1,n(t[u],u,d(function(e){s-=1,e?(r(e),c=!0):a()}))}}()}}function L(e){return function(t,n,r){return e(o.eachOf,t,n,r)}}function T(e){return function(t,n,r,i){return e(P(n),t,r,i)}}function x(e){return function(t,n,r){return e(o.eachOfSeries,t,n,r)}}function M(e,t,n,r){r=p(r||a);var i=m(t=t||[])?[]:{};e(t,function(e,t,r){n(e,function(e,n){i[t]=n,r(e)})},function(e){r(e,i)})}function A(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(n){n&&i.push({index:t,value:e}),r()})},function(){r(y(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})}function I(e,t,n,r){A(e,t,function(e,t){n(e,function(e){t(!e)})},r)}function O(e,t,n){return function(r,i,o,a){function s(){a&&a(n(!1,void 0))}function c(e,r,i){if(!a)return i();o(e,function(r){a&&t(r)&&(a(n(!0,e)),a=o=!1),i()})}arguments.length>3?e(r,i,c,s):(a=o,o=i,e(r,c,s))}}function D(e,t){return t}function k(e,t,n){n=n||a;var r=m(t)?[]:{};e(t,function(e,t,n){e(C(function(e,i){i.length<=1&&(i=i[0]),r[t]=i,n(e)}))},function(e){n(e,r)})}function j(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(e,t){i=i.concat(t||[]),r(e)})},function(e){r(e,i)})}function N(e,t,n){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");function r(e,t,n,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(e.started=!0,h(t)||(t=[t]),0===t.length&&e.idle())return o.setImmediate(function(){e.drain()});v(t,function(t){var i={data:t,callback:r||a};n?e.tasks.unshift(i):e.tasks.push(i),e.tasks.length===e.concurrency&&e.saturated()}),o.setImmediate(e.process)}function i(e,t){return function(){s-=1;var n=!1,r=arguments;v(t,function(e){v(c,function(t,r){t!==e||n||(c.splice(r,1),n=!0)}),e.callback.apply(e,r)}),e.tasks.length+s===0&&e.drain(),e.process()}}var s=0,c=[],u={tasks:[],concurrency:t,payload:n,saturated:a,empty:a,drain:a,started:!1,paused:!1,push:function(e,t){r(u,e,!1,t)},kill:function(){u.drain=a,u.tasks=[]},unshift:function(e,t){r(u,e,!0,t)},process:function(){for(;!u.paused&&s<u.concurrency&&u.tasks.length;){var t=u.payload?u.tasks.splice(0,u.payload):u.tasks.splice(0,u.tasks.length),n=y(t,function(e){return e.data});0===u.tasks.length&&u.empty(),s+=1,c.push(t[0]);var r=d(i(u,t));e(n,r)}},length:function(){return u.tasks.length},running:function(){return s},workersList:function(){return c},idle:function(){return u.tasks.length+s===0},pause:function(){u.paused=!0},resume:function(){if(!1!==u.paused){u.paused=!1;for(var e=Math.min(u.concurrency,u.tasks.length),t=1;t<=e;t++)o.setImmediate(u.process)}}};return u}function V(e){return C(function(t,n){t.apply(null,n.concat([C(function(t,n){"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&v(n,function(t){console[e](t)}))})]))})}function U(e){return function(t,n,r){e(g(t),n,r)}}function B(e){return C(function(t,n){var r=C(function(n){var r=this,i=n.pop();return e(t,function(e,t,i){e.apply(r,n.concat([i]))},i)});return n.length?r.apply(this,n):r})}function F(e){return C(function(t){var n=t.pop();t.push(function(){var e=arguments;r?o.setImmediate(function(){n.apply(null,e)}):n.apply(null,e)});var r=!0;e.apply(this,t),r=!1})}"object"==typeof e&&"function"==typeof e.nextTick?o.nextTick=e.nextTick:o.nextTick=R,o.setImmediate=E?R:o.nextTick,o.forEach=o.each=function(e,t,n){return o.eachOf(e,w(t),n)},o.forEachSeries=o.eachSeries=function(e,t,n){return o.eachOfSeries(e,w(t),n)},o.forEachLimit=o.eachLimit=function(e,t,n,r){return P(t)(e,w(n),r)},o.forEachOf=o.eachOf=function(e,t,n){n=p(n||a);for(var r,i=b(e=e||[]),o=0;null!=(r=i());)o+=1,t(e[r],r,d(s));function s(e){o--,e?n(e):null===r&&o<=0&&n(null)}0===o&&n(null)},o.forEachOfSeries=o.eachOfSeries=function(e,t,n){n=p(n||a);var r=b(e=e||[]),i=r();!function a(){var s=!0;if(null===i)return n(null);t(e[i],i,d(function(e){if(e)n(e);else{if(null===(i=r()))return n(null);s?o.setImmediate(a):a()}})),s=!1}()},o.forEachOfLimit=o.eachOfLimit=function(e,t,n,r){P(t)(e,n,r)},o.map=L(M),o.mapSeries=x(M),o.mapLimit=T(M),o.inject=o.foldl=o.reduce=function(e,t,n,r){o.eachOfSeries(e,function(e,r,i){n(t,e,function(e,n){t=n,i(e)})},function(e){r(e,t)})},o.foldr=o.reduceRight=function(e,t,n,r){var i=y(e,s).reverse();o.reduce(i,t,n,r)},o.transform=function(e,t,n,r){3===arguments.length&&(r=n,n=t,t=h(e)?[]:{}),o.eachOf(e,function(e,r,i){n(t,e,r,i)},function(e){r(e,t)})},o.select=o.filter=L(A),o.selectLimit=o.filterLimit=T(A),o.selectSeries=o.filterSeries=x(A),o.reject=L(I),o.rejectLimit=T(I),o.rejectSeries=x(I),o.any=o.some=O(o.eachOf,c,s),o.someLimit=O(o.eachOfLimit,c,s),o.all=o.every=O(o.eachOf,u,u),o.everyLimit=O(o.eachOfLimit,u,u),o.detect=O(o.eachOf,s,D),o.detectSeries=O(o.eachOfSeries,s,D),o.detectLimit=O(o.eachOfLimit,s,D),o.sortBy=function(e,t,n){function r(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0}o.map(e,function(e,n){t(e,function(t,r){t?n(t):n(null,{value:e,criteria:r})})},function(e,t){if(e)return n(e);n(null,y(t.sort(r),function(e){return e.value}))})},o.auto=function(e,t,n){"function"==typeof arguments[1]&&(n=t,t=null),n=p(n||a);var r=_(e),i=r.length;if(!i)return n(null);t||(t=i);var s={},c=0,u=!1,l=[];function d(e){l.unshift(e)}function f(){i--,v(l.slice(0),function(e){e()})}d(function(){i||n(null,s)}),v(r,function(r){if(!u){for(var i,a=h(e[r])?e[r]:[e[r]],p=C(function(e,t){if(c--,t.length<=1&&(t=t[0]),e){var i={};l=function(e,t){i[t]=e},v(_(a=s),function(e){l(a[e],e)}),i[r]=t,u=!0,n(e,i)}else s[r]=t,o.setImmediate(f);var a,l}),m=a.slice(0,a.length-1),y=m.length;y--;){if(!(i=e[m[y]]))throw new Error("Has nonexistent dependency in "+m.join(", "));if(h(i)&&S(i,r)>=0)throw new Error("Has cyclic dependencies")}g()?(c++,a[a.length-1](p,s)):d(function e(){g()&&(c++,(t=S(l,e))>=0&&l.splice(t,1),a[a.length-1](p,s));var t})}function g(){return c<t&&(e=function(e,t){return e&&s.hasOwnProperty(t)},n=!0,v(m,function(t,r,i){n=e(n,t,r,i)}),n)&&!s.hasOwnProperty(r);var e,n}})},o.retry=function(e,t,n){var r=5,i=0,a=[],s={times:r,interval:i};var c=arguments.length;if(c<1||c>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");function u(e,t){function n(e,n){return function(r){e(function(e,t){r(!e||n,{err:e,result:t})},t)}}function r(e){return function(t){setTimeout(function(){t(null)},e)}}for(;s.times;){var i=!(s.times-=1);a.push(n(s.task,i)),!i&&s.interval>0&&a.push(r(s.interval))}o.series(a,function(t,n){n=n[n.length-1],(e||s.callback)(n.err,n.result)})}return c<=2&&"function"==typeof e&&(n=t,t=e),"function"!=typeof e&&function(e,t){if("number"==typeof t)e.times=parseInt(t,10)||r;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);e.times=parseInt(t.times,10)||r,e.interval=parseInt(t.interval,10)||i}}(s,e),s.callback=n,s.task=t,s.callback?u():u},o.waterfall=function(e,t){if(t=p(t||a),!h(e)){var n=new Error("First argument to waterfall must be an array of functions");return t(n)}if(!e.length)return t();!function e(n){return C(function(r,i){if(r)t.apply(null,[r].concat(i));else{var o=n.next();o?i.push(e(o)):i.push(t),F(n).apply(null,i)}})}(o.iterator(e))()},o.parallel=function(e,t){k(o.eachOf,e,t)},o.parallelLimit=function(e,t,n){k(P(t),e,n)},o.series=function(e,t){k(o.eachOfSeries,e,t)},o.iterator=function(e){return function t(n){function r(){return e.length&&e[n].apply(null,arguments),r.next()}return r.next=function(){return n<e.length-1?t(n+1):null},r}(0)},o.apply=C(function(e,t){return C(function(n){return e.apply(null,t.concat(n))})}),o.concat=L(j),o.concatSeries=x(j),o.whilst=function(e,t,n){if(n=n||a,e()){var r=C(function(i,o){i?n(i):e.apply(this,o)?t(r):n.apply(null,[null].concat(o))});t(r)}else n(null)},o.doWhilst=function(e,t,n){var r=0;return o.whilst(function(){return++r<=1||t.apply(this,arguments)},e,n)},o.until=function(e,t,n){return o.whilst(function(){return!e.apply(this,arguments)},t,n)},o.doUntil=function(e,t,n){return o.doWhilst(e,function(){return!t.apply(this,arguments)},n)},o.during=function(e,t,n){n=n||a;var r=C(function(t,r){t?n(t):(r.push(i),e.apply(this,r))}),i=function(e,i){e?n(e):i?t(r):n(null)};e(i)},o.doDuring=function(e,t,n){var r=0;o.during(function(e){r++<1?e(null,!0):t.apply(this,arguments)},e,n)},o.queue=function(e,t){return N(function(t,n){e(t[0],n)},t,1)},o.priorityQueue=function(e,t){function n(e,t){return e.priority-t.priority}var r=o.queue(e,t);return r.push=function(e,t,i){!function(e,t,r,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");if(e.started=!0,h(t)||(t=[t]),0===t.length)return o.setImmediate(function(){e.drain()});v(t,function(t){var s={data:t,priority:r,callback:"function"==typeof i?i:a};e.tasks.splice(function(e,t,n){for(var r=-1,i=e.length-1;r<i;){var o=r+(i-r+1>>>1);n(t,e[o])>=0?r=o:i=o-1}return r}(e.tasks,s,n)+1,0,s),e.tasks.length===e.concurrency&&e.saturated(),o.setImmediate(e.process)})}(r,e,t,i)},delete r.unshift,r},o.cargo=function(e,t){return N(e,1,t)},o.log=V("log"),o.dir=V("dir"),o.memoize=function(e,t){var n={},r={},i=Object.prototype.hasOwnProperty;t=t||s;var a=C(function(a){var s=a.pop(),c=t.apply(null,a);i.call(n,c)?o.setImmediate(function(){s.apply(null,n[c])}):i.call(r,c)?r[c].push(s):(r[c]=[s],e.apply(null,a.concat([C(function(e){n[c]=e;var t=r[c];delete r[c];for(var i=0,o=t.length;i<o;i++)t[i].apply(null,e)})])))});return a.memo=n,a.unmemoized=e,a},o.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},o.times=U(o.map),o.timesSeries=U(o.mapSeries),o.timesLimit=function(e,t,n,r){return o.mapLimit(g(e),t,n,r)},o.seq=function(){var e=arguments;return C(function(t){var n=this,r=t[t.length-1];"function"==typeof r?t.pop():r=a,o.reduce(e,t,function(e,t,r){t.apply(n,e.concat([C(function(e,t){r(e,t)})]))},function(e,t){r.apply(n,[e].concat(t))})})},o.compose=function(){return o.seq.apply(null,Array.prototype.reverse.call(arguments))},o.applyEach=B(o.eachOf),o.applyEachSeries=B(o.eachOfSeries),o.forever=function(e,t){var n=d(t||a),r=F(e);!function e(t){if(t)return n(t);r(e)}()},o.ensureAsync=F,o.constant=C(function(e){var t=[null].concat(e);return function(e){return e.apply(this,t)}}),o.wrapSync=o.asyncify=function(e){return C(function(t){var n,r,i,o=t.pop();try{n=e.apply(this,t)}catch(e){return o(e)}("function"===(i=typeof(r=n))||"object"===i&&r)&&"function"==typeof n.then?n.then(function(e){o(null,e)}).catch(function(e){o(e.message?e:new Error(e))}):o(null,n)})},"object"==typeof t&&t.exports?t.exports=o:"function"==typeof define&&define.amd?define([],function(){return o}):l.async=o}()}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{_process:8,timers:326}],318:[function(e,t,n){(function(e){var n,r=e.crypto||e.msCrypto;if(r&&r.getRandomValues){var i=new Uint8Array(16);n=function(){return r.getRandomValues(i),i}}if(!n){var o=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],319:[function(e,t,n){arguments[4][90][0].apply(n,arguments)},{"./rng":318,dup:90}],320:[function(e,t,n){t.exports=i;var r=e("events").EventEmitter;function i(){r.call(this)}e("inherits")(i,r),i.Readable=e("readable-stream/readable.js"),i.Writable=e("readable-stream/writable.js"),i.Duplex=e("readable-stream/duplex.js"),i.Transform=e("readable-stream/transform.js"),i.PassThrough=e("readable-stream/passthrough.js"),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",c));var a=!1;function s(){a||(a=!0,e.end())}function c(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(l(),0===r.listenerCount(this,"error"))throw e}function l(){n.removeListener("data",i),e.removeListener("drain",o),n.removeListener("end",s),n.removeListener("close",c),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",l),n.removeListener("close",l),e.removeListener("close",l)}return n.on("error",u),e.on("error",u),n.on("end",l),n.on("close",l),e.on("close",l),e.emit("pipe",n),e}},{events:44,inherits:61,"readable-stream/duplex.js":212,"readable-stream/passthrough.js":223,"readable-stream/readable.js":224,"readable-stream/transform.js":225,"readable-stream/writable.js":226}],321:[function(e,t,n){"use strict";var r=e("function-bind"),i=e("es-abstract/es5"),o=r.call(Function.call,String.prototype.replace),a=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,s=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;t.exports=function(){var e=i.ToString(i.CheckObjectCoercible(this));return o(o(e,a,""),s,"")}},{"es-abstract/es5":35,"function-bind":51}],322:[function(e,t,n){"use strict";var r=e("function-bind"),i=e("define-properties"),o=e("./implementation"),a=e("./polyfill"),s=e("./shim"),c=r.call(Function.call,a());i(c,{getPolyfill:a,implementation:o,shim:s}),t.exports=c},{"./implementation":321,"./polyfill":323,"./shim":324,"define-properties":32,"function-bind":51}],323:[function(e,t,n){"use strict";var r=e("./implementation");t.exports=function(){return String.prototype.trim&&""==="".trim()?String.prototype.trim:r}},{"./implementation":321}],324:[function(e,t,n){"use strict";var r=e("define-properties"),i=e("./polyfill");t.exports=function(){var e=i();return r(String.prototype,{trim:e},{trim:function(){return String.prototype.trim!==e}}),e}},{"./polyfill":323,"define-properties":32}],325:[function(e,t,n){var r=e("buffer").Buffer,i=r.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};var o=n.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!i(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=s;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=c;break;default:return void(this.write=a)}this.charBuffer=new r(6),this.charReceived=0,this.charLength=0};function a(e){return e.toString(this.encoding)}function s(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function c(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}o.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(e=e.slice(n,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var r=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,r),r-=this.charReceived);var i;r=(t+=e.toString(this.encoding,0,r)).length-1;if((i=t.charCodeAt(r))>=55296&&i<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,r)}return t},o.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},o.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;t+=r.slice(0,n).toString(i)}return t}},{buffer:10}],326:[function(e,t,n){(function(t,r){var i=e("process/browser.js").nextTick,o=Function.prototype.apply,a=Array.prototype.slice,s={},c=0;function u(e,t){this._id=e,this._clearFn=t}n.setTimeout=function(){return new u(o.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new u(o.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n.setImmediate="function"==typeof t?t:function(e){var t=c++,r=!(arguments.length<2)&&a.call(arguments,1);return s[t]=!0,i(function(){s[t]&&(r?e.apply(null,r):e.call(null),n.clearImmediate(t))}),t},n.clearImmediate="function"==typeof r?r:function(e){delete s[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":327,timers:326}],327:[function(e,t,n){arguments[4][8][0].apply(n,arguments)},{dup:8}],328:[function(e,t,n){(function(e){function n(t){try{if(!e.localStorage)return!1}catch(e){return!1}var n=e.localStorage[t];return null!=n&&"true"===String(n).toLowerCase()}t.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],329:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],330:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],331:[function(e,t,n){(function(t,r){var i=/%[sdj%]/g;n.format=function(e){if(!y(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(e).replace(i,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),c=r[n];n<o;c=r[++n])m(c)||!_(c)?a+=" "+c:a+=" "+s(c);return a},n.deprecate=function(e,i){if(g(r.process))return function(){return n.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),o=!0}return e.apply(this,arguments)}};var o,a={};function s(e,t){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),h(t)?r.showHidden=t:t&&n._extend(r,t),g(r.showHidden)&&(r.showHidden=!1),g(r.depth)&&(r.depth=2),g(r.colors)&&(r.colors=!1),g(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),l(r,e,r.depth)}function c(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function u(e,t){return e}function l(e,t,r){if(e.customInspect&&t&&w(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(r,e);return y(i)||(i=l(e,i,r)),i}var o=function(e,t){if(g(t))return e.stylize("undefined","undefined");if(y(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(v(t))return e.stylize(""+t,"number");if(h(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,t);if(o)return o;var a=Object.keys(t),s=function(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),C(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return d(t);if(0===a.length){if(w(t)){var c=t.name?": "+t.name:"";return e.stylize("[Function"+c+"]","special")}if(S(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(b(t))return e.stylize(Date.prototype.toString.call(t),"date");if(C(t))return d(t)}var u,_="",E=!1,R=["{","}"];(f(t)&&(E=!0,R=["[","]"]),w(t))&&(_=" [Function"+(t.name?": "+t.name:"")+"]");return S(t)&&(_=" "+RegExp.prototype.toString.call(t)),b(t)&&(_=" "+Date.prototype.toUTCString.call(t)),C(t)&&(_=" "+d(t)),0!==a.length||E&&0!=t.length?r<0?S(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),u=E?function(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;++a)L(t,String(a))?o.push(p(e,t,n,r,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(e,t,n,r,i,!0))}),o}(e,t,r,s,a):a.map(function(n){return p(e,t,r,s,n,E)}),e.seen.pop(),function(e,t,n){if(e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(u,_,R)):R[0]+_+R[1]}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,n,r,i,o){var a,s,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),L(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(c.value)<0?(s=m(n)?l(e,c.value,null):l(e,c.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),g(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function f(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function m(e){return null===e}function v(e){return"number"==typeof e}function y(e){return"string"==typeof e}function g(e){return void 0===e}function S(e){return _(e)&&"[object RegExp]"===E(e)}function _(e){return"object"==typeof e&&null!==e}function b(e){return _(e)&&"[object Date]"===E(e)}function C(e){return _(e)&&("[object Error]"===E(e)||e instanceof Error)}function w(e){return"function"==typeof e}function E(e){return Object.prototype.toString.call(e)}function R(e){return e<10?"0"+e.toString(10):e.toString(10)}n.debuglog=function(e){if(g(o)&&(o=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(o)){var r=t.pid;a[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else a[e]=function(){};return a[e]},n.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=f,n.isBoolean=h,n.isNull=m,n.isNullOrUndefined=function(e){return null==e},n.isNumber=v,n.isString=y,n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=g,n.isRegExp=S,n.isObject=_,n.isDate=b,n.isError=C,n.isFunction=w,n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=e("./support/isBuffer");var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function L(e,t){return Object.prototype.hasOwnProperty.call(e,t)}n.log=function(){var e,t;console.log("%s - %s",(e=new Date,t=[R(e.getHours()),R(e.getMinutes()),R(e.getSeconds())].join(":"),[e.getDate(),P[e.getMonth()],t].join(" ")),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!_(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":330,_process:8,inherits:329}],332:[function(e,t,n){var r=e("./v1"),i=e("./v4"),o=i;o.v1=r,o.v4=i,t.exports=o},{"./v1":335,"./v4":336}],333:[function(e,t,n){for(var r=[],i=0;i<256;++i)r[i]=(i+256).toString(16).substr(1);t.exports=function(e,t){var n=t||0,i=r;return[i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]]].join("")}},{}],334:[function(e,t,n){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var i=new Uint8Array(16);t.exports=function(){return r(i),i}}else{var o=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},{}],335:[function(e,t,n){var r,i,o=e("./lib/rng"),a=e("./lib/bytesToUuid"),s=0,c=0;t.exports=function(e,t,n){var u=t&&n||0,l=t||[],d=(e=e||{}).node||r,p=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==p){var f=o();null==d&&(d=r=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==p&&(p=i=16383&(f[6]<<8|f[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,v=h-s+(m-c)/1e4;if(v<0&&void 0===e.clockseq&&(p=p+1&16383),(v<0||h>s)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,c=m,i=p;var y=(1e4*(268435455&(h+=122192928e5))+m)%4294967296;l[u++]=y>>>24&255,l[u++]=y>>>16&255,l[u++]=y>>>8&255,l[u++]=255&y;var g=h/4294967296*1e4&268435455;l[u++]=g>>>8&255,l[u++]=255&g,l[u++]=g>>>24&15|16,l[u++]=g>>>16&255,l[u++]=p>>>8|128,l[u++]=255&p;for(var S=0;S<6;++S)l[u+S]=d[S];return t||a(l)}},{"./lib/bytesToUuid":333,"./lib/rng":334}],336:[function(e,t,n){var r=e("./lib/rng"),i=e("./lib/bytesToUuid");t.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},{"./lib/bytesToUuid":333,"./lib/rng":334}],337:[function(e,t,n){arguments[4][228][0].apply(n,arguments)},{dup:228}],338:[function(e,t,n){(function(n){"use strict";var r=e("./adapter_factory.js");t.exports=r({window:n.window})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./adapter_factory.js":339}],339:[function(e,t,n){"use strict";var r=e("./utils");t.exports=function(t,n){var i=t&&t.window,o={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var a in n)hasOwnProperty.call(n,a)&&(o[a]=n[a]);var s=r.log,c=r.detectBrowser(i),u={browserDetails:c,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings},l=e("./chrome/chrome_shim")||null,d=e("./edge/edge_shim")||null,p=e("./firefox/firefox_shim")||null,f=e("./safari/safari_shim")||null,h=e("./common_shim")||null;switch(c.browser){case"chrome":if(!l||!l.shimPeerConnection||!o.shimChrome)return s("Chrome shim is not included in this adapter release."),u;s("adapter.js shimming chrome."),u.browserShim=l,h.shimCreateObjectURL(i),l.shimGetUserMedia(i),l.shimMediaStream(i),l.shimSourceObject(i),l.shimPeerConnection(i),l.shimOnTrack(i),l.shimAddTrackRemoveTrack(i),l.shimGetSendersWithDtmf(i),h.shimRTCIceCandidate(i);break;case"firefox":if(!p||!p.shimPeerConnection||!o.shimFirefox)return s("Firefox shim is not included in this adapter release."),u;s("adapter.js shimming firefox."),u.browserShim=p,h.shimCreateObjectURL(i),p.shimGetUserMedia(i),p.shimSourceObject(i),p.shimPeerConnection(i),p.shimOnTrack(i),h.shimRTCIceCandidate(i);break;case"edge":if(!d||!d.shimPeerConnection||!o.shimEdge)return s("MS edge shim is not included in this adapter release."),u;s("adapter.js shimming edge."),u.browserShim=d,h.shimCreateObjectURL(i),d.shimGetUserMedia(i),d.shimPeerConnection(i),d.shimReplaceTrack(i);break;case"safari":if(!f||!o.shimSafari)return s("Safari shim is not included in this adapter release."),u;s("adapter.js shimming safari."),u.browserShim=f,h.shimCreateObjectURL(i),f.shimRTCIceServerUrls(i),f.shimCallbacksAPI(i),f.shimLocalStreamsAPI(i),f.shimRemoteStreamsAPI(i),f.shimTrackEventTransceiver(i),f.shimGetUserMedia(i),f.shimCreateOfferLegacy(i),h.shimRTCIceCandidate(i);break;default:s("Unsupported browser!")}return u}},{"./chrome/chrome_shim":340,"./common_shim":342,"./edge/edge_shim":343,"./firefox/firefox_shim":345,"./safari/safari_shim":347,"./utils":348}],340:[function(e,t,n){"use strict";var r=e("../utils.js"),i=r.log,o={shimMediaStream:function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},shimOnTrack:function(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return n._ontrackpoly||(n._ontrackpoly=function(t){t.stream.addEventListener("addtrack",function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===r.track.id}):{track:r.track};var o=new Event("track");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)}),t.stream.getTracks().forEach(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===r.id}):{track:r};var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)})},n.addEventListener("addstream",n._ontrackpoly)),t.apply(n,arguments)}}},shimGetSendersWithDtmf:function(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;n._senders=n._senders||[],i.apply(n,[e]),e.getTracks().forEach(function(e){n._senders.push(t(n,e))})};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._senders=t._senders||[],o.apply(t,[e]),e.getTracks().forEach(function(e){var n=t._senders.find(function(t){return t.track===e});n&&t._senders.splice(t._senders.indexOf(n),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(e,[]);return t.forEach(function(t){t._pc=e}),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},shimSourceObject:function(e){var t=e&&e.URL;"object"==typeof e&&(!e.HTMLMediaElement||"srcObject"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var n=this;this._srcObject=e,this.src&&t.revokeObjectURL(this.src),e?(this.src=t.createObjectURL(e),e.addEventListener("addtrack",function(){n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)}),e.addEventListener("removetrack",function(){n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)})):this.src=""}}))},shimAddTrackRemoveTrack:function(e){var t=r.detectBrowser(e);if(!(e.RTCPeerConnection.prototype.addTrack&&t.version>=63)){var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return e._reverseStreams=e._reverseStreams||{},t.map(function(t){return e._reverseStreams[t.id]})};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(n._streams=n._streams||{},n._reverseStreams=n._reverseStreams||{},t.getTracks().forEach(function(e){if(n.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")}),!n._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());n._streams[t.id]=r,n._reverseStreams[r.id]=t,t=r}i.apply(n,[t])};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._streams=t._streams||{},t._reverseStreams=t._reverseStreams||{},o.apply(t,[t._streams[e.id]||e]),delete t._reverseStreams[t._streams[e.id]?t._streams[e.id].id:e.id],delete t._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===r.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(r.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");r._streams=r._streams||{},r._reverseStreams=r._reverseStreams||{};var o=r._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then(function(){r.dispatchEvent(new Event("negotiationneeded"))});else{var a=new e.MediaStream([t]);r._streams[n.id]=a,r._reverseStreams[a.id]=n,r.addStream(a)}return r.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(e,[function(n){var r=c(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(e,arguments).then(function(t){return c(e,t)})}});var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};var s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:c(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if("closed"===n.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===n))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");n._streams=n._streams||{},Object.keys(n._streams).forEach(function(r){n._streams[r].getTracks().find(function(t){return e.track===t})&&(t=n._streams[r])}),t&&(1===t.getTracks().length?n.removeStream(n._reverseStreams[t.id]):t.removeTrack(e.track),n.dispatchEvent(new Event("negotiationneeded")))}}function c(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}},shimPeerConnection:function(e){var t=r.detectBrowser(e);if(e.RTCPeerConnection){var n=e.RTCPeerConnection;e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var i=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,i.push(a)):i.push(e.iceServers[o])}e.iceServers=i}return new n(e,t)},e.RTCPeerConnection.prototype=n.prototype,Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return n.generateCertificate}})}else e.RTCPeerConnection=function(t,n){return i("PeerConnection"),t&&t.iceTransportPolicy&&(t.iceTransports=t.iceTransportPolicy),new e.webkitRTCPeerConnection(t,n)},e.RTCPeerConnection.prototype=e.webkitRTCPeerConnection.prototype,e.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.webkitRTCPeerConnection.generateCertificate}});var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,n){var r=this,i=arguments;if(arguments.length>0&&"function"==typeof e)return o.apply(this,arguments);if(0===o.length&&(0===arguments.length||"function"!=typeof arguments[0]))return o.apply(this,[]);var a=function(e){var t={};return e.result().forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(arguments.length>=2){return o.apply(this,[function(e){i[1](s(a(e)))},arguments[0]])}return new Promise(function(e,t){o.apply(r,[function(t){e(s(a(t)))},t])}).then(t,n)},t.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=arguments,t=this,r=new Promise(function(r,i){n.apply(t,[e[0],r,i])});return e.length<2?r:r.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}}),t.version<52&&["createOffer","createAnswer"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var t=1===arguments.length?arguments[0]:void 0;return new Promise(function(r,i){n.apply(e,[r,i,t])})}return n.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}});var a=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?a.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};t.exports={shimMediaStream:o.shimMediaStream,shimOnTrack:o.shimOnTrack,shimAddTrackRemoveTrack:o.shimAddTrackRemoveTrack,shimGetSendersWithDtmf:o.shimGetSendersWithDtmf,shimSourceObject:o.shimSourceObject,shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils.js":348,"./getusermedia":341}],341:[function(e,t,n){"use strict";var r=e("../utils.js"),i=r.log;t.exports=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,o=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var o={};"number"==typeof r.ideal?(o[i("min",n)]=r.ideal,t.optional.push(o),(o={})[i("max",n)]=r.ideal,t.optional.push(o)):(o[i("",n)]=r.ideal,t.optional.push(o))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},a=function(e,r){if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};a((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),a(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=o(e.audio)}if(e&&"object"==typeof e.video){var s=e.video.facingMode;s=s&&("object"==typeof s?s:{ideal:s});var c,u=t.version<61;if(s&&("user"===s.exact||"environment"===s.exact||"user"===s.ideal||"environment"===s.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||u))if(delete e.video.facingMode,"environment"===s.exact||"environment"===s.ideal?c=["back","rear"]:"user"!==s.exact&&"user"!==s.ideal||(c=["front"]),c)return n.mediaDevices.enumerateDevices().then(function(t){var n=(t=t.filter(function(e){return"videoinput"===e.kind})).find(function(e){return c.some(function(t){return-1!==e.label.toLowerCase().indexOf(t)})});return!n&&t.length&&-1!==c.indexOf("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=s.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=o(e.video),i("chrome: "+JSON.stringify(e)),r(e)});e.video=o(e.video)}return i("chrome: "+JSON.stringify(e)),r(e)},s=function(e){return{name:{PermissionDeniedError:"NotAllowedError",InvalidStateError:"NotReadableError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotReadableError",MediaDeviceKillSwitchOn:"NotReadableError"}[e.name]||e.name,message:e.message,constraint:e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};n.getUserMedia=function(e,t,r){a(e,function(e){n.webkitGetUserMedia(e,t,function(e){r&&r(s(e))})})};var c=function(e){return new Promise(function(t,r){n.getUserMedia(e,t,r)})};if(n.mediaDevices||(n.mediaDevices={getUserMedia:c,enumerateDevices:function(){return new Promise(function(t){var n={audio:"audioinput",video:"videoinput"};return e.MediaStreamTrack.getSources(function(e){t(e.map(function(e){return{label:e.label,kind:n[e.kind],deviceId:e.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),n.mediaDevices.getUserMedia){var u=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return a(e,function(e){return u(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(s(e))})})}}else n.mediaDevices.getUserMedia=function(e){return c(e)};void 0===n.mediaDevices.addEventListener&&(n.mediaDevices.addEventListener=function(){i("Dummy mediaDevices.addEventListener called.")}),void 0===n.mediaDevices.removeEventListener&&(n.mediaDevices.removeEventListener=function(){i("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":348}],342:[function(e,t,n){"use strict";var r=e("sdp"),i=e("./utils");t.exports={shimRTCIceCandidate:function(e){if(!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){"object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2));var n=new t(e),i=r.parseCandidate(e.candidate),o=Object.assign(n,i);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o},function(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var o=function(e){r(n(e))};return this._eventMap=this._eventMap||{},this._eventMap[r]=o,i.apply(this,[e,o])};var o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return o.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)}})}}(e,"icecandidate",function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t})}},shimCreateObjectURL:function(e){var t=e&&e.URL;if("object"==typeof e&&e.HTMLMediaElement&&"srcObject"in e.HTMLMediaElement.prototype&&t.createObjectURL&&t.revokeObjectURL){var n=t.createObjectURL.bind(t),r=t.revokeObjectURL.bind(t),o=new Map,a=0;t.createObjectURL=function(e){if("getTracks"in e){var t="polyblob:"+ ++a;return o.set(t,e),i.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream"),t}return n(e)},t.revokeObjectURL=function(e){r(e),o.delete(e)};var s=Object.getOwnPropertyDescriptor(e.HTMLMediaElement.prototype,"src");Object.defineProperty(e.HTMLMediaElement.prototype,"src",{get:function(){return s.get.apply(this)},set:function(e){return this.srcObject=o.get(e)||null,s.set.apply(this,[e])}});var c=e.HTMLMediaElement.prototype.setAttribute;e.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=o.get(arguments[1])||null),c.apply(this,arguments)}}}}},{"./utils":348,sdp:337}],343:[function(e,t,n){"use strict";var r=e("../utils"),i=e("rtcpeerconnection-shim");t.exports={shimGetUserMedia:e("./getusermedia"),shimPeerConnection:function(e){var t=r.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCPeerConnection=i(e,t.version)},shimReplaceTrack:function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}}},{"../utils":348,"./getusermedia":344,"rtcpeerconnection-shim":229}],344:[function(e,t,n){"use strict";t.exports=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch(function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}}},{}],345:[function(e,t,n){"use strict";var r=e("../utils"),i={shimOnTrack:function(e){"object"!=typeof e||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.transceiver={receiver:n.receiver},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}}),"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(e){"object"==typeof e&&(!e.HTMLMediaElement||"srcObject"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(e){var t=r.detectBrowser(e);if("object"==typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){e.RTCPeerConnection||(e.RTCPeerConnection=function(n,r){if(t.version<38&&n&&n.iceServers){for(var i=[],o=0;o<n.iceServers.length;o++){var a=n.iceServers[o];if(a.hasOwnProperty("urls"))for(var s=0;s<a.urls.length;s++){var c={url:a.urls[s]};0===a.urls[s].indexOf("turn")&&(c.username=a.username,c.credential=a.credential),i.push(c)}else i.push(n.iceServers[o])}n.iceServers=i}return new e.mozRTCPeerConnection(n,r)},e.RTCPeerConnection.prototype=e.mozRTCPeerConnection.prototype,e.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.mozRTCPeerConnection.generateCertificate}}),e.RTCSessionDescription=e.mozRTCSessionDescription,e.RTCIceCandidate=e.mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}});var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,n,r){return o.apply(this,[e||null]).then(function(e){if(t.version<48&&(e=function(e){var t=new Map;return Object.keys(e).forEach(function(n){t.set(n,e[n]),t[n]=e[n]}),t}(e)),t.version<53&&!n)try{e.forEach(function(e){e.type=i[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach(function(t,n){e.set(n,Object.assign({},t,{type:i[t.type]||t.type}))})}return e}).then(n,r)}}}};t.exports={shimOnTrack:i.shimOnTrack,shimSourceObject:i.shimSourceObject,shimPeerConnection:i.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":348,"./getusermedia":346}],346:[function(e,t,n){"use strict";var r=e("../utils"),i=r.log;t.exports=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,o=e&&e.MediaStreamTrack,a=function(e){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},s=function(e,r,o){var s=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r=e[n]="object"==typeof e[n]?e[n]:{ideal:e[n]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||t.push(n),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var i={};"number"==typeof r.ideal?i[n]={min:r.ideal,max:r.ideal}:i[n]=r.ideal,e.advanced.push(i),delete r.ideal,Object.keys(r).length||delete e[n]}}}),t.length&&(e.require=t),e};return e=JSON.parse(JSON.stringify(e)),t.version<38&&(i("spec: "+JSON.stringify(e)),e.audio&&(e.audio=s(e.audio)),e.video&&(e.video=s(e.video)),i("ff37: "+JSON.stringify(e))),n.mozGetUserMedia(e,r,function(e){o(a(e))})};if(n.mediaDevices||(n.mediaDevices={getUserMedia:function(e){return new Promise(function(t,n){s(e,t,n)})},addEventListener:function(){},removeEventListener:function(){}}),n.mediaDevices.enumerateDevices=n.mediaDevices.enumerateDevices||function(){return new Promise(function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},t.version<41){var c=n.mediaDevices.enumerateDevices.bind(n.mediaDevices);n.mediaDevices.enumerateDevices=function(){return c().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(t.version<49){var u=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return u(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("The object can not be found here.","NotFoundError");return t},function(e){return Promise.reject(a(e))})}}if(!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var l=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},d=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"==typeof e&&"object"==typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),l(e.audio,"autoGainControl","mozAutoGainControl"),l(e.audio,"noiseSuppression","mozNoiseSuppression")),d(e)},o&&o.prototype.getSettings){var p=o.prototype.getSettings;o.prototype.getSettings=function(){var e=p.apply(this,arguments);return l(e,"mozAutoGainControl","autoGainControl"),l(e,"mozNoiseSuppression","noiseSuppression"),e}}if(o&&o.prototype.applyConstraints){var f=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"==typeof e&&(e=JSON.parse(JSON.stringify(e)),l(e,"autoGainControl","mozAutoGainControl"),l(e,"noiseSuppression","mozNoiseSuppression")),f.apply(this,[e])}}}n.getUserMedia=function(e,i,o){if(t.version<44)return s(e,i,o);r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(i,o)}}},{"../utils":348}],347:[function(e,t,n){"use strict";var r=e("../utils"),i={shimLocalStreamsAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"getStreamById"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getStreamById=function(e){var t=null;return this._localStreams&&this._localStreams.forEach(function(n){n.id===e&&(t=n)}),this._remoteStreams&&this._remoteStreams.forEach(function(n){n.id===e&&(t=n)}),t}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),-1===this._localStreams.indexOf(e)&&this._localStreams.push(e);var n=this;e.getTracks().forEach(function(r){t.call(n,r,e)})},e.RTCPeerConnection.prototype.addTrack=function(e,n){n&&(this._localStreams?-1===this._localStreams.indexOf(n)&&this._localStreams.push(n):this._localStreams=[n]),t.call(this,e,n)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);var t=this._localStreams.indexOf(e);if(-1!==t){this._localStreams.splice(t,1);var n=this,r=e.getTracks();this.getSenders().forEach(function(e){-1!==r.indexOf(e.track)&&n.removeTrack(e)})}})}},shimRemoteStreamsAPI:function(e){"object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),"onaddstream"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){var t=e.streams[0];if(this._remoteStreams||(this._remoteStreams=[]),!(this._remoteStreams.indexOf(t)>=0)){this._remoteStreams.push(t);var n=new Event("addstream");n.stream=e.streams[0],this.dispatchEvent(n)}}.bind(this))}}))},shimCallbacksAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};var s=function(e,t,n){var r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=s,s=function(e,t,n){var r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=s,s=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=s}},shimGetUserMedia:function(e){var t=e&&e.navigator;t.getUserMedia||(t.webkitGetUserMedia?t.getUserMedia=t.webkitGetUserMedia.bind(t):t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t)))},shimRTCIceServerUrls:function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var i=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,i.push(a)):i.push(e.iceServers[o])}e.iceServers=i}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},shimTrackEventTransceiver:function(e){"object"==typeof e&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var n=this;if(e){var r=n.getTransceivers().find(function(e){return e.sender.track&&"audio"===e.sender.track.kind});!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection("sendonly"):"recvonly"===r.direction&&r.setDirection("inactive"):!0!==e.offerToReceiveAudio||r||n.addTransceiver("audio");var i=n.getTransceivers().find(function(e){return e.sender.track&&"video"===e.sender.track.kind});!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection("sendonly"):"recvonly"===i.direction&&i.setDirection("inactive"):!0!==e.offerToReceiveVideo||i||n.addTransceiver("video")}return t.apply(n,arguments)}}};t.exports={shimCallbacksAPI:i.shimCallbacksAPI,shimLocalStreamsAPI:i.shimLocalStreamsAPI,shimRemoteStreamsAPI:i.shimRemoteStreamsAPI,shimGetUserMedia:i.shimGetUserMedia,shimRTCIceServerUrls:i.shimRTCIceServerUrls,shimTrackEventTransceiver:i.shimTrackEventTransceiver,shimCreateOfferLegacy:i.shimCreateOfferLegacy}},{"../utils":348}],348:[function(e,t,n){"use strict";var r=!0,i=!0,o={disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(r=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},disableWarnings:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},log:function(){if("object"==typeof window){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},deprecated:function(e,t){i&&console.warn(e+" is deprecated, please use "+t+" instead.")},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)},detectBrowser:function(e){var t=e&&e.navigator,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=this.extractVersion(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia)if(e.webkitRTCPeerConnection)n.browser="chrome",n.version=this.extractVersion(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!t.userAgent.match(/Version\/(\d+).(\d+)/))return n.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",n;n.browser="safari",n.version=this.extractVersion(t.userAgent,/AppleWebKit\/(\d+)\./,1)}else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=this.extractVersion(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!t.mediaDevices||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=this.extractVersion(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return n}};t.exports={log:o.log,deprecated:o.deprecated,disableLog:o.disableLog,disableWarnings:o.disableWarnings,extractVersion:o.extractVersion,shimCreateObjectURL:o.shimCreateObjectURL,detectBrowser:o.detectBrowser.bind(o)}},{}],349:[function(e,t,n){var r,i;window.mozRTCPeerConnection||navigator.mozGetUserMedia?(r="moz",i=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)):(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)&&(r="webkit",i=navigator.userAgent.match(/Chrom(e|ium)/)&&parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10));var o=window.mozRTCPeerConnection||window.webkitRTCPeerConnection,a=window.mozRTCIceCandidate||window.RTCIceCandidate,s=window.mozRTCSessionDescription||window.RTCSessionDescription,c=window.webkitMediaStream||window.MediaStream,u="https:"===window.location.protocol&&("webkit"===r&&i>=26||"moz"===r&&i>=33),l=window.AudioContext||window.webkitAudioContext,d=document.createElement("video"),p=d&&d.canPlayType&&"probably"===d.canPlayType('video/webm; codecs="vp8", vorbis'),f=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;t.exports={prefix:r,browserVersion:i,support:!!o&&p&&!!f,supportRTCPeerConnection:!!o,supportVp8:p,supportGetUserMedia:!!f,supportDataChannel:!!(o&&o.prototype&&o.prototype.createDataChannel),supportWebAudio:!(!l||!l.prototype.createMediaStreamSource),supportMediaStream:!(!c||!c.prototype.removeTrack),supportScreenSharing:!!u,dataChannel:!!(o&&o.prototype&&o.prototype.createDataChannel),webAudio:!(!l||!l.prototype.createMediaStreamSource),mediaStream:!(!c||!c.prototype.removeTrack),screenSharing:!!u,AudioContext:l,PeerConnection:o,SessionDescription:s,IceCandidate:a,MediaStream:c,getUserMedia:f}},{}],350:[function(e,t,n){function r(){}t.exports=r,r.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,n){this.callbacks=this.callbacks||{};var r=3===arguments.length,i=r?arguments[1]:void 0,o=r?arguments[2]:arguments[1];return o._groupName=i,(this.callbacks[e]=this.callbacks[e]||[]).push(o),this},t.once=function(e,t,n){var r=this,i=3===arguments.length,o=i?arguments[1]:void 0,a=i?arguments[2]:arguments[1];return this.on(e,o,function t(){r.off(e,t),a.apply(this,arguments)}),this},t.releaseGroup=function(e){var t,n,r,i;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(n=0,r=(i=this.callbacks[t]).length;n<r;n++)i[n]._groupName===e&&(i.splice(n,1),n--,r--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var n,r=this.callbacks[e];return r?1===arguments.length?(delete this.callbacks[e],this):(n=r.indexOf(t),r.splice(n,1),0===r.length&&delete this.callbacks[e],this):this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,n,r,i=[].slice.call(arguments,1),o=this.callbacks[e],a=this.getWildcardCallbacks(e);if(o)for(t=0,n=(r=o.slice()).length;t<n&&r[t];++t)r[t].apply(this,i);if(a)for(n=a.length,t=0,n=(r=a.slice()).length;t<n&&r[t];++t)r[t].apply(this,[e].concat(i));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,r=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(r=r.concat(this.callbacks[t]));return r}},r.mixin(r)},{}],351:[function(e,t,n){"use strict";var r=e("global/window"),i=e("is-function"),o=e("parse-headers"),a=e("xtend");function s(e,t,n){var r=e;return i(t)?(n=t,"string"==typeof e&&(r={uri:e})):r=a(t,{uri:e}),r.callback=n,r}function c(e,t,n){return u(t=s(e,t,n))}function u(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,n=function(n,r,i){t||(t=!0,e.callback(n,r,i))};function r(){var e=void 0;if(e=l.response?l.response:l.responseText||function(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(e){}return null}(l),y)try{e=JSON.parse(e)}catch(e){}return e}function i(e){return clearTimeout(d),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,g)}function a(){if(!u){var t;clearTimeout(d),t=e.useXDR&&void 0===l.status?200:1223===l.status?204:l.status;var i=g,a=null;return 0!==t?(i={body:r(),statusCode:t,method:f,headers:{},url:p,rawRequest:l},l.getAllResponseHeaders&&(i.headers=o(l.getAllResponseHeaders()))):a=new Error("Internal XMLHttpRequest Error"),n(a,i,i.body)}}var s,u,l=e.xhr||null;l||(l=e.cors||e.useXDR?new c.XDomainRequest:new c.XMLHttpRequest);var d,p=l.url=e.uri||e.url,f=l.method=e.method||"GET",h=e.body||e.data,m=l.headers=e.headers||{},v=!!e.sync,y=!1,g={body:void 0,headers:{},statusCode:0,method:f,url:p,rawRequest:l};if("json"in e&&!1!==e.json&&(y=!0,m.accept||m.Accept||(m.Accept="application/json"),"GET"!==f&&"HEAD"!==f&&(m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json"),h=JSON.stringify(!0===e.json?h:e.json))),l.onreadystatechange=function(){4===l.readyState&&setTimeout(a,0)},l.onload=a,l.onerror=i,l.onprogress=function(){},l.onabort=function(){u=!0},l.ontimeout=i,l.open(f,p,!v,e.username,e.password),v||(l.withCredentials=!!e.withCredentials),!v&&e.timeout>0&&(d=setTimeout(function(){if(!u){u=!0,l.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",i(e)}},e.timeout)),l.setRequestHeader)for(s in m)m.hasOwnProperty(s)&&l.setRequestHeader(s,m[s]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(l.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(l),l.send(h||null),l}t.exports=c,t.exports.default=c,c.XMLHttpRequest=r.XMLHttpRequest||function(){},c.XDomainRequest="withCredentials"in new c.XMLHttpRequest?c.XMLHttpRequest:r.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],function(e){c["delete"===e?"del":e]=function(t,n,r){return(n=s(t,n,r)).method=e.toUpperCase(),u(n)}})},{"global/window":52,"is-function":65,"parse-headers":209,xtend:360}],352:[function(e,t,n){t.exports={Namespace:e("./lib/namespaces"),MUC:e("./lib/muc"),PubSub:e("./lib/pubsub"),Jingle:e("./lib/jingle"),Presence:e("./lib/presence")}},{"./lib/jingle":353,"./lib/muc":354,"./lib/namespaces":355,"./lib/presence":356,"./lib/pubsub":357}],353:[function(e,t,n){t.exports={Action:{CONTENT_ACCEPT:"content-accept",CONTENT_ADD:"content-add",CONTENT_MODIFY:"content-modify",CONTENT_REJECT:"content-reject",CONTENT_REMOVE:"content-remove",DESCRIPTION_INFO:"description-info",SECURITY_INFO:"security-info",SESSION_ACCEPT:"session-accept",SESSION_INFO:"session-info",SESSION_INITIATE:"session-initiate",SESSION_TERMINATE:"session-terminate",TRANSPORT_ACCEPT:"transport-accept",TRANSPORT_INFO:"transport-info",TRANSPORT_REJECT:"transport-reject",TRANSPORT_REPLACE:"transport-replace"},Reason:{ALTERNATIVE_SESSION:"alernative-session",BUSY:"busy",CANCEL:"cancel",CONNECTIVITY_ERROR:"connectivity-error",DECLINE:"decline",EXPIRED:"expired",FAILED_APPLICATION:"failed-application",FAILED_TRANSPORT:"failed-transport",GENERAL_ERROR:"general-error",GONE:"gone",INCOMPATIBLE_PARAMETERS:"incompatible-parameters",MEDIA_ERROR:"media-error",SECURITY_ERROR:"security-error",SUCCESS:"success",TIMEOUT:"timeout",UNSUPPORTED_APPLICATIONS:"unsupported-applications",UNSUPPORTED_TRANSPORTS:"unsupported-transports"},Condition:{OUT_OF_ORDER:"out-of-order",TIE_BREAK:"tie-break",UNKNOWN_SESSION:"unknown-session",UNSUPPORTED_INFO:"unsupported-info"}}},{}],354:[function(e,t,n){t.exports={Status:{REALJID_PUBLIC:"100",AFFILIATION_CHANGED:"101",UNAVAILABLE_SHOWN:"102",UNAVAILABLE_NOT_SHOWN:"103",CONFIGURATION_CHANGED:"104",SELF_PRESENCE:"110",LOGGING_ENABLED:"170",LOGGING_DISABLED:"171",NON_ANONYMOUS:"172",SEMI_ANONYMOUS:"173",FULLY_ANONYMOUS:"174",ROOM_CREATED:"201",NICK_ASSIGNED:"210",BANNED:"301",NEW_NICK:"303",KICKED:"307",REMOVED_AFFILIATION:"321",REMOVED_MEMBERSHIP:"322",REMOVED_SHUTDOWN:"332"},Affiliation:{ADMIN:"admin",MEMBER:"member",NONE:"none",OUTCAST:"outcast",OWNER:"owner"},Role:{MODERATOR:"moderator",NONE:"none",PARTICIPANT:"participant",VISITOR:"visitor"}}},{}],355:[function(e,t,n){t.exports={BIND:"urn:ietf:params:xml:ns:xmpp-bind",CLIENT:"jabber:client",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",SERVER:"jabber:server",SESSION:"urn:ietf:params:xml:ns:xmpp-session",STANZA_ERROR:"urn:ietf:params:xml:ns:xmpp-stanzas",STREAM:"http://etherx.jabber.org/streams",STREAM_ERROR:"urn:ietf:params:xml:ns:xmpp-streams",ROSTER:"jabber:iq:roster",ROSTER_VERSIONING:"urn:xmpp:features:rosterver",SUBSCRIPTION_PREAPPROVAL:"urn:xmpp:features:pre-approval",FRAMING:"urn:ietf:params:xml:ns:xmpp-framing",DATAFORM:"jabber:x:data",RPC:"jabber:iq:rpc",LAST_ACTIVITY:"jabber:iq:last",PRIVACY:"jabber:iq:privacy",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",ADDRESS:"http://jabber.org/protocol/address",MUC:"http://jabber.org/protocol/muc",MUC_ADMIN:"http://jabber.org/protocol/muc#admin",MUC_OWNER:"http://jabber.org/protocol/muc#owner",MUC_USER:"http://jabber.org/protocol/muc#user",IBB:"http://jabber.org/protocol/ibb",BOOKMARKS:"storage:bookmarks",PRIVATE:"jabber:iq:private",ADHOC_COMMANDS:"http://jabber.org/protocol/commands",VCARD_TEMP:"vcard-temp",SEARCH:"jabber:iq:search",RSM:"http://jabber.org/protocol/rsm",PUBSUB:"http://jabber.org/protocol/pubsub",PUBSUB_ERRORS:"http://jabber.org/protocol/pubsub#errors",PUBSUB_EVENT:"http://jabber.org/protocol/pubsub#event",PUBSUB_OWNER:"http://jabber.org/protocol/pubsub#owner",SOCKS5:"http://jabber.org/protocol/bytestreams",OOB_IQ:"jabber:iq:oob",OOB:"jabber:x:oob",HTTP_AUTH:"http://jabber.org/protocol/http-auth",XHTML_IM:"http://jabber.org/protocol/xhtml-im",REGISTER:"jabber:iq:register",AMP:"http://jabber.org/protocol/amp",GEOLOC:"http://jabber.org/protocol/geoloc",ROSTER_DELIMITER:"roster:delimiter",AVATAR_DATA:"urn:xmpp:avatar:data",AVATAR_METADATA:"urn:xmpp:avatar:metadata",CHAT_STATES:"http://jabber.org/protocol/chatstates",VERSION:"jabber:iq:version",MOOD:"http://jabber.org/protocol/mood",ACTIVITY:"http://jabber.org/protocol/activity",COMPONENT:"jabber:component:accept",CAPS:"http://jabber.org/protocol/caps",TUNE:"http://jabber.org/protocol/tune",DATAFORM_VALIDATION:"http://jabber.org/protocol/xdata-validate",BOSH:"http://jabber.org/protocol/httpbind",SHIM:"http://jabber.org/protocol/shim",COMPRESSION:"http://jabber.org/features/compress",DATAFORM_LAYOUT:"http://jabber.org/protocol/xdata-layout",ROSTER_EXCHANGE:"http://jabber.org/protocol/rosterx",ROSTER_NOTES:"storage:rosternotes",REACH_0:"urn:xmpp:reach:0",VCARD_TEMP_UPDATE:"vcard-temp:x:update",CAPTCHA:"urn:xmpp:captcha",JINGLE_1:"urn:xmpp:jingle:1",JINGLE_ERRORS_1:"urn:xmpp:jingle:errors:1",JINGLE_RTP_1:"urn:xmpp:jingle:apps:rtp:1",JINGLE_RTP_ERRORS_1:"urn:xmpp:jingle:apps:rtp:errors:1",JINGLE_RTP_INFO_1:"urn:xmpp:jingle:apps:rtp:info:1",LANG_TRANS:"urn:xmpp:langtrans",LANG_TRANS_ITEMS:"urn:xmpp:langtrans:items",NICK:"http://jabber.org/protocol/nick",JINGLE_ICE_UDP_1:"urn:xmpp:jingle:transports:ice-udp:1",JINGLE_RAW_UDP_1:"urn:xmpp:jingle:transports:raw-udp:1",RECEIPTS:"urn:xmpp:receipts",INVISIBLE_0:"urn:xmpp:invisible:0",BLOCKING:"urn:xmpp:blocking",SMACKS_3:"urn:xmpp:sm:3",PING:"urn:xmpp:ping",TIME:"urn:xmpp:time",DELAY:"urn:xmpp:delay",BOSH_XMPP:"urn:xmpp:xbosh",DISCO_EXTERNAL_1:"urn:xmpp:extdisco:1",DATAFORM_MEDIA:"urn:xmpp:media-element",ATTENTION_0:"urn:xmpp:attention:0",BOB:"urn:xmpp:bob",FILE_TRANSFER_3:"urn:xmpp:jingle:apps:file-transfer:3",FILE_TRANSFER_4:"urn:xmpp:jingle:apps:file-transfer:4",FILE_TRANSFER_5:"urn:xmpp:jingle:apps:file-transfer:5",MUC_DIRECT_INVITE:"jabber:x:conference",SEC_LABEL_0:"urn:xmpp:sec-label:0",SEC_LABEL_CATALOG_2:"urn:xmpp:sec-label:catalog:2",SEC_LABEL_ESS_0:"urn:xmpp:sec-label:ess:0",JINGLE_SOCKS5_1:"urn:xmpp:jingle:transports:s5b:1",JINGLE_IBB_1:"urn:xmpp:jingle:transports:ibb:1",JINGLE_RTP_ZRTP_1:"urn:xmpp:jingle:apps:rtp:zrtp:1",THUMBS_0:"urn:xmpp:thumbs:0",THUMBS_1:"urn:xmpp:thumbs:1",DECLOAKING_0:"urn:xmpp:decloaking:0",CARBONS_2:"urn:xmpp:carbons:2",JINGLE_RTP_RTCP_FB_0:"urn:xmpp:jingle:apps:rtp:rtcp-fb:0",JINGLE_RTP_HDREXT_0:"urn:xmpp:jingle:apps:rtp:rtp-hdrext:0",FORWARD_0:"urn:xmpp:forward:0",HASHES_1:"urn:xmpp:hashes:1",RTT_0:"urn:xmpp:rtt:0",MUC_UNIQUE:"http://jabber.org/protocol/muc#unique",CORRECTION_0:"urn:xmpp:message-correct:0",PSA:"urn:xmpp:psa",MAM_TMP:"urn:xmpp:mam:tmp",MAM_0:"urn:xmpp:mam:0",MAM_1:"urn:xmpp:mam:1",MAM_2:"urn:xmpp:mam:2",HATS_0:"urn:xmpp:hats:0",IDLE_1:"urn:xmpp:idle:1",JINGLE_DTLS_0:"urn:xmpp:jingle:apps:dtls:0",JID_PREP_0:"urn:xmpp:jidprep:0",CHAT_MARKERS:"urn:xmpp:chat-markers:0",HINTS:"urn:xmpp:hints",JSON_0:"urn:xmpp:json:0",EVENTLOG:"urn:xmpp:eventlog",JINGLE_GROUPING_0:"urn:xmpp:jingle:apps:grouping:0",JINGLE_RTP_SSMA_0:"urn:xmpp:jingle:apps:rtp:ssma:0",COLIBRI:"http://jitsi.org/protocol/colibri",DTLS_SCTP_1:"urn:xmpp:jingle:transports:dtls-sctp:1",CSI:"urn:xmpp:csi:0",JINGLE_MSG_INITIATE_0:"urn:xmpp:jingle:jingle-message:0",PUSH_0:"urn:xmpp:push:0",JINGLE_PUB_1:"urn:xmpp:jinglepub:1",STANZA_ID_0:"urn:xmpp:sid:0",HTTP_UPLOAD_0:"urn:xmpp:http:upload:0",JINGLE_HTTP_0:"urn:xmpp:jingle:transports:http:0",JINGLE_HTTP_UPLOAD_0:"urn:xmpp:jingle:transports:http:upload:0",REFERENCE_0:"urn:xmpp:reference:0",SPOILER_0:"urn:xmppp:spoiler:0"}},{}],356:[function(e,t,n){t.exports={Type:{SUBSCRIBE:"subscribe",SUBSCRIBED:"subscribed",UNSUBSCRIBE:"unsubscribe",UNSUBSCRIBED:"unsubscribed",PROBE:"probe",UNAVAILABLE:"unavailable"},Show:{CHAT:"chat",AWAY:"away",DO_NOT_DISTURB:"dnd",EXTENDED_AWAY:"xa"}}},{}],357:[function(e,t,n){t.exports={Affiliation:{MEMBER:"member",NONE:"none",OUTCAST:"outcast",OWNER:"owner",PUBLISHER:"publisher",PUBLISH_ONLY:"publish-only"},Subscription:{NONE:"none",PENDING:"pending",UNCONFIGURED:"unconfigured",SUBSCRIBED:"subscribed"},AccessModel:{OPEN:"open",PRESENCE:"presence",ROSTER:"roster",AUTHORIZE:"authorize",WHITELIST:"whitelist"},Condition:{CONFLICT:"conflict"}}},{}],358:[function(e,t,n){"use strict";var r=e("./lib/stringprep"),i=/^[\x00-\x7F]*$/;function o(e,t){return e?e+"@"+t:t}function a(e,t,n){return n?o(e,t)+"/"+n:o(e,t)}n.prep=function(e){var t=e.local,i=e.domain,s=e.resource,c=t;return t&&(t=r.nodeprep(t),c=n.unescape(t)),s&&(s=r.resourceprep(s)),"."===i[i.length-1]&&(i=i.slice(0,i.length-1)),i=r.nameprep(i.split(".").map(r.toUnicode).join(".")),{prepped:e.prepped||r.available,local:t,domain:i,resource:s,bare:o(t,i),full:a(t,i,s),unescapedLocal:c,unescapedBare:o(c,i),unescapedFull:a(c,i,s)}},n.parse=function(e,t){var r,o="",a="";t=t||i.test(e);var s=e.indexOf("/");s>0&&(a=e.slice(s+1),e=e.slice(0,s));var c=e.indexOf("@");c>0&&(o=e.slice(0,c),e=e.slice(c+1)),r=e;var u=n.prep({local:o,domain:r,resource:a});return u.prepped=u.prepped||t,u},n.equal=function(e,t,r){return e=new n.JID(e),t=new n.JID(t),2===arguments.length&&(r=!0),e.local===t.local&&e.domain===t.domain&&e.resource===t.resource&&(!r||e.prepped&&t.prepped)},n.equalBare=function(e,t,r){return e=new n.JID(e),t=new n.JID(t),2===arguments.length&&(r=!0),e.local===t.local&&e.domain===t.domain&&(!r||e.prepped&&t.prepped)},n.isBare=function(e){return!!!(e=new n.JID(e)).resource},n.isFull=function(e){return!!(e=new n.JID(e)).resource},n.escape=function(e){return e.replace(/^\s+|\s+$/g,"").replace(/\\5c/g,"\\5c5c").replace(/\\20/g,"\\5c20").replace(/\\22/g,"\\5c22").replace(/\\26/g,"\\5c26").replace(/\\27/g,"\\5c27").replace(/\\2f/g,"\\5c2f").replace(/\\3a/g,"\\5c3a").replace(/\\3c/g,"\\5c3c").replace(/\\3e/g,"\\5c3e").replace(/\\40/g,"\\5c40").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},n.unescape=function(e){return e.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},n.create=function(e,t,r){return new n.JID(e,t,r)},n.JID=function(e,t,r){var o={};if(!e||t||r)if(t){var a=i.test(e)&&i.test(t);r&&(a=a&&i.test(r)),o=n.prep({local:n.escape(e),domain:t,resource:r,prepped:a})}else o={};else if("string"==typeof e)o=n.parse(e);else{if(!(e._isJID||e instanceof n.JID))throw new Error("Invalid argument type");o=e}this._isJID=!0,this.local=o.local||"",this.domain=o.domain||"",this.resource=o.resource||"",this.bare=o.bare||"",this.full=o.full||"",this.unescapedLocal=o.unescapedLocal||"",this.unescapedBare=o.unescapedBare||"",this.unescapedFull=o.unescapedFull||"",this.prepped=o.prepped},n.JID.prototype.toString=function(){return this.full},n.JID.prototype.toJSON=function(){return this.full}},{"./lib/stringprep":359}],359:[function(e,t,n){"use strict";var r=e("punycode");n.available=!1,n.toUnicode=r.toUnicode,n.nameprep=function(e){return e.toLowerCase()},n.nodeprep=function(e){return e.toLowerCase()},n.resourceprep=function(e){return e}},{punycode:9}],360:[function(e,t,n){t.exports=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var i in n)r.call(n,i)&&(e[i]=n[i])}return e};var r=Object.prototype.hasOwnProperty},{}],361:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("es6-promise"),a=e("./vidyo_simple_api/VidyoSimple"),s=e("./IntergrationTestEvents"),c=function(e){function t(t,n){var r=e.call(this)||this;return window.VC=t||r,window.onVidyoClientLoaded({state:"READY"}),r._eventDispatcher=r._vidyoCore.EventDispatcher,r}return i(t,e),t.prototype.Connect=function(e,t,n,r,i,a,c){var u=this;return null!=i&&this._eventDispatcher.on(s.IntegrationTestEvents.Connect,i),null!=c&&this._eventDispatcher.on(s.IntegrationTestEvents.Disconnect,c),null!=a&&this._eventDispatcher.on(s.IntegrationTestEvents.ConnectionError,a),new o.Promise(function(e,n){u._eventDispatcher.on(s.IntegrationTestEvents.Connect,e),u._eventDispatcher.on(s.IntegrationTestEvents.Disconnect,e),u._eventDispatcher.on(s.IntegrationTestEvents.ConnectionError,n),"badToken"===t?u._eventDispatcher.emit(s.IntegrationTestEvents.ConnectionError,"Stubbed connection error"):u._eventDispatcher.emit(s.IntegrationTestEvents.Connect,"Stubbed connection")})},t.prototype.Disconnect=function(){this._eventDispatcher.emit(s.IntegrationTestEvents.Disconnect,"Stubbed disconnect")},t.prototype.GetVidyoClient=function(){return this},t}(a.VidyoSimple);n.StartVidyoSimple=c,n.SaveGlobalVidyoClient=function(e){window.VC=e}},{"./IntergrationTestEvents":362,"./vidyo_simple_api/VidyoSimple":537,"es6-promise":43}],362:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("./core/utils/EventListFactory"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Connect=new o.EventDescriptor,t.ConnectionError=new o.EventDescriptor,t.Disconnect=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.EventList=a,n.IntegrationTestEvents=o.CreateEventList("IntegrationTest",a)},{"./core/utils/EventListFactory":463}],363:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./controllers/StreamController/TrackMetaDataProvider");n.MediaTrackType=r.MediaTrackType;var i=function(){function e(e){this._vidyoCore=e}return Object.defineProperty(e.prototype,"AdvancedSettings",{get:function(){return this._vidyoCore.Controllers.AdvancedSettingsController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Log",{get:function(){return this._vidyoCore.Controllers.LogController},enumerable:!0,configurable:!0}),e.prototype.GetLocalStreamMediaProperties=function(e){return this._vidyoCore.Controllers.LocalStreamController.GetTrackMediaProperties(e)},e.prototype.UpdateTransmitedStreamTracksMap=function(e){this._vidyoCore.Controllers.TransmittedStreamController.UpdateTracksSrrcs(e)},e}();n.SimplifiedVidyoCore=i},{"./controllers/StreamController/TrackMetaDataProvider":391}],364:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e("./utils/WebRTCAdapterLoader");var r=e("../render/RendererFactory"),i=e("./controllers/AdvancedSettingsController"),o=e("./controllers/BaseController"),a=e("./controllers/CallStateController"),s=e("./controllers/ConferenceController/ConferenceController"),c=e("./controllers/ConnectionController"),u=e("./events/EventDispatcher"),l=e("./controllers/DeviceController"),d=e("../vidyo_simple_api/EndPoint"),p=e("./controllers/StreamController/LocalStreamController"),f=e("./controllers/LogController/LogController"),h=e("./controllers/ParticipantController"),m=e("./controllers/PersistedSettingsController"),v=e("./controllers/StreamController/RemoteStreamController"),y=e("./controllers/RendererController"),g=e("./controllers/RoomController"),S=e("./SimplifiedVidyoCore"),_=e("./controllers/StatisticsController"),b=e("./controllers/StreamController/TransmittedStreamController"),C=e("../vidyo_simple_api/User"),w=e("./controllers/UserController"),E=e("./xmpp/XmppProvider"),R=e("./utils/ObjectUtils"),P=e("./controllers/MicrophoneEnergyLevelController"),L=e("./models/RendererTypes"),T=e("../vidyo_simple_api/Permission"),x=e("./controllers/PermissionController"),M=e("./controllers/MessageController"),A=e("./controllers/ResourceManager/ResourcesManager"),I=function(){function e(){this.Controllers=o.CreateControllers(this,{AdvancedSettingsController:i.AdvancedSettingsController,CallStateController:a.CallStateController,ConferenceController:s.ConferenceController,ConnectionController:c.ConnectionController,DeviceController:l.DeviceController,LocalStreamController:p.LocalStreamController,MessageController:M.MessageController,MicrophoneEnergyLevelController:P.MicrophoneEnergyLevelController,LogController:f.LogController,ParticipantController:h.ParticipantController,PermissionController:x.PermissionController,PersistedSettingsController:m.PersistedSettingsController,RendererController:y.RendererController,ResourcesManager:A.ResourcesManager,RoomController:g.RoomController,StatisticsController:_.StatisticsController,RemoteStreamController:v.RemoteStreamController,TransmittedStreamController:b.TransmittedStreamController,UserController:w.UserController}),this.Diagnostics=new O,this.EventDispatcher=u.CreateEventDispatcher(),this.XmppProvider=new E.XmppProvider(this.EventDispatcher,new S.SimplifiedVidyoCore(this),this.Controllers.LogController),window["vidyoCore"+Math.floor(10*Math.random())]=this}return e.prototype.CreateEndpoint=function(e,t,n,i,o,a){this.Controllers.LogController.SetLogLevelSDK(i),this.Controllers.AdvancedSettingsController.ParticipantLimit=n,this._renderer=r.CreateRenderer(e,t,this);var s=this.Controllers.RendererController.RenderMode===L.RenderMode.Composite;return this.Controllers.ResourcesManager.DynamicShowState=s,s&&this.Controllers.DeviceController.StartDeviceDetection(),new d.EndPoint(this)},e.prototype.CreatePermission=function(){return new T.Permission(this)},e.prototype.CreateUser=function(e){return new C.User(this)},e.prototype.Disable=function(){var e=this;return this.Controllers.ConnectionController.Disable().then(function(){e.Controllers.MicrophoneEnergyLevelController.Disable()}).then(function(){e.Controllers.MessageController.Disable()}).then(function(){e.Controllers.StatisticsController.Disable()}).then(function(){e.Controllers.LocalStreamController.Disable()}).then(function(){e.Controllers.RemoteStreamController.Disable()}).then(function(){e.Controllers.TransmittedStreamController.Disable()}).then(function(){e.Controllers.ResourcesManager.Disable()}).then(function(){e._renderer&&e._renderer.Destroy()}).then(function(){e.Controllers.DeviceController.Disable()}).then(function(){e.Controllers.CallStateController.Disable()}).then(function(){e.Controllers.ConferenceController.Disable()}).then(function(){e.Controllers.RoomController.Disable()}).then(function(){e.Controllers.ParticipantController.Disable()}).then(function(){e.Controllers.PermissionController.Disable()}).then(function(){e.Controllers.UserController.Disable()}).then(function(){e.Controllers.RendererController.Disable()}).then(function(){e.Controllers.PersistedSettingsController.Disable()}).then(function(){e.Controllers.AdvancedSettingsController.Disable()}).then(function(){e.Controllers.LogController.Disable()}).then(function(){return e.EventDispatcher.releaseAll(),Promise.resolve(!0)}).catch(function(e){throw e||new Error("Failed to Disable VidyoCore")})},e.prototype.Initialize=function(){var e=Object.values(this.Controllers);return Promise.all(e.map(function(e){return e.Initialize().catch(function(t){throw new Error("Failed to initialize controller "+e.constructor.name+" ("+t+")")})})).then(function(){return Promise.resolve(!0)})},e.prototype.ReassignRenderer=function(e,t){return this._renderer&&this._renderer.Destroy&&this._renderer.Destroy(),this._renderer=r.CreateRenderer(e,t,this),Promise.resolve(!0)},e.Version="0.0.0.1",e}();n.VidyoCore=I;var O=function(){function e(){}return e.prototype.LayoutParameters=function(){var e=document.querySelector(".vidyo-rendering-container");if(!e)throw new Error("Failed to find .vidyo-rendering-container");var t=e.querySelectorAll("video"),n=R.default.MapObject(t,function(e){return e.videoWidth}).filter(function(e){return e>0}),r=n.reduce(function(e,t){return e+t}),i=R.default.MapObject(t,function(e){return e.videoHeight}).filter(function(e){return e>0}),o=i.reduce(function(e,t){return e+t}),a=r/o/(e.clientWidth/e.clientHeight);return t.length+" videos, "+e.clientWidth+" x "+e.clientHeight+" container,\n        average video is "+r/n.length+" x "+o/i.length+"\n        (threshold === "+a+")"},e}();n.VidyoDiagnostics=O},{"../render/RendererFactory":522,"../vidyo_simple_api/EndPoint":530,"../vidyo_simple_api/Permission":534,"../vidyo_simple_api/User":536,"./SimplifiedVidyoCore":363,"./controllers/AdvancedSettingsController":365,"./controllers/BaseController":366,"./controllers/CallStateController":367,"./controllers/ConferenceController/ConferenceController":368,"./controllers/ConnectionController":373,"./controllers/DeviceController":374,"./controllers/LogController/LogController":375,"./controllers/MessageController":377,"./controllers/MicrophoneEnergyLevelController":378,"./controllers/ParticipantController":379,"./controllers/PermissionController":380,"./controllers/PersistedSettingsController":381,"./controllers/RendererController":382,"./controllers/ResourceManager/ResourcesManager":383,"./controllers/RoomController":386,"./controllers/StatisticsController":387,"./controllers/StreamController/LocalStreamController":388,"./controllers/StreamController/RemoteStreamController":389,"./controllers/StreamController/TransmittedStreamController":392,"./controllers/UserController":393,"./events/EventDispatcher":399,"./models/RendererTypes":416,"./utils/ObjectUtils":471,"./utils/WebRTCAdapterLoader":485,"./xmpp/XmppProvider":488}],365:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../events/AdvancedSettingsEvents"),a=e("./BaseController"),s=e("../utils/AutoPropertyHelper"),c=e("../utils/Constants"),u=e("../events/LogEvents");function l(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AddGoogleConferenceFlag=!1,t.CodecExcludeFilter="",t.DisableStats=!1,t.EnableSimpleAPILogging=!1,t.EnableSimulcast=!1,t.EnableVidyoConnectorAPILogging=!1,t.EnableXMPPMessageLogging=!1,t.ParticipantLimit=c.ParticipantLimit,t.ShowStatisticsOverlay=!1,t}return i(t,e),t}(e)}var d={AddGoogleConferenceFlag:o.Events.AddGoogleConferenceFlagChanged,CodecExcludeFilter:o.Events.CodecExcludeFilterChanged,DisableStats:o.Events.DisableStatsChanged,EnableSimpleAPILogging:o.Events.EnableSimpleAPILoggingChanged,EnableSimulcast:o.Events.EnableSimulcastChanged,EnableVidyoConnectorAPILogging:o.Events.EnableVidyoConnectorAPILoggingChanged,EnableXMPPMessageLogging:o.Events.EnableXMPPMessageLoggingChanged,ParticipantLimit:o.Events.ParticipantLimitChanged,ShowLogCategory:o.Events.LogCategoryChanged,ShowStatisticsOverlay:o.Events.ShowStatisticsOverlayChanged},p={CodecExcludeFilter:function(e){try{return new RegExp(e),!0}catch(e){return e}},ParticipantLimit:function(e){return"number"==typeof e&&!isNaN(e)&&e>=0&&e<1e3}},f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Silent=!1,t}return i(t,e),t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.Initialize=function(){var t=this,n=new(l(Object)),r={};return Object.keys(u.VidyoLogLevel).filter(isNaN).forEach(function(e){return r[e]=u.VidyoLogLevel[e]}),Object.defineProperty(this,"ShowLogCategory",{get:function(){return{logLevel:r,logCategory:Object.keys(u.VidyoLogCategory),activeLogs:t._vidyoCore.Controllers.LogController.GetLogLevelSDK()}},set:function(e){t._vidyoCore.EventDispatcher.emit(d.ShowLogCategory,t._vidyoCore.Controllers.LogController.GetLogLevelSDK())}}),s.CreateAutoProperties(l,this,function(e){var r=n[e];return{get:function(){return r},set:function(n){var i=(p[e]||function(){return!0})(n);if(!0===i){var o=r!==n;r=n,o&&d[e]&&t._vidyoCore.EventDispatcher.emit(d[e],n)}else t.Silent||t._vidyoCore.Controllers.LogController.LogWarning('Cannot assign "'+n+'" to AdvancedSettings.'+e+"."+("boolean"==typeof i?"":i))}}}),e.prototype.Initialize.call(this)},t}(l(a.BaseController));n.AdvancedSettingsController=f},{"../events/AdvancedSettingsEvents":394,"../events/LogEvents":400,"../utils/AutoPropertyHelper":457,"../utils/Constants":461,"./BaseController":366}],366:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e){this._vidyoCore=e}return e.prototype.Disable=function(){return Promise.resolve(!0)},e.prototype.Initialize=function(){return Promise.resolve(void 0)},e}();n.BaseController=r,n.CreateControllers=function(e,t){var n={};return Object.keys(t).forEach(function(r){return n[r]=new t[r](e)}),n}},{}],367:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../events/CallStateEvents"),a=e("../events/ConferenceEvents"),s=e("../events/ConnectionEvents"),c=e("./BaseController"),u=e("../events/EventDispatcher"),l=function(){function e(){this._name="<no name>"}return e.prototype.EnableMedia=function(){return this},e.prototype.StartTransmitting=function(){return this},e.prototype.StopTransmitting=function(){return this},e.prototype.toString=function(){return"MediaState."+this._name},e}();n.BaseMediaState=l;var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name="Off",t}return i(t,e),t.prototype.EnableMedia=function(){return n.MediaState.PreviewOnly},Object.defineProperty(t.prototype,"ShouldRenderMedia",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShouldTransmitMedia",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(l),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name="PreviewOnly",t}return i(t,e),t.prototype.StartTransmitting=function(){return n.MediaState.Transmitting},Object.defineProperty(t.prototype,"ShouldRenderMedia",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShouldTransmitMedia",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(l),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name="Transmitting",t}return i(t,e),t.prototype.StopTransmitting=function(){return n.MediaState.PreviewOnly},Object.defineProperty(t.prototype,"ShouldRenderMedia",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShouldTransmitMedia",{get:function(){return!0},enumerable:!0,configurable:!0}),t}(l);n.MediaState={Off:new d,PreviewOnly:new p,Transmitting:new f};var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mediaState=n.MediaState.Off,t}return i(t,e),t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.EnableMedia=function(){this._transition(this._mediaState.EnableMedia())},t.prototype.Initialize=function(){var t=this;return this._vidyoCore.EventDispatcher.releaseGroup(u.CallStateControllerListeners),this._vidyoCore.EventDispatcher.on(a.Events.ConferenceJoined,u.CallStateControllerListeners,function(){return t._startTransmitting()}),this._vidyoCore.EventDispatcher.on(s.Events.Disconnecting,u.CallStateControllerListeners,function(){return t._stopTransmitting()}),e.prototype.Initialize.call(this)},Object.defineProperty(t.prototype,"MediaState",{get:function(){return this._mediaState},enumerable:!0,configurable:!0}),t.prototype._startTransmitting=function(){this._transition(this._mediaState.StartTransmitting())},t.prototype._stopTransmitting=function(){this._transition(this._mediaState.StopTransmitting())},t.prototype._transition=function(e){e!==this._mediaState&&(this._vidyoCore.EventDispatcher.emit(o.Events.MediaStateTransition,e),this._mediaState=e)},t}(c.BaseController);n.CallStateController=h},{"../events/CallStateEvents":395,"../events/ConferenceEvents":396,"../events/ConnectionEvents":397,"../events/EventDispatcher":399,"./BaseController":366}],368:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../models/ConferenceCommandParameters"),a=e("../../events/ConferenceEvents"),s=e("../../events/ConnectionEvents"),c=e("../../events/RenderEvents"),u=e("../../utils/Constants"),l=e("../../events/EventDispatcher"),d=e("./ConferenceDialog"),p=e("../../models/ConferenceCommandParameters"),f=e("../../models/ConferenceDialogIdentity"),h=e("../../utils/Constants"),m=e("../../models/Source"),v=e("../../models/Participant"),y=e("es6-promise"),g=e("../../models/RendererTypes"),S=e("./SubscriptionDialog"),_=e("../BaseController"),b=e("../../../vidyo_simple_api/VidyoSimple"),C=e("../../events/StreamEvents"),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.ActivateParticipantSource=function(e,t){this._changeParticipantSourceState(e,t,!0)},t.prototype.DeactivateParticipantSource=function(e,t){this._changeParticipantSourceState(e,t,!1)},t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.Initialize=function(){var e=this;return this._nextLocalDialogId=0,this._dialogIdentity=new f.DialogIdentity,this._vidyoCore.EventDispatcher.releaseGroup(l.ConferenceControllerListeners),this._vidyoCore.EventDispatcher.on(s.Events.LmiXmppMucMediaConf,l.ConferenceControllerListeners,function(t){return e._onLmiXmppMucMediaConf(t)}),this._vidyoCore.EventDispatcher.on(s.Events.JingleAccepted,l.ConferenceControllerListeners,function(t){return e._onJingleAccepted(t)}),this._vidyoCore.EventDispatcher.on(s.Events.MediaSessionStarted,l.ConferenceControllerListeners,function(t){return e._onMediaSessionStarted(t)}),this._vidyoCore.EventDispatcher.on(s.Events.Disconnecting,l.ConferenceControllerListeners,function(){return e._onDisconnecting()}),this._vidyoCore.EventDispatcher.on(c.Events.VideoResolutionChanged,l.ConferenceControllerListeners,function(){return e._onVideoResolutionChanged()}),this._vidyoCore.Controllers.ParticipantController.ResetParticipantList(),y.Promise.resolve(void 0)},t.prototype.ShowSource=function(e){this.ConferenceDialog&&this.ConferenceDialog.Show({sourceId:e,state:"on"})},t.prototype.StartConferenceDialog=function(e){var t=this._dialogIdentity.Clone(this._generateLocalDialogId());this._ensureIdIsFinalized("start conference dialog",t),this.ConferenceDialog=new d.ConferenceDialog(this._vidyoCore.EventDispatcher,t.ToObject(),this._vidyoCore.XmppProvider),this.ConferenceDialog.Join(e)},t.prototype.StartParticipantSubscriptionDialog=function(e){var t=this;e.package="participant",this.ParticipantDialog=this.StartSubscriptionDialog(e),this.ParticipantDialog.OnNotifyParticipant(function(e){t._onParticipantNotifyMessage(e)})},t.prototype.StartSelectedParticipantSubscriptionDialog=function(e){var t=this;e.package="selectedparticipant",this.SelectedParticipantDialog=this.StartSubscriptionDialog(e),this.SelectedParticipantDialog.OnNotifySelectedParticipant(function(e){t._onSelectedParticipantNotifyMessage(e)})},t.prototype.StartSubscriptionDialog=function(e){var t=this._dialogIdentity.Clone(this._generateLocalDialogId());this._ensureIdIsFinalized("start subscription dialog",t);var n=new S.SubscriptionDialog(this._vidyoCore.EventDispatcher,t.ToObject(),this._vidyoCore.XmppProvider);return n.Subscribe(e),n},t.prototype._addParticipant=function(e){var t=e.participantUri;if(t===this._vidyoCore.Controllers.RoomController.RoomUserResourceId()){var n=this._vidyoCore.XmppProvider.Jid();this._vidyoCore.Controllers.ParticipantController.CreateParticipant(t,v.ParticipantOrigin.Local,e.displayText,n.bare)}else this._vidyoCore.Controllers.ParticipantController.CreateParticipant(t,v.ParticipantOrigin.Remote,e.displayText)},t.prototype._addSource=function(e,t){var n=e.participantUri,r=!1;if(t.properties&&Array.isArray(t.properties)){var i=t.properties.find(function(e){return"paused"===e.name});i&&(r="true"===i.value)}var a=new m.Source(t.id.toString(),t.name,t.type,r);if(t.rc&&t.rc.id&&(a.RemoteControlId=t.rc.id,t.rc.parameters)){var s=t.rc.parameters.filter(function(e){return"nudge"===e.mode}).map(function(e){return e.id});a.HasZoom=s.includes("zoom"),a.HasPanAndTilt=s.includes("pan")&&s.includes("tilt")}if(t.dyn){a.Dynamic="true"===t.dyn;var c=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(n);if(c&&c.IsRemote&&a.Type===m.SourceMediaType.Audio&&!a.Dynamic){var u={sourceId:a.Ssrc,state:o.SourceState.On};this.ConferenceDialog&&this.ConferenceDialog.Show(u)}}return t.signal&&(a.Signal=t.signal),this._vidyoCore.Controllers.ParticipantController.UpdateParticipantSource(n,a),a},t.prototype._changeParticipantSourceState=function(e,t,n){if(e&&e.IsRemote){this._vidyoCore.Controllers.ParticipantController.UpdateParticipants([{participantId:e.Id,update:{Active:!0}}]);var r=this._vidyoCore.Controllers.RendererController.GetViewBySsrc(t);if(e.HasSource(t)){var i=u.DefaultLocalStreamHeight,o=u.DefaultLocalStreamWidth;r&&r.position&&(i=r.position.height,o=r.position.width);var a=screen.width*screen.height*h.DefaultLocalStreamFrameRate*h.ScreenRefreshRate;this._setSourceProperties({enable:n,framesPerSec:h.DefaultLocalStreamFrameRate,height:i,pixelRate:a,sourceId:Number(t),width:o})}}},t.prototype._checkSourcesChanged=function(e){var t=this,n=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e.participantUri);if(n){var r=[],i=n.Sources.filter(function(t){return!(!e.sources||!e.sources.some(function(e){return e.idStr===t.Ssrc}))||(r.push({ssrc:t.Ssrc,participantId:n.Id,type:t.Type}),!1)});n.UpdateSources(i),r.forEach(function(e){t._vidyoCore.EventDispatcher.emit(a.Events.SourceRemoved,e)})}},t.prototype._ensureIdIsFinalized=function(e,t){if(!t.IsFinalized()){var n="ConferenceController: Cannot "+e+" without a complete DialogIdentity object.\nDialogIdentity: "+JSON.stringify(t,null,1).replace(/["\n]/g,"");throw new Error(n)}},t.prototype._generateLocalDialogId=function(){return this._nextLocalDialogId+=1,this._nextLocalDialogId},t.prototype._isNewSource=function(e,t){var n=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e.participantUri);return!n||!n.HasSource(t.idStr)},t.prototype._onDisconnecting=function(){this._nextLocalDialogId=0,this._dialogIdentity=new f.DialogIdentity,this.ConferenceDialog=void 0},t.prototype._onJingleAccepted=function(e){this._dialogIdentity.Session=e.sid},t.prototype._onLmiXmppMucMediaConf=function(e){this._dialogIdentity.Conference=e.id,this._dialogIdentity.Reflector=e.reflector},t.prototype._onMediaSessionStarted=function(e){var t=this,n={displayText:this._vidyoCore.Controllers.UserController.UserDisplayName(),gm:this._vidyoCore.Controllers.RendererController.RenderMode===g.RenderMode.Composite?p.GhostMode.NoSel:p.GhostMode.NoGen};this._vidyoCore.Controllers.ConferenceController.StartConferenceDialog(n),this.ConferenceDialog&&this.ConferenceDialog.PromiseToOpen.then(function(){var e={duration:h.SubscriptionDialogDuration};t._vidyoCore.Controllers.ConferenceController.StartParticipantSubscriptionDialog(e),t._sendDynamicShow(),t._vidyoCore.Controllers.ConferenceController.StartSelectedParticipantSubscriptionDialog(e)})},t.prototype._onParticipantNotifyMessage=function(e){var t=this;o.IsSourceNotification(e)?e.notify.event.participantPackageContent.participants.forEach(function(e){t._processOnSourceNotification(e)}):o.IsLeaveNotification(e)&&e.notify.event.participantPackageContent.participants.forEach(function(e){t._vidyoCore.Controllers.ParticipantController.RemoveParticipant(e.participantUri)})},t.prototype._onSelectedParticipantNotifyMessage=function(e){var t=this,n={};e.notify.event.selectedParticipantPackageContent&&e.notify.event.selectedParticipantPackageContent.selectedParticipants&&e.notify.event.selectedParticipantPackageContent.selectedParticipants.forEach(function(e){n[e.id]=e.generation});var r=this._vidyoCore.Controllers.ParticipantController.GetParticipants(),i=this._vidyoCore.Controllers.ResourcesManager.SelfViewPolicy,s=0;if(r.length){var c=0,u=Object.keys(n).length;if(r.forEach(function(e){n.hasOwnProperty(e.Id)?(e.Generation=n[e.Id],(e.IsRemote||i===o.SelfViewPolicy.ShowSelf)&&s++):e.Generation=u++}),this._vidyoCore.Controllers.RendererController.RenderMode===g.RenderMode.Composite){r=r.sort(function(e,t){return e.Generation-t.Generation});var l=this._vidyoCore.Controllers.ResourcesManager.CurrentParticipantLimit,d=(this._vidyoCore.Controllers.ResourcesManager.AudioCount,Math.min(s,l));r.forEach(function(e){var n=!1;if(c<d){switch(i){case o.SelfViewPolicy.HideSelf:n=e.IsRemote;break;case o.SelfViewPolicy.ShowSelf:n=!0;break;case o.SelfViewPolicy.ShowSelfIfNoOther:n=e.IsRemote;break;default:n=!1,t._vidyoCore.Controllers.LogController.LogError("WRONG users's ACTIVE setting!")}n&&c++}e.Active=n});if(i===o.SelfViewPolicy.ShowSelfIfNoOther&&r.every(function(e){return!(e.IsRemote&&e.Active)})){var p=r.filter(function(e){return e.IsLocal})[0];p&&(p.Active=!0)}}this._vidyoCore.Controllers.ParticipantController.UpdateParticipants([]),this._vidyoCore.EventDispatcher.emit(a.Events.SelectedParticipantsChanged,{participants:r})}},t.prototype._onSourceNotification=function(e,t){if(this._isNewSource(e,t)){var n=this._addSource(e,t),r=this._vidyoCore.Controllers.ParticipantController.GetParticipant(e.participantUri);if(!r.IsLocal&&n.Type===m.SourceMediaType.Application&&this._vidyoCore.Controllers.RendererController.RenderMode===g.RenderMode.Composite){this.ShowSource(parseInt(n.Ssrc,10))}this._vidyoCore.EventDispatcher.emit(a.Events.SourceDetected,{ssrc:n.Ssrc,name:t.name,origin:r.Origin,participantId:e.participantUri,participantName:e.displayText,type:n.Type})}else this._updateSource(e,t)},t.prototype._onVideoResolutionChanged=function(){this._sendDynamicShow()},t.prototype._processOnSourceNotification=function(e){var t=this;"join"===e.event&&this._addParticipant(e),"update"!==e.event&&"join"!==e.event||(e.sources&&e.sources.forEach(function(n){t._onSourceNotification(e,n)}),this._checkSourcesChanged(e))},t.prototype._sendDynamicShow=function(){if(this._vidyoCore.Controllers.RendererController.RenderMode===g.RenderMode.Composite)this._vidyoCore.Controllers.ResourcesManager.SendDynamicShow();else if(this.ConferenceDialog){var e={audio:{count:u.NumberOfSelectedAudioSources,policy:o.AudioPolicy.LoudestSpeaker}};this._vidyoCore.XmppProvider.ConferenceShowSelected(this.ConferenceDialog.Identity(),e)}},t.prototype._setSourceProperties=function(e){var t={sourceId:e.sourceId,state:e.enable?o.SourceState.On:o.SourceState.Off,params:{windowSize:{height:e.height,width:e.width},framesPerSec:e.framesPerSec,pixelRate:e.pixelRate}};this.ConferenceDialog&&this.ConferenceDialog.Show(t)},t.prototype._updateSource=function(e,t){var n=e.participantUri,r=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(n);if(r&&r.IsRemote){var i=!1;if(t.properties&&Array.isArray(t.properties)){var o=t.properties.find(function(e){return"paused"===e.name});o&&(i="true"===o.value)}var a=r.GetSourceBySSrc(t.id.toString());if(a&&a.Type===m.SourceMediaType.Audio&&a.Paused!==i){a.Paused=i;var s=this._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantRemoteAudioDevice(n);s&&this._vidyoCore.EventDispatcher.emitAsync(C.Events.RemoteMicrophoneStateUpdated,{microphone:s,participant:r,state:i?b.VidyoDeviceState.Paused:b.VidyoDeviceState.Resumed}),this._vidyoCore.EventDispatcher.emit(C.Events.TracksChanged,r.Id)}}},t}(_.BaseController);n.ConferenceController=w},{"../../../vidyo_simple_api/VidyoSimple":537,"../../events/ConferenceEvents":396,"../../events/ConnectionEvents":397,"../../events/EventDispatcher":399,"../../events/RenderEvents":404,"../../events/StreamEvents":408,"../../models/ConferenceCommandParameters":410,"../../models/ConferenceDialogIdentity":411,"../../models/Participant":413,"../../models/RendererTypes":416,"../../models/Source":418,"../../utils/Constants":461,"../BaseController":366,"./ConferenceDialog":369,"./SubscriptionDialog":372,"es6-promise":43}],369:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o,a=e("../../events/ConferenceEvents"),s=e("./DialogBaseState"),c=e("../../events/EventDispatcher"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.Join=function(e){return this._handleStateResult(this._state().Join(this._context,e))},t.prototype.Leave=function(e){return this._handleStateResult(this._state().Leave(this._context,e))},t.prototype.Show=function(e){return this._handleStateResult(this._state().Show(this._context,e))},t.prototype.ShowSelected=function(e){return this._handleStateResult(this._state().ShowSelected(this._context,e))},t.prototype.State=function(){return this._state().Name},t.prototype.Update=function(e){return this._handleStateResult(this._state().Update(this._context,e))},t.prototype._initialize=function(){var e=this;this._transitionTo(o.Closed),this._eventDispatcher.on(a.Events.ConferenceRejected.Scoped(this._id),c.ConnectionControllerListeners,function(t){e._transitionTo(e._state().AfterReject())}),this._eventDispatcher.on(a.Events.ConferenceAccepted.Scoped(this._id),c.ConnectionControllerListeners,function(t){e._transitionTo(e._state().AfterAccept(e._context,t)),e._eventDispatcher.emit(a.Events.ConferenceJoined)})},t.prototype._handleStateResult=function(e){return this._transitionTo(e.nextState),e.returnValue},t.prototype._state=function(){return this._readonlyState},t.prototype._transitionTo=function(e){var t=this._readonlyState&&this._readonlyState.Name;this._readonlyState=e,this._handleImportantStateTransitions(t,e.Name)},t}(e("./Dialog").Dialog);n.ConferenceDialog=u;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._dialogName="ConferenceDialog",t}return i(t,e),t.prototype.AfterAccept=function(e,t){return this},t.prototype.AfterReject=function(){return this},t.prototype.Join=function(e,t){return this._invalidAction("join")},t.prototype.Leave=function(e,t){return this._invalidAction("leave")},t.prototype.Show=function(e,t){return this._invalidAction("show")},t.prototype.ShowSelected=function(e,t){return this._invalidAction("show selected")},t.prototype.Update=function(e,t){return this._invalidAction("update")},t}(s.BaseState),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Closed",t}return i(t,e),t.prototype.Join=function(e,t){return{nextState:o.Pending,returnValue:e.Commands.ConferenceJoin(e.Identity,t)}},t}(l),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Pending",t}return i(t,e),t.prototype.AfterAccept=function(e,t){return t&&t.dialogId&&(e.Identity.RemoteId=t.dialogId.local),o.Open},t.prototype.AfterReject=function(){return o.Terminated},t}(l),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Open",t}return i(t,e),t.prototype.Leave=function(e,t){return{nextState:o.Terminated,returnValue:e.Commands.ConferenceLeave(e.Identity,t)}},t.prototype.Show=function(e,t){return{nextState:this,returnValue:e.Commands.ConferenceShow(e.Identity,t)}},t.prototype.ShowSelected=function(e,t){return{nextState:this,returnValue:e.Commands.ConferenceShowSelected(e.Identity,t)}},t.prototype.Update=function(e,t){return{nextState:this,returnValue:e.Commands.ConferenceUpdate(e.Identity,t)}},t}(l),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Terminated",t}return i(t,e),t}(l);o={Closed:new d,Pending:new p,Open:new f,Terminated:new h}},{"../../events/ConferenceEvents":396,"../../events/EventDispatcher":399,"./Dialog":370,"./DialogBaseState":371}],370:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("es6-promise"),i=function(){function e(e,t,n){var i=this;this._id=t.LocalId,this._eventDispatcher=e,this._context=new o(t,n),this.PromiseToOpen=new r.Promise(function(e,t){i._isOpen=e,i._cannotOpen=t}),this._initialize()}return e.prototype.Identity=function(){return this._context.Identity},e.prototype._handleImportantStateTransitions=function(e,t){"Open"===t&&this._isOpen(),"Terminated"===t&&"Pending"===e&&this._cannotOpen()},e.prototype._initialize=function(){},e}();n.Dialog=i;var o=function(){return function(e,t){this.Identity=e,this.Commands=t}}();n.DialogContext=o},{"es6-promise":43}],371:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this._dialogName="<this._dialogName is not defined>"}return e.prototype._invalidAction=function(e){throw new Error("CmcpStateError: cannot "+e+" when "+this._dialogName+" is in the '"+this.Name+"' state")},e}();n.BaseState=r},{}],372:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o,a=e("./Dialog"),s=e("./DialogBaseState"),c=e("../../events/EventDispatcher"),u=e("../../events/ConferenceEvents"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.OnNotifyParticipant=function(e){this._eventDispatcher.on(u.Events.NotifyParticipant.Scoped(this._id),c.ConnectionControllerListeners,e)},t.prototype.OnNotifySelectedParticipant=function(e){this._eventDispatcher.on(u.Events.NotifySelectedParticipant.Scoped(this._id),c.ConnectionControllerListeners,e)},t.prototype.State=function(){return this._state().Name},t.prototype.Subscribe=function(e){var t=this._state().Subscribe(this._context,e);return this._transitionTo(t.nextState),t.returnValue},t.prototype.Unsubscribe=function(e){var t=this._state().Unsubscribe(this._context,e);return this._transitionTo(t.nextState),t.returnValue},t.prototype._initialize=function(){var e=this;this._transitionTo(o.Closed),this._eventDispatcher.on(u.Events.Reply.Scoped(this._id),c.ConnectionControllerListeners,function(t){e._transitionTo(e._state().AfterSubscribeAck(e._context,t))}),this._eventDispatcher.on(u.Events.SubscribeTimeout.Scoped(this._id),c.ConnectionControllerListeners,function(){e._transitionTo(e._state().AfterSubscribeTimeout())})},t.prototype._state=function(){return this._readonlyState},t.prototype._transitionTo=function(e){var t=this._readonlyState&&this._readonlyState.Name;this._readonlyState=e,this._handleImportantStateTransitions(t,e.Name)},t}(a.Dialog);n.SubscriptionDialog=l;var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._dialogName="SubscriptionDialog",t}return i(t,e),t.prototype.AfterSubscribeAck=function(e,t){return this},t.prototype.AfterSubscribeTimeout=function(){return this},t.prototype.Subscribe=function(e,t){return this._invalidAction("subscribe")},t.prototype.Unsubscribe=function(e,t){return this._invalidAction("unsubscribe")},t}(s.BaseState),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Closed",t}return i(t,e),t.prototype.Subscribe=function(e,t){var n=e.Commands.Subscribe(e.Identity,t);return{nextState:o.Pending,returnValue:n}},t}(d),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Pending",t}return i(t,e),t.prototype.AfterSubscribeAck=function(e,t){return t&&t.dialogId&&(e.Identity.RemoteId=t.dialogId.remote),o.Open},t.prototype.AfterSubscribeTimeout=function(){return o.Terminated},t}(d),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Open",t}return i(t,e),t.prototype.Unsubscribe=function(e,t){return{nextState:o.Terminated,returnValue:e.Commands.Unsubscribe(e.Identity,t)}},t}(d),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Terminated",t}return i(t,e),t}(d);o={Closed:new p,Pending:new f,Open:new h,Terminated:new m}},{"../../events/ConferenceEvents":396,"../../events/EventDispatcher":399,"./Dialog":370,"./DialogBaseState":371}],373:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../events/ConnectionEvents"),a=e("../events/StreamEvents"),s=e("../utils/Constants"),c=e("../utils/Messages"),u=e("../utils/TokenUtils"),l=e("../utils/XmlHttpRequest"),d=e("./BaseController"),p=e("../events/EventDispatcher"),f=e("es6-promise"),h=e("../utils/ReflectorPools"),m=e("../utils/ObjectUtils"),v=e("../utils/StringUtils"),y=e("../utils/TokenUtils"),g=e("../utils/LocationProvider"),S=e("../events/ConnectionEvents"),_=e("../../vidyo_connector_api/VidyoConnector"),b=e("../models/VideoResolution"),C=e("../models/RendererTypes"),w=e("../events/LogEvents"),E=e("detect-browser"),R=e("../utils/PromiseHelper"),P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._disconnectingPromise=null,t._reflectorsPoolName=null,t}return i(t,e),Object.defineProperty(t.prototype,"ReflectorsPoolName",{get:function(){return this._reflectorsPoolName},set:function(e){this._reflectorsPoolName=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HasReflectorsPoolName",{get:function(){return!!this._reflectorsPoolName},enumerable:!0,configurable:!0}),t.prototype.AddStream=function(e){return this._vidyoCore.XmppProvider.AddStream(e)},t.prototype.Connect=function(){var e=this;this._vidyoCore.EventDispatcher.releaseGroup(p.ConnectionControllerListeners),this._vidyoCore.EventDispatcher.on(o.Events.Connected,p.ConnectionControllerListeners,function(t){return e._onConnected(t)}),this._vidyoCore.EventDispatcher.on(o.Events.LmiXmppMucMediaConf,p.ConnectionControllerListeners,function(t){return e._onLmiXmppMucMediaConf(t)}),this._vidyoCore.EventDispatcher.on(o.Events.JingleSourceView,p.ConnectionControllerListeners,function(t){return e._onJingleSourceView(t)}),this._vidyoCore.EventDispatcher.on(o.Events.JingleSessionTerminated,p.ConnectionControllerListeners,function(t){return e._onJingleSessionTerminated(t)}),this._vidyoCore.EventDispatcher.on(o.Events.IqSendingError,p.ConnectionControllerListeners,function(t){return e._onIqSendingError(t)}),this._vidyoCore.EventDispatcher.on(o.Events.MediaSessionFailed,p.ConnectionControllerListeners,function(t){return e._onMediaSessionFailed(t)}),this._vidyoCore.EventDispatcher.on(o.Events.MediaSessionEnded,p.ConnectionControllerListeners,function(t){return e._onMediaSessionEnded(t)}),this._vidyoCore.EventDispatcher.on(o.Events.SignallingDisconnected,p.ConnectionControllerListeners,function(t){return e._onSignallingDisconnected(t)}),this._vidyoCore.EventDispatcher.on(o.Events.SignallingError,p.ConnectionControllerListeners,function(t){return e._onSignallingDisconnected(t)}),this._vidyoCore.EventDispatcher.on(a.Events.MediaFailed,p.ConnectionControllerListeners,function(t){return e._onMediaSessionFailed(S.ConnectionEventsInfo[t.reason])}),this._vidyoCore.EventDispatcher.on(o.Events.AuthenticationError,p.ConnectionControllerListeners,function(t){return e._onSignallingDisconnected(t)}),this._vidyoCore.XmppProvider.Connect()},t.prototype.CreateConnection=function(e){var t={displayName:"anonymous",host:e.host,port:s.DefaultPort,saslMechanisms:["plain","anonymous"],sendReceipts:!0,serviceType:"wss",transports:["websocket"],websocketHost:"wss://"+e.host+":443/ws-xmpp"};if((e=m.default.Merge(t,e)).credentials&&e.credentials.token&&(e.credentials.password=e.credentials.password||e.credentials.token,e.credentials.username=e.credentials.username||u.DecodeUserName(e.credentials.token)),e.displayName){if(e.displayName.length>s.MaxDisplayNameLength)return f.Promise.reject(_.VidyoConnectorFailReason.InvalidDisplayNameLength);this._vidyoCore.Controllers.UserController.SetUserDisplayName(e.displayName)}this._vidyoCore.XmppProvider.CreateClient(e);var n=this._vidyoCore.Controllers.RendererController.RenderMode===C.RenderMode.Composite;return this._vidyoCore.Controllers.ResourcesManager.DynamicShowState=n,this._vidyoCore.Controllers.StatisticsController.SetClientConnectionStats(e.host,e.port,e.serviceType),this._reflectorsPoolUrl="https://"+e.host+s.ReflectorPoolsURL,f.Promise.resolve(!0)},t.prototype.Disable=function(){var t=this;return this.Disconnect(S.ConnectionEventsInfo.Disconnecting).then(function(){return e.prototype.Disable.call(t)})},t.prototype.Disconnect=function(e){var t=this;return this._disconnectingPromise||(this._vidyoCore.Controllers.ResourcesManager.Stop(),this._vidyoCore.Controllers.LogController.LogInfo('ConnectionController: Disconnecting - "'+e.msg+'"'),this._disconnectingPromise=this._vidyoCore.Controllers.RoomController.LeaveAll().then(function(){return t._disconnect(e)}).catch(function(n){return t._vidyoCore.Controllers.LogController.LogError(n,w.VidyoLogCategory.VidyoClient,"ConnectionController::__disconnect error during disconnection"),t._disconnect(e),f.Promise.resolve()})),this._disconnectingPromise},t.prototype.GetClosestReflectorPool=function(){return this._findClosestReflectorPool()},t.prototype.Initialize=function(){var e=this;return g.LocationProvider.Initialize(),window.addEventListener("beforeunload",function(){e.Disconnect(S.ConnectionEventsInfo.Disconnecting)}),f.Promise.resolve(void 0)},t.prototype.InitializeJson=function(e){return this._jsonPool=e,this.Initialize()},t.prototype.Reflector=function(){return this._reflector},t.prototype.RemoveStream=function(e){return this._vidyoCore.XmppProvider.RemoveStream(e)},t.prototype.SendClientStats=function(e){this._vidyoCore.XmppProvider.SendClientStats(this._reflector,e)},t.prototype.StartMediaExchange=function(){var e=this,t=function(t){e._vidyoCore.XmppProvider.MediaStart({jid:e._vidyoCore.Controllers.RoomController.RoomJid(),start:{location:t}})};return this.HasReflectorsPoolName?f.Promise.resolve().then(function(){return t()}):g.LocationProvider.GetCurrentPosition().then(function(e){return t(e)}).catch(function(){return t()})},Object.defineProperty(t.prototype,"SessionState",{get:function(){if(this.Session)return this.Session.State()},enumerable:!0,configurable:!0}),t.prototype.UpdateLocalStream=function(e,t){return void 0===t&&(t=!0),this._vidyoCore.XmppProvider.UpdateLocalStream(e,t)},t.prototype._buildIceSrv=function(e){var t={urls:""},n=e.substring(0,e.indexOf("?"));n=n.replace("turns:","turn:");var r=y.ParseUrlParams(e);return t.urls=n+(r.transport?"?transport="+r.transport:""),t.username=r.usr?r.usr:"some-user",t.credential=r.pwd?r.pwd:"some-password",t},t.prototype._disconnect=function(e){try{this._vidyoCore.XmppProvider.IsXMPPSessionAlive()&&this._vidyoCore.XmppProvider.Disconnect()}catch(e){this._vidyoCore.Controllers.LogController.LogError(e,w.VidyoLogCategory.VidyoClient,"ConnectionController::__disconnect error during disconnection")}try{this._vidyoCore.EventDispatcher.releaseGroup(p.ConnectionControllerListeners)}catch(e){this._vidyoCore.Controllers.LogController.LogError(e,w.VidyoLogCategory.VidyoClient,"ConnectionController::__disconnect error during disconnection")}this._vidyoCore.Controllers.LogController.LogInfo("ConnectionController: Disconnected."),e.code===S.ConnectionEventsInfo.Disconnecting.code&&(e=S.ConnectionEventsInfo.Disconnected),this._vidyoCore.EventDispatcher.emit(o.Events.Disconnecting),this._vidyoCore.EventDispatcher.emitAsync(o.Events.Disconnected,e),this._disconnectingPromise=null},t.prototype._findClosestReflectorPool=function(){var e=this;return l.Get({url:this._reflectorsPoolUrl}).then(function(t){var n=e._jsonPool;try{n=JSON.parse(t).pools}catch(t){var r=v.default.Format(c.CouldNotParseString,{string:s.ReflectorPoolsURL});e._vidyoCore.Controllers.LogController.LogWarning(r)}if(!Array.isArray(n)||0===n.length)return f.Promise.resolve(void 0);var i=m.default.Flatten(n.map(function(e){return h.SelectReflectors(e)}));return R.RaceResolve(i.map(function(t){var n=t.Fqdn||t.Ip,r=performance.now();return new f.Promise(function(i,o){l.Get({url:"https://"+n,timeout:s.LatencyCheckTimeout,validResponseCodesRange:{begin:200,end:299}}).then(function(){var n=performance.now();t.ResponseTime=Math.round(n-r),e._vidyoCore.Controllers.LogController.LogInfo("Reflector latency: "+t.Fqdn+": "+t.ResponseTime+"ms"),i(t)}).catch(function(n){e._vidyoCore.Controllers.LogController.LogInfo("Reflector latency failed: "+t.Fqdn+": "+n.message),o()})})})).then(function(t){var n,r;return t&&t.Location&&(n=t.Location.Latitude,r=t.Location.Longitude,e._vidyoCore.Controllers.LogController.LogInfo("Chosen closest reflector: "+t.Fqdn+" longitude: "+r+" latitude: "+n)),f.Promise.resolve({latitude:n,longitude:r})}).catch(function(t){return e._vidyoCore.Controllers.LogController.LogWarning("Can't find closest reflector: "+(t&&t.message)),f.Promise.reject(void 0)})}).catch(function(t){return e._vidyoCore.Controllers.LogController.LogWarning("Can't load reflectors pool: "+t.message),f.Promise.reject(void 0)})},t.prototype._onConnected=function(e){},t.prototype._onIqSendingError=function(e){e&&e.data&&e.data.commands&&e.data.commands.command.conferenceShowSelected||e&&e.data&&e.data.notify&&e.data.notify.topic&&"client_stats"===e.data.notify.topic||this.Disconnect(S.ConnectionEventsInfo.SignallingError)},t.prototype._onJingleSessionTerminated=function(e){this.Disconnect(S.ConnectionEventsInfo.Disconnecting)},t.prototype._onJingleSourceView=function(e){var t=this;e.sources.forEach(function(e){t._vidyoCore.Controllers.TransmittedStreamController.SetLocalSource(e)})},t.prototype._onLmiXmppMucMediaConf=function(e){var t=this;this._reflector=e.reflector,this._vidyoCore.Controllers.RoomController.SetConference(e.id);for(var n={urls:""},r=0,i=e.properties;r<i.length;r++){var a=i[r];if(0===a.name.indexOf("turn.")){n=this._buildIceSrv(a.value);break}}this._vidyoCore.Controllers.ResourcesManager.Start();var c=[],u=E.detect();u&&(c=[{name:"VidyoTechnologyWebRTC",version:s.LibVersion},{name:u.name,version:u.version}]),this._vidyoCore.XmppProvider.StartMediaSession({jid:this._reflector,stream:void 0,iceServer:n,identities:c,addGoogleConferenceFlag:this._vidyoCore.Controllers.AdvancedSettingsController.AddGoogleConferenceFlag,enableSimulcast:this._vidyoCore.Controllers.AdvancedSettingsController.EnableSimulcast,displayName:this._vidyoCore.Controllers.UserController.UserDisplayName(),preferredCodec:b.GetPreferredCodec()}).then(function(e){t.Session=e,t._vidyoCore.EventDispatcher.emit(o.Events.MediaSessionStarted,{session:e})}).catch(function(e){t._vidyoCore.Controllers.LogController.LogError(e),t._vidyoCore.EventDispatcher.emit(o.Events.MediaSessionFailed,new o.VidyoEventInfo(e.name,_.VidyoConnectorDisconnectReason.Terminated,e.message,"error"))})},t.prototype._onMediaSessionEnded=function(e){this.Disconnect(e)},t.prototype._onMediaSessionFailed=function(e){this.Disconnect(e)},t.prototype._onSignallingDisconnected=function(e){this.Disconnect(e)},t.prototype._onSignallingError=function(e){this.Disconnect(e)},t}(d.BaseController);n.ConnectionController=P},{"../../vidyo_connector_api/VidyoConnector":526,"../events/ConnectionEvents":397,"../events/EventDispatcher":399,"../events/LogEvents":400,"../events/StreamEvents":408,"../models/RendererTypes":416,"../models/VideoResolution":420,"../utils/Constants":461,"../utils/LocationProvider":466,"../utils/Messages":468,"../utils/ObjectUtils":471,"../utils/PromiseHelper":475,"../utils/ReflectorPools":476,"../utils/StringUtils":479,"../utils/TokenUtils":481,"../utils/XmlHttpRequest":486,"./BaseController":366,"detect-browser":33,"es6-promise":43}],374:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../events/DeviceEvents"),a=e("../models/device/Camera"),s=e("../events/EventDispatcher"),c=e("./BaseController"),u=e("../models/device/DeviceList"),l=e("../models/device/DeviceSelection"),d=e("../utils/MediaDevicesProvider"),p=e("../models/device/Microphone"),f=e("es6-promise"),h=e("../models/device/Speaker"),m=e("../events/RenderEvents"),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._deviceDetectionStarted=!1,t._deviceSelection=new l.DeviceSelection,t}return i(t,e),t.prototype.AllowRemoteCameraControl=function(e,t){return this.IsLocalCameraControllable(e)},t.prototype.ClearLocalCameras=function(){var e=this;this._deviceList.Cameras.All().forEach(function(t){e._deviceList.Cameras.Remove(t.Id),e._vidyoCore.EventDispatcher.emit(o.Events.CameraRemoved,{camera:t})}),this._deviceSelection.SelectCamera(void 0)},t.prototype.ClearLocalMicrophones=function(){var e=this;this._deviceList.Microphones.All().forEach(function(t){e._deviceList.Microphones.Remove(t.Id),e._vidyoCore.EventDispatcher.emit(o.Events.MicrophoneRemoved,{microphone:t})}),this._deviceSelection.SelectMicrophone(void 0)},t.prototype.ClearLocalSpeakers=function(){var e=this;this._deviceList.Speakers.All().forEach(function(t){e._deviceList.Speakers.Remove(t.Id),e._vidyoCore.EventDispatcher.emit(o.Events.SpeakerRemoved,{speaker:t})}),this._deviceSelection.SelectSpeaker(void 0)},t.prototype.ControlRemoteCameraCapture=function(e){var t=this._vidyoCore.Controllers.ParticipantController.GetParticipantBySsrc(e);if(t){var n=t.GetSourceBySSrc(e);if(n&&n.RemoteControlId&&t.FullJID)return this._vidyoCore.XmppProvider.SendFeccMessage({to:t.FullJID,type:"normal",fecc:{cmds:{capture:[{id:"id"}],source:n.RemoteControlId}}}),f.Promise.resolve(!0)}return f.Promise.resolve(!1)},t.prototype.ControlRemoteCameraPTZ=function(e,t){var n=this._vidyoCore.Controllers.ParticipantController.GetParticipantBySsrc(e);if(n){var r=n.GetSourceBySSrc(e);if(r&&r.RemoteControlId&&n.FullJID){var i=[],o=["pan","tilt","zoom"];return t.hasOwnProperty("zoom")&&!r.HasZoom||(t.hasOwnProperty("pan")||t.hasOwnProperty("tilt"))&&!r.HasPanAndTilt?f.Promise.resolve(!1):(Object.keys(t).forEach(function(e){o.includes(e)&&i.push({param:e,nudges:t[e]})}),this._vidyoCore.XmppProvider.SendFeccMessage({to:n.FullJID,type:"normal",fecc:{cmds:{nudge:i,source:r.RemoteControlId}}}),f.Promise.resolve(!0))}}return f.Promise.resolve(!1)},t.prototype.CycleCamera=function(){var e;this._checkPreconditions(),(e=this._deviceSelection.Camera.Device?this._deviceList.Cameras.Next(this._deviceSelection.Camera.Device.Id):this._deviceList.Cameras.GetFirstDevice())&&this._selectCamera(e)},t.prototype.CycleMicrophone=function(){var e;this._checkPreconditions(),(e=this._deviceSelection.Microphone.Device?this._deviceList.Microphones.Next(this._deviceSelection.Microphone.Device.Id):this._deviceList.Microphones.GetFirstDevice())&&this._selectMicrophone(e)},t.prototype.CycleSpeaker=function(){var e;this._checkPreconditions(),(e=this._deviceSelection.Speaker.Device?this._deviceList.Speakers.Next(this._deviceSelection.Speaker.Device.Id):this._deviceList.Speakers.GetFirstDevice())&&this._selectSpeaker(e)},t.prototype.Disable=function(){return this.ClearLocalCameras(),this.ClearLocalMicrophones(),this.ClearLocalSpeakers(),e.prototype.Disable.call(this)},Object.defineProperty(t.prototype,"DevicesAreBeingDetected",{get:function(){return this._deviceDetectionStarted},enumerable:!0,configurable:!0}),t.prototype.GetAudioMuteState=function(){return this._deviceSelection.Microphone.Muted},t.prototype.GetCameraList=function(){return this._deviceList.Cameras.All()},t.prototype.GetMicrophoneList=function(){return this._deviceList.Microphones.All()},t.prototype.GetPreviewLabel=function(e){var t="",n=this._deviceList.Cameras.Find(e);return n&&(t=n.PreviewLabel),t},t.prototype.GetSelectedDevices=function(){return this._deviceSelection.Simplified},t.prototype.GetSpeakerList=function(){return this._deviceList.Speakers.All()},t.prototype.GetSpeakerMuteState=function(){return this._deviceSelection.Speaker.Muted},t.prototype.GetVideoMuteState=function(){return!this._deviceSelection.Camera.Enabled},t.prototype.Initialize=function(){return this._deviceList={Cameras:new u.DeviceList(a.Camera),Microphones:new u.DeviceList(p.Microphone),Speakers:new u.DeviceList(h.Speaker)},this._mediaDevices=d.MediaDevicesProvider.GetMediaDevices(),this._vidyoCore.EventDispatcher.releaseGroup(s.DeviceControllerListeners),f.Promise.resolve(void 0)},t.prototype.IsCameraSelected=function(){return!!this._deviceSelection.Camera.Device},t.prototype.IsDefaultCamera=function(e){var t=this._deviceList.Cameras.GetDefaultDevice();return!!t&&!!e&&t.Id===e.Id&&t.Name===e.Name},t.prototype.IsDefaultCameraSelected=function(){return this.IsDefaultCamera(this._deviceList.Cameras.GetDefaultDevice())},t.prototype.IsDefaultMicrophone=function(e){var t=this._deviceList.Microphones.GetDefaultDevice();return!!t&&!!e&&t.Id===e.Id&&t.Name===e.Name},t.prototype.IsDefaultMicrophoneSelected=function(){return this.IsDefaultMicrophone(this._deviceList.Microphones.GetDefaultDevice())},t.prototype.IsDefaultSpeaker=function(e){var t=this._deviceList.Speakers.GetDefaultDevice();return!!t&&!!e&&t.Id===e.Id&&t.Name===e.Name},t.prototype.IsDefaultSpeakerSelected=function(){return this.IsDefaultSpeaker(this._deviceList.Speakers.GetDefaultDevice())},t.prototype.IsLocalCameraControllable=function(e){return f.Promise.resolve(!1)},t.prototype.IsMicrophoneSelected=function(){return!!this._deviceSelection.Microphone.Device},t.prototype.IsRemoteCameraControllable=function(e){var t=this._vidyoCore.Controllers.ParticipantController.GetParticipantBySsrc(e);if(t){var n=t.GetSourceBySSrc(e);if(n&&n.RemoteControlId)return f.Promise.resolve(!0)}return f.Promise.resolve(!1)},t.prototype.IsSpeakerSelected=function(){return!!this._deviceSelection.Speaker.Device},t.prototype.RemoteCameraHasPanAndTilt=function(e){var t=this._vidyoCore.Controllers.ParticipantController.GetParticipantBySsrc(e);if(t){var n=t.GetSourceBySSrc(e);if(n)return f.Promise.resolve(n.HasPanAndTilt)}return f.Promise.resolve(!1)},t.prototype.RemoteCameraHasZoom=function(e){var t=this._vidyoCore.Controllers.ParticipantController.GetParticipantBySsrc(e);if(t){var n=t.GetSourceBySSrc(e);if(n)return f.Promise.resolve(n.HasZoom)}return f.Promise.resolve(!1)},t.prototype.SelectAudioContentShareDevice=function(e){var t;this._checkPreconditions(),e&&(t=this._deviceList.Microphones.Find(e.Id)||void 0),this._deviceSelection.SelectAudioContentShare(t),this._vidyoCore.EventDispatcher.emit(o.Events.AudioContentDeviceChanged)},t.prototype.SelectCamera=function(e){this._checkPreconditions(),this._selectCamera(e)},t.prototype.SelectDefaultCamera=function(){this._checkPreconditions();var e=this._deviceList.Cameras.GetDefaultDevice();e||(e=this._deviceList.Cameras.GetFirstDevice()),e&&!this._checkDeviceId(e)&&this._selectCamera(e)},t.prototype.SelectDefaultMicrophone=function(){this._checkPreconditions();var e=this._deviceList.Microphones.GetDefaultDevice();e||(e=this._deviceList.Microphones.GetFirstDevice()),e&&!this._checkDeviceId(e)&&this._selectMicrophone(e)},t.prototype.SelectDefaultSpeaker=function(){this._checkPreconditions();var e=this._deviceList.Speakers.GetDefaultDevice();e||(e=this._deviceList.Speakers.GetFirstDevice()),e&&!this._checkDeviceId(e)&&this._selectSpeaker(e)},t.prototype.SelectMicrophone=function(e){this._checkPreconditions(),this._selectMicrophone(e)},t.prototype.SelectMonitor=function(e){return e?this._vidyoCore.Controllers.LocalStreamController.StartMonitorShare(e.sourceId):(this._vidyoCore.Controllers.LocalStreamController.StopMonitorShare(),f.Promise.resolve())},t.prototype.SelectPreviousCamera=function(){var e=this._vidyoCore.Controllers.PersistedSettingsController.SelectedCamera;if(e){var t=this._deviceList.Cameras.Find(e);t&&this.SelectCamera(t)}},t.prototype.SelectPreviousMicrophone=function(){var e=this._vidyoCore.Controllers.PersistedSettingsController.SelectedMicrophone;if(e){var t=this._deviceList.Microphones.Find(e);t&&this.SelectMicrophone(t)}},t.prototype.SelectPreviousSpeaker=function(){var e=this._vidyoCore.Controllers.PersistedSettingsController.SelectedSpeaker;if(e){var t=this._deviceList.Speakers.Find(e);t&&this.SelectSpeaker(t)}},t.prototype.SelectSpeaker=function(e){this._checkPreconditions(),this._selectSpeaker(e)},t.prototype.SelectVideoContentShareDevice=function(e){var t;this._checkPreconditions(),e&&(t=this._deviceList.Cameras.Find(e.Id)||void 0),this._deviceSelection.SelectVideoContentShare(t),this._vidyoCore.EventDispatcher.emit(o.Events.VideoContentDeviceChanged)},t.prototype.SelectWindowShare=function(e){return e?this._vidyoCore.Controllers.LocalStreamController.StartWindowShare(e.sourceId):(this._vidyoCore.Controllers.LocalStreamController.StopWindowShare(),f.Promise.resolve())},t.prototype.SetAudioMuteState=function(e){e!==this._deviceSelection.Microphone.Muted&&(this._deviceSelection.Microphone.Muted=e,this._vidyoCore.EventDispatcher.emit(o.Events.MicrophoneMuteStateChanged))},t.prototype.SetDefaultCamera=function(e){this._deviceList.Cameras.SetDefaultDevice(e)},t.prototype.SetDefaultMicrophone=function(e){this._deviceList.Microphones.SetDefaultDevice(e)},t.prototype.SetDefaultSpeaker=function(e){this._deviceList.Speakers.SetDefaultDevice(e)},t.prototype.SetMaxConstraint=function(e,t){var n=this._deviceList.Cameras.Find(t);if(n){var r={height:e.height,width:e.width};e.frameInterval&&(r.frameRate=e.frameInterval),n.MaxConstraints=r;var i=this._deviceSelection.Camera.Device;i&&i.Id===n.Id&&this._vidyoCore.EventDispatcher.emit(o.Events.CameraMaxConstraintChanged)}},t.prototype.SetPreviewLabel=function(e,t){var n=this._deviceList.Cameras.Find(t);if(n){n.PreviewLabel=e;var r=this._deviceSelection.Camera.Device;r&&r.Id===n.Id&&this._vidyoCore.EventDispatcher.emit(m.Events.UpdateLocalViewLabel)}},t.prototype.SetSpeakerMuteState=function(e){e!==this._deviceSelection.Speaker.Muted&&(this._deviceSelection.Speaker.Muted=e,this._vidyoCore.EventDispatcher.emit(o.Events.SpeakerSettingsChanged,this._deviceSelection.Speaker),this._vidyoCore.EventDispatcher.emit(m.Events.SpeakerPrivacyChanged,e))},t.prototype.SetVideoMuteState=function(e){e!==this._deviceSelection.Camera.Muted&&(this._deviceSelection.Camera.Muted=e,this._vidyoCore.EventDispatcher.emit(o.Events.CameraSettingsChanged,this._deviceSelection.Camera))},t.prototype.StartDeviceDetection=function(){var e=this;if(!this._deviceDetectionPromise){this._deviceDetectionStarted=!0;var t=this._identifyDeviceListChanges();this._mediaDevices.ondevicechange=function(){e._identifyDeviceListChanges()},this._deviceDetectionPromise=t.then(function(){return!0})}return this._deviceDetectionPromise},t.prototype._checkDeviceId=function(e){return!!this._deviceSelection[e.Type].Device&&this._deviceSelection[e.Type].Device.Id===e.Id},t.prototype._checkPreconditions=function(){if(!this._deviceDetectionStarted)throw new Error("This method does nothing unless StartDeviceDetection is called first")},t.prototype._identifyDeviceListChanges=function(){var e=this;return this._mediaDevices.enumerateDevices().then(function(t){if(e._deviceList.Cameras.All().forEach(function(n){t.some(function(e){return"videoinput"===e.kind&&e.deviceId===n.Id&&e.label===n.Name})||(e._onCameraRemoved(n),e._deviceList.Cameras.Remove(n.Id),e._vidyoCore.EventDispatcher.emit(o.Events.CameraUnplugged,{camera:n}))}),e._deviceList.Microphones.All().forEach(function(n){t.some(function(e){return"audioinput"===e.kind&&e.deviceId===n.Id&&e.label===n.Name})||(e._onMicrophoneRemoved(n),e._deviceList.Microphones.Remove(n.Id),e._vidyoCore.EventDispatcher.emit(o.Events.MicrophoneUnplugged,{microphone:n}))}),e._deviceList.Speakers.All().forEach(function(n){t.some(function(e){return"audiooutput"===e.kind&&e.deviceId===n.Id&&e.label===n.Name})||"default"!==n.Id&&(e._deviceList.Speakers.Remove(n.Id),e._vidyoCore.EventDispatcher.emit(o.Events.SpeakerUnplugged,{speaker:n}))}),t.forEach(function(t){switch(t.kind){case"videoinput":var n=e._deviceList.Cameras.Add(t.label,t.deviceId);n&&e._vidyoCore.EventDispatcher.emit(o.Events.CameraAdded,{camera:n});break;case"audioinput":var r=e._deviceList.Microphones.Add(t.label,t.deviceId);r&&e._vidyoCore.EventDispatcher.emit(o.Events.MicrophoneAdded,{microphone:r});break;case"audiooutput":var i=e._deviceList.Speakers.Add(t.label,t.deviceId);i&&e._vidyoCore.EventDispatcher.emit(o.Events.SpeakerAdded,{speaker:i})}}),!e._deviceList.Speakers.Find("default")){var n=e._deviceList.Speakers.Add("Default","default");n&&e._vidyoCore.EventDispatcher.emit(o.Events.SpeakerAdded,{speaker:n})}})},t.prototype._onCameraRemoved=function(e){var t=this._deviceSelection.Simplified.VideoContent;"boolean"!=typeof t&&e.Id===t.Id&&this._deviceSelection.SelectVideoContentShare(void 0)},t.prototype._onMicrophoneRemoved=function(e){var t=this._deviceSelection.Simplified.AudioContent;"boolean"!=typeof t&&e.Id===t.Id&&this._deviceSelection.SelectAudioContentShare(void 0)},t.prototype._selectCamera=function(e){var t;e&&(t=this._deviceList.Cameras.Find(e.Id)||void 0),this._deviceSelection.SelectCamera(t),this._vidyoCore.Controllers.PersistedSettingsController.SelectedCamera=t?t.Id:null,this._vidyoCore.EventDispatcher.emit(o.Events.CameraSettingsChanged,this._deviceSelection.Camera);var n=t?{camera:t}:void 0;this._vidyoCore.EventDispatcher.emit(o.Events.CameraSelected,n),this._vidyoCore.EventDispatcher.emit(m.Events.UpdateLocalViewLabel)},t.prototype._selectMicrophone=function(e){var t=this._deviceSelection.Microphone.Device;this._deviceSelection.SelectMicrophone(e),this._vidyoCore.Controllers.PersistedSettingsController.SelectedMicrophone=e?e.Id:null,t!==e&&this._vidyoCore.EventDispatcher.emit(o.Events.MicrophoneChanged),e&&this._vidyoCore.EventDispatcher.emit(o.Events.MicrophoneSelected,{microphone:e})},t.prototype._selectSpeaker=function(e){this._vidyoCore.Controllers.PersistedSettingsController.SelectedSpeaker=e?e.Id:null,e&&(this._deviceSelection.SelectSpeaker(e),this._vidyoCore.EventDispatcher.emit(o.Events.SpeakerSelected,{speaker:e}))},t}(c.BaseController);n.DeviceController=v},{"../events/DeviceEvents":398,"../events/EventDispatcher":399,"../events/RenderEvents":404,"../models/device/Camera":421,"../models/device/DeviceList":423,"../models/device/DeviceSelection":424,"../models/device/Microphone":425,"../models/device/Speaker":426,"../utils/MediaDevicesProvider":467,"./BaseController":366,"es6-promise":43}],375:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../BaseController"),a=e("../../events/LogEvents"),s=e("../../events/AdvancedSettingsEvents"),c=e("json-decycle"),u=e("../../utils/VidyoDebugger"),l=e("../../utils/EventListFactory"),d=e("../../utils/Constants"),p=e("../../utils/OperatingSystemInfoProvider"),f=e("../../utils/StringUtils"),h=e("./LogLevelParser"),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._logLevelFilterSDK={},t._logLevelFilterApp={},t._logLevelFilterDebug={},t}return i(t,e),t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.EnableDebug=function(e){return this.SetLogLevelSDK(e),Promise.resolve(!0)},t.prototype.Initialize=function(){return u.VidyoDebugger.Initialize(this._vidyoCore),Promise.resolve(void 0)},t.prototype.LogFatal=function(e,t,n){e instanceof Error&&(e={name:e.name,message:e.message}),this._log(a.VidyoLogLevel.fatal,e,this._parseStackTrace(),t,n)},t.prototype.LogError=function(e,t,n){e instanceof Error&&(e={name:e.name,message:e.message}),this._log(a.VidyoLogLevel.error,e,this._parseStackTrace(),t,n)},t.prototype.LogWarning=function(e,t,n){this._log(a.VidyoLogLevel.warning,e,this._parseStackTrace(),t,n)},t.prototype.LogInfo=function(e,t,n){this._log(a.VidyoLogLevel.info,e,this._parseStackTrace(),t,n)},t.prototype.LogDebug=function(e,t,n){this._log(a.VidyoLogLevel.debug,e,this._parseStackTrace(),t,n)},t.prototype.LogReceived=function(e,t,n){this._log(a.VidyoLogLevel.received,e,this._parseStackTrace(),t,n)},t.prototype.LogSent=function(e,t,n){this._log(a.VidyoLogLevel.sent,e,this._parseStackTrace(),t,n)},t.prototype.LogEnter=function(e,t,n){this._log(a.VidyoLogLevel.enter,e,this._parseStackTrace(),t,n)},t.prototype.LogLeave=function(e,t,n){this._log(a.VidyoLogLevel.leave,e,this._parseStackTrace(),t,n)},t.prototype.SetLogLevelSDK=function(e){h.LogLevelParser.ParseLogLevelFilter(e,this._logLevelFilterSDK),this._vidyoCore.EventDispatcher.emit(s.Events.LogCategoryChanged,this.GetLogLevelSDK())},t.prototype.GetLogLevelSDK=function(){return this._logLevelFilterSDK},t.prototype.SetLogLevelApp=function(e){h.LogLevelParser.ParseLogLevelFilter(e,this._logLevelFilterApp)},t.prototype.SetLogLevelDebug=function(e){h.LogLevelParser.ParseLogLevelFilter(e,this._logLevelFilterDebug)},t.prototype._log=function(e,t,n,r,i){if(void 0===r&&(r=a.VidyoLogCategory.VidyoClient),0!=(this._logLevelFilterSDK[r]&e)){var o=a.LogEventsSDK[a.VidyoLogLevel[e]];o||(o=new l.EventDescriptor(a.VidyoLogLevel[a.VidyoLogLevel.error])),this._logEvent(o,r,e,t,n,i)}0!=(this._logLevelFilterApp[r]&e)&&this._logEvent(a.LogEventApp,r,e,t,n,i),0!=(this._logLevelFilterDebug[r]&e)&&this._logEvent(a.LogEventDebug,r,e,t,n,i)},t.prototype._logEvent=function(e,t,n,r,i,o){var s="string"==typeof r?r:JSON.stringify(r,c.decycle(),2);this._vidyoCore.EventDispatcher.emit(e,new y(t,Date.now(),i.fileName,i.functionName,a.VidyoLogLevel[n],i.lineNumber,s,o||e.toString(),"Execute Main Thread"))},t.prototype._parseStackTrace=function(){var e="unknown functionName",t="unknown fileName",n="0";if(p.OperatingSystemInfoProvider.IsChrome()){var r=new Error;try{if(r.stack){var i=r.stack.split("\n");if(i&&i.length>3){var o=i[3].split(" ("),a=0;o.length>1&&(e=o[0].split("at ")[1],a=1);var s=o[a].split("/"),c=s[s.length-1].split(":");t=c[0],n=c[1]}}}catch(e){}}return new v(t,e,parseInt(n,d.BaseTenRadix))},t}(o.BaseController);n.LogController=m;var v=function(){return function(e,t,n){this.fileName=e,this.functionName=t,this.lineNumber=n}}(),y=function(){function e(e,t,n,r,i,o,a,s,c){this.categoryName=e,this.eventTime=t,this.file=n,this.functionName=r,this.level=i,this.line=o,this.message=a,this.name=s,this.threadName=c}return e.toLogString=function(e){return f.default.toStringDate(new Date(e.eventTime),!0)+": "+e.level.toUpperCase()+": "+e.categoryName+": "+e.threadName+": "+e.file+":"+e.line+": "+e.functionName+": "+e.message},e}();n.LogRecord=y},{"../../events/AdvancedSettingsEvents":394,"../../events/LogEvents":400,"../../utils/Constants":461,"../../utils/EventListFactory":463,"../../utils/OperatingSystemInfoProvider":472,"../../utils/StringUtils":479,"../../utils/VidyoDebugger":484,"../BaseController":366,"./LogLevelParser":376,"json-decycle":92}],376:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../events/LogEvents"),i=function(){function e(){}return e.ParseLogLevelFilter=function(t,n){for(var r=(t=t.replace("@*","")).split(" "),i=[],o=0,a=r;o<a.length;o++){(v=a[o]).match(/(^[^\+\-\!\=])([^@]+)$/g)&&i.push(v)}e._setLogLevelItems(n,i);for(var s=[],c=0,u=r;c<u.length;c++){(v=u[c]).match(/(^[\+\-\!\=])([^@]+)$/g)&&s.push(v)}e._setLogLevelItems(n,s);for(var l=[],d=0,p=r;d<p.length;d++){(v=p[d]).match(/(^[^\+\-\!\=])(.+[@].+)$/g)&&l.push(v)}e._setLogLevelItems(n,l);for(var f=[],h=0,m=r;h<m.length;h++){var v;(v=m[h]).match(/(^[\+\-\!\=])(.+[@].+)$/g)&&f.push(v)}e._setLogLevelItems(n,f)},e._setLogLevelItems=function(t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o.match(/[^\+\-\!\=][a-z][^@]+/g);if(null===a||a.length<1)return!1;var s=a[0],c=a[1],u=o.match(/^[\+\-\!\=]+/g),l=u?u[0]:null;if(!e._checkLogLevel(s))return console.error("LogLevelParser Error: "+s),!1;if(!e._checkLogCategory(c))return console.error("LogCategory Error: "+c),!1;if(!e._checkLogModifiers(l))return console.error("LogModifiers Error: "+l),!1;"all"===s.toLowerCase()?e._setLogLevelALL(t,l,c):e._setLogLevel(t,s,l,c)}return!0},e._checkLogLevel=function(e){return!!e&&("all"===e.toLowerCase()||!!r.VidyoLogLevel[e])},e._checkLogCategory=function(e){return!e||!!r.VidyoLogCategory[e]},e._checkLogModifiers=function(e){return!e||!e.match(/^(\+{2})|(\-{2})|(\!{2})|(\={2})|(\+\-)|(\-\+)|(\+\!)|(\!\+)|(\-\!)|(\!\-)$/g)&&!!e.match(/^[\+\-\!\=]{1,2}$/g)},e._setLogLevelALL=function(t,n,i){if(i)n&&null!==n.match(/^(\-)|(\-\=)|(\=\-)|(\!\=)|(\=\!)$/g)?t[r.VidyoLogCategory[i]]=0:t[r.VidyoLogCategory[i]]=r.VidyoLogLevel.fatal|r.VidyoLogLevel.error|r.VidyoLogLevel.warning|r.VidyoLogLevel.info|r.VidyoLogLevel.debug|r.VidyoLogLevel.sent|r.VidyoLogLevel.received|r.VidyoLogLevel.enter|r.VidyoLogLevel.leave;else for(var o in r.VidyoLogCategory)r.VidyoLogCategory.hasOwnProperty(o)&&e._setLogLevelALL(t,n,r.VidyoLogCategory[o])},e._setLogLevel=function(t,n,i,o){var a=r.VidyoLogLevel[n],s=o?r.VidyoLogCategory[o]:null,c=new Array;c.push(a);var u=!1;if(i&&(u=!!i.match(/[=]/g)),!1===u)switch(a){case r.VidyoLogLevel.enter:c.push(r.VidyoLogLevel.leave);break;case r.VidyoLogLevel.leave:c.push(r.VidyoLogLevel.enter);break;case r.VidyoLogLevel.sent:c.push(r.VidyoLogLevel.received);break;case r.VidyoLogLevel.received:c.push(r.VidyoLogLevel.sent);break;case r.VidyoLogLevel.fatal:break;case r.VidyoLogLevel.error:c.push(r.VidyoLogLevel.fatal);break;case r.VidyoLogLevel.warning:c.push(r.VidyoLogLevel.error),c.push(r.VidyoLogLevel.fatal);break;case r.VidyoLogLevel.info:c.push(r.VidyoLogLevel.warning),c.push(r.VidyoLogLevel.error),c.push(r.VidyoLogLevel.fatal);break;case r.VidyoLogLevel.debug:c.push(r.VidyoLogLevel.info),c.push(r.VidyoLogLevel.warning),c.push(r.VidyoLogLevel.error),c.push(r.VidyoLogLevel.fatal)}for(var l=0,d=c;l<d.length;l++){var p=d[l];e._setLogLevelItem(t,p,i,s)}},e._setLogLevelItem=function(t,n,i,o){if(o){var a=!0;i&&(a=!i.match(/[\-\!]/g)),!0===a?t[o]|=n:t[o]&=~n}else for(var s in r.VidyoLogCategory)r.VidyoLogCategory.hasOwnProperty(s)&&e._setLogLevelItem(t,n,i,s)},e}();n.LogLevelParser=i},{"../../events/LogEvents":400}],377:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o,a=e("./BaseController"),s=e("../events/EventDispatcher"),c=e("../events/MessageEvents"),u=e("../models/Message");!function(e){e.active="active",e.inactive="inactive",e.gone="gone",e.composing="composing",e.paused="paused"}(o=n.ChatStates||(n.ChatStates={}));var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._messages=[],t}return i(t,e),t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.GetMessageById=function(e){return this._messages.find(function(t){return t.id===e})},t.prototype.Initialize=function(){var e=this;return this._vidyoCore.EventDispatcher.on(c.Events.MessageReceived,s.MessageControllerListeners,function(t){return e._onMessageReceived(t)}),this._vidyoCore.EventDispatcher.on(c.Events.MessageRead,s.MessageControllerListeners,function(t){return e._onMessageRead(t)}),this._vidyoCore.EventDispatcher.on(c.Events.MessageChatState,s.MessageControllerListeners,function(t){return e._onMessageChatState(t)}),Promise.resolve(void 0)},t.prototype.SendMessage=function(e){var t=this._vidyoCore.Controllers.RoomController.RoomJid();this._vidyoCore.XmppProvider.SendMessage({message:e,to:t,type:"groupchat"})},t.prototype.SendMessageAcknowledged=function(e){var t=this._messages.find(function(t){return+t.id==+e});return t?(this._vidyoCore.XmppProvider.SendMessageAcknowledged({id:t.id,to:t.userId+"/"+t.resource,type:t.type}),Promise.resolve(!0)):Promise.resolve(!1)},t.prototype.SendMessageTypingIndication=function(e){if(e in o){var t=this._vidyoCore.Controllers.RoomController.RoomJid();return this._vidyoCore.XmppProvider.SendMessageChatState(t,e),Promise.resolve(!0)}return Promise.resolve(!1)},t.prototype._onMessageChatState=function(e){var t=null;e.resource&&(t=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e.resource))&&this._vidyoCore.EventDispatcher.emit(c.Events.OnMessageChatState,{participant:t,state:e.chatState})},t.prototype._onMessageRead=function(e){var t=null;e.resource&&(t=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e.resource))&&this._vidyoCore.EventDispatcher.emit(c.Events.OnMessageRead,{participant:t,messageId:e.id})},t.prototype._onMessageReceived=function(e){var t=new u.Message;t.body=e.body,t.id=e.id,t.timestamp=Date.now();var n=null;e.resource&&(n=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e.resource))&&(n.UserId||n.IsLocal)&&(t.userId=n.IsRemote?n.UserId:"local",t.resource=e.resource,t.senderType=u.SenderType.user,t.type=u.MessageType.chat),!e.subtype||e.subtype!==u.MessageType.mediastart&&e.subtype!==u.MessageType.mediastop||(t.userId=null,t.senderType=u.SenderType.room,t.type=e.subtype),this._messages.push(t),n&&t.senderType===u.SenderType.user&&(this._vidyoCore.EventDispatcher.emit(c.Events.OnMessage,{participant:n,message:t}),n.IsLocal&&this._vidyoCore.EventDispatcher.emit(c.Events.OnMessageAcknowledged,{message:t}))},t}(a.BaseController);n.MessageController=l},{"../events/EventDispatcher":399,"../events/MessageEvents":401,"../models/Message":412,"./BaseController":366}],378:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("./BaseController"),a=e("../utils/TimingProvider"),s=e("../utils/AudioAnalyser"),c=e("../models/Participant"),u=e("../events/StreamEvents"),l=e("../events/ParticipantEvents"),d=e("../events/EventDispatcher"),p=e("../../vidyo_simple_api/Participant"),f=e("../models/Participant"),h=e("../../vidyo_simple_api/Devices"),m=e("../models/device/Microphone"),v=e("../../vidyo_simple_api/Origin"),y=e("es6-promise"),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._intervalRefreshLocal=null,t._intervalRefreshRemote=null,t._remoteEnergyMeters={},t._remoteOnEnergyCallback=null,t}return i(t,e),t.prototype.Disable=function(){return this._onDisconnected(),e.prototype.Disable.call(this)},t.prototype.Initialize=function(){return this._initializeRemoteParticipantEnergyMeters(),y.Promise.resolve(void 0)},t.prototype.RegisterLocalMicrophoneEnergyListener=function(e){var n=this;return this._clearLocalMeter(),this._vidyoCore.EventDispatcher.on(u.Events.TracksChanged,d.MicrophoneLocalEnergyLevelControllerListeners,function(e){return n._onLocalStreamChanged(e)}),this._processLocalStream(),this._intervalRefreshLocal=a.TimingProvider.Interval(t.period,function(){n._localEnergyMeter&&n._localEnergyMeter.renewMetering().then(function(t){t.suspendMetering(),t.audioEnabled&&e.onEnergy(t.GetMicrophone(),t.instantMaxEnergy)})}),y.Promise.resolve(!0)},t.prototype.RegisterRemoteMicrophoneEnergyListener=function(e){return this._remoteOnEnergyCallback=e,y.Promise.resolve(!0)},t.prototype.UnregisterLocalMicrophoneEnergyListener=function(){return this._clearLocalMeter(),y.Promise.resolve(!0)},t.prototype.UnregisterRemoteMicrophoneEnergyListener=function(){return this._remoteOnEnergyCallback=null,y.Promise.resolve(!0)},t.prototype._addRemoteParticipant=function(e){var t=this,n=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e);if(n&&n.Origin===c.ParticipantOrigin.Remote){var r=this._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantAudioStream(e);r&&setTimeout(function(){r&&n&&(t._remoteEnergyMeters[e]=S.createMeter(t._vidyoCore,r,t._getRemoteMicrophone(r,e),n))})}},t.prototype._clearLocalMeter=function(){this._vidyoCore.EventDispatcher.releaseGroup(d.MicrophoneLocalEnergyLevelControllerListeners),null!==this._intervalRefreshLocal&&(a.TimingProvider.ClearInterval(this._intervalRefreshLocal),this._intervalRefreshLocal=null),this._localEnergyMeter&&(this._localEnergyMeter.stopMetering(),this._localEnergyMeter=null)},t.prototype._clearMeters=function(){this._clearRemoteMeters(),this._clearLocalMeter()},t.prototype._clearRemoteMeters=function(){for(var e in this._vidyoCore.EventDispatcher.releaseGroup(d.MicrophoneRemoteEnergyLevelControllerListeners),null!==this._intervalRefreshRemote&&(a.TimingProvider.ClearInterval(this._intervalRefreshRemote),this._intervalRefreshRemote=null),this._remoteEnergyMeters)this._remoteEnergyMeters.hasOwnProperty(e)&&(this._remoteEnergyMeters[e].stopMetering(),delete this._remoteEnergyMeters[e])},t.prototype._getParticipantIdForRemoteStream=function(e){for(var t in this._remoteEnergyMeters)if(this._remoteEnergyMeters.hasOwnProperty(t)&&(t===e||this._remoteEnergyMeters[t].roStream.Id===e))return t;return null},t.prototype._getRemoteMicrophone=function(e,t){var n=new m.Microphone("Remote Microphone "+t,t),r=e.GetAudioTracks();if(r&&r.length>0){var i=this._vidyoCore.Controllers.ParticipantController.GetParticipant(t).GetSourceBySSrc(r[0].Settings.deviceId);i&&(n=new m.Microphone(i.Name,i.Ssrc,i.ObjId))}return n},t.prototype._initializeRemoteParticipantEnergyMeters=function(){var e=this;if(this._vidyoCore.EventDispatcher.on(u.Events.TracksChanged,d.MicrophoneRemoteEnergyLevelControllerListeners,function(t){return e._onRemoteStreamChanged(t)}),this._vidyoCore.EventDispatcher.on(u.Events.StreamListChanged,d.MicrophoneRemoteEnergyLevelControllerListeners,function(){return e._onRemoteStreamsChanged()}),this._vidyoCore.Controllers.ConnectionController.Session)for(var n=0,r=this._vidyoCore.Controllers.ParticipantController.GetParticipants();n<r.length;n++){var i=r[n];this._addRemoteParticipant(i.Id)}var o=this._loudestEnergyMeter;this._intervalRefreshRemote=a.TimingProvider.Interval(t.period,function(){for(var t in e._remoteEnergyMeters)e._remoteEnergyMeters.hasOwnProperty(t)&&e._remoteEnergyMeters[t].renewMetering().then(function(t){t.suspendMetering(),t.audioEnabled&&((!o||o.instantMaxEnergy<t.instantMaxEnergy)&&(o=t),e._remoteOnEnergyCallback&&e._remoteOnEnergyCallback.onEnergy(t.GetMicrophone(),t.GetParticipant(),t.instantMaxEnergy))});o&&o!==e._loudestEnergyMeter&&(e._loudestEnergyMeter=o,e._vidyoCore.EventDispatcher.emit(l.Events.LoudestParticipantChanged,{participant:e._loudestEnergyMeter.CoreParticiopant}))})},t.prototype._onDisconnected=function(){this._clearMeters()},t.prototype._onLocalStreamChanged=function(e){var t=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream;t&&t.Id===e&&this._intervalRefreshLocal&&this._processLocalStream()},t.prototype._onRemoteStreamChanged=function(e){var t=this,n=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream;if((!n||n.Id!==e)&&this._intervalRefreshRemote){var r=this._getParticipantIdForRemoteStream(e);if(r){var i=this._remoteEnergyMeters[r];i.stopMetering(),delete this._remoteEnergyMeters[r],setTimeout(function(){i.roStream.GetMediaStream().active&&i.roStream.GetAudioTracks().length>0&&r&&(t._remoteEnergyMeters[r]=S.createMeter(t._vidyoCore,i.roStream,t._getRemoteMicrophone(i.roStream,r),t._vidyoCore.Controllers.ParticipantController.GetParticipant(r)))})}else this._onRemoteStreamsChanged()}},t.prototype._onRemoteStreamsChanged=function(){for(var e=Object.keys(this._remoteEnergyMeters),t=this._vidyoCore.Controllers.ParticipantController.GetParticipants({Origin:c.ParticipantOrigin.Remote}).map(function(e){return e.Id}),n=0,r=e;n<r.length;n++){var i=r[n];t.includes(i)||(this._remoteEnergyMeters[i].stopMetering(),delete this._remoteEnergyMeters[i])}for(var o=0,a=t;o<a.length;o++){var s=a[o];e.includes(s)||this._addRemoteParticipant(s)}},t.prototype._processLocalStream=function(){this._localEnergyMeter&&this._localEnergyMeter.stopMetering(),this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream&&(this._localEnergyMeter=S.createMeter(this._vidyoCore,this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream,this._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Microphone,new f.Participant("me",c.ParticipantOrigin.Local,"Me")))},t.period=100,t}(o.BaseController);n.MicrophoneEnergyLevelController=g;var S=function(){function e(){this.audioEnabled=!1,this._bufferSize=8192,this._inProgress=!1,this._isLgScale=!0}return Object.defineProperty(e.prototype,"CoreParticiopant",{get:function(){return this._coreParticipant},enumerable:!0,configurable:!0}),e.prototype.GetMicrophone=function(){return this._microphone},e.prototype.GetParticipant=function(){return this._participant},e.prototype.renewMetering=function(){var e=this;return this.audioEnabled=this._checkAudioEnabled(),this.audioEnabled?!0===this._inProgress?y.Promise.resolve(this):new y.Promise(function(t){e._inProgress=!0,e._meteringPromiseResolve=t}):y.Promise.resolve(this)},e.prototype.stopMetering=function(){try{this._mediaStreamAudioSource.disconnect(),this._scriptProcessor.disconnect(),this.instantMaxEnergy=this._isLgScale?e.MinLGAudioLevel:0,this._clonedStream&&this._clonedStream.getAudioTracks().forEach(function(e){return e.stop()})}catch(e){}},e.prototype.suspendMetering=function(){this._inProgress=!1},e.prototype._calculateEnergyLevel=function(t){this.instantMaxEnergy=this._isLgScale?e.MinLGAudioLevel:0;for(var n=0;n<t.inputBuffer.numberOfChannels;n++)this._calculateEnergyLevelForChannel(t,n);this._meteringPromiseResolve(this)},e.prototype._calculateEnergyLevelForChannel=function(t,n){for(var r=t.inputBuffer.getChannelData(n),i=0,o=0,a=r;o<a.length;o++){var s=a[o];i+=s*s}var c=i/r.length;this.instantMaxEnergy=Math.max(this.instantMaxEnergy,c),this.avgMaxEnergy=e.AVGMainWeight*this.avgMaxEnergy+e.AVGInstantWeight*this.instantMaxEnergy,!0===this._isLgScale&&(this.instantMaxEnergy=e.LGScaleMultiplier*Math.log10(this.instantMaxEnergy),this.instantMaxEnergy=Math.max(Math.min(e.MaxLGAudioLevel,this.instantMaxEnergy),e.MinLGAudioLevel))},e.prototype._checkAudioEnabled=function(){return this.roStream.GetAudioTracks().length>0&&this.roStream.GetAudioTracks()[0].IsActive()&&!this.roStream.GetAudioTracks()[0].Muted&&(this._coreParticipant.Origin===c.ParticipantOrigin.Local||!this._coreParticipant.AudioMuted())},e.prototype._initMetering=function(t,n,r){var i=this;this._audioContext=t||new AudioContext,this._isLgScale=r||!0,this.instantMaxEnergy=this._isLgScale?e.MinLGAudioLevel:0,this.avgMaxEnergy=0,this.roStream=n,this.audioEnabled=this._checkAudioEnabled(),this.audioEnabled&&(this._scriptProcessor=this._audioContext.createScriptProcessor(this._bufferSize,this.roStream.GetAudioTracks().length,this.roStream.GetAudioTracks().length),this._scriptProcessor.onaudioprocess=function(e){i._inProgress&&i._calculateEnergyLevel(e)},this._clonedStream=new MediaStream,this.roStream.GetMediaStream().getAudioTracks().forEach(function(e){i._clonedStream.addTrack(e.clone())}),this._mediaStreamAudioSource=this._audioContext.createMediaStreamSource(this._clonedStream),this._mediaStreamAudioSource.connect(this._scriptProcessor),this._scriptProcessor.connect(this._audioContext.destination))},e.createMeter=function(t,n,r,i){var o=new e;return o._coreParticipant=i,o._participant=new p.Participant(o._coreParticipant),o._microphone=new h.Microphone(t,r,v.FromCoreOrigin(o._coreParticipant.Origin)),o._initMetering(s.AudioAnalyser.getAudioContext(),n),o},e.AVGInstantWeight=.05,e.AVGMainWeight=.95,e.LGScaleMultiplier=10,e.MaxLGAudioLevel=0,e.MinLGAudioLevel=-127,e}()},{"../../vidyo_simple_api/Devices":529,"../../vidyo_simple_api/Origin":532,"../../vidyo_simple_api/Participant":533,"../events/EventDispatcher":399,"../events/ParticipantEvents":402,"../events/StreamEvents":408,"../models/Participant":413,"../models/device/Microphone":425,"../utils/AudioAnalyser":456,"../utils/TimingProvider":480,"./BaseController":366,"es6-promise":43}],379:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../events/ConferenceEvents"),a=e("../events/ConnectionEvents"),s=e("../events/ParticipantEvents"),c=e("../models/Participant"),u=e("./BaseController"),l=e("../utils/Messages"),d=e("../events/EventDispatcher"),p=e("../utils/ObjectUtils"),f=e("../utils/StringUtils"),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._reportLocalParticipant=!1,t}return i(t,e),t.prototype.CreateParticipant=function(e,t,n,r){var i,o=!1;return r&&(r=r.replace(/(.*)_(.*)@.*/,"$1@$2")),this._participants[e]?(i=this._participants[e],r&&(i.UserId=r,o=i.IsComplete),n&&(i.Name=n,o=i.IsComplete)):(i=new c.Participant(e,t,n,r),this._participants[e]=i,o=i.IsComplete),o&&(this._vidyoCore.EventDispatcher.emit(s.Events.ParticipantsChanged),(t===c.ParticipantOrigin.Remote||this._reportLocalParticipant&&t===c.ParticipantOrigin.Local)&&this._vidyoCore.EventDispatcher.emit(s.Events.ParticipantJoined,{participant:i})),i},t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.GetLocalParticipant=function(){var e=this._vidyoCore.Controllers.ParticipantController.GetParticipants({Origin:c.ParticipantOrigin.Local});if(e&&e.length>0)return e[0]},t.prototype.GetParticipant=function(e){var t=this._participants[e];if(t)return t;throw new Error(f.default.Format(l.NoSuchParticipant,{id:e}))},t.prototype.GetParticipantBySsrc=function(e){for(var t in this._participants)if(this._participants.hasOwnProperty(t)){var n=this._participants[t];if(n.Sources.some(function(t){return t.Ssrc===e}))return n}return null},t.prototype.GetParticipants=function(e){return e?p.default.Filter(this._participants,e):this._participants?Object.values(this._participants):[]},t.prototype.Initialize=function(){var e=this;return this._vidyoCore.EventDispatcher.releaseGroup(d.ParticipantControllerListeners),this._vidyoCore.EventDispatcher.on(o.Events.SelectedParticipantsChanged,d.ParticipantControllerListeners,function(t){return e._onSelectedParticipantsChanged(t)}),this._vidyoCore.EventDispatcher.on(o.Events.SelectedParticipantUnavailable,d.ParticipantControllerListeners,function(t){return e._onSelectedParticipantsRemoved(t)}),this._vidyoCore.EventDispatcher.on(a.Events.Available,d.ParticipantControllerListeners,function(t){return e._onParticipantAvailable(t)}),this._vidyoCore.EventDispatcher.on(a.Events.Disconnecting,d.ParticipantControllerListeners,function(){return e._onDisconnecting()}),Promise.resolve(void 0)},t.prototype.RemoveParticipant=function(e){var t=this._participants[e];t&&t.IsRemote&&(this._vidyoCore.EventDispatcher.emitAsync(s.Events.ParticipantLeft,{participant:t}),this._vidyoCore.EventDispatcher.emitAsync(s.Events.ParticipantsChanged)),delete this._participants[e]},t.prototype.ReportLocalParticipant=function(e){this._reportLocalParticipant=e.reportLocalParticipant},t.prototype.ResetParticipantList=function(){this._participants={}},t.prototype.TryGetParticipant=function(e){return this._participants[e]},t.prototype.UpdateParticipants=function(e){var t=this;e.forEach(function(e){var n=t.GetParticipant(e.participantId);for(var r in e.update)e.update.hasOwnProperty(r)&&(n[r]=e.update[r])}),this._vidyoCore.EventDispatcher.emit(s.Events.ParticipantsChanged)},t.prototype.UpdateParticipantSource=function(e,t){var n=this._participants[e];n&&(n.Sources.push(t),this._vidyoCore.EventDispatcher.emit(s.Events.ParticipantsChanged))},t.prototype._onDisconnecting=function(){var e=this;Object.keys(this._participants).forEach(function(t){return e.RemoveParticipant(t)})},t.prototype._onParticipantAvailable=function(e){var t=e.resource,n=t===this._vidyoCore.Controllers.RoomController.RoomUserResourceId()?c.ParticipantOrigin.Local:c.ParticipantOrigin.Remote;this.CreateParticipant(t,n,void 0,e.jid).FullJID=e.fullJid},t.prototype._onSelectedParticipantsChanged=function(e){this._vidyoCore.EventDispatcher.emit(s.Events.DynamicParticipantChanged,{participants:e.participants})},t.prototype._onSelectedParticipantsRemoved=function(e){this._participants.hasOwnProperty(e.id)&&(this._participants[e.id].Active=!1,this._vidyoCore.EventDispatcher.emit(s.Events.ParticipantsChanged))},t}(u.BaseController);n.ParticipantController=h},{"../events/ConferenceEvents":396,"../events/ConnectionEvents":397,"../events/EventDispatcher":399,"../events/ParticipantEvents":402,"../models/Participant":413,"../utils/Messages":468,"../utils/ObjectUtils":471,"../utils/StringUtils":479,"./BaseController":366}],380:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("./BaseController"),a=e("../events/EventDispatcher"),s=e("../../core/events/PermissionEvents"),c=e("../models/Permission"),u=e("../utils/PermissionProvider"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._permissions={},t}return i(t,e),t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.GetPermissions=function(){var e={};for(var t in this._permissions)t&&(e[t]=this._permissions[t].granted);return e},t.prototype.Initialize=function(){var e=this;return this._vidyoCore.EventDispatcher.releaseGroup(a.PermissionControllerListeners),this._vidyoCore.EventDispatcher.on(s.Events.PermissionListenerRegistered,a.PermissionControllerListeners,function(){return e._subscribePermissionsAll()}),this._vidyoCore.EventDispatcher.on(s.Events.PermissionListenerUnregistered,a.PermissionControllerListeners,function(){return e._unsubscribePermissionsAll()}),Promise.resolve(void 0)},t.prototype.TrySubscribePermission=function(e,t){var n=this,r=this._getPermissionKeys(e);return this._subscribePermission(r).then(function(){return Promise.resolve(!0)}).catch(function(){return n._permissions[e]&&n._unsubscribePermission(e),n._permissions[e]={granted:t},n._notifyPermissionChanged(e,n._permissions[e].granted),Promise.resolve(!1)})},t.prototype._getPermissionKeys=function(e){var t=Object.entries(c.PermissionType);if(e){var n=t.find(function(t){return t.includes(e)}),r=n[0];n[1];return r}return t.map(function(e){return e[0]})},t.prototype._notifyPermissionChanged=function(e,t){this._vidyoCore.EventDispatcher.emit(s.Events.PermissionUpdated,{granted:t,permission:e})},t.prototype._onPermissionStatusChanged=function(e){var t=c.PermissionType[e.sender];if(t){switch(e.state){case"granted":this._permissions[t].granted=!0;break;default:this._permissions[t].granted=!1}this._notifyPermissionChanged(t,this._permissions[t].granted)}},t.prototype._subscribePermission=function(e){var t=this;return u.PermissionProvider.subscribe(e).then(function(n){return t._unsubscribePermission(c.PermissionType[e]),t._permissions[c.PermissionType[e]]=n,t._permissions[c.PermissionType[e]].onchange=function(n){var r=n.target.state,i=e;t._onPermissionStatusChanged({sender:i,state:r})},t._onPermissionStatusChanged({sender:e,state:n.state}),Promise.resolve(!0)}).catch(function(e){return Promise.reject(e)})},t.prototype._subscribePermissionsAll=function(){for(var e=this,t=this._getPermissionKeys(),n=function(t){r._subscribePermission(t).catch(function(n){e._permissions[c.PermissionType[t]]&&e._notifyPermissionChanged(c.PermissionType[t],e._permissions[c.PermissionType[t]].granted)})},r=this,i=0,o=t;i<o.length;i++){n(o[i])}return Promise.resolve(!0)},t.prototype._unsubscribePermission=function(e){return this._permissions[e]?(this._permissions[e].onchange=null,Promise.resolve(!0)):Promise.resolve(!1)},t.prototype._unsubscribePermissionsAll=function(){for(var e in this._permissions)e&&this._unsubscribePermission(e);return Promise.resolve(!0)},t}(o.BaseController);n.PermissionController=l},{"../../core/events/PermissionEvents":403,"../events/EventDispatcher":399,"../models/Permission":414,"../utils/PermissionProvider":473,"./BaseController":366}],381:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("./BaseController"),a=e("../utils/AutoPropertyHelper"),s=e("../utils/LocalStorageProvider");function c(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SelectedCamera="",t.SelectedMicrophone="",t.SelectedSpeaker="",t}return i(t,e),t}(e)}var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.Initialize=function(){return a.CreateAutoProperties(c,this,function(e){var t="VidyoCore::"+e;return{get:function(){return s.LocalStorageProvider.Get(t)},set:function(e){return s.LocalStorageProvider.Set(t,e)}}}),Promise.resolve(void 0)},t}(c(o.BaseController));n.PersistedSettingsController=u},{"../utils/AutoPropertyHelper":457,"../utils/LocalStorageProvider":465,"./BaseController":366}],382:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../events/StreamEvents"),a=e("../events/DeviceEvents"),s=e("../events/ParticipantEvents"),c=e("../events/RenderEvents"),u=e("../events/StatisticsEvents"),l=e("../models/RendererTypes"),d=e("./BaseController"),p=e("../models/VideoResolution"),f=e("../utils/Collection"),h=e("../models/renderer/GridLayout"),m=e("./StreamController/TrackMetaDataProvider"),v=e("es6-promise"),y=e("../events/EventDispatcher"),g=e("../utils/VideoPlaceholderTrack"),S=e("../utils/ObjectUtils"),_=e("../utils/TimingProvider"),b=function(){return function(){this.ParticipantCount=0,this.Resolutions=new p.VideoResolutionSet,this.VideoPlaceholders=new f.Collection(function(e){return new f.DataWithId(e,new g.VideoPlaceholderTrack)}),this.Views={}}}(),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ApplicationGridLayout=new h.GridLayout(0,0),t.DebounceTimeForResize=200,t.MaxNumberOfTracks=9,t.MediaGridSplit="horizontal",t.VideoGridLayout=new h.GridLayout,t._previewOn=!0,t._showLocalPreview=!0,t._showLocalSharePreview=!1,t._state=new b,t}return i(t,e),Object.defineProperty(t.prototype,"ShowLocalPreview",{get:function(){return this._showLocalPreview},set:function(e){this._showLocalPreview=e,this._vidyoCore.EventDispatcher.emit(c.Events.Update)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShowLocalSharePreview",{get:function(){return this._showLocalSharePreview},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VideoResolutions",{get:function(){return this._state.Resolutions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Views",{get:function(){return this._state.Views},enumerable:!0,configurable:!0}),t.prototype.AssignViewToCompositeRenderer=function(e){var t=e.viewId,n=e.viewStyle,r=e.remoteParticipants;this._vidyoCore.Controllers.RendererController.RenderMode===l.RenderMode.Custom&&this._vidyoCore.ReassignRenderer(t,n),this.UpdateCompositeRenderer(t,n,r)},t.prototype.AssignViewToLocalSource=function(e){var t={allowZoom:e.allowZoom,displayCropped:e.displayCropped,isApplication:e.isApplication,isLocal:!0,label:"Preview",participantId:"local",streamId:e.streamId,sourceId:"",viewId:e.viewId};this._state.Views[e.viewId]=S.default.Merge({},this._state.Views[e.viewId],t),this._vidyoCore.EventDispatcher.emit(c.Events.Update)},t.prototype.AssignViewToRemoteSource=function(e){var t=this._vidyoCore.Controllers.ParticipantController.GetParticipantBySsrc(e.sourceId);if(t&&t.IsRemote){var n=this._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantStreamBySsrc(t.Id,e.sourceId);if(n){var r={allowZoom:e.allowZoom,displayCropped:e.displayCropped,isApplication:e.isApplication,isLocal:!1,label:t.Name,participantId:t.Id,streamId:n.Id,sourceId:e.sourceId,viewId:e.viewId};this._state.Views[e.viewId]=S.default.Merge({},this._state.Views[e.viewId],r)}}this._vidyoCore.EventDispatcher.emit(c.Events.Update)},t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.GetViewBySsrc=function(e){return Object.values(this._state.Views).find(function(t){return t.sourceId===e})},t.prototype.HideView=function(e){if(this._state.Views[e.viewId]){if(!this._state.Views[e.viewId].isLocal){var t=this._state.Views[e.viewId].participantId,n=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(t);if(n){var r=this._state.Views[e.viewId].sourceId;this._vidyoCore.Controllers.ConferenceController.DeactivateParticipantSource(n,r)}}delete this._state.Views[e.viewId],this._vidyoCore.EventDispatcher.emit(c.Events.Hide,{viewId:e.viewId})}},t.prototype.Initialize=function(){var e=this;return this._vidyoCore.EventDispatcher.releaseGroup(y.RendererControllerListeners),this._vidyoCore.EventDispatcher.on(a.Events.SpeakerSelected,y.RendererControllerListeners,function(t){var n=t.speaker;return e._onSpeakerSelected(n)}),this._vidyoCore.EventDispatcher.on(o.Events.StreamListChanged,y.RendererControllerListeners,function(){return e._onStreamsChanged([])}),this._vidyoCore.EventDispatcher.on(o.Events.TracksChanged,y.RendererControllerListeners,function(t){return e._onStreamStateChanged(t)}),this._vidyoCore.EventDispatcher.on(o.Events.StreamEnableStateChanged,y.RendererControllerListeners,function(t){return e._onStreamStateChanged(t)}),this._vidyoCore.EventDispatcher.on(s.Events.ParticipantsChanged,y.RendererControllerListeners,function(){e._onParticipantsChanged()}),this._vidyoCore.EventDispatcher.on(u.Events.Update,y.RendererControllerListeners,function(){return e._onStatisticsChanged()}),this._debouncedNotifyOfVideoResolutionChanged=_.TimingProvider.Debounce(function(){return e._notifyOfVideoResolutionChanged()},this.DebounceTimeForResize),v.Promise.resolve(void 0)},t.prototype.SetPreview=function(e){this._previewOn=e.preview,this._vidyoCore.EventDispatcher.emit(c.Events.Update)},t.prototype.SetShowLocalPreview=function(e){this._showLocalPreview=e,this._vidyoCore.EventDispatcher.emit(c.Events.Update)},t.prototype.ShowAudioMeters=function(e){return this._vidyoCore.EventDispatcher.emit(c.Events.UpdateAudioMeters,{viewId:e.viewId,showMeters:e.showMeters}),v.Promise.resolve(!0)},t.prototype.ShowLocalShare=function(e){this._showLocalSharePreview=e;var t=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream.Id;this._vidyoCore.EventDispatcher.emit(c.Events.UpdateSource,t)},t.prototype.ShowViewAt=function(e){if(e.x||e.y){this._vidyoCore.Controllers.LogController.LogDebug("X and Y parameters of ShowViewAt are not supported in browser")}var t={viewId:e.viewId,position:{height:e.height,width:e.width}};return this._state.Views[e.viewId]=S.default.Merge({},this._state.Views[e.viewId],t),v.Promise.resolve(!0)},t.prototype.ShowViewLabel=function(e){return this._vidyoCore.EventDispatcher.emit(c.Events.UpdateViewLabel,{viewId:e.viewId,showLabel:e.showLabel}),v.Promise.resolve(!0)},t.prototype.UpdateCompositeRenderer=function(e,t,n){this.RenderMode===l.RenderMode.Composite&&(this._vidyoCore.Controllers.ResourcesManager.DynamicShowState=!0,this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit=n,this._vidyoCore.EventDispatcher.emit(c.Events.UpdateCompositeRenderer,{viewId:e,viewStyle:t}),this._vidyoCore.EventDispatcher.emit(c.Events.RecheckEachVideoSize))},t.prototype.UpdateRenderer=function(){var e=this._vidyoCore.Controllers.ParticipantController.GetParticipants().length;e!==this._state.ParticipantCount&&(this._state.ParticipantCount=e,this._vidyoCore.EventDispatcher.emit(c.Events.Update),this._vidyoCore.EventDispatcher.emit(c.Events.RecheckEachVideoSize))},t.prototype.UpdateVideoResolutions=function(e,t){var n=this,r=0,i=0,o=0,a=0,s=0,u=0;t.forEach(function(e){(n._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantStream(e.Id)?n._vidyoCore.Controllers.RemoteStreamController.GetTrackMediaType(e.Id):n._vidyoCore.Controllers.LocalStreamController.GetStreamTrackMediaType(e.Id))===m.MediaTrackType.Application?e.Width>0&&e.Height>0?(a+=e.AspectRatio,s+=1):u+=1:e.Width>0&&e.Height>0?(r+=e.AspectRatio,i+=1):o+=1,n._state.Resolutions.Get(e.Id).AspectRatioRatioType!==e.AspectRatioRatioType&&n._vidyoCore.EventDispatcher.emit(c.Events.VideoCropSettingsChanged,e)});var l=t.some(function(e){var t=n._state.Resolutions.Get(e.Id).ContainerResolution,r=e.ContainerResolution;return t.Width!==r.Width||t.Height!==r.Height});this._state.Resolutions.UpdateVideoResolutions(e,t);var d=0;s>0&&i>0?d=.8:s>0&&i<=0&&(d=1);var p=1-d;e.AspectRatio<=1?(d=1/d,p=1/p,this.MediaGridSplit="vertical"):this.MediaGridSplit="horizontal";var f=this.VideoGridLayout.Update(i+o,e.AspectRatio*p,r/i),h=this.ApplicationGridLayout.Update(s+u,e.AspectRatio*d,a/s);(f||h)&&this._vidyoCore.EventDispatcher.emit(c.Events.GridLayoutChanged),l&&this._debouncedNotifyOfVideoResolutionChanged&&this._debouncedNotifyOfVideoResolutionChanged()},t.prototype._notifyOfVideoResolutionChanged=function(){this._vidyoCore.EventDispatcher.emit(c.Events.VideoResolutionChanged)},t.prototype._onParticipantsChanged=function(){this.UpdateRenderer(),this._vidyoCore.EventDispatcher.emit(c.Events.Update)},t.prototype._onSpeakerSelected=function(e){this._vidyoCore.EventDispatcher.emit(c.Events.SpeakerSelected,{speakerId:e.Id})},t.prototype._onStatisticsChanged=function(){this._vidyoCore.EventDispatcher.emit(c.Events.StatisticsUpdate)},t.prototype._onStreamsChanged=function(e){this.UpdateRenderer(),this._vidyoCore.EventDispatcher.emit(c.Events.Update,e)},t.prototype._onStreamStateChanged=function(e){this._vidyoCore.EventDispatcher.emit(c.Events.UpdateSource,e)},t.prototype._simplifyAspectRatio=function(e){return e>=10?10..toString():e>=1?Math.floor(e).toString():e>=.75?"0.75":e>=.5?"0.5":e>=.25?"0.25":"0"},t}(d.BaseController);n.RendererController=C},{"../events/DeviceEvents":398,"../events/EventDispatcher":399,"../events/ParticipantEvents":402,"../events/RenderEvents":404,"../events/StatisticsEvents":407,"../events/StreamEvents":408,"../models/RendererTypes":416,"../models/VideoResolution":420,"../models/renderer/GridLayout":428,"../utils/Collection":460,"../utils/ObjectUtils":471,"../utils/TimingProvider":480,"../utils/VideoPlaceholderTrack":483,"./BaseController":366,"./StreamController/TrackMetaDataProvider":391,"es6-promise":43}],383:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../BaseController"),a=e("./SourcesStatisticManager"),s=e("../../models/ConferenceCommandParameters"),c=e("../../models/Participant"),u=e("../../utils/Constants"),l=e("../../events/LogEvents"),d=e("../../events/ResourcesManagerEvents"),p=e("../../events/EventDispatcher"),f=e("../../events/AdvancedSettingsEvents"),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AudioCount=u.NumberOfSelectedAudioSources,t.NumberOfDynamicOffsToSend=5,t._adjustTimeoutsCounter=0,t._currentParticipantLimit=1,t._selfViewPolicy=u.DefaultSelfViewPolicy,t}return i(t,e),Object.defineProperty(t.prototype,"SelfViewPolicy",{get:function(){return this._selfViewPolicy},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CurrentParticipantLimit",{get:function(){return this._currentParticipantLimit},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DynamicShowState",{set:function(e){this._isDynamicShowState=e},enumerable:!0,configurable:!0}),t.prototype.AccumulateStatistics=function(e){if(e.userStats&&e.userStats.length){var t=e.userStats[0];if(t.roomStats&&t.roomStats.length){var n=t.roomStats[0],r={bandwidthReceiveObj:n.availableDecodeBwPercent,bandwidthSendObj:n.availableEncodeBwPercent,cpuDecodeObj:n.availableDecodeCpuPercent,cpuEncodeObj:n.availableEncodeCpuPercent};this._onAvailableResourcesChanged(r)}}},t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.Initialize=function(){var t=this;return this._sourceStatisticManager=new a.SourcesStatisticManager(this._vidyoCore),this._vidyoCore.EventDispatcher.on(f.Events.ParticipantLimitChanged,function(e){return t._onParticipantLimitChanged(e)}),e.prototype.Initialize.call(this)},t.prototype.RegisterResourceManagerEventListener=function(e){return e.onMaxRemoteSourcesChanged&&this._vidyoCore.EventDispatcher.on(d.Events.MaxRemoteSourcesChanged,p.VidyoResourceManagerEventListeners,function(t){e.onMaxRemoteSourcesChanged(t.maxRemoteSourcesObj)}),e.onAvailableResourcesChanged&&this._vidyoCore.EventDispatcher.on(d.Events.AvailableResourcesChanged,p.VidyoResourceManagerEventListeners,function(t){e.onAvailableResourcesChanged(t.cpuEncodeObj,t.cpuDecodeObj,t.bandwidthSendObj,t.bandwidthReceiveObj)}),Promise.resolve(!0)},t.prototype.SendDynamicShow=function(){var e=this,t=this._buildDynamicShowPayload(this._currentParticipantLimit);return this._vidyoCore.Controllers.ConferenceController.ConferenceDialog?this._vidyoCore.XmppProvider.ConferenceShowSelected(this._vidyoCore.Controllers.ConferenceController.ConferenceDialog.Identity(),t).then(function(t){return setTimeout(function(){return e._vidyoCore.Controllers.ParticipantController.UpdateParticipants([])},0),t}):Promise.resolve()},t.prototype.Start=function(){var e=this;this._runningState||(this._runningState=!0,this._currentParticipantLimit=Math.min(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit,t.DEFAULT_START_PARTICIPANT_LIMIT),this._adjustTimeoutsCounter=0,setTimeout(function(){return e._adjustSources()},this._getTimeoutForAdjust()))},t.prototype.Stop=function(){this._runningState=!1},t.prototype.UnregisterResourceManagerEventListener=function(){return this._vidyoCore.EventDispatcher.releaseGroup(p.VidyoResourceManagerEventListeners),Promise.resolve(!0)},t.prototype._adjustSources=function(){var e=this;if(this._runningState){if(this._sourceStatisticManager&&this._sourceStatisticManager.AvailableIncomingBandwidth>0){var t=this._calculateNewLimit();t=Math.min(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit,t),this._onParticipantLimitChanged(t)}setTimeout(function(){return e._adjustSources()},this._getTimeoutForAdjust())}},t.prototype._buildDynamicShowPayload=function(e){var t,n=[],r=[];for(t=0;t<e;t++)n.push({id:t,state:s.SourceState.On,params:{windowSize:{width:u.DefaultLocalStreamWidth,height:u.DefaultLocalStreamHeight},framesPerSec:30}});var i=this._vidyoCore.Controllers.ParticipantController.GetParticipants({Origin:c.ParticipantOrigin.Remote});i=i.sort(function(e,t){return e.Generation-t.Generation});for(var o=e,a=Math.max(0,i.length-o)+this.NumberOfDynamicOffsToSend,l=0;l<a;l++)n.push({id:t+l,state:s.SourceState.Off}),r.push({id:t+l,state:s.SourceState.Off});return i.forEach(function(e,t){t>=o?e.Active=!1:e.HasVideoSource()&&!e.Active&&(e.Active=!0)}),{audio:{count:this.AudioCount,policy:s.AudioPolicy.LoudestSpeaker},video:{policy:this.SelfViewPolicy,dynamicViewPolicy:s.ViewPolicy.ShowIfNotStaticallyViewed,generation:n}}},t.prototype._calculateNewLimit=function(){var e=this._currentParticipantLimit;if(this._sourceStatisticManager.CurrentBitrate>this._sourceStatisticManager.AvailableIncomingBandwidth&&this._adjustTimeoutsCounter>t.AGGRESSIVE_GROW_COUNT){var n=this._sourceStatisticManager.ActiveCount;e=Math.min(n,e),e=Math.max(t.MIN_PARTICIPANT_LIMIT,e-this._getDecreaseNumberForAdjust())}else e++;return e},t.prototype._onParticipantLimitChanged=function(e){this._currentParticipantLimit!==e&&(this._currentParticipantLimit=e,this._vidyoCore.Controllers.LogController.LogDebug("ResourceManager: adjust sources\n            ; AvailableIncomingBandwidth= "+this._sourceStatisticManager.AvailableIncomingBandwidth+"\n            ; ParticipantLimit= "+this._currentParticipantLimit,l.VidyoLogCategory.VidyoResourceManager),this._onMaxRemoteSourcesChanged({maxRemoteSourcesObj:this.CurrentParticipantLimit}),this._isDynamicShowState&&this.SendDynamicShow())},t.prototype._onAvailableResourcesChanged=function(e){this._vidyoCore.EventDispatcher.emit(d.Events.AvailableResourcesChanged,e)},t.prototype._onMaxRemoteSourcesChanged=function(e){this._vidyoCore.EventDispatcher.emit(d.Events.MaxRemoteSourcesChanged,e)},t.prototype._getDecreaseNumberForAdjust=function(){return this._adjustTimeoutsCounter<t.SMOOTH_START_ADJUST_COUNT?0:1},t.prototype._getTimeoutForAdjust=function(){return this._adjustTimeoutsCounter++<t.SMOOTH_START_ADJUST_COUNT?t.SMOOTH_START_ADJUST_TIMEOUT:t.ADJUST_TIMEOUT},t.ADJUST_TIMEOUT=15e3,t.MIN_PARTICIPANT_LIMIT=1,t.SMOOTH_START_ADJUST_COUNT=20,t.AGGRESSIVE_GROW_COUNT=6,t.SMOOTH_START_ADJUST_TIMEOUT=3e3,t.DEFAULT_START_PARTICIPANT_LIMIT=1,t}(o.BaseController);n.ResourcesManager=h},{"../../events/AdvancedSettingsEvents":394,"../../events/EventDispatcher":399,"../../events/LogEvents":400,"../../events/ResourcesManagerEvents":405,"../../models/ConferenceCommandParameters":410,"../../models/Participant":413,"../../utils/Constants":461,"../BaseController":366,"./SourcesStatisticManager":385}],384:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../models/VideoResolution"),a=function(){function e(e,t,n){this.Ssrc=e,this.type=t,this.ParticipantId=n}return Object.defineProperty(e.prototype,"CurrentBitrate",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalPacketLost",{get:function(){var e=this.TotalPacketsReceived+this.TotalPacketsLost;return 100*this.TotalPacketsLost/e},enumerable:!0,configurable:!0}),e.prototype.FillFromStats=function(e,t){},e}();n.default=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.FillFromStats=function(e,t){this.TotalPacketsLost=e.packetsLost||0,this.TotalPacketsReceived=e.packetsReceived||0;var n=t.get(e.codecId);if(n){var r=/[^\/]*$/.exec(n.mimeType),i="";r&&r.length&&(i=r[0]),this.CodecName=i}var o=t.get(e.trackId);o&&(this.FrameHeight=o.frameHeight||0,this.FrameWidth=o.frameWidth||0,this.MediaType=o.kind)},Object.defineProperty(t.prototype,"CurrentBitrate",{get:function(){return o.CalculateRemoteSourceBitrate(this.FrameWidth,this.FrameHeight,this.CodecName)||0},enumerable:!0,configurable:!0}),t}(a);n.VideoSourceStatistics=s},{"../../models/VideoResolution":420}],385:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./SourceStatistics"),i=e("../../events/ConferenceEvents"),o=e("../../models/Source"),a=e("../../events/ConnectionEvents"),s=e("../../models/Participant"),c=e("../../events/ParticipantEvents"),u=function(){function e(t){var n=this;this._vidyoCore=t,this._sourcesStatisticsVideo=[],setInterval(function(){return n._processSourcesStatistics()},e.GATHER_STATS_INTERVAL),this._vidyoCore.EventDispatcher.on(i.Events.SourceDetected,function(e){return n._onNewSource(e)}),this._vidyoCore.EventDispatcher.on(i.Events.SourceRemoved,function(e){return n._onSourceRemoved(e)}),this._vidyoCore.EventDispatcher.on(a.Events.Disconnected,function(){return n._onDisconnected()}),this._vidyoCore.EventDispatcher.on(i.Events.SelectedParticipantsChanged,function(){return n._rearangeSourcesByGeneration()}),this._vidyoCore.EventDispatcher.on(c.Events.ParticipantsChanged,function(){return n._rearangeSourcesByGeneration()}),this._vidyoCore.EventDispatcher.on(c.Events.ParticipantLeft,function(e){return n._onParticipantLeave(e.participant)})}return e.prototype.CalculateAcceptableBitrate=function(e){return this._sourcesStatisticsVideo.slice(0,e).filter(function(e){return e.IsActive}).reduce(function(e,t){return e+t.CurrentBitrate},0)},Object.defineProperty(e.prototype,"AvailableIncomingBandwidth",{get:function(){return this._aib||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AvailableOutcomingBandwidth",{get:function(){return this._aob||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ActiveCount",{get:function(){return this._sourcesStatisticsVideo.filter(function(e){return e.IsActive}).length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurrentBitrate",{get:function(){return this._sourcesStatisticsVideo.filter(function(e){return e.IsActive}).reduce(function(e,t){return e+t.CurrentBitrate},0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CombinedPacketLost",{get:function(){var e=this._sourcesStatisticsVideo.filter(function(e){return e.IsActive}).reduce(function(e,t){return e+t.TotalPacketLost},0);return e/=this._sourcesStatisticsVideo.length},enumerable:!0,configurable:!0}),e.prototype._fillSourceStats=function(e,t){var n=this._getSourceStatBySsrc(e.ssrc);n&&n.FillFromStats(e,t)},e.prototype._getSourceStatBySsrc=function(e){return this._sourcesStatisticsVideo.find(function(t){return+t.Ssrc===e})},e.prototype._onDisconnected=function(){this._sourcesStatisticsVideo.length=0},e.prototype._onNewSource=function(e){if(e.origin===s.ParticipantOrigin.Remote&&e.type===o.SourceMediaType.Video){var t=new r.VideoSourceStatistics(e.ssrc,e.type,e.participantId);this._sourcesStatisticsVideo.push(t)}},e.prototype._onParticipantLeave=function(e){this._sourcesStatisticsVideo=this._sourcesStatisticsVideo.filter(function(t){return e.Id!==t.ParticipantId})},e.prototype._onSourceRemoved=function(e){this._sourcesStatisticsVideo=this._sourcesStatisticsVideo.filter(function(t){return+e.ssrc!=+t.Ssrc})},e.prototype._processSourcesStatistics=function(){var e=this,t=this._vidyoCore.Controllers.ConnectionController.Session;t&&t.GetStats().then(function(t){t.forEach(function(n,r){switch(n.type){case"candidate-pair":"succeeded"===n.state&&n.hasOwnProperty("availableIncomingBitrate")&&n.hasOwnProperty("availableOutgoingBitrate")&&(e._aob=n.availableOutgoingBitrate||0,e._aib=n.availableIncomingBitrate||0);break;case"inbound-rtp":e._fillSourceStats(n,t)}})})},e.prototype._rearangeSourcesByGeneration=function(){var e={},t={};this._vidyoCore.Controllers.ParticipantController.GetParticipants({Origin:s.ParticipantOrigin.Remote}).map(function(n){e[n.Id]=n.Generation,t[n.Id]=n.Active}),this._sourcesStatisticsVideo.sort(function(t,n){return e[t.ParticipantId]-e[n.ParticipantId]}),this._sourcesStatisticsVideo.forEach(function(e){return e.IsActive=t[e.ParticipantId]})},e.GATHER_STATS_INTERVAL=1e3,e}();n.SourcesStatisticManager=u},{"../../events/ConferenceEvents":396,"../../events/ConnectionEvents":397,"../../events/ParticipantEvents":402,"../../models/Participant":413,"../../models/Source":418,"./SourceStatistics":384}],386:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o,a=e("../utils/Constants"),s=e("../utils/Errors"),c=e("../xmpp/XmppProvider"),u=e("./BaseController"),l=e("../events/RoomEvents"),d=e("es6-promise"),p=e("../models/Room"),f=e("../../vidyo_simple_api/Room"),h=e("../utils/TokenUtils"),m=e("../utils/LocationProvider"),v=e("../events/ConnectionEvents"),y=e("../events/ConnectionEvents"),g=e("../../vidyo_connector_api/VidyoConnector"),S=e("../models/Permission"),_=e("../utils/PromiseHelper");!function(e){e[e.VIDYO_USERROOMCREATERESULT_DUPLICATENAME=0]="VIDYO_USERROOMCREATERESULT_DUPLICATENAME",e[e.VIDYO_USERROOMCREATERESULT_MISCLOCALERROR=1]="VIDYO_USERROOMCREATERESULT_MISCLOCALERROR",e[e.VIDYO_USERROOMCREATERESULT_MISCREMOTEERROR=2]="VIDYO_USERROOMCREATERESULT_MISCREMOTEERROR",e[e.VIDYO_USERROOMCREATERESULT_NORESPONSE=3]="VIDYO_USERROOMCREATERESULT_NORESPONSE",e[e.VIDYO_USERROOMCREATERESULT_NOTFOUND=4]="VIDYO_USERROOMCREATERESULT_NOTFOUND",e[e.VIDYO_USERROOMCREATERESULT_OK=5]="VIDYO_USERROOMCREATERESULT_OK",e[e.VIDYO_USERROOMCREATERESULT_UNAUTHORIZED=6]="VIDYO_USERROOMCREATERESULT_UNAUTHORIZED"}(o=n.CreateRoomResults||(n.CreateRoomResults={}));var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.ConferenceJoin=function(e){return this._vidyoCore.XmppProvider.ConferenceJoin({Session:e,Conference:this._conference,Reflector:this._vidyoCore.Controllers.ConnectionController.Reflector(),LocalId:1},{})},t.prototype.CreateRoom=function(e){var t=this,n=this._createRoomJID(e);return this.FindRoomOnServer(n).then(function(t){if(t&&e.isNewRoom)throw new s.DuplicateNameError}).then(function(){var e=function(e){return t._vidyoCore.XmppProvider.SendPresence(e),t._vidyoCore.XmppProvider.JoinRoom({jid:n,user:t._vidyoCore.XmppProvider.Jid().resource})},r={to:n+"/"+t._vidyoCore.XmppProvider.Jid().resource,displayName:t._vidyoCore.Controllers.UserController.UserDisplayName(),idName:"VidyoTechnologyWebRTC",idVersion:a.LibVersion,maxStanzas:0};return t._vidyoCore.Controllers.ConnectionController.HasReflectorsPoolName?(r.poolName=t._vidyoCore.Controllers.ConnectionController.ReflectorsPoolName,e(r)):t._getLocationForPresence().then(function(n){return n&&(r.location=n),t._vidyoCore.Controllers.PermissionController.TrySubscribePermission(S.PermissionType.geolocation,m.LocationProvider.HasCurrentPosition()),e(r)})}).then(function(n){t._room.Jid=n.roomJid,t._room.LocalUserId=t._vidyoCore.XmppProvider.Jid().resource,t._room.InRoom=!0,t._vidyoCore.EventDispatcher.emit(l.Events.Created,{room:new f.Room(t._vidyoCore,t._room),result:o[o.VIDYO_USERROOMCREATERESULT_OK],token:e.token})}).then(function(){return e.subject?t._vidyoCore.XmppProvider.SetRoomSubject(n,e.subject):d.Promise.resolve(void 0)}).catch(function(n){if(n.name!==s.NotValidClientError.Name){var r;switch(n.name){case s.TimeOutError.Name:r=o[o.VIDYO_USERROOMCREATERESULT_NORESPONSE];break;case s.DuplicateNameError.Name:r=o[o.VIDYO_USERROOMCREATERESULT_DUPLICATENAME];break;default:r=o[o.VIDYO_USERROOMCREATERESULT_MISCREMOTEERROR]}n.message=r,t._vidyoCore.Controllers.LogController.LogError(n),t._vidyoCore.EventDispatcher.emit(l.Events.Created,{room:new f.Room(t._vidyoCore,t._room),result:r,token:e.token}),t._vidyoCore.EventDispatcher.emit(v.Events.SignallingError,new y.VidyoEventInfo("SignallingError",g.VidyoConnectorDisconnectReason.MiscError,r,"error"))}})},t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.Enter=function(e){var t=this;if(e.InRoom)return this._vidyoCore.EventDispatcher.emit(l.Events.Entered,{roomJid:e.Jid}),d.Promise.resolve(void 0);var n={to:e.Jid+"/"+e.LocalUserId,displayName:this._vidyoCore.Controllers.UserController.UserDisplayName()};return this._vidyoCore.XmppProvider.SendPresence(n),this._vidyoCore.XmppProvider.JoinRoom({jid:e.Jid,user:e.LocalUserId}).then(function(n){return e.InRoom=!0,t._vidyoCore.EventDispatcher.emit(l.Events.Entered,{roomJid:e.Jid}),d.Promise.resolve(void 0)})},t.prototype.FindRoomOnServer=function(e){return this._vidyoCore.XmppProvider.GetDiscoInfo(e).then(function(e){return e.type===c.StanzaTypes[c.StanzaTypes.result]})},t.prototype.GetConference=function(){return this._conference},t.prototype.Initialize=function(){return this._room=new p.Room,d.Promise.resolve(void 0)},t.prototype.Leave=function(e){var t=this;return e.InRoom&&this._vidyoCore.XmppProvider.IsXMPPSessionAlive()?this._vidyoCore.XmppProvider.LeaveRoom({jid:e.Jid,user:e.LocalUserId}).then(function(){return e.InRoom=!1,t._vidyoCore.EventDispatcher.emit(l.Events.Left,{roomJid:e.Jid}),d.Promise.resolve(void 0)}):(e.InRoom=!1,this._vidyoCore.EventDispatcher.emit(l.Events.Left,{roomJid:e.Jid}),d.Promise.resolve(void 0))},t.prototype.LeaveAll=function(){return this.Leave(this._room)},t.prototype.RoomJid=function(){return this._room.Jid},t.prototype.RoomUserResourceId=function(){return this._room.LocalUserId},t.prototype.SetConference=function(e){this._conference=e},t.prototype._createRoomJID=function(e){return e.resourceId+a.ResourceIdDomainSeparator+h.DecodeUserDomainName(e.token)+a.Muc+this._vidyoCore.XmppProvider.Domain()},t.prototype._getLocationForPresence=function(){var e=this;if(m.LocationProvider.HasCurrentPosition())return d.Promise.resolve(m.LocationProvider.GetCurrentPositionSync());var t=new d.Promise(function(t,n){m.LocationProvider.GetCurrentPosition().then(function(e){t(e)}).catch(function(t){e._vidyoCore.Controllers.LogController.LogWarning("Can't get current location: "+(t&&t.message)),n(t)})}),n=new d.Promise(function(t,n){e._vidyoCore.Controllers.ConnectionController.GetClosestReflectorPool().then(function(e){t(m.LocationProvider.toMinutes(e))}).catch(n)});return new d.Promise(function(e){_.RaceResolve([t,n]).then(e).catch(function(){return e()})})},t}(u.BaseController);n.RoomController=b},{"../../vidyo_connector_api/VidyoConnector":526,"../../vidyo_simple_api/Room":535,"../events/ConnectionEvents":397,"../events/RoomEvents":406,"../models/Permission":414,"../models/Room":417,"../utils/Constants":461,"../utils/Errors":462,"../utils/LocationProvider":466,"../utils/PromiseHelper":475,"../utils/TokenUtils":481,"../xmpp/XmppProvider":488,"./BaseController":366,"es6-promise":43}],387:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../events/ConferenceEvents"),a=e("../events/ConnectionEvents"),s=e("../utils/Constants"),c=e("../events/StatisticsEvents"),u=e("./BaseController"),l=e("../utils/Constants"),d=e("../models/statistics/Statistics"),p=e("../events/EventDispatcher"),f=e("../utils/TimingProvider"),h=e("../../vidyo_simple_api/stats/Stats"),m=e("../utils/OperatingSystemInfoProvider"),v=e("../models/Source"),y=e("../utils/AudioAnalyser"),g=e("../models/Participant"),S=e("../utils/ObjectUtils"),_=e("../utils/StringUtils"),b=e("../utils/StatisticsExtension"),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.EndpointStatistic=new d.EndpointStatistics,t.RoomStatistics=new d.RoomStatistics,t.UserStatistic=new d.UserStatistics,t._bytesReceived=0,t._bytesSent=0,t._intervalRefreshHandle=null,t._intervalResourceManagerStatisticsMeasuring=null,t._intervalSendStatsHandle=null,t._maxPercent=100,t._maxReceiveBitRateAvailable=1,t._maxSendBitRateAvailable=1,t._receiveBytesPrev=0,t._roomJoinedTimestamp=0,t._sendBytesPrev=0,t._statsOn=!1,t._timestampPrev=0,t}return i(t,e),t.prototype.Disable=function(){return this._onDisconnected(),e.prototype.Disable.call(this)},t.prototype.GetCallStats=function(){var e=new d.CallStatistics;return e.FillFromBandwidthSummaryStatistics(this.RoomStatistics.BandwidthVideo),S.default.IsNotEmpty(this.EndpointStatistic.LocalMicrophoneStats)&&e.FillFromLocalMicrophoneStatistics(this.EndpointStatistic.LocalMicrophoneStats[0]),S.default.IsNotEmpty(this.EndpointStatistic.LocalCameraStats)&&e.FillFromLocalVideoSourceStatistics(this.EndpointStatistic.LocalCameraStats[0]),this.RoomStatistics.ParticipantStats.forEach(function(t){var n,r=e.ParticipantStatistics.Get(t.Id);r.ParticipantIsActive=t.ParticipantIsActive,S.default.IsNotEmpty(t.RemoteMicrophoneStats)&&r.FillFromRemoteMicrophoneStatistics(t.RemoteMicrophoneStats[0]),S.default.IsNotEmpty(t.RemoteCameraStats)?n=t.RemoteCameraStats[0]:S.default.IsNotEmpty(t.RemoteWindowShareStats)&&(n=t.RemoteWindowShareStats[0]),n&&r.FillFromRemoteVideoSourceStatistics(n),r.SSRCs.Push(t.SSRCs)}),e},t.prototype.GetEndpointStatistics=function(){return this.EndpointStatistic},t.prototype.GetLocalCameraCodecName=function(){var e;if(this.EndpointStatistic.LocalCameraStats.length){var t=this.EndpointStatistic.LocalCameraStats[0].CodecName;if(t){var n=/[^\/]*$/.exec(t);n&&n.length&&(e=n[0])}}return e},t.prototype.GetUserStatistics=function(){return this.UserStatistic},t.prototype.Initialize=function(){var e=this;return this._initStatistics(),this._vidyoCore.EventDispatcher.releaseGroup(p.StatisticsControllerListeners),this._vidyoCore.EventDispatcher.on(o.Events.ConferenceJoined,p.StatisticsControllerListeners,function(){return e._onConferenceJoined()}),this._vidyoCore.EventDispatcher.on(a.Events.Disconnecting,p.StatisticsControllerListeners,function(){return e._onDisconnected()}),b.StatisticsExtention.Initialize(this._vidyoCore),Promise.resolve(void 0)},t.prototype.SetClientConnectionStats=function(e,t,n){this.UserStatistic.Host=e,this.UserStatistic.Port=t||0,this.UserStatistic.ServiceType=n||"",b.StatisticsExtention.catchConnectTime()},t.prototype._clearIntervals=function(){null!==this._intervalRefreshHandle&&(f.TimingProvider.ClearInterval(this._intervalRefreshHandle),this._intervalRefreshHandle=null),null!==this._intervalSendStatsHandle&&(f.TimingProvider.ClearInterval(this._intervalSendStatsHandle),this._intervalSendStatsHandle=null,f.TimingProvider.ClearInterval(this._intervalResourceManagerStatisticsMeasuring),this._intervalResourceManagerStatisticsMeasuring=null)},t.prototype._fillLocalCameraStatistics=function(){var e=this._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Camera,t=b.StatisticsExtention.getLocalCameraStatistics(e);this.EndpointStatistic.LocalCameraStats=[t]},t.prototype._fillLocalMicrophoneStatistics=function(){var e=this._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Microphone,t=b.StatisticsExtention.getLocalMicrophoneStatistics(e);this.EndpointStatistic.LocalMicrophoneStats=[t]},t.prototype._fillLocalRendererStats=function(){var e=this,t=this._vidyoCore.Controllers.RendererController.Views;this.EndpointStatistic.LocalRendererStats.length=0,Object.keys(t).forEach(function(n){var r=t[n],i=new d.LocalRendererStatistics;i.Id=r.viewId,i.Width=r.width||0,i.Height=r.height||0,e.EndpointStatistic.LocalRendererStats.push(i)})},t.prototype._fillLocalShareStatistics=function(){var e=b.StatisticsExtention.getLocalShareStats();this.EndpointStatistic.LocalWindowShareStats=e.window,this.EndpointStatistic.LocalMonitorStats=e.monitor},t.prototype._fillLocalSpeakerStatistics=function(){var e=this._vidyoCore.Controllers.DeviceController.GetSelectedDevices(),t=new d.LocalSpeakerStatistics,n=e.Speaker;t.Id=n.Id||"",t.Name=n.Name||"",this.EndpointStatistic.LocalSpeakerStats.length=0,this.EndpointStatistic.LocalSpeakerStats.push(t)},t.prototype._initStatistics=function(){this.TransportInformation=this.RoomStatistics.TransportInformation,this.UserStatistic.RoomStats=[this.RoomStatistics],this.EndpointStatistic.UserStats=[this.UserStatistic];var e=m.OperatingSystemInfoProvider.GetOSInfo();this.EndpointStatistic.OsName=e.OSName||"",this.EndpointStatistic.OsVersion=e.OSVersion||"",this.EndpointStatistic.UserAgent=m.OperatingSystemInfoProvider.UserAgent},t.prototype._onConferenceJoined=function(){var e=this;this._vidyoCore.Controllers.AdvancedSettingsController.DisableStats||(this._roomJoinedTimestamp=Date.now(),this.RoomStatistics.CallId=_.default.generateRandomString(),this._clearIntervals(),this._intervalRefreshHandle=f.TimingProvider.Interval(s.StatisticsRefreshInterval,function(){e._updateStatistics(),e._vidyoCore.EventDispatcher.emit(c.Events.Update)}),this._intervalSendStatsHandle=f.TimingProvider.Interval(s.SendClientStatisticsInterval,function(){return e._sendClientStatistic()}),this._intervalResourceManagerStatisticsMeasuring=f.TimingProvider.Interval(s.ResourceManagerStatisticsMeasuringInterval,function(){e._vidyoCore.Controllers.ResourcesManager.AccumulateStatistics(new h.EndpointStats(e.EndpointStatistic))}))},t.prototype._onDisconnected=function(){this._clearIntervals()},t.prototype._processLocalAudioTrackStats=function(e,t){var n=new d.LocalMicrophoneStatistics;n.FillFromRTCStats(t,e),this.EndpointStatistic.LocalMicrophoneStats=[n]},t.prototype._processLocalStreamStatistic=function(e,t){var n=this;t.trackIds.forEach(function(t){switch(e.get(t).kind){case"video":n._processLocalVideoTrackStats(e,t);break;case"audio":n._processLocalAudioTrackStats(e,t)}})},t.prototype._processLocalVideoTrackStats=function(e,t){var n=new d.LocalVideoSourceStatistics;n.FillFromRTCStats(t,e,this._lastStats),this.EndpointStatistic.LocalCameraStats=[n]},t.prototype._processParticipantAudioTrack=function(e,t,n){var r=new d.RemoteMicrophoneStatistics;r.FillFromRTCStats(t,e,this._lastStats),r.LocalSpeakerStreams=b.StatisticsExtention.getLocalSpeakerStreamStatistics();var i=y.AudioAnalyser.GetAudioStats(n.Id);r.FillFromAudioAnalyzerStats(i),n.RemoteMicrophoneStats=[r]},t.prototype._processParticipantStreamStatistic=function(e,t){var n=this,r=t.streamIdentifier,i=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(r);if(i&&i.IsComplete){var o=i.Id,a=this.RoomStatistics.ParticipantStats.find(function(e){return e.Id===o});a||((a=new d.ParticipantStatistic).Id=o,this.RoomStatistics.ParticipantStats.push(a)),a.Name=i.Name,a.ParticipantIsActive=i.Active,a.EmptyStats();var s=t.trackIds;i.IsRemote&&s.forEach(function(t){var r=e.get(t);if(r)switch(a.SSRCs.push(r.trackIdentifier),r.kind){case"video":n._processParticipantVideoTrack(e,t,a,i);break;case"audio":n._processParticipantAudioTrack(e,t,a)}})}var c=this._vidyoCore.Controllers.ParticipantController.GetParticipants();this.RoomStatistics.ParticipantStats=this.RoomStatistics.ParticipantStats.filter(function(e){return c.find(function(t){return t.Id===e.Id})})},t.prototype._processParticipantVideoTrack=function(e,t,n,r){var i=new d.RemoteVideoSourceStatistics;i.FillFromRTCStats(t,e,this._lastStats);var o,a=e.get(t),s=e.get("RTCInboundRTPVideoStream_"+a.trackIdentifier);s&&r&&(o=r.GetSourceBySSrc(""+s.ssrc)),o&&o.Type===v.SourceMediaType.Application?n.RemoteWindowShareStats=[i]:n.RemoteCameraStats=[i]},t.prototype._processSafariLocalAudioTrackStats=function(e,t,n){var r=new d.LocalMicrophoneStatistics,i=e.get("RTCOutboundRTPAudioStream_"+n);i&&(r.BytesSentUdp=i.bytesSent||0),e.forEach(function(e){"track"===e.type&&e.trackIdentifier===t&&(r.AudioLevel=e.audioLevel||0)}),this.EndpointStatistic.LocalMicrophoneStats=[r]},t.prototype._processSafariLocalVideoTrackStats=function(e,t,n){var r=this,i=new d.LocalVideoSourceStatistics,o=e.get("RTCOutboundRTPVideoStream_"+n);o&&(i.BytesSentUdp=o.bytesSent||0,i.FirsReceived=o.firCount||0,i.NacksReceived=o.nackCount||0,i.PlisReceived=o.pliCount||0,i.VideoFramesEncoded=o.framesEncoded||0),e.forEach(function(e){if("track"===e.type&&e.trackIdentifier===t){i.Height=e.frameHeight||0,i.Width=e.frameWidth||0,i.TotalFrames=e.framesSent||0;var n=r._lastStats&&r._lastStats.get(e.id);n&&i._calculateFrameRateSent(e,n)}}),this.EndpointStatistic.LocalCameraStats=[i]},t.prototype._processSafariParticipantAudioTrack=function(e,t,n){var r=new d.RemoteMicrophoneStatistics,i=e.get("RTCInboundRTPAudioStream_"+t.Ssrc);if(i){r.ReceiveNetworkJitter=i.jitter||0,r.AudioBytesReceived=i.bytesReceived||0;var o=this._lastStats&&this._lastStats.get("RTCInboundRTPAudioStream_"+t.Ssrc);o&&r._calculateBitrate(i,o)}r.LocalSpeakerStreams=b.StatisticsExtention.getLocalSpeakerStreamStatistics();var a=y.AudioAnalyser.GetAudioStats(n.Id);r.FillFromAudioAnalyzerStats(a),n.RemoteMicrophoneStats=[r]},t.prototype._processSafariParticipantStreamStatistic=function(e,t){var n=this,r=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(t);if(r&&r.IsComplete){var i=r.Id,o=this.RoomStatistics.ParticipantStats.find(function(e){return e.Id===i});o||((o=new d.ParticipantStatistic).Id=i,this.RoomStatistics.ParticipantStats.push(o)),o.Name=r.Name,o.ParticipantIsActive=r.Active,o.EmptyStats(),r.IsRemote&&r.Sources.forEach(function(t){switch(o.SSRCs.push(t.Ssrc),t.Type){case v.SourceMediaType.Video:case v.SourceMediaType.Application:n._processSafariParticipantVideoTrack(e,t,o,r);break;case v.SourceMediaType.Audio:n._processSafariParticipantAudioTrack(e,t,o)}})}var a=this._vidyoCore.Controllers.ParticipantController.GetParticipants();this.RoomStatistics.ParticipantStats=this.RoomStatistics.ParticipantStats.filter(function(e){return a.find(function(t){return t.Id===e.Id})})},t.prototype._processSafariParticipantVideoTrack=function(e,t,n,r){var i=new d.RemoteVideoSourceStatistics,o=e.get("RTCInboundRTPVideoStream_"+t.Ssrc);if(o){i.VideoFrameRateDecoded=o.framesDecoded||0,i.ReceiveNetworkPacketsLost=o.packetsLost||0,i.VideoPacketsReceived=o.packetsReceived||0,i.CodecFir=o.firCount||0,i.CodecNacks=o.nackCount||0;var a=this._lastStats&&this._lastStats.get("RTCInboundRTPVideoStream_"+t.Ssrc);a&&(i._calculateFPS(o,a),i._calculateBitrate(o,a))}t&&t.Type===v.SourceMediaType.Application?n.RemoteWindowShareStats=[i]:n.RemoteCameraStats=[i]},t.prototype._processTransportStatistic=function(e,t,n){var r=new d.MediaConnectionTransportInformation;r.FillFromRTCStats(t.selectedCandidatePairId,e);var i=e.get(t.selectedCandidatePairId);if(i){var o=e.get(i.localCandidateId);o&&"tcp"===o.protocol?(this.EndpointStatistic.BytesReceivedTcp+=i.bytesReceived||0,this.EndpointStatistic.BytesSentTcp+=i.bytesSent||0):(this.EndpointStatistic.BytesReceivedUdp+=i.bytesReceived||0,this.EndpointStatistic.BytesSentUdp+=i.bytesSent||0),this.RoomStatistics.ReceiveBitRateAvailable=i.availableIncomingBitrate||0,this.RoomStatistics.SendBitRateAvailable=i.availableOutgoingBitrate||0,this._bytesSent+=i.bytesSent||0,this._bytesReceived+=i.bytesReceived||0,this._maxSendBitRateAvailable=Math.max(this._maxSendBitRateAvailable,this.RoomStatistics.SendBitRateAvailable),this.RoomStatistics.AvailableEncodeBwPercent=Math.round(this.RoomStatistics.SendBitRateAvailable*this._maxPercent/this._maxSendBitRateAvailable),this._maxReceiveBitRateAvailable=Math.max(this._maxReceiveBitRateAvailable,this.RoomStatistics.ReceiveBitRateAvailable),this.RoomStatistics.AvailableDecodeBwPercent=Math.round(this.RoomStatistics.ReceiveBitRateAvailable*this._maxPercent/this._maxReceiveBitRateAvailable),this._vidyoCore.Controllers.LogController.LogDebug("StatisticController._processTransportStatistic  SendBitRateAvailable="+this.RoomStatistics.SendBitRateAvailable),this._vidyoCore.Controllers.LogController.LogDebug("StatisticController._processTransportStatistic  _maxSendBitRateAvailable="+this._maxSendBitRateAvailable),this._vidyoCore.Controllers.LogController.LogDebug("StatisticController._processTransportStatistic  AvailableEncodeBwPercent="+this.RoomStatistics.AvailableEncodeBwPercent),this._vidyoCore.Controllers.LogController.LogDebug("StatisticController._processTransportStatistic  ReceiveBitRateAvailable="+this.RoomStatistics.ReceiveBitRateAvailable),this._vidyoCore.Controllers.LogController.LogDebug("StatisticController._processTransportStatistic  _maxReceiveBitRateAvailable="+this._maxReceiveBitRateAvailable),this._vidyoCore.Controllers.LogController.LogDebug("StatisticController._processTransportStatistic  AvailableDecodeBwPercent="+this.RoomStatistics.AvailableDecodeBwPercent)}this.TransportInformation.push(r)},t.prototype._sendClientStatistic=function(){this.EndpointStatistic.MaxBitRate=this._vidyoCore.Controllers.LocalStreamController.MaxBitrate||0,this.EndpointStatistic.TimeStamp=b.StatisticsExtention.getISODate(new Date),this.EndpointStatistic.RoomEnterTimeConsumedMs=Date.now()-this._roomJoinedTimestamp,this.RoomStatistics.ReflectorId=this._vidyoCore.Controllers.ConnectionController.Reflector(),this.RoomStatistics.ConferenceId=this._vidyoCore.Controllers.RoomController.GetConference(),this.RoomStatistics.Id=this._vidyoCore.Controllers.RoomController.RoomJid(),this._fillLocalCameraStatistics(),this._fillLocalShareStatistics(),this._fillLocalMicrophoneStatistics(),this._fillLocalSpeakerStatistics(),this._fillLocalRendererStats();var e=new h.EndpointStats(this.EndpointStatistic);this._vidyoCore.Controllers.ConnectionController.SendClientStats(JSON.stringify(e)),b.StatisticsExtention.supplementClientStatistics()},t.prototype._updateSafariStatistic=function(e){var t=this;e.forEach(function(n,r){switch(n.type){case"candidate-pair":"succeeded"===n.state&&t._processTransportStatistic(e,{selectedCandidatePairId:r},r)}}),this._vidyoCore.Controllers.ParticipantController.GetParticipants({Origin:g.ParticipantOrigin.Remote}).forEach(function(n){t._processSafariParticipantStreamStatistic(e,n.Id)});var n=this._vidyoCore.Controllers.LocalStreamController.GetTransmittedStream().getTracks(),r=this._vidyoCore.Controllers.TransmittedStreamController._tracksSrrcsMap;n.forEach(function(n){var i=Object.entries(r).find(function(e){return e[1]===n.id});if(i)switch(n.kind){case"video":t._processSafariLocalVideoTrackStats(e,n.id,i[0]);break;case"audio":t._processSafariLocalAudioTrackStats(e,n.id,i[0])}})},t.prototype._updateStatistics=function(){var e=this,t=this._vidyoCore.Controllers.ConnectionController.Session,n=0;t&&(this.TransportInformation.length=0,this.EndpointStatistic.EmptyBytesCountStatistic(),t.GetStats().then(function(t){if(e._bytesSent=0,e._bytesReceived=0,m.OperatingSystemInfoProvider.IsSafari())try{e._updateSafariStatistic(t),n=Array.from(t)[0][1].timestamp}catch(e){}else t.forEach(function(r,i){switch(r.type){case"stream":r.trackIds&&r.trackIds.length&&r.trackIds.some(function(e){return e.match(/.+_sender_.+/)})||i.match(/.+_local_.+/)?e._processLocalStreamStatistic(t,r):e._processParticipantStreamStatistic(t,r);break;case"transport":n=r.timestamp,e._processTransportStatistic(t,r,i)}});e.RoomStatistics.SendBitRateTotal=Math.max(0,Math.floor(l.BitsInByteValue*(e._bytesSent-e._sendBytesPrev)/(n-e._timestampPrev)*l.SecToMsCoefficient)),e.RoomStatistics.ReceiveBitRateTotal=Math.max(0,Math.floor(l.BitsInByteValue*(e._bytesReceived-e._receiveBytesPrev)/(n-e._timestampPrev)*l.SecToMsCoefficient)),e._timestampPrev=n,e._sendBytesPrev=e._bytesSent,e._receiveBytesPrev=e._bytesReceived,e._lastStats=t}))},t}(u.BaseController);n.StatisticsController=C},{"../../vidyo_simple_api/stats/Stats":561,"../events/ConferenceEvents":396,"../events/ConnectionEvents":397,"../events/EventDispatcher":399,"../events/StatisticsEvents":407,"../models/Participant":413,"../models/Source":418,"../models/statistics/Statistics":451,"../utils/AudioAnalyser":456,"../utils/Constants":461,"../utils/ObjectUtils":471,"../utils/OperatingSystemInfoProvider":472,"../utils/StatisticsExtension":478,"../utils/StringUtils":479,"../utils/TimingProvider":480,"./BaseController":366}],388:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(n,"__esModule",{value:!0});var a,s=e("../../events/CallStateEvents"),c=e("../../utils/Constants"),u=e("../../events/DeviceEvents"),l=e("../../events/StreamEvents"),d=e("../../utils/Messages"),p=e("../BaseController"),f=e("../../events/EventDispatcher"),h=e("../../models/stream/ReadOnlyMediaStream"),m=e("../../utils/UserMediaProvider"),v=e("es6-promise"),y=e("./StreamEventHelper"),g=e("./TrackMetaDataProvider"),S=e("async"),_=e("../../utils/StringUtils"),b=e("../../../vidyo_simple_api/Permission"),C=e("../../events/ConnectionEvents"),w=e("../../models/VideoResolution");!function(e){e.AudioContent="AudioContent",e.Camera="Camera",e.Microphone="Microphone",e.Monitor="Monitor",e.VideoContent="VideoContent",e.WindowShare="WindowShare"}(a||(a={}));var E=function(){function e(e){this.bandwidth=0,this.lastBandwidth=0,this.locked=!1,this.constraints=e,this.minConstraints={width:c.MinimumLocalStreamWidth,height:c.MinimumLocalStreamHeight}}return Object.defineProperty(e.prototype,"MaxConstraints",{set:function(e){if(e){for(var t in this.constraints=e,e)this.minConstraints[t]&&(this.constraints[t]=Math.max(this.constraints[t],this.minConstraints[t]));this.maxConstraints=this.constraints}else this.maxConstraints=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurrentConstraints",{get:function(){var e=o({},this.constraints),t=this.maxConstraints;if(t)for(var n in t)e[n]>t[n]&&(e[n]=t[n]);return e},enumerable:!0,configurable:!0}),e.prototype.MaxPreferredBandwidth=function(e){var t=this.CurrentConstraints,n=t.width||c.DefaultLocalStreamWidth,r=t.height||c.DefaultLocalStreamHeight;return w.CalculateSendBitrate(n,r,e)},e}(),R=function(e){function t(t){var n=e.call(this,t)||this;return n._constraintsMap={Camera:new E({width:c.DefaultLocalStreamWidth,height:c.DefaultLocalStreamHeight,frameRate:c.DefaultLocalStreamFrameRate}),Monitor:new E({width:c.DefaultLocalShareStreamWidth,height:c.DefaultLocalShareStreamHeight,frameRate:c.DefaultLocalShareStreamFrameRate}),VideoContentShare:new E({width:c.DefaultLocalStreamWidth,height:c.DefaultLocalStreamHeight,frameRate:c.DefaultLocalStreamFrameRate}),WindowShare:new E({width:c.DefaultLocalShareStreamWidth,height:c.DefaultLocalShareStreamHeight,frameRate:c.DefaultLocalShareStreamFrameRate})},n._hasMonitorShare=!1,n._hasWindowShare=!1,n._maxLocalStreamBandwidth=null,n._trackIndex={AudioContent:{},Camera:{},Microphone:{},Monitor:{},VideoContent:{},WindowShare:{}},n._transmittedStream=new MediaStream,n._userMediaProvider=new m.UserMediaProvider,n._localStreamsMap={},n._localStreamsMap.AudioContent=new MediaStream,n._localStreamsMap.Camera=new MediaStream,n._localStreamsMap.Microphone=n._localStreamsMap.Camera,n._localStreamsMap.Monitor=new MediaStream,n._localStreamsMap.VideoContent=new MediaStream,n._localStreamsMap.WindowShare=new MediaStream,n._mediaActionsQueue=S.queue(function(e,t){e().then(t).catch(t)}),n}return i(t,e),Object.defineProperty(t.prototype,"AudioVideoStream",{get:function(){return new h.ReadOnlyMediaStream(this._localStreamsMap[a.Camera])},enumerable:!0,configurable:!0}),t.prototype.Disable=function(){return this.StopMedia(),e.prototype.Disable.call(this)},t.prototype.GetApplicationStreamById=function(e){return this._localStreamsMap[a.Monitor].id===e?this.MonitorShareStream:this._localStreamsMap[a.WindowShare].id===e?this.WindowShareStream:null},t.prototype.GetApplicationStreams=function(){var e=[];return this._hasMonitorShare&&e.push(this.MonitorShareStream),this._hasWindowShare&&e.push(this.WindowShareStream),e},t.prototype.GetLocalStreamBandwidthByTrackId=function(e){var t=this._getLocalStreamConstraintsByTrack(e);if(t)return t.bandwidth},t.prototype.GetLocalStreamConstraintsByTrackId=function(e){var t=this._getLocalStreamConstraintsByTrack(e);if(t)return t.constraints},t.prototype.GetLocalStreamVideoConstraints=function(){return this._constraintsMap.Camera.constraints},t.prototype.GetOutgoingBandwidth=function(){var e=0;return this._vidyoCore.Controllers.DeviceController.GetVideoMuteState()||(e+=this._constraintsMap.Camera.bandwidth),this._hasWindowShare&&(e+=this._constraintsMap.WindowShare.bandwidth),this._hasMonitorShare&&(e+=this._constraintsMap.Monitor.bandwidth),"boolean"!=typeof this._vidyoCore.Controllers.DeviceController.GetSelectedDevices().VideoContent&&(e+=this._constraintsMap.VideoContentShare.bandwidth),e},t.prototype.GetStreamTrackMediaType=function(e){var t;return((t={})[this._localStreamsMap.Camera.id]=g.MediaTrackType.Video,t[this._localStreamsMap.Monitor.id]=g.MediaTrackType.Application,t[this._localStreamsMap.VideoContent.id]=g.MediaTrackType.Application,t[this._localStreamsMap.WindowShare.id]=g.MediaTrackType.Application,t)[e]||g.UnknownMediaTrackType},t.prototype.GetTrackMediaProperties=function(e){var t=this._getTrackTypes(e),n=t.trackMediaType,r=!1,i=!1;switch(t.trackType){case a.Microphone:i=this._vidyoCore.Controllers.DeviceController.GetAudioMuteState();break;case a.AudioContent:case a.VideoContent:r=!0}return{isContentShare:r,mediaType:n,muted:i}},t.prototype.GetTrackMediaType=function(e){return this._getTrackTypes(e).trackMediaType},t.prototype.GetTransmittedStream=function(){return this._transmittedStream},t.prototype.Initialize=function(){var t=this;return this._streamEventHelper=new y.StreamEventHelper(this._vidyoCore.EventDispatcher),this._vidyoCore.EventDispatcher.releaseGroup(f.LocalStreamControllerListeners),this._vidyoCore.EventDispatcher.on(s.Events.MediaStateTransition,f.LocalStreamControllerListeners,function(e){return t._mediaStateTransition(e)}),this._vidyoCore.EventDispatcher.on(u.Events.MicrophoneMuteStateChanged,f.LocalStreamControllerListeners,function(){return t._setAudioMutedState()}),this._vidyoCore.EventDispatcher.on(u.Events.MicrophoneChanged,f.LocalStreamControllerListeners,function(){return t.StartOrStopAudio()}),this._vidyoCore.EventDispatcher.on(u.Events.CameraSettingsChanged,f.LocalStreamControllerListeners,function(e){return t.StartOrStopVideo()}),this._vidyoCore.EventDispatcher.on(u.Events.VideoContentDeviceChanged,f.LocalStreamControllerListeners,function(){return t._startOrStopVideoContentShare()}),this._vidyoCore.EventDispatcher.on(u.Events.AudioContentDeviceChanged,f.LocalStreamControllerListeners,function(){return t._startOrStopAudioContentShare()}),this._vidyoCore.EventDispatcher.on(u.Events.CameraMaxConstraintChanged,f.LocalStreamControllerListeners,function(){return t._setVideoStreamMaxConstraints()}),this._vidyoCore.EventDispatcher.on(C.Events.MediaSessionStarted,f.LocalStreamControllerListeners,function(e){return t._onMediaSessionStarted(e)}),this._vidyoCore.EventDispatcher.on(C.Events.Disconnected,f.LocalStreamControllerListeners,function(){return t._onCallDisconnected()}),e.prototype.Initialize.call(this).then(function(){return t._userMediaProvider.Initialize().then(function(e){t._vidyoCore.Controllers.PermissionController.TrySubscribePermission(b.PermissionType.camera,e),t._vidyoCore.Controllers.PermissionController.TrySubscribePermission(b.PermissionType.microphone,e)})})},t.prototype.IsTransmittedStream=function(e){return this._transmittedStream.id===e.id},Object.defineProperty(t.prototype,"MonitorShareStream",{get:function(){return new h.ReadOnlyMediaStream(this._localStreamsMap[a.Monitor])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MaxBitrate",{get:function(){return this._maxLocalStreamBandwidth},enumerable:!0,configurable:!0}),t.prototype.SetMaxBitrate=function(e){this._maxLocalStreamBandwidth=e,this.UpdateLocalSendBandwidth()},t.prototype.StartMedia=function(){var e=this,t=[],n=!!this._trackIndex.Microphone[this._localStreamsMap[a.Camera].id],r=!!this._trackIndex.Camera[this._localStreamsMap[a.Camera].id],i=!!this._trackIndex.WindowShare[this._localStreamsMap[a.WindowShare].id],o=!!this._trackIndex.WindowShare[this._localStreamsMap[a.Monitor].id];if(n||t.push(this.StartOrStopAudio()),r||t.push(this.StartOrStopVideo()),!(o||i||n||r)){t=t.map(function(e){return e.catch(function(){return v.Promise.resolve()})}),v.Promise.all(t).then(function(){e._streamEventHelper.AttachStreamEvents(e.AudioVideoStream),e._streamEventHelper.AttachStreamEvents(e.WindowShareStream),e._streamEventHelper.AttachStreamEvents(e.MonitorShareStream),e._vidyoCore.EventDispatcher.emit(l.Events.LocalStreamReady)})}},t.prototype.StartMonitorShare=function(e){var t=this;return this._hasMonitorShare&&this.StopMonitorShare(),this._pushToAsyncQueue(function(){return t._startMonitorShare(e)})},t.prototype.StartOrStopAudio=function(){return this._vidyoCore.Controllers.DeviceController.IsMicrophoneSelected()?this._startAudio():this.StopAudio()},t.prototype.StartOrStopVideo=function(){return this._vidyoCore.Controllers.DeviceController.GetVideoMuteState()?this.StopVideo():this._startVideo()},t.prototype.StartWindowShare=function(e){var t=this;return this._hasWindowShare&&this.StopWindowShare(),this._pushToAsyncQueue(function(){return t._startWindowShare(e)})},t.prototype.StopAudio=function(){var e=this;return this._pushToAsyncQueue(function(){return e._removeTrack(a.Microphone),v.Promise.resolve()})},t.prototype.StopAudioContentShare=function(){var e=this;return this._pushToAsyncQueue(function(){return e._removeTrack(a.AudioContent),v.Promise.resolve()})},t.prototype.StopMedia=function(){this.StopAudio(),this.StopAudioContentShare(),this.StopVideo(),this.StopVideoContentShare(),this.StopWindowShare(),this.StopMonitorShare()},t.prototype.StopMonitorShare=function(){var e=this;return this._pushToAsyncQueue(function(){e._hasMonitorShare=!1;var t=e._trackIndex[a.Monitor][e._localStreamsMap[a.Monitor].id];return e._removeTrack(a.Monitor),t&&e._vidyoCore.EventDispatcher.emit(l.Events.LocalMonitorDeselected),v.Promise.resolve()})},t.prototype.StopVideo=function(){var e=this;return this._pushToAsyncQueue(function(){return e._removeTrack(a.Camera),v.Promise.resolve()})},t.prototype.StopVideoContentShare=function(){var e=this;return this._pushToAsyncQueue(function(){return e._removeTrack(a.VideoContent),v.Promise.resolve()})},t.prototype.StopWindowShare=function(){var e=this;return this._pushToAsyncQueue(function(){e._hasWindowShare=!1;var t=e._trackIndex[a.WindowShare][e._localStreamsMap[a.WindowShare].id];return e._removeTrack(a.WindowShare),t&&e._vidyoCore.EventDispatcher.emit(l.Events.LocalWindowShareDeselected),v.Promise.resolve()})},t.prototype.UpdateLocalSendBandwidth=function(e){this._constraintsMap.Camera.CurrentConstraints;var t=this._constraintsMap.Camera.MaxPreferredBandwidth(this._vidyoCore.Controllers.StatisticsController.GetLocalCameraCodecName()),n=e||this._constraintsMap.Camera.lastBandwidth||t;n&&(this._maxLocalStreamBandwidth&&(n=Math.min(this._maxLocalStreamBandwidth,n)),t&&(n=Math.min(n,t)),this._constraintsMap.Camera.lastBandwidth=n,this._vidyoCore.XmppProvider.ApplyLocalBandwidthLimit(n))},t.prototype.UpdateTrackBandwidth=function(e,t){var n=this._getLocalStreamConstraintsByTrack(t);n&&(n.bandwidth=e)},t.prototype.UpdateTrackConstraints=function(e,t){var n=this._getLocalStreamConstraintsByTrack(t),r=this._getLocalStreamTrackTypeByTrack(t);if(n&&r){if(r!==a.Camera)return;Object.assign(n.constraints,e),this._videoStreamConstraintsChanged(n,this._trackIndex[r][this._transmittedStream.id]),this._videoStreamConstraintsChanged(this._constraintsMap.Camera,this._trackIndex[r][this._localStreamsMap[r].id])}},Object.defineProperty(t.prototype,"WindowShareStream",{get:function(){return new h.ReadOnlyMediaStream(this._localStreamsMap[a.WindowShare])},enumerable:!0,configurable:!0}),t.prototype._addStreamTrack=function(e,t){this._addTrackToStream(t,this._localStreamsMap[t],e),this._addTrackToStream(t,this._transmittedStream,e.clone())},t.prototype._addTrackToStream=function(e,t,n){t.addTrack(n),t.dispatchEvent(new Event("addtrack")),this._trackIndex[e][t.id]=n},t.prototype._getLocalStreamConstraintsByTrack=function(e){this._transmittedStream.id;var t,n=this._getLocalStreamTrackTypeByTrack(e);return n&&(t=this._constraintsMap[n]),t},t.prototype._getLocalStreamTrackTypeByTrack=function(e){for(var t=this._transmittedStream.id,n=0,r=[a.Camera,a.Monitor,a.WindowShare];n<r.length;n++){var i=r[n],o=this._trackIndex[i][t];if(o&&o.id===e)return i}},t.prototype._getTrackTypes=function(e){for(var t,n=g.UnknownMediaTrackType,r=this._transmittedStream.id,i=((t={})[a.AudioContent]=g.MediaTrackType.Audio,t[a.Camera]=g.MediaTrackType.Video,t[a.Monitor]=g.MediaTrackType.Application,t[a.VideoContent]=g.MediaTrackType.Application,t[a.WindowShare]=g.MediaTrackType.Application,t[a.Microphone]=g.MediaTrackType.Audio,t),o=0,s=Object.entries(i);o<s.length;o++){var c=s[o],u=c[0],l=c[1],d=this._trackIndex[u][r];if(d&&d.id===e)return{trackType:u,trackMediaType:l}}return{trackMediaType:n}},t.prototype._mediaStateTransition=function(e){e.ShouldRenderMedia?this.StartMedia():this.StopMedia()},t.prototype._onCallDisconnected=function(){this.StopWindowShare(),this.StopMonitorShare()},t.prototype._onMediaSessionStarted=function(e){for(var t in this._constraintsMap)this._constraintsMap.hasOwnProperty(t)&&(this._constraintsMap[t].bandwidth=0)},t.prototype._pushToAsyncQueue=function(e){var t=this;return new v.Promise(function(n,r){t._mediaActionsQueue.push(e,function(e){e?r(e):n()})})},t.prototype._removeTrack=function(e){this._removeTrackFromStream(e,this._localStreamsMap[e]),this._removeTrackFromStream(e,this._transmittedStream)},t.prototype._removeTrackFromStream=function(e,t){var n=this._trackIndex[e][t.id];n&&(n.stop(),t.removeTrack(n),t.dispatchEvent(new Event("removetrack")),delete this._trackIndex[e][t.id])},t.prototype._setAudioMutedState=function(){this._vidyoCore.XmppProvider.MuteAudio(this._vidyoCore.Controllers.DeviceController.GetAudioMuteState()),this._vidyoCore.EventDispatcher.emit(l.Events.TracksChanged,this.AudioVideoStream.Id)},t.prototype._setVideoStreamMaxConstraints=function(){var e=this._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Camera;this._constraintsMap.Camera.MaxConstraints="boolean"!=typeof e?e.MaxConstraints:void 0,this._videoTransmittedStreamConstraintsChanged(),this._videoLocalStreamConstraintsChanged()},t.prototype._startAudio=function(){var e=this;return this._pushToAsyncQueue(function(){var t=e._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Microphone;return e._startTrack(a.Microphone,function(){return e._userMediaProvider.GetAudioTrack(t||!0)})})},t.prototype._startAudioContentShare=function(e){var t=this;return this._startTrack(a.AudioContent,function(){return t._userMediaProvider.GetAudioTrack(e)}).then(function(){var e=t._trackIndex[a.AudioContent][t._localStreamsMap[a.AudioContent].id];e&&e.addEventListener("ended",function(){t.StopAudioContentShare()})})},t.prototype._startMonitorShare=function(e){var t=this;return this._startTrack(a.Monitor,function(){return t._userMediaProvider.GetWindowShareTrack(e)}).then(function(){var e=t._trackIndex[a.Monitor][t._localStreamsMap[a.Monitor].id];e&&(t._hasMonitorShare=!0,t._vidyoCore.EventDispatcher.emit(l.Events.LocalMonitorSelected),e.addEventListener("ended",function(){t.StopMonitorShare()}))})},t.prototype._startOrStopAudioContentShare=function(){var e=this._vidyoCore.Controllers.DeviceController.GetSelectedDevices().AudioContent;"boolean"!=typeof e?this._startAudioContentShare(e):this.StopAudioContentShare()},t.prototype._startOrStopVideoContentShare=function(){var e=this._vidyoCore.Controllers.DeviceController.GetSelectedDevices().VideoContent;"boolean"!=typeof e?this._startVideoContentShare(e):this.StopVideoContentShare()},t.prototype._startTrack=function(e,t){var n=this,r=this._vidyoCore.Controllers.CallStateController.MediaState;if(r.ShouldRenderMedia)return this._removeTrack(e),t().then(function(t){return n._addStreamTrack(t,e),v.Promise.resolve()}).catch(function(e){return v.Promise.reject(e)});var i={mediaType:e,mediaState:r.toString()},o=_.default.Format(d.LocalMediaOperationNotPermitted,i);return v.Promise.reject(o)},t.prototype._startVideo=function(){var e=this;return this._pushToAsyncQueue(function(){var t=e._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Camera;e._constraintsMap.Camera.MaxConstraints="boolean"!=typeof t?t.MaxConstraints:void 0;var n=e._constraintsMap.Camera.CurrentConstraints;return e._startTrack(a.Camera,function(){return e._userMediaProvider.GetVideoTrack(t||!0,n)})})},t.prototype._startVideoContentShare=function(e){var t=this,n=this._constraintsMap.VideoContentShare.CurrentConstraints;return this._startTrack(a.VideoContent,function(){return t._userMediaProvider.GetVideoTrack(e,n)}).then(function(){var e=t._trackIndex[a.VideoContent][t._localStreamsMap[a.VideoContent].id];e&&e.addEventListener("ended",function(){t.StopVideoContentShare()})})},t.prototype._startWindowShare=function(e){var t=this;return this._startTrack(a.WindowShare,function(){return t._userMediaProvider.GetWindowShareTrack(e)}).then(function(){var e=t._trackIndex[a.WindowShare][t._localStreamsMap[a.WindowShare].id];e&&(t._hasWindowShare=!0,t._vidyoCore.EventDispatcher.emit(l.Events.LocalWindowShareSelected),e.addEventListener("ended",function(){t.StopWindowShare()}))})},t.prototype._videoLocalStreamConstraintsChanged=function(){var e=this._trackIndex[a.Camera][this._localStreamsMap[a.Camera].id];this._videoStreamConstraintsChanged(this._constraintsMap.Camera,e)},t.prototype._videoLockConstraints=function(e){this._constraintsMap.Camera.locked=e},t.prototype._videoStreamConstraintsChanged=function(e,t){if(!0===e.locked)return v.Promise.resolve();if(t){var n=e.CurrentConstraints,r={width:{exact:n.width},height:{exact:n.height},frameRate:{ideal:n.frameRate}};return new v.Promise(function(e,n){t.applyConstraints(r).then(function(){e(r)}).catch(function(e){n(r)})})}return v.Promise.resolve()},t.prototype._videoTransmittedStreamConstraintsChanged=function(){var e=this,t=this._trackIndex[a.Camera][this._transmittedStream.id];this._videoStreamConstraintsChanged(this._constraintsMap.Camera,t).then(function(t){t&&(e.UpdateLocalSendBandwidth(),e._vidyoCore.Controllers.LogController.LogInfo(new Date+" :\n        LocalStreamController: transmitted stream video constraints changed. "+JSON.stringify(t)))}).catch(function(t){e._vidyoCore.Controllers.LogController.LogError(new Date+" :\n              LocalStreamController: transmitted stream video constraints NOT changed. "+JSON.stringify(t)+"\n              - trying to restart video with new constraints"),e.StopVideo(),e.StartOrStopVideo()})},t}(p.BaseController);n.LocalStreamController=R},{"../../../vidyo_simple_api/Permission":534,"../../events/CallStateEvents":395,"../../events/ConnectionEvents":397,"../../events/DeviceEvents":398,"../../events/EventDispatcher":399,"../../events/StreamEvents":408,"../../models/VideoResolution":420,"../../models/stream/ReadOnlyMediaStream":453,"../../utils/Constants":461,"../../utils/Messages":468,"../../utils/StringUtils":479,"../../utils/UserMediaProvider":482,"../BaseController":366,"./StreamEventHelper":390,"./TrackMetaDataProvider":391,async:2,"es6-promise":43}],389:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../events/ConferenceEvents"),a=e("../../events/ConnectionEvents"),s=e("../../utils/Messages"),c=e("../../events/StreamEvents"),u=e("../BaseController"),l=e("../../models/stream/ReadOnlyMediaStream"),d=e("../../events/EventDispatcher"),p=e("./StreamEventHelper"),f=e("./TrackMetaDataProvider"),h=e("../../models/device/Microphone"),m=e("../../models/device/Camera"),v=e("../../models/device/WindowShare"),y=e("../../utils/StringUtils"),g=e("../../events/ParticipantEvents"),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._participantStreamsData={},t._participantStreamsMap={},t._ssrcToSafariGeneratedIdMap={},t._streams={},t._trackMetaData={},t}return i(t,e),t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.GetNetworkStream=function(e){var t=this.TryGetNetworkStream(e);if(t)return t;throw new Error(y.default.Format(s.NoSuchStream,{id:e}))},t.prototype.GetParticipantApplicationStreams=function(e){var t=[];return this._participantStreamsData[e]&&(t=Object.values(this._participantStreamsData[e].Application).map(function(e){return new l.ReadOnlyMediaStream(e.stream)})),t},t.prototype.GetTrackMediaType=function(e){var t,n=this.TryGetParticipantStream(e);if(n){var r=n.GetVideoTracks()[0];r&&(t=this._trackMetaData[r.Id])}return t||"unknown"},t.prototype.Initialize=function(){var t=this;return this._streamEventHelper=new p.StreamEventHelper(this._vidyoCore.EventDispatcher),this._vidyoCore.EventDispatcher.releaseGroup(d.RemoteStreamControllerListeners),this._vidyoCore.EventDispatcher.on(a.Events.JingleRemoteStreamAdded,d.RemoteStreamControllerListeners,function(e){var n=e.stream;return t._onRemoteStreamAdded(n)}),this._vidyoCore.EventDispatcher.on(a.Events.JingleRemoteStreamRemoved,d.RemoteStreamControllerListeners,function(e){var n=e.stream;return t._onRemoteStreamRemoved(n)}),this._vidyoCore.EventDispatcher.on(o.Events.SourceDetected,d.RemoteStreamControllerListeners,function(e){return t._onRemoteTrackMetaData(e)}),this._vidyoCore.EventDispatcher.on(o.Events.SourceRemoved,d.RemoteStreamControllerListeners,function(e){return t._onRemoteTrackRemoved(e)}),this._vidyoCore.EventDispatcher.on(g.Events.ParticipantLeft,function(e){return t._onParticipantLeave(e.participant)}),e.prototype.Initialize.call(this)},t.prototype.TryGetNetworkStream=function(e){return this._streams[e]},t.prototype.TryGetParticipantAudioStream=function(e){var t;return this._participantStreamsData[e]&&(t=new l.ReadOnlyMediaStream(this._participantStreamsData[e].Audio.stream)),t},t.prototype.TryGetParticipantRemoteAudioDevice=function(e){var t=null;return this._participantStreamsData[e]&&(t=this._participantStreamsData[e].Audio.device),t},t.prototype.TryGetParticipantStream=function(e){var t;return this._participantStreamsMap[e]&&(t=new l.ReadOnlyMediaStream(this._participantStreamsMap[e])),t},t.prototype.TryGetParticipantStreamBySsrc=function(e,t){var n;if(this._participantStreamsData[e]){var r=this._participantStreamsData[e];r.SourceToStreamMap[t]&&(n=new l.ReadOnlyMediaStream(r.SourceToStreamMap[t]))}return n},t.prototype.TryGetParticipantVideoStream=function(e){var t;return this._participantStreamsData[e]&&(t=new l.ReadOnlyMediaStream(this._participantStreamsData[e].Video.stream)),t},t.prototype._checkAndAddParticipantStreamsDataTrack=function(e,t){var n=this;t.getTracks().forEach(function(t){var r=n._trackMetaData[t.id];if(void 0===r){var i=n._vidyoCore.Controllers.ConnectionController.Session.GetReceiverSsrcByTrackId(t.id);i&&n._trackMetaData[i]?(r=n._trackMetaData[t.id]=n._trackMetaData[i],n._ssrcToSafariGeneratedIdMap[i]=t.id):"audio"===t.kind?r=n._trackMetaData[t.id]=f.MediaTrackType.Audio:"video"===t.kind&&(r=n._trackMetaData[t.id]=f.MediaTrackType.Video)}switch(r){case f.MediaTrackType.Audio:if(!e.MediaTrackMap[t.id]&&!t.muted){var o=t.clone();n._trackMetaData[o.id]=r,e.MediaTrackMap[t.id]=o,e.Audio.stream.addTrack(o),e.Audio.device=new h.Microphone(t.label,t.id),e.SourceToStreamMap[e.Audio.device.Id]=e.Audio.stream,e.Participant.IsRemote&&n._vidyoCore.EventDispatcher.emitAsync(c.Events.RemoteMicrophoneAdded,{microphone:e.Audio.device,participant:e.Participant})}break;case f.MediaTrackType.Video:if(!e.MediaTrackMap[t.id]&&!t.muted){o=t.clone();n._trackMetaData[o.id]=r,e.MediaTrackMap[t.id]=o,e.Video.stream.addTrack(o),e.Video.device=new m.Camera(t.label,t.id),e.SourceToStreamMap[e.Video.device.Id]=e.Video.stream,e.Participant.IsRemote&&n._vidyoCore.EventDispatcher.emitAsync(c.Events.RemoteCameraAdded,{camera:e.Video.device,participant:e.Participant})}break;case f.MediaTrackType.Application:if(!e.Application[t.id]&&!t.muted){var a=new MediaStream;o=t.clone();n._trackMetaData[o.id]=r,a.addTrack(o),n._participantStreamsMap[a.id]=a,e.Application[t.id]={device:new v.WindowShare(t.label,t.id),stream:a},e.Participant.IsRemote&&n._vidyoCore.EventDispatcher.emitAsync(c.Events.RemoteWindowShareAdded,{participant:e.Participant,windowShare:e.Application[t.id].device});var s=e.Application[t.id].device.Id;e.SourceToStreamMap[s]=a}}})},t.prototype._checkAndRemoveNetworkStreamTracks=function(e,t){var n=e.GetMediaStream();if(n){var r=n.getTracks();if(r)r.filter(function(e){return!t.includes(e.id)}).forEach(function(e){e.stop(),n.removeTrack(e)})}},t.prototype._checkAndRemoveParticipantStreamsDataTracks=function(e,t){for(var n=0,r=Object.entries(e.MediaTrackMap);n<r.length;n++){var i=r[n],o=i[0],a=i[1];if(-1===t.indexOf(o)){switch(a.stop(),this._trackMetaData[a.id]){case f.MediaTrackType.Audio:e.Audio.stream.removeTrack(a),e.Audio.device&&e.Participant.IsRemote&&(this._vidyoCore.EventDispatcher.emitAsync(c.Events.RemoteMicrophoneRemoved,{microphone:e.Audio.device,participant:e.Participant}),delete e.SourceToStreamMap[e.Audio.device.Id],e.Audio.device=null);break;case f.MediaTrackType.Video:e.Video.stream.removeTrack(a),e.Video.device&&e.Participant.IsRemote&&(this._vidyoCore.EventDispatcher.emitAsync(c.Events.RemoteCameraRemoved,{camera:e.Video.device,participant:e.Participant}),delete e.SourceToStreamMap[e.Video.device.Id],e.Video.device=null)}delete this._trackMetaData[a.id],delete e.MediaTrackMap[o]}}for(var s=0,u=Object.entries(e.Application);s<u.length;s++){var l=u[s];o=l[0],a=l[1];if(-1===t.indexOf(o)){var d=e.Application[o].stream.getVideoTracks()[0];e.Application[o].stream.removeTrack(d),e.Application[o].stream.dispatchEvent(new Event("removetrack")),e.Application[o].device&&e.Participant.IsRemote&&(this._vidyoCore.EventDispatcher.emitAsync(c.Events.RemoteWindowShareRemoved,{participant:e.Participant,windowShare:e.Application[o].device}),delete e.SourceToStreamMap[e.Application[o].device.Id]),delete this._trackMetaData[d.id],delete e.Application[o]}}},t.prototype._createParticipantStreamsData=function(e){var t=this,n=new MediaStream,r=this._vidyoCore.Controllers.ParticipantController.GetParticipant(e.id),i={Application:{},Audio:{device:null,stream:new MediaStream},MediaTrackMap:{},Participant:r,SourceToStreamMap:{},Video:{device:null,stream:n}};this._participantStreamsMap[n.id]=n,this._checkAndAddParticipantStreamsDataTrack(i,e),e.addEventListener("addtrack",function(){t._checkAndAddParticipantStreamsDataTrack(i,e)}),e.addEventListener("removetrack",function(){var n=e.getTracks().map(function(e){return e.id});t._checkAndRemoveParticipantStreamsDataTracks(i,n)}),this._participantStreamsData[e.id]=i,this._streamEventHelper.AttachStreamEvents(new l.ReadOnlyMediaStream(n))},t.prototype._onParticipantLeave=function(e){var t=this.TryGetNetworkStream(e.Id);t&&this._onRemoteStreamRemoved(t.GetMediaStream())},t.prototype._onRemoteStreamAdded=function(e){if(this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e.id)){var t=new l.ReadOnlyMediaStream(e);this._createParticipantStreamsData(e),this._streams[e.id]=t,this._streamEventHelper.AttachStreamEvents(t)}},t.prototype._onRemoteStreamRemoved=function(e){var t=this._streams[e.id];t&&(t.UnregisterEventListeners(),this._participantStreamsData[e.id]&&(this._checkAndRemoveParticipantStreamsDataTracks(this._participantStreamsData[e.id],[]),delete this._participantStreamsData[e.id]),delete this._streams[e.id],this._vidyoCore.EventDispatcher.emit(c.Events.StreamListChanged))},t.prototype._onRemoteTrackMetaData=function(e){this._trackMetaData[e.ssrc]=e.type},t.prototype._onRemoteTrackRemoved=function(e){var t=this,n=this._streams[e.participantId];if(n){var r=n.GetTracks().map(function(e){return e.Id});r=r.filter(function(n){return n!==e.ssrc&&!(t._ssrcToSafariGeneratedIdMap[e.ssrc]&&n===t._ssrcToSafariGeneratedIdMap[e.ssrc])}),this._checkAndRemoveParticipantStreamsDataTracks(this._participantStreamsData[e.participantId],r),this._checkAndRemoveNetworkStreamTracks(n,r),this._vidyoCore.EventDispatcher.emit(c.Events.TracksChanged,e.participantId)}},t}(u.BaseController);n.RemoteStreamController=S},{"../../events/ConferenceEvents":396,"../../events/ConnectionEvents":397,"../../events/EventDispatcher":399,"../../events/ParticipantEvents":402,"../../events/StreamEvents":408,"../../models/device/Camera":421,"../../models/device/Microphone":425,"../../models/device/WindowShare":427,"../../models/stream/ReadOnlyMediaStream":453,"../../utils/Messages":468,"../../utils/StringUtils":479,"../BaseController":366,"./StreamEventHelper":390,"./TrackMetaDataProvider":391}],390:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../events/StreamEvents"),i=function(){function e(e){this._eventDispatcher=e}return e.prototype.AttachStreamEvents=function(e){var t=this;e.OnTrackAdded(function(){return t._tracksChanged(e.Id)}),e.OnTrackRemoved(function(){return t._tracksChanged(e.Id)}),e.OnTrackEnabledChanged(function(){return t._streamEnableStateChanged(e.Id)}),this._eventDispatcher.emit(r.Events.StreamListChanged)},e.prototype._streamEnableStateChanged=function(e){this._eventDispatcher.emit(r.Events.StreamEnableStateChanged,e)},e.prototype._tracksChanged=function(e){this._eventDispatcher.emit(r.Events.TracksChanged,e)},e}();n.StreamEventHelper=i},{"../../events/StreamEvents":408}],391:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../models/Source");n.UnknownMediaTrackType="unknown",n.MediaTrackType=r.SourceMediaType},{"../../models/Source":418}],392:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../BaseController"),a=e("../../events/CallStateEvents"),s=e("../../events/StreamEvents"),c=e("../../events/EventDispatcher"),u=e("../../utils/Constants"),l=e("../../utils/NotEqual"),d=e("../../models/VideoResolution"),p=e("../../events/LogEvents"),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._bandwidthList=[],t._inCall=!1,t._interval=null,t._tracksActiveMap={},t._tracksSrrcsMap={},t}return i(t,e),t.prototype.Initialize=function(){var t=this,n=this._vidyoCore.Controllers.LocalStreamController.GetTransmittedStream();return n.addEventListener("addtrack",function(){return t._updateStreamTracks(n)}),n.addEventListener("removetrack",function(){return t._updateStreamTracks(n)}),this._vidyoCore.EventDispatcher.releaseGroup(c.TransmittedStreamControllerListeners),this._vidyoCore.EventDispatcher.on(a.Events.MediaStateTransition,c.TransmittedStreamControllerListeners,function(e){return t._mediaStateTransition(e,n)}),e.prototype.Initialize.call(this)},t.prototype.SetLocalSource=function(e){if(this._tracksSrrcsMap[e.id]){var t=this._tracksSrrcsMap[e.id],n=this._detectAboveThresholdCondition(e);if(n.isVideoConstraintsAboveThreshold,n.isBandwidthAboveThreshold){this._vidyoCore.Controllers.LocalStreamController.UpdateTrackBandwidth(n.bandwidth,t);var r=this._vidyoCore.Controllers.LocalStreamController.GetOutgoingBandwidth();this._bandwidthList.push(r)}this._tracksActiveMap[t]=!!e.enable,this._vidyoCore.XmppProvider.SetMediaEnabled(t,!!e.enable)}},t.prototype.UpdateTracksSrrcs=function(e){var t=this;this._tracksSrrcsMap=e;var n=Object.values(this._tracksSrrcsMap);Object.keys(this._tracksActiveMap).forEach(function(e){-1===n.indexOf(e)&&delete t._tracksActiveMap[e]}),n.forEach(function(e){t._tracksActiveMap.hasOwnProperty(e)||(t._tracksActiveMap[e]=!1)})},t.prototype._detectAboveThresholdCondition=function(e){var t={bandwidth:d.GetStdOutgoingBandwidth(this._getCurrentCodec()),isBandwidthAboveThreshold:!1,isVideoConstraintsAboveThreshold:!1,videoStreamConstraints:{}},n=this._vidyoCore.Controllers.LocalStreamController.GetLocalStreamConstraintsByTrackId(this._tracksSrrcsMap[e.id]);if(n&&e.params&&n){if(e.params.height&&e.params.width){var r=parseInt(e.params.height,10),i=parseInt(e.params.width,10);(l.NotEqual(n.height,r,u.Threshold)||l.NotEqual(n.width,i,u.Threshold))&&(t.isVideoConstraintsAboveThreshold=!0,t.videoStreamConstraints.height=r,t.videoStreamConstraints.width=i)}if(e.params.minFrameRate||e.params.framerate){var o=parseInt(e.params.minFrameRate,10)||parseInt(e.params.framerate,10);n.frameRate!==o&&(t.isVideoConstraintsAboveThreshold=!0,t.videoStreamConstraints.frameRate=o)}var a=this._vidyoCore.Controllers.LocalStreamController.GetLocalStreamBandwidthByTrackId(this._tracksSrrcsMap[e.id]);if(e.params.bandwidth&&null!=a){var s=parseInt(e.params.bandwidth+"",10),c=e.params.minBandwidth?parseInt(e.params.minBandwidth+"",10):s,p=Math.min(s,c);p=this._pickSuitableBandwidth(n,p,t.videoStreamConstraints.height),l.NotEqual(a,p,u.Threshold)&&(this._vidyoCore.Controllers.LogController.LogDebug("~~~~~~~~~~~~~~~~ adjusting encoder bitrate: requested="+s+"; requestedMin="+c+"; CALCULATED NEW="+p+(a>0?"; prev="+a:"")),t.isBandwidthAboveThreshold=!0,t.bandwidth=p)}}return t},t.prototype._getCurrentCodec=function(){return d.GetPreferredCodec()},t.prototype._mediaStateTransition=function(e,t){var n=this;e.ShouldTransmitMedia?this._vidyoCore.Controllers.ConnectionController.AddStream(t).then(function(){n._inCall=!0,t.getTracks().forEach(function(e){n._vidyoCore.XmppProvider.SetMediaEnabled(e.id,!1)}),n._interval&&clearInterval(n._interval),n._interval=setInterval(function(){if(n._bandwidthList.length>0){var e=n._bandwidthList.reduce(function(e,t){return e+t},0)/n._bandwidthList.length;n._bandwidthList.length=0,n._vidyoCore.Controllers.LocalStreamController.UpdateLocalSendBandwidth(e)}},u.OutgoingBandwidthCalculationInterval),n._vidyoCore.Controllers.LocalStreamController.UpdateLocalSendBandwidth()}).catch(function(e){n._inCall=!1,n._vidyoCore.Controllers.LogController.LogError(e,p.VidyoLogCategory.VidyoClient,"TransmittedStreamController::_mediaStateTransition error"),n._vidyoCore.EventDispatcher.emit(s.Events.MediaFailed,{reason:"MediaSessionAddingStreamError"})}):this._inCall&&(this._interval&&clearInterval(this._interval),this._vidyoCore.Controllers.ConnectionController.RemoveStream(t),this._inCall=!1)},t.prototype._pickSuitableBandwidth=function(e,t,n){void 0===n&&void 0===(n=e.height)&&(n=0);var r=this._getCurrentCodec(),i=d.BandwidthPreferred[r],o=d.GetStdOutgoingBandwidth(r);for(var a in i)if(i.hasOwnProperty(a)){var s=i[a];if(n<=s.Height){o=s.Bandwidth;break}}return Math.min(t,o)},t.prototype._updateStreamTracks=function(e){var t=this;this._inCall&&this._vidyoCore.XmppProvider.UpdateStreamTracks(e).then(function(){t._vidyoCore.Controllers.LocalStreamController.UpdateLocalSendBandwidth(),Object.keys(t._tracksActiveMap).forEach(function(e){t._vidyoCore.XmppProvider.SetMediaEnabled(e,t._tracksActiveMap[e])})})},t}(o.BaseController);n.TransmittedStreamController=f},{"../../events/CallStateEvents":395,"../../events/EventDispatcher":399,"../../events/LogEvents":400,"../../events/StreamEvents":408,"../../models/VideoResolution":420,"../../utils/Constants":461,"../../utils/NotEqual":469,"../BaseController":366}],393:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../models/User"),a=function(e){function t(t){var n=e.call(this,t)||this;return n._coreUser=new o.User,n}return i(t,e),t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.Initialize=function(){return e.prototype.Initialize.call(this)},t.prototype.SetUserDisplayName=function(e){this._coreUser.DisplayName=e},t.prototype.UserDisplayName=function(){return this._coreUser.DisplayName},t}(e("./BaseController").BaseController);n.UserController=a},{"../models/User":419,"./BaseController":366}],394:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../utils/EventListFactory"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AddGoogleConferenceFlagChanged=new o.EventDescriptor,t.CodecExcludeFilterChanged=new o.EventDescriptor,t.DisableStatsChanged=new o.EventDescriptor,t.EnableSimpleAPILoggingChanged=new o.EventDescriptor,t.EnableSimulcastChanged=new o.EventDescriptor,t.EnableVidyoConnectorAPILoggingChanged=new o.EventDescriptor,t.EnableXMPPMessageLoggingChanged=new o.EventDescriptor,t.LogCategoryChanged=new o.EventDescriptor,t.ParticipantLimitChanged=new o.EventDescriptor,t.ShowStatisticsOverlayChanged=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.EventList=a,n.Events=o.CreateEventList("AdvancedSettings",a)},{"../utils/EventListFactory":463}],395:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../utils/EventListFactory"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.MediaStateTransition=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.EventList=a,n.Events=o.CreateEventList("CallState",a)},{"../utils/EventListFactory":463}],396:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../utils/EventListFactory"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ConferenceAccepted=new o.EventDescriptor,t.ConferenceJoined=new o.EventDescriptor,t.ConferenceRejected=new o.EventDescriptor,t.NotifyParticipant=new o.EventDescriptor,t.NotifySelectedParticipant=new o.EventDescriptor,t.Reply=new o.EventDescriptor,t.SelectedParticipantsChanged=new o.EventDescriptor,t.SelectedParticipantUnavailable=new o.EventDescriptor,t.SourceDetected=new o.EventDescriptor,t.SourceRemoved=new o.EventDescriptor,t.SubscribeTimeout=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.EventList=a,n.Events=o.CreateEventList("Conference",a)},{"../utils/EventListFactory":463}],397:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../utils/EventListFactory"),a=e("../utils/Messages"),s=e("../../vidyo_connector_api/VidyoConnector"),c=function(){return function(e,t,n,r){this.code=e,this.msg=n,this.reasonCode=t,this.type=r||"info"}}();n.VidyoEventInfo=c;var u=function(){function e(){}return e.ConnectionLost=new c("ConnectionLost",s.VidyoConnectorDisconnectReason.ConnectionLost,a.ConnectionLost,"error"),e.ConnectionTimeout=new c("ConnectionTimeout",s.VidyoConnectorDisconnectReason.ConnectionTimeout,a.ConnectionTimeout,"error"),e.Disconnected=new c("Disconnected",s.VidyoConnectorDisconnectReason.Disconnected,a.Disconnected),e.Disconnecting=new c("Disconnecting",s.VidyoConnectorDisconnectReason.Disconnected,a.Disconnected),e.InvalidToken=new c("InvalidToken",s.VidyoConnectorFailReason.InvalidToken,a.InvalidToken),e.MediaSessionAddingStreamError=new c("MediaSessionAddingStreamError",s.VidyoConnectorDisconnectReason.MiscError,a.MediaSessionAddingStreamError,"error"),e.MediaSessionEnded=new c("MediaSessionEnded",s.VidyoConnectorDisconnectReason.Disconnected,a.MediaSessionEnded,"error"),e.MediaSessionError=new c("MediaSessionError",s.VidyoConnectorDisconnectReason.MiscError,a.MediaSessionError),e.MediaSessionTransportError=new c("MediaSessionTransportError",s.VidyoConnectorDisconnectReason.MiscError,a.MediaSessionTransportError,"error"),e.MiscError=new c("MiscError",s.VidyoConnectorDisconnectReason.MiscError,a.MiscError,"error"),e.MiscLocalError=new c("MiscLocalError",s.VidyoConnectorDisconnectReason.MiscLocalError,a.MiscLocalError,"error"),e.MiscRemoteError=new c("MiscRemoteError",s.VidyoConnectorDisconnectReason.MiscRemoteError,a.MiscRemoteError,"error"),e.NoResponse=new c("NoResponse",s.VidyoConnectorDisconnectReason.NoResponse,a.NoResponse,"error"),e.SignallingError=new c("SignallingError",s.VidyoConnectorDisconnectReason.MiscError,a.SignallingError,"error"),e.SignallingTransportError=new c("SignallingTransportError",s.VidyoConnectorDisconnectReason.MiscError,a.SignallingTransportError,"error"),e.Terminated=new c("Terminated",s.VidyoConnectorDisconnectReason.Terminated,a.Terminated,"error"),e}();n.ConnectionEventsInfo=u;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AuthenticationError=new o.EventDescriptor,t.Available=new o.EventDescriptor,t.Connected=new o.EventDescriptor,t.ConnectionStatusChanged=new o.EventDescriptor,t.Disconnected=new o.EventDescriptor,t.Disconnecting=new o.EventDescriptor,t.GetWebProxyCredentials=new o.EventDescriptor,t.IqSendingError=new o.EventDescriptor,t.JingleAccepted=new o.EventDescriptor,t.JingleRemoteStreamAdded=new o.EventDescriptor,t.JingleRemoteStreamRemoved=new o.EventDescriptor,t.JingleSessionTerminated=new o.EventDescriptor,t.JingleSourceView=new o.EventDescriptor,t.LmiXmppMucMediaConf=new o.EventDescriptor,t.MediaSessionEnded=new o.EventDescriptor,t.MediaSessionFailed=new o.EventDescriptor,t.MediaSessionStarted=new o.EventDescriptor,t.SignallingDisconnected=new o.EventDescriptor,t.SignallingError=new o.EventDescriptor,t.TokenReceived=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.EventList=l,n.Events=o.CreateEventList("Connection",l)},{"../../vidyo_connector_api/VidyoConnector":526,"../utils/EventListFactory":463,"../utils/Messages":468}],398:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../utils/EventListFactory"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AudioContentDeviceChanged=new o.EventDescriptor,t.CameraAdded=new o.EventDescriptor,t.CameraMaxConstraintChanged=new o.EventDescriptor,t.CameraRemoved=new o.EventDescriptor,t.CameraSelected=new o.EventDescriptor,t.CameraSettingsChanged=new o.EventDescriptor,t.CameraUnplugged=new o.EventDescriptor,t.MicrophoneAdded=new o.EventDescriptor,t.MicrophoneChanged=new o.EventDescriptor,t.MicrophoneMuteStateChanged=new o.EventDescriptor,t.MicrophoneRemoved=new o.EventDescriptor,t.MicrophoneSelected=new o.EventDescriptor,t.MicrophoneUnplugged=new o.EventDescriptor,t.SpeakerAdded=new o.EventDescriptor,t.SpeakerRemoved=new o.EventDescriptor,t.SpeakerSelected=new o.EventDescriptor,t.SpeakerSettingsChanged=new o.EventDescriptor,t.SpeakerUnplugged=new o.EventDescriptor,t.VideoContentDeviceChanged=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.EventList=a,n.Events=o.CreateEventList("Device",a)},{"../utils/EventListFactory":463}],399:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("wildemitter");n.CallStateControllerListeners="CallStateControllerListeners",n.ConferenceControllerListeners="ConferenceControllerListeners",n.ConnectionControllerListeners="ConnectionControllerListeners",n.DeviceControllerListeners="DeviceControllerListeners",n.LocalStreamControllerListeners="LocalStreamControllerListeners",n.MicrophoneLocalEnergyLevelControllerListeners="MicrophoneLocalEnergyLevelControllerListeners",n.MicrophoneRemoteEnergyLevelControllerListeners="MicrophoneRemoteEnergyLevelControllerListeners",n.MessageControllerListeners="MessageControllerListeners",n.ParticipantControllerListeners="ParticipantControllerListeners",n.PermissionControllerListeners="PermissionControllerListeners",n.RenderListeners="RenderListeners",n.RendererControllerListeners="RendererControllerListeners",n.ResourceControllerListeners="ResourceControllerListeners",n.SmoothStartModeListeners="SmoothStartModeListeners",n.StatisticsControllerListeners="StatisticsControllerListeners",n.StreamControllerListeners="StreamControllerListeners",n.RemoteStreamControllerListeners="RemoteStreamControllerListeners",n.TransmittedStreamControllerListeners="TransmittedStreamControllerListeners",n.VidyoAdvancedSettingsEventListeners="VidyoAdvancedSettingsEventListeners",n.VidyoCustomLoggingEventListeners="VidyoCustomLoggingEventListeners",n.VidyoEnableMediaRoomListeners="VidyoEnableMediaRoomListeners",n.VidyoEndpointListeners="VidyoEndpointListeners",n.VidyoEnterRoomListeners="VidyoEnterRoomListeners",n.VidyoLocalCameraEventListeners="VidyoLocalCameraEventListeners",n.VidyoMessageEventListeners="VidyoMessageEventListeners",n.VidyoLocalMicrophoneEventListeners="VidyoLocalMicrophoneEventListeners",n.VidyoLocalMonitorEventListeners="VidyoLocalMonitorEventListeners",n.VidyoLocalSpeakerEventListeners="VidyoLocalSpeakerEventListeners",n.VidyoLocalWindowShareEventListeners="VidyoLocalWindowShareEventListeners",n.VidyoPermissionEventListeners="VidyoPermissionEventListeners",n.VidyoRemoteCameraEventListeners="VidyoRemoteCameraEventListeners",n.VidyoRemoteMicrophoneEventListeners="VidyoRemoteMicrophoneEventListeners",n.VidyoRemoteWindowShareEventListeners="VidyoRemoteWindowShareEventListeners",n.VidyoResourceManagerEventListeners="VidyoResourceManagerEventListeners",n.VidyoRoomParticipantEventListeners="VidyoRoomParticipantEventListeners",n.VidyoUserListeners="VidyoUserListeners",n.CreateEventDispatcher=function(){var e=this,t={};return r.mixin(t),t.releaseAll=function(){for(var n in t.callbacks=t.callbacks||{},t.callbacks)if(t.callbacks.hasOwnProperty(n)){for(var r=t.callbacks[n],i=r.length;i>0;i--)r.pop();delete t.callbacks[n]}return e},t.getGroupCallbacks=function(e){var n=[];for(var r in t.callbacks=t.callbacks||{},t.callbacks)if(t.callbacks.hasOwnProperty(r))for(var i=t.callbacks[r],o=i.length-1;o>=0;o--)i[o]._groupName===e&&n.push(i[o]);return n},t.emitAsync=function(e,n){return setTimeout(function(){t.emit(e,n)},0),t},t},n.ReleaseAllEventListeners=function(e){var t=e.callbacks||{};for(var n in t)if(t.hasOwnProperty(n)){for(var r=t[n],i=r.length;i>0;i--)r.pop();delete t[n]}}},{wildemitter:350}],400:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../utils/EventListFactory");!function(e){e.VidyoClient="VidyoClient",e.VidyoJingle="VidyoJingle",e.VidyoSDP="VidyoSDP",e.VidyoResourceManager="VidyoResourceManager",e.VidyoConnector="VidyoConnector",e.VidyoApplication="VidyoApplication",e.VidyoDevelopment="VidyoDevelopment"}(n.VidyoLogCategory||(n.VidyoLogCategory={})),function(e){e[e.fatal=1]="fatal",e[e.error=2]="error",e[e.warning=4]="warning",e[e.info=8]="info",e[e.debug=16]="debug",e[e.sent=32]="sent",e[e.received=64]="received",e[e.enter=128]="enter",e[e.leave=256]="leave"}(n.VidyoLogLevel||(n.VidyoLogLevel={}));var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fatal=new o.EventDescriptor,t.error=new o.EventDescriptor,t.warning=new o.EventDescriptor,t.info=new o.EventDescriptor,t.debug=new o.EventDescriptor,t.sent=new o.EventDescriptor,t.received=new o.EventDescriptor,t.enter=new o.EventDescriptor,t.leave=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.LogEventListSDK=a,n.LogEventsSDK=o.CreateEventList("LogSDK",a),n.LogEventApp=new o.EventDescriptor("LogApp"),n.LogEventDebug=new o.EventDescriptor("LogDebug")},{"../utils/EventListFactory":463}],401:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../utils/EventListFactory"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.MessageChatState=new o.EventDescriptor,t.MessageRead=new o.EventDescriptor,t.MessageReceived=new o.EventDescriptor,t.OnMessage=new o.EventDescriptor,t.OnMessageAcknowledged=new o.EventDescriptor,t.OnMessageChatState=new o.EventDescriptor,t.OnMessageRead=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.EventList=a,n.Events=o.CreateEventList("Message",a)},{"../utils/EventListFactory":463}],402:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../utils/EventListFactory"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.DynamicParticipantChanged=new o.EventDescriptor,t.LoudestParticipantChanged=new o.EventDescriptor,t.ParticipantJoined=new o.EventDescriptor,t.ParticipantLeft=new o.EventDescriptor,t.ParticipantsChanged=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.EventList=a,n.Events=o.CreateEventList("Participant",a)},{"../utils/EventListFactory":463}],403:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../utils/EventListFactory"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.PermissionListenerRegistered=new o.EventDescriptor,t.PermissionListenerUnregistered=new o.EventDescriptor,t.PermissionUpdated=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.EventList=a,n.Events=o.CreateEventList("Permission",a)},{"../utils/EventListFactory":463}],404:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../utils/EventListFactory"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AddLocalStream=new o.EventDescriptor,t.AddRemoteStream=new o.EventDescriptor,t.GridLayoutChanged=new o.EventDescriptor,t.Hide=new o.EventDescriptor,t.RecheckEachVideoSize=new o.EventDescriptor,t.SpeakerPrivacyChanged=new o.EventDescriptor,t.SpeakerSelected=new o.EventDescriptor,t.StatisticsUpdate=new o.EventDescriptor,t.Update=new o.EventDescriptor,t.UpdateAudioMeters=new o.EventDescriptor,t.UpdateCompositeRenderer=new o.EventDescriptor,t.UpdateLocalViewLabel=new o.EventDescriptor,t.UpdatePosition=new o.EventDescriptor,t.UpdateSource=new o.EventDescriptor,t.UpdateSourcesState=new o.EventDescriptor,t.UpdateViewLabel=new o.EventDescriptor,t.VideoCropSettingsChanged=new o.EventDescriptor,t.VideoResolutionChanged=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.EventList=a,n.Events=o.CreateEventList("Render",a)},{"../utils/EventListFactory":463}],405:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../utils/EventListFactory"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AvailableResourcesChanged=new o.EventDescriptor,t.MaxRemoteSourcesChanged=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.EventList=a,n.Events=o.CreateEventList("ResourcesManager",a)},{"../utils/EventListFactory":463}],406:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../utils/EventListFactory"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Created=new o.EventDescriptor,t.Entered=new o.EventDescriptor,t.Left=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.EventList=a,n.Events=o.CreateEventList("Room",a)},{"../utils/EventListFactory":463}],407:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../utils/EventListFactory"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Update=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.EventList=a,n.Events=o.CreateEventList("Statistics",a)},{"../utils/EventListFactory":463}],408:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../utils/EventListFactory"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LocalMonitorAdded=new o.EventDescriptor,t.LocalMonitorDeselected=new o.EventDescriptor,t.LocalMonitorRemoved=new o.EventDescriptor,t.LocalMonitorSelected=new o.EventDescriptor,t.LocalStreamReady=new o.EventDescriptor,t.LocalWindowShareAdded=new o.EventDescriptor,t.LocalWindowShareDeselected=new o.EventDescriptor,t.LocalWindowShareRemoved=new o.EventDescriptor,t.LocalWindowShareSelected=new o.EventDescriptor,t.MediaDisabled=new o.EventDescriptor,t.MediaEnabled=new o.EventDescriptor,t.MediaFailed=new o.EventDescriptor,t.RemoteCameraAdded=new o.EventDescriptor,t.RemoteCameraRemoved=new o.EventDescriptor,t.RemoteCameraStateUpdated=new o.EventDescriptor,t.RemoteMicrophoneAdded=new o.EventDescriptor,t.RemoteMicrophoneRemoved=new o.EventDescriptor,t.RemoteMicrophoneStateUpdated=new o.EventDescriptor,t.RemoteWindowShareAdded=new o.EventDescriptor,t.RemoteWindowShareRemoved=new o.EventDescriptor,t.RemoteWindowShareStateUpdated=new o.EventDescriptor,t.StreamEnableStateChanged=new o.EventDescriptor,t.StreamListChanged=new o.EventDescriptor,t.TracksChanged=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.EventList=a,n.Events=o.CreateEventList("Stream",a);var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TrackEnded=new o.EventDescriptor,t.TrackMute=new o.EventDescriptor,t.TrackOverconstrained=new o.EventDescriptor,t.TrackUnmute=new o.EventDescriptor,t}return i(t,e),t}(o.EventListBase);n.TrackEventList=s,n.TrackEvents=o.CreateEventList("Track",s)},{"../utils/EventListFactory":463}],409:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){e.Simple="Simple",e.VidyoConnector="VidyoConnector"}(n.API||(n.API={}))},{}],410:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){e.LoudestSpeaker="loudestSpeaker"}(n.AudioPolicy||(n.AudioPolicy={})),function(e){e.HideSelf="Hide Self",e.ShowSelf="Show Self",e.ShowSelfIfNoOther="Show Self If No Other"}(n.SelfViewPolicy||(n.SelfViewPolicy={})),function(e){e.On="on",e.Off="off"}(n.SourceState||(n.SourceState={})),function(e){e.ShowIfNotStaticallyViewed="Show If Not Statically Viewed",e.ShowEvenIfStaticallyViewed="Show Even If Statically Viewed"}(n.ViewPolicy||(n.ViewPolicy={})),function(e){e.NoSel="noSel",e.NoGen="noGen",e.Gen="gen"}(n.GhostMode||(n.GhostMode={})),n.IsLeaveNotification=function(e){return e.notify.event&&e.notify.event.participantPackageContent&&e.notify.event.participantPackageContent.participants&&e.notify.event.participantPackageContent.participants.some(function(e){return"leave"===e.event})},n.IsSourceNotification=function(e){return e.notify.event&&e.notify.event.participantPackageContent&&e.notify.event.participantPackageContent.participants&&e.notify.event.participantPackageContent.participants.some(function(e){return!("update"!==e.event&&"join"!==e.event)})}},{}],411:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e){void 0!==e&&(this.LocalId=e)}return e.prototype.Clone=function(t){var n=new e(t);return n.Session=this.Session,n.Conference=this.Conference,n.Reflector=this.Reflector,n},e.prototype.IsFinalized=function(){return!!(this.LocalId&&this.Session&&this.Conference&&this.Reflector)},e.prototype.ToObject=function(){var e={Session:this.Session||"",Conference:this.Conference||"",Reflector:this.Reflector||"",LocalId:this.LocalId};return this.RemoteId&&(e.RemoteId=this.RemoteId),e},Object.defineProperty(e.prototype,"Session",{get:function(){return this._session},set:function(e){this._set("Session","_session",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LocalId",{get:function(){return this._localId},set:function(e){this._set("LocalId","_localId",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Conference",{get:function(){return this._conference},set:function(e){this._set("Conference","_conference",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Reflector",{get:function(){return this._reflector},set:function(e){this._set("Reflector","_reflector",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RemoteId",{get:function(){return this._remoteId},set:function(e){this._set("RemoteId","_remoteId",e)},enumerable:!0,configurable:!0}),e.prototype._readOnlyError=function(e){return new Error(e+" has already been set and is now read-only")},e.prototype._set=function(e,t,n){if(this[t])throw this._readOnlyError(e);this[t]=n},e}();n.DialogIdentity=r},{}],412:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("uuid");!function(e){e.chat="chat",e.mediastart="mediastart",e.mediastop="mediastop"}(n.MessageType||(n.MessageType={})),function(e){e.user="user",e.room="room"}(n.SenderType||(n.SenderType={}));var i=function(){return function(){this.objId=r.v4()}}();n.Message=i},{uuid:332}],413:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("../utils/Messages"),o=e("./Source"),a=e("../utils/StringUtils"),s=e("uuid");!function(e){e.Local="local",e.Remote="remote"}(r=n.ParticipantOrigin||(n.ParticipantOrigin={}));var c=function(){function e(e,t,n,r){if(this.Id=e,this.Origin=t,this.UserId=r,this.Active=!1,this.Generation=1/0,this.ObjId=s.v4(),this.Sources=[],!this.Id||0===this.Id.length)throw new Error(i.IdCannotBeEmpty);n&&(this.Name=n)}return e.prototype.AudioMuted=function(){return this.Sources.some(function(e){return e.Type===o.SourceMediaType.Audio&&e.Paused})},e.prototype.GetSourceBySSrc=function(e){return this.Sources.find(function(t){return t.Ssrc===e})},e.prototype.HasAudioSource=function(){return this.Sources.some(function(e){return e.Type===o.SourceMediaType.Audio})},e.prototype.HasSource=function(e){return this.Sources.some(function(t){return t.Ssrc===e})},e.prototype.HasVideoSource=function(){return this.Sources.some(function(e){return e.Type===o.SourceMediaType.Video})},Object.defineProperty(e.prototype,"IsComplete",{get:function(){return!!this.Origin&&!!this.UserId&&!!this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsRemote",{get:function(){return this.Origin===r.Remote},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsLocal",{get:function(){return this.Origin===r.Local},enumerable:!0,configurable:!0}),e.prototype.UpdateSources=function(e){this.Sources=e},Object.defineProperty(e.prototype,"Name",{get:function(){return this._name||this.Id},set:function(e){this._name=a.default.toSecureString(e)},enumerable:!0,configurable:!0}),e}();n.Participant=c},{"../utils/Messages":468,"../utils/StringUtils":479,"./Source":418,uuid:332}],414:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){e.camera="VIDYO_PERMISSION_Camera",e.microphone="VIDYO_PERMISSION_Microphone",e.geolocation="VIDYO_PERMISSION_Location"}(n.PermissionType||(n.PermissionType={}))},{}],415:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(e,t){this.ResponseTime=Number.MAX_VALUE,this.Fqdn=t.fqdn,t.addresses&&t.addresses.length>0&&(this.Ip=t.addresses[0].ip),this.Location={Latitude:e.location.lat,Longitude:e.location.lon}}}();n.default=r},{}],416:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.RenderMode={Composite:"Composite",Custom:"Custom"}},{}],417:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){}}();n.Room=r},{}],418:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("uuid");n.SourceMediaType={Video:"video",Audio:"audio",Application:"application"},n.IsSourceMediaType=function(e){return"video"===e||"audio"===e},n.SourceType={Loopback:"loopback",Preview:"preview",Remote:"remote"};var i=function(){return function(e,t,n,i){void 0===i&&(i=!1),this.Paused=i,this.HasPanAndTilt=!1,this.HasZoom=!1,this.Name=t,this.Ssrc=e,this.Type=n,this.ObjId=r.v4()}}();n.Source=i},{uuid:332}],419:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){}}();n.User=r},{}],420:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o,a=e("../utils/Constants"),s=e("../utils/OperatingSystemInfoProvider"),c=function(){function e(e,t){void 0===e&&(e=640),void 0===t&&(t=360),this.Width=e,this.Height=t}return Object.defineProperty(e.prototype,"AspectRatio",{get:function(){return 0===this.Height?0:this.Width/this.Height},enumerable:!0,configurable:!0}),e.prototype.Clone=function(){return new e(this.Width,this.Height)},e}();n.BasicVideoResolution=c,function(e){e.Taller="Taller",e.Wider="Wider"}(o=n.AspectRatioRatioType||(n.AspectRatioRatioType={}));var u=function(e){function t(t,n,r,i){void 0===i&&(i=new c);var o=e.call(this,n,r)||this;return o.Id=t,o.ContainerResolution=i,o}return i(t,e),Object.defineProperty(t.prototype,"AspectRatioRatio",{get:function(){return 0===this.AspectRatio?0:this.ContainerResolution.AspectRatio/this.AspectRatio},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AspectRatioRatioType",{get:function(){return this.AspectRatioRatio<1?o.Wider:o.Taller},enumerable:!0,configurable:!0}),t.prototype.Clone=function(){return new t(this.Id,this.Width,this.Height,this.ContainerResolution.Clone())},t}(c);n.VideoResolution=u;var l=function(){function e(){this.ContainerResolution=new c,this._videoResolutions={}}return e.prototype.All=function(){return Object.values(this._videoResolutions)},e.prototype.Get=function(e){return this._videoResolutions[e]||new u(e)},e.prototype.UpdateVideoResolutions=function(e,t){var n=this;this.ContainerResolution=e.Clone(),this._videoResolutions={},t.forEach(function(e){n._videoResolutions[e.Id]=e.Clone()})},e}();n.VideoResolutionSet=l;var d,p,f,h=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.Bandwidth=r,i}return i(t,e),t}(c);function m(){return s.OperatingSystemInfoProvider.IsChrome()?d.VP8:s.OperatingSystemInfoProvider.IsSafari()?d.H264:d.VP8}n.VideoStreamConstraints=h,function(e){e.H264="H264",e.H265="H265",e.VP8="VP8",e.VP9="VP9"}(d=n.CodecName||(n.CodecName={})),n.BandwidthNominal=((p={})[d[d.H264]]=[new h(160,120,5e4),new h(320,180,1e5),new h(320,240,1e5),new h(352,288,2e5),new h(640,360,24e4),new h(640,480,32e4),new h(1280,720,1e6),new h(1920,1080,19e5)],p[d[d.H265]]=[new h(160,120,25e3),new h(320,180,5e4),new h(320,240,5e4),new h(352,288,1e5),new h(640,360,12e4),new h(640,480,16e4),new h(1280,720,5e5),new h(1920,1080,95e4)],p[d[d.VP8]]=[new h(160,120,58e3),new h(320,180,115e3),new h(320,240,115e3),new h(352,288,23e4),new h(640,360,276e3),new h(640,480,368e3),new h(1280,720,118e4),new h(1920,1080,228e4)],p[d[d.VP9]]=[new h(160,120,4e4),new h(320,180,8e4),new h(320,240,8e4),new h(352,288,16e4),new h(640,360,187e3),new h(640,480,25e4),new h(1280,720,75e4),new h(1920,1080,14e5)],p),n.BandwidthPreferred=((f={})[d[d.H264]]=[new h(160,120,23e4),new h(320,180,5e5),new h(320,240,5e5),new h(352,288,67e4),new h(640,360,712e3),new h(640,480,95e4),new h(1280,720,2e6),new h(1920,1080,4e6)],f[d[d.H265]]=[new h(160,120,23e4),new h(320,180,4e5),new h(320,240,4e5),new h(352,288,5e5),new h(640,360,487e3),new h(640,480,65e4),new h(1280,720,15e5),new h(1920,1080,3e6)],f[d[d.VP8]]=[new h(160,120,23e4),new h(320,180,5e5),new h(320,240,5e5),new h(352,288,67e4),new h(640,360,712e3),new h(640,480,95e4),new h(1280,720,2e6),new h(1920,1080,4e6)],f[d[d.VP9]]=[new h(160,120,23e4),new h(320,180,4e5),new h(320,240,4e5),new h(352,288,5e5),new h(640,360,487e3),new h(640,480,65e4),new h(1280,720,15e5),new h(1920,1080,3e6)],f),n.CalculateSendBitrate=function(e,t,r){void 0===r&&(r=m());var i=n.BandwidthPreferred[r],o=null;if(i){var a=0,s=0;i.forEach(function(n,r){(0===r||i[r-1].Width<e)&&e<=n.Width&&(a=n.Bandwidth),(0===r||i[r-1].Height<t)&&t<=n.Height&&(s=n.Bandwidth)}),a>0&&s>0&&(o=Math.round((s+a)/2))}return o},n.CalculateRemoteSourceBitrate=function(e,t,r){var i=n.BandwidthNominal[r],o=null;if(i){var a=0,s=0;i.forEach(function(n,r){(0===r||i[r-1].Width<e)&&e<=n.Width&&(a=n.Bandwidth),(0===r||i[r-1].Height<t)&&t<=n.Height&&(s=n.Bandwidth)}),a>0&&s>0&&(o=Math.round((s+a)/2))}return o},n.GetStdOutgoingBandwidth=function(e,t){void 0===t&&(t=!1),e||(e=m());var r=n.BandwidthPreferred[e].filter(function(e){return e.Height===a.DefaultLocalStreamHeight})[0].Bandwidth;return t?Math.round(r/a.KiloCoefficient):r},n.GetPreferredCodec=m},{"../utils/Constants":461,"../utils/OperatingSystemInfoProvider":472}],421:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype._getType=function(){return"Camera"},Object.defineProperty(t.prototype,"MaxConstraints",{get:function(){return this._maxConstraints},set:function(e){this._maxConstraints=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PreviewLabel",{get:function(){return this._previewLabel||"Preview"},set:function(e){this._previewLabel=e},enumerable:!0,configurable:!0}),t}(e("./Device").Device);n.Camera=o},{"./Device":422}],422:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("uuid"),i=function(){return function(e,t,n){void 0===n&&(n=r.v4()),this.Name=e,this.Id=t,this.Type=this._getType(),this.ObjId=n}}();n.Device=i},{uuid:332}],423:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e){this._defaultDevice=null,this._deviceList=[],this._deviceConstructor=e}return e.prototype.Add=function(e,t){if(this._findDeviceIndexByID(t)>=0)return!1;var n=new this._deviceConstructor(e,t);return this._deviceList.push(n),n},e.prototype.All=function(){for(var e=[],t=this._deviceList.length;t--;)e[t]=this._deviceList[t];return e},e.prototype.Find=function(e){var t=this._findDeviceIndexByID(e);return t>=0&&this._deviceList[t]},e.prototype.GetDefaultDevice=function(){if(this._defaultDevice){var t=this.Find(this._defaultDevice.Id);if(t)return t;throw new Error(e.notInListMsg)}return!1},e.prototype.GetFirstDevice=function(){return this._deviceList.length>0&&this._deviceList[0]},e.prototype.Next=function(e){var t=this._findDeviceIndexByID(e);if(t>=0){var n=(t+1)%this._deviceList.length;return this._deviceList[n]}return!1},e.prototype.Remove=function(e){this._defaultDevice&&this._defaultDevice.Id===e&&(this._defaultDevice=null);var t=this._findDeviceIndexByID(e);return t>=0&&(this._deviceList.splice(t,1),!0)},e.prototype.SetDefaultDevice=function(t){if(t){var n=this.Find(t.Id);if(!1===n)throw new Error(e.notInListMsg);this._defaultDevice=n}else this._defaultDevice=null},e.prototype._findDeviceIndexByID=function(e){return this._deviceList.findIndex(function(t){return t.Id===e})},e.notInListMsg="Default device not in the device list",e}();n.DeviceList=r},{}],424:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){this.Muted=!1}return Object.defineProperty(e.prototype,"Enabled",{get:function(){return!this.Muted&&!!this.Device},enumerable:!0,configurable:!0}),e.prototype.Simplify=function(){return this.Device||!0},e}();n.DeviceSelectionInfo=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(o);n.CameraSelectionInfo=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(o);n.MicrophoneSelectionInfo=s;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(o);n.SpeakerSelectionInfo=c;var u=function(){function e(){this.AudioContent=new s,this.Camera=new a,this.Microphone=new s,this.Speaker=new c,this.VideoContent=new a}return e.prototype.SelectAudioContentShare=function(e){this.AudioContent.Device=e},e.prototype.SelectCamera=function(e){this.Camera.Device=e},e.prototype.SelectMicrophone=function(e){this.Microphone.Device=e},e.prototype.SelectSpeaker=function(e){this.Speaker.Device=e},e.prototype.SelectVideoContentShare=function(e){this.VideoContent.Device=e},Object.defineProperty(e.prototype,"Simplified",{get:function(){return{AudioContent:this.AudioContent.Simplify(),Camera:this.Camera.Simplify(),Microphone:this.Microphone.Simplify(),Speaker:this.Speaker.Simplify(),VideoContent:this.VideoContent.Simplify()}},enumerable:!0,configurable:!0}),e}();n.DeviceSelection=u},{}],425:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype._getType=function(){return"Microphone"},t}(e("./Device").Device);n.Microphone=o},{"./Device":422}],426:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype._getType=function(){return"Speaker"},t}(e("./Device").Device);n.Speaker=o},{"./Device":422}],427:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype._getType=function(){return"WindowShare"},t}(e("./Device").Device);n.WindowShare=o},{"./Device":422}],428:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../utils/ObjectUtils"),i=function(){function e(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),void 0===n&&(n=[]),this._columns=e,this._rows=t,this._spaceBefore=n}return Object.defineProperty(e.prototype,"Cells",{get:function(){return this._columns*this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Columns",{get:function(){return this._columns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SpaceBefore",{get:function(){return this._spaceBefore},enumerable:!0,configurable:!0}),e.prototype.Update=function(e,t,n){var i,o,a=this._rows,s=this._columns,c=this._spaceBefore,u=[];if(e<=0)i=0,o=0;else{if(n/t<.7){var l=Math.sqrt(e*n/t);i=Math.ceil(l-1+.7),o=Math.ceil(e/i)}else{var d=Math.sqrt(e*t/n);o=Math.ceil(d-1+.7),i=Math.ceil(e/o)}var p=i*o-e;if(p>0&&u.push(1),p>1){var f=o*(i-1);u.push(f)}}return this._rows=i,this._columns=o,this._spaceBefore=u,a!==i||s!==o||r.default.IsNotEqual(c,u)},e.MinimizedVideoAreaGridRows=2,e.VideoAreaGridCols=12,e.VideoAreaGridRows=26,e}();n.GridLayout=i},{"../../utils/ObjectUtils":471}],429:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){this.ActualEncoderBitRate=0,this.AvailableBandwidth=0,this.AvailableRecieveBandwidth=0,this.LeakyBucketDelay=0,this.RetransmitBitRate=0,this.TargetEncoderBitRate=0,this.TotalTransmitBitRate=0}}();n.BandwidthSummaryStatistics=r},{}],430:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./LogStatistics"),i=function(){function e(){this.ApplicationTag="",this.BuildTag="",this.BytesReceivedTcp=0,this.BytesReceivedUdp=0,this.BytesSentTcp=0,this.BytesSentUdp=0,this.ConnectTime="",this.Id="",this.LibraryVersion="",this.LocalCameraStats=[],this.LocalMicrophoneStats=[],this.LocalMonitorStats=[],this.LocalRendererStats=[],this.LocalSpeakerStats=[],this.LocalWindowShareStats=[],this.LoginTimeConsumedMs=0,this.LogStats=new r.LogStatistics,this.MaxBitRate=0,this.MaxEncodePixelRateInitial=0,this.MediaEnableTimeConsumedMs=0,this.MediaRouteAcquireTimeConsumedMs=0,this.NetworkInterfaceStats=[],this.OsName="",this.OsVersion="",this.ProcessorBrand="",this.ProcessorLogicalCores=0,this.ProcessorModel="",this.ProcessorPhysicalCores=0,this.ProcessorSpeed=0,this.RoomEnterTimeConsumedMs=0,this.TimeStamp="",this.UserAgent="",this.UserStats=[]}return e.prototype.EmptyBytesCountStatistic=function(){this.BytesSentUdp=0,this.BytesSentTcp=0,this.BytesReceivedUdp=0,this.BytesReceivedTcp=0},e}();n.EndpointStatistics=i},{"./LogStatistics":440}],431:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){this.Address="",this.LatencyMs=0,this.Latitude=0,this.Longitude=0,this.Name="",this.ResponseReceived=!1}}();n.LatencyTestDataStatistics=r},{}],432:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){this.LatencyTestDataStats=[]}}();n.LatencyTestStatistics=r},{}],433:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Statistics"),i=function(){function e(){this.AecEchoCoupling=0,this.AgcAverageGain=0,this.AudioLevel=0,this.AudioPacketsLost=0,this.BitsPerSample=0,this.BytesSentUdp=0,this.CodecName="",this.Format="",this.Id="",this.LocalSpeakerStreams=[],this.Name="",this.NoiseSuppressionSnr=0,this.NumberOfChannels=0,this.RemoteSpeakerStreams=[],this.SampleRateMeasured=0,this.SampleRateSet=0}return e.prototype.FillFromRTCStats=function(e,t){if(t){var n=t.get(e);if(n){this.AudioLevel=n.audioLevel||0;var i=r.CutSsrcFromTrackId(n.id||""),o=t.get("RTCOutboundRTPAudioStream_"+i);this._fillFromRTCOutboundRTPStreamStats(o,t)}}},e.prototype._fillFromCodecStats=function(e){e&&(this.CodecName=e.mimeType)},e.prototype._fillFromRTCOutboundRTPStreamStats=function(e,t){if(e){this.BytesSentUdp=e.bytesSent||0;var n=t.get(e.codecId);this._fillFromCodecStats(n)}},e}();n.LocalMicrophoneStatistics=i},{"./Statistics":451}],434:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){this.Format="",this.FrameIntervalMeasured=0,this.FrameIntervalSet=0,this.Height=0,this.Id="",this.Name="",this.TotalFrames=0,this.TotalPixels=0,this.Width=0}}();n.LocalRendererStatistics=r},{}],435:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){this.BufferDropped=0,this.BufferSize=0,this.Height=0,this.Id="",this.Name="",this.Width=0}}();n.LocalRendererStreamStatistics=r},{}],436:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){this.BitsPerSample=0,this.Format="",this.Id="",this.Name="",this.NumberOfChannels=0,this.SampleRateMeasured=0,this.SampleRateSet=0}}();n.LocalSpeakerStatistics=r},{}],437:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){this.BitsPerSample=0,this.Delay=0,this.Format="",this.HighestThreshold=0,this.HighThreshold=0,this.IsActive=!1,this.LastEnergy=0,this.LastPlayed=0,this.LowestThreshold=0,this.LowThreshold=0,this.MaxThreshold=0,this.Name="",this.NumberOfChannels=0,this.Overrun=0,this.Played=0,this.SampleRate=0,this.Underrun=0}}();n.LocalSpeakerStreamStatistics=r},{}],438:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Statistics"),i=e("../../utils/Constants"),o=function(){function e(){this.BytesSentUdp=0,this.CodecName="",this.FirsReceived=0,this.Format="",this.FrameIntervalMeasured=0,this.FrameIntervalSet=0,this.Height=0,this.Id="",this.LocalRendererStreams=[],this.NacksReceived=0,this.Name="",this.PlisReceived=0,this.RemoteRendererStreams=[],this.TotalFrames=0,this.VideoEncodeUsagePercent=0,this.VideoFrameRateInput=0,this.VideoFrameRateSent=0,this.VideoFramesEncoded=0,this.VideoPacketsLost=0,this.VideoResolutionLimitedByBandwidth=!1,this.VideoResolutionLimitedByCPU=!1,this.Width=0}return e.prototype.FillFromRTCStats=function(e,t,n){if(t){var r=t.get(e);r&&(this._fillFromRTCMediaStreamTrackStats(r,t),n&&this._calculateFrameRateSent(r,n.get(r.id)))}},e.prototype._calculateFrameRateSent=function(e,t){if(e&&t){var n=e.framesSent||0,r=e.timestamp||0,o=(n-(t.framesSent||0))/(r-(t.timestamp||0));this.VideoFrameRateSent=Math.round(o*i.SecToMsCoefficient)}},e.prototype._fillFromCodecStats=function(e){e&&(this.CodecName=e.mimeType)},e.prototype._fillFromRTCMediaStreamTrackStats=function(e,t){if(e){this.Height=e.frameHeight||0,this.Width=e.frameWidth||0,this.TotalFrames=e.framesSent||0;var n=r.CutSsrcFromTrackId(e.id||""),i=t.get("RTCOutboundRTPVideoStream_"+n);if(i||t.forEach(function(t){"outbound-rtp"===t.type&&t.trackId===e.id&&(i=t)}),this._fillFromRTCOutboundRTPStreamStats(i),i){var o=t.get(i.codecId);this._fillFromCodecStats(o)}}},e.prototype._fillFromRTCOutboundRTPStreamStats=function(e){e&&(this.BytesSentUdp=e.bytesSent||0,this.FirsReceived=e.firCount||0,this.NacksReceived=e.nackCount||0,this.PlisReceived=e.pliCount||0,this.VideoFramesEncoded=e.framesEncoded||0)},e}();n.LocalVideoSourceStatistics=o},{"../../utils/Constants":461,"./Statistics":451}],439:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){this.Name="",this.Occurances=0}}();n.LogDataStatistics=r},{}],440:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){this.LogErrorDataStats=[],this.LogWarningDataStats=[]}}();n.LogStatistics=r},{}],441:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.AddressType="",this.ComponentType="",this.ConnectionId=0,this.ConnectionType="",this.ExternalLocalAddr="",this.ExternalRemoteAddr="",this.InterfaceName="",this.InterfaceType="",this.InternalLocalAddr="",this.InternalRemoteAddr="",this.TransportPlugIn=""}return e.prototype.FillFromRTCStats=function(e,t){if(t){var n=t.get(e);n&&(this._fillFromCandidatePair(n,t),n.transportId.match(/RTCTransport_audio_/)?this.ConnectionType="audio":n.transportId.match(/RTCTransport_video/)&&(this.ConnectionType="video"))}},e.prototype._fillFromCandidatePair=function(e,t){if(e){var n=t.get(e.localCandidateId);n&&(this.TransportPlugIn="relay"===n.candidateType?("TURN "+n.protocol).toUpperCase():(""+n.protocol).toUpperCase(),this.InternalLocalAddr=n.ip,this.ExternalLocalAddr=n.ip);var r=t.get(e.remoteCandidateId);r&&(this.InternalRemoteAddr=r.ip,this.ExternalRemoteAddr=r.ip)}},e}();n.MediaConnectionTransportInformation=r},{}],442:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){this.IsUp=!1,this.Name="",this.Type=""}}();n.NetworkInterfaceStatistics=r},{}],443:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){this.CameraId="",this.CameraName="",this.Enabled=!1,this.FrameInterval=0,this.Height=0,this.Id="",this.Name="",this.PixelRate=0,this.Width=0}}();n.ParticipantGenerationStatistics=r},{}],444:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.Id="",this.Name="",this.ParticipantIsActive=!1,this.RemoteCameraStats=[],this.RemoteMicrophoneStats=[],this.RemoteWindowShareStats=[],this.SSRCs=[],this.UserId=""}return e.prototype.EmptyStats=function(){this.RemoteCameraStats=[],this.RemoteMicrophoneStats=[],this.RemoteWindowShareStats=[],this.SSRCs=[]},e}();n.ParticipantStatistic=r},{}],445:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){this.DelayNormal=0,this.DelayRetransmit=0,this.DropNormal=0,this.PacketsNormal=0,this.PacketsRetransmit=0}}();n.RateShaperStatistics=r},{}],446:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../utils/Constants"),i=function(){function e(){this.AudioBytesReceived=0,this.AudioDecodingMuted=0,this.AudioDecodingNormal=0,this.BitsPerSample=0,this.CodecDtx=0,this.CodecName="",this.CodecQualitySetting=0,this.Id="",this.LastFrameMs=0,this.LocalSpeakerStreams=[],this.Name="",this.NumberOfChannels=0,this.ReceiveNetworkBitRate=0,this.ReceiveNetworkDelay=0,this.ReceiveNetworkDroppedPackets=0,this.ReceiveNetworkJitter=0,this.ReceiveNetworkPacketsConcealed=0,this.ReceiveNetworkPacketsLost=0,this.SampleRateMeasured=0,this.SampleRateSet=0}return e.prototype.FillFromAudioAnalyzerStats=function(e){e&&(this.BitsPerSample=e.sampleSize,this.NumberOfChannels=e.channelsCount,this.SampleRateSet=e.sampleRate,this.SampleRateMeasured=e.sampleRate)},e.prototype.FillFromRTCStats=function(e,t,n){if(t){var r=t.get(e);if(r){var i=t.get("RTCInboundRTPAudioStream_"+r.trackIdentifier);this._fillFromRTCInboundRTPStreamStats(i,t,n)}}},e.prototype._calculateBitrate=function(e,t){if(e&&t){var n=e.bytesReceived||0,i=e.timestamp||0,o=t.bytesReceived||0,a=t.timestamp||0,s=r.BitsInByteValue*(n-o)/(i-a);this.ReceiveNetworkBitRate=Math.floor(s*r.SecToMsCoefficient)}},e.prototype._fillFromCodecStats=function(e){e&&(this.CodecName=e.mimeType)},e.prototype._fillFromRTCInboundRTPStreamStats=function(e,t,n){if(e){this.ReceiveNetworkJitter=e.jitter||0,this.AudioBytesReceived=e.bytesReceived||0,n&&this._calculateBitrate(e,n.get(e.id));var r=t.get(e.codecId);this._fillFromCodecStats(r)}},e}();n.RemoteMicrophoneStatistics=i},{"../../utils/Constants":461}],447:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){this.CodecFir=0,this.CodecIFrames=0,this.CodecLayers=0,this.CodecNacks=0,this.CodecName="",this.Fps=0,this.FpsInput=0,this.FpsSent=0,this.FramesDropped=0,this.Height=0,this.LastHeight=0,this.LastWidth=0,this.Name="",this.SendNetworkBitRate=0,this.SendNetworkRtt=0,this.Width=0}}();n.RemoteRendererStreamStatistics=r},{}],448:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(){this.BitsPerSample=0,this.CodecDtx=0,this.CodecName="",this.CodecQualitySetting=0,this.Name="",this.NumberOfChannels=0,this.SampleRate=0,this.SendNetworkBitRate=0,this.SendNetworkRtt=0}}();n.RemoteSpeakerStreamStatistics=r},{}],449:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../utils/Constants"),i=function(){function e(){this.CodecFir=0,this.CodecIFrames=0,this.CodecLayers=0,this.CodecNacks=0,this.CodecName="",this.FpsDecoded=0,this.FpsDecoderInput=0,this.FpsRendered=0,this.Height=0,this.Id="",this.JitterBuffer=0,this.LocalRendererStreams=[],this.MaxStreamFrameRate=0,this.MaxStreamHeight=0,this.MaxStreamWidth=0,this.Name="",this.PlisSent=0,this.ReceiveNetworkBitRate=0,this.ReceiveNetworkPacketsConcealed=0,this.ReceiveNetworkPacketsLost=0,this.ReceiveNetworkPacketsReordered=0,this.ReceiveNetworkRecoveredWithFec=0,this.ShowFrameRate=0,this.ShowHeight=0,this.ShowPixelRate=0,this.ShowState="",this.ShowWidth=0,this.VideoFrameRateDecoded=0,this.VideoFrameRateOutput=0,this.VideoFrameRateReceived=0,this.VideoFramesDecoded=0,this.VideoPacketsReceived=0,this.Width=0}return e.prototype.FillFromRTCStats=function(e,t,n){if(t){var r=t.get(e);this._fillFromRTCMediaStreamTrackStats(r);var i=t.get("RTCInboundRTPVideoStream_"+r.trackIdentifier);this._fillFromRTCInboundRTPStreamStats(i,t),n&&(this._calculateFPS(r,n.get(r.id)),this._calculateBitrate(i,n.get(i.id)))}},e.prototype._calculateBitrate=function(e,t){if(e&&t){var n=e.bytesReceived||0,i=e.timestamp||0,o=t.bytesReceived||0,a=t.timestamp||0,s=r.BitsInByteValue*(n-o)/(i-a);this.ReceiveNetworkBitRate=Math.floor(s*r.SecToMsCoefficient)}},e.prototype._calculateFPS=function(e,t){if(t){var n=e.framesDecoded||0,i=e.timestamp||0,o=t.framesDecoded||0,a=t.timestamp||0,s=(n-o)/(i-a);this.FpsDecoded=Math.round(s*r.SecToMsCoefficient),this.VideoFrameRateDecoded=this.FpsDecoded;e.framesReceived,t.framesReceived;this.FpsRendered=Math.round(s*r.SecToMsCoefficient),this.VideoFrameRateReceived=this.FpsRendered}},e.prototype._fillFromCodecStats=function(e){e&&(this.CodecName=e.mimeType)},e.prototype._fillFromRTCInboundRTPStreamStats=function(e,t){if(e){this.CodecFir=e.firCount||0,this.CodecNacks=e.nackCount||0,this.ReceiveNetworkPacketsLost=e.packetsLost||0,this.VideoPacketsReceived=e.packetsReceived||0,this.PlisSent=e.pliCount||0;var n=t.get(e.codecId);this._fillFromCodecStats(n)}},e.prototype._fillFromRTCMediaStreamTrackStats=function(e){e&&(this.Width=e.frameWidth||0,this.Height=e.frameHeight||0,this.VideoFramesDecoded=e.framesDecoded||0)},e}();n.RemoteVideoSourceStatistics=i},{"../../utils/Constants":461}],450:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./BandwidthSummaryStatistics"),i=e("./RateShaperStatistics"),o=function(){return function(){this.AvailableDecodeBwPercent=0,this.AvailableDecodeCpuPercent=0,this.AvailableEncodeBwPercent=0,this.AvailableEncodeCpuPercent=0,this.BandwidthApp=new r.BandwidthSummaryStatistics,this.BandwidthAudio=new r.BandwidthSummaryStatistics,this.BandwidthVideo=new r.BandwidthSummaryStatistics,this.CallId="",this.ConferenceId="",this.CpuUsage=0,this.CurrentBandwidthDecodePixelRate=0,this.CurrentBandwidthEncodePixelRate=0,this.CurrentCpuDecodePixelRate=0,this.CurrentCpuEncodePixelRate=0,this.Id="",this.MaxDecodePixelRate=0,this.MaxEncodePixelRate=0,this.MaxVideoSources=0,this.ParticipantGenerationStats=[],this.ParticipantStats=[],this.RateShaperApp=new i.RateShaperStatistics,this.RateShaperAudio=new i.RateShaperStatistics,this.RateShaperVideo=new i.RateShaperStatistics,this.ReceiveBitRateAvailable=0,this.ReceiveBitRateTotal=0,this.ReflectorId="",this.SendBitRateAvailable=0,this.SendBitRateTotal=0,this.StaticSources=0,this.TransportInformation=[]}}();n.RoomStatistics=o},{"./BandwidthSummaryStatistics":429,"./RateShaperStatistics":445}],451:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../utils/PrettyNumber"),i=e("../../utils/Collection"),o=e("../../utils/ObjectUtils"),a=function(){function e(){this.AudioBytesSent=new r.PrettyNumber,this.AudioCodec="",this.AudioLevel=new r.PrettyNumber,this.AudioPacketsLost=new r.PrettyNumber,this.AvailableRecieveBandwidth=new r.PrettyNumber,this.AvailableSendBandwidth=new r.PrettyNumber,this.EncodeBitrate=new r.PrettyNumber,this.FirsReceived=new r.PrettyNumber,this.NacksReceived=new r.PrettyNumber,this.ParticipantStatistics=new i.Collection(function(e){return new s(e)}),this.PlisReceived=new r.PrettyNumber,this.TargetEncodeBitrate=new r.PrettyNumber,this.TransmitBitrate=new r.PrettyNumber,this.VideoBytesSent=new r.PrettyNumber,this.VideoCodec="",this.VideoEncodeUsagePercent=new r.PrettyNumberWithUnits("%"),this.VideoFrameRateInput=new r.PrettyNumber,this.VideoFrameRateSent=new r.PrettyNumber,this.VideoFramesEncoded=new r.PrettyNumber,this.VideoPacketsLost=new r.PrettyNumber,this.VideoResolutionSent=new r.PrettyTuple("x")}return Object.defineProperty(e.prototype,"RemoteParticipantAverageFrameRate",{get:function(){var e=this._activeParticipantsStatistics.map(function(e){return e.VideoFrameRateOutput.Value});return new r.PrettyNumber(o.default.MeanValueOfArray(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RemoteParticipantAverageResolution",{get:function(){var e=this._activeParticipantsStatistics.map(function(e){return e.VideoResolutionReceived.Values[0]}),t=this._activeParticipantsStatistics.map(function(e){return e.VideoResolutionReceived.Values[1]}),n=o.default.MeanValueOfArray(e),i=o.default.MeanValueOfArray(t);return new r.PrettyTuple("x",n,i)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RemoteParticipantTotalFirsSent",{get:function(){return this._calculateStatisticsTotalBy("FirsSent")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RemoteParticipantTotalNacksSent",{get:function(){return this._calculateStatisticsTotalBy("NacksSent")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RemoteParticipantTotalPlisSent",{get:function(){return this._calculateStatisticsTotalBy("PlisSent")},enumerable:!0,configurable:!0}),e.prototype.FillFromBandwidthSummaryStatistics=function(e){this.TargetEncodeBitrate.Value=e.TargetEncoderBitRate,this.TransmitBitrate.Value=e.TotalTransmitBitRate,this.EncodeBitrate.Value=e.ActualEncoderBitRate,this.AvailableRecieveBandwidth.Value=e.AvailableRecieveBandwidth,this.AvailableSendBandwidth.Value=e.AvailableBandwidth},e.prototype.FillFromLocalMicrophoneStatistics=function(e){this.AudioCodec=e.CodecName,this.AudioBytesSent.Value=e.BytesSentUdp,this.AudioLevel.Value=e.AudioLevel,this.AudioPacketsLost.Value=e.AudioPacketsLost},e.prototype.FillFromLocalVideoSourceStatistics=function(e){this.VideoCodec=e.CodecName,this.FirsReceived.Value=e.FirsReceived,this.NacksReceived.Value=e.NacksReceived,this.PlisReceived.Value=e.PlisReceived,this.VideoBytesSent.Value=e.BytesSentUdp,this.VideoEncodeUsagePercent.Value=e.VideoEncodeUsagePercent,this.VideoFrameRateInput.Value=e.VideoFrameRateInput,this.VideoFrameRateSent.Value=e.VideoFrameRateSent,this.VideoFramesEncoded.Value=e.VideoFramesEncoded,this.VideoPacketsLost.Value=e.VideoPacketsLost,this.VideoResolutionSent.SetValues(e.Width,e.Height),this.VideoResolutionLimitedByBandwidth=e.VideoResolutionLimitedByBandwidth,this.VideoResolutionLimitedByCPU=e.VideoResolutionLimitedByCPU},Object.defineProperty(e.prototype,"_activeParticipantsStatistics",{get:function(){return this.ParticipantStatistics.Where({ParticipantIsActive:!0})},enumerable:!0,configurable:!0}),e.prototype._calculateStatisticsTotalBy=function(e){return new r.PrettyNumber(this.ParticipantStatistics.All().reduce(function(t,n){return t+n[e].Value},0))},e}();n.CallStatistics=a;var s=function(){function e(e){this.Id=e,this.AudioBytesReceived=new r.PrettyNumber,this.AudioCodec="",this.AudioDecodingMuted=new r.PrettyNumber,this.AudioDecodingNormal=new r.PrettyNumber,this.FirsSent=new r.PrettyNumber,this.JitterBuffer=new r.PrettyNumber,this.NacksSent=new r.PrettyNumber,this.PlisSent=new r.PrettyNumber,this.SSRCs=new r.PrettyList,this.VideoCodec="",this.VideoFrameRateDecoded=new r.PrettyNumber,this.VideoFrameRateOutput=new r.PrettyNumber,this.VideoFrameRateReceived=new r.PrettyNumber,this.VideoFramesDecoded=new r.PrettyNumber,this.VideoPacketsLost=new r.PrettyNumber,this.VideoPacketsReceived=new r.PrettyNumber,this.VideoResolutionReceived=new r.PrettyTuple("x")}return e.prototype.FillFromRemoteMicrophoneStatistics=function(e){this.AudioBytesReceived.Value=e.AudioBytesReceived,this.AudioCodec=e.CodecName,this.AudioDecodingMuted.Value=e.AudioDecodingMuted,this.AudioDecodingNormal.Value=e.AudioDecodingNormal},e.prototype.FillFromRemoteVideoSourceStatistics=function(e){this.FirsSent.Value=e.CodecFir,this.JitterBuffer.Value=e.JitterBuffer,this.NacksSent.Value=e.CodecNacks,this.PlisSent.Value=e.PlisSent,this.VideoCodec=e.CodecName,this.VideoFrameRateDecoded.Value=e.VideoFrameRateDecoded,this.VideoFrameRateOutput.Value=e.VideoFrameRateOutput,this.VideoFrameRateReceived.Value=e.VideoFrameRateReceived,this.VideoFramesDecoded.Value=e.VideoFramesDecoded,this.VideoPacketsLost.Value=e.ReceiveNetworkPacketsLost,this.VideoPacketsReceived.Value=e.VideoPacketsReceived,this.VideoResolutionReceived.SetValues(e.Width,e.Height)},e}();n.ParticipantStatistics=s;var c=e("./BandwidthSummaryStatistics");n.BandwidthSummaryStatistics=c.BandwidthSummaryStatistics;var u=e("./EndpointStatistics");n.EndpointStatistics=u.EndpointStatistics;var l=e("./LocalMicrophoneStatistics");n.LocalMicrophoneStatistics=l.LocalMicrophoneStatistics;var d=e("./LocalRendererStatistics");n.LocalRendererStatistics=d.LocalRendererStatistics;var p=e("./LocalRendererStreamStatistics");n.LocalRendererStreamStatistics=p.LocalRendererStreamStatistics;var f=e("./LocalSpeakerStatistics");n.LocalSpeakerStatistics=f.LocalSpeakerStatistics;var h=e("./LocalSpeakerStreamStatistics");n.LocalSpeakerStreamStatistics=h.LocalSpeakerStreamStatistics;var m=e("./LocalVideoSourceStatistics");n.LocalVideoSourceStatistics=m.LocalVideoSourceStatistics;var v=e("./MediaConnectionTransportInformation");n.MediaConnectionTransportInformation=v.MediaConnectionTransportInformation;var y=e("./NetworkInterfaceStatistics");n.NetworkInterfaceStatistics=y.NetworkInterfaceStatistics;var g=e("./ParticipantGenerationStatistics");n.ParticipantGenerationStatistics=g.ParticipantGenerationStatistics;var S=e("./ParticipantStatistic");n.ParticipantStatistic=S.ParticipantStatistic;var _=e("./RateShaperStatistics");n.RateShaperStatistics=_.RateShaperStatistics;var b=e("./RemoteMicrophoneStatistics");n.RemoteMicrophoneStatistics=b.RemoteMicrophoneStatistics;var C=e("./RemoteRendererStreamStatistics");n.RemoteRendererStreamStatistics=C.RemoteRendererStreamStatistics;var w=e("./RemoteSpeakerStreamStatistics");n.RemoteSpeakerStreamStatistics=w.RemoteSpeakerStreamStatistics;var E=e("./RemoteVideoSourceStatistics");n.RemoteVideoSourceStatistics=E.RemoteVideoSourceStatistics;var R=e("./RoomStatistics");n.RoomStatistics=R.RoomStatistics;var P=e("./UserStatistics");n.UserStatistics=P.UserStatistics;var L=e("./LogDataStatistics");n.LogDataStatistics=L.LogDataStatistics;var T=e("./LogStatistics");n.LogStatistics=T.LogStatistics;var x=e("./LatencyTestDataStatistics");n.LatencyTestDataStatistics=x.LatencyTestDataStatistics;var M=e("./LatencyTestStatistics");n.LatencyTestStatistics=M.LatencyTestStatistics,n.CutSsrcFromTrackId=function(e){var t=e.match(/\d+$/),n="0";return t&&t.length&&(n=t[0]),n}},{"../../utils/Collection":460,"../../utils/ObjectUtils":471,"../../utils/PrettyNumber":474,"./BandwidthSummaryStatistics":429,"./EndpointStatistics":430,"./LatencyTestDataStatistics":431,"./LatencyTestStatistics":432,"./LocalMicrophoneStatistics":433,"./LocalRendererStatistics":434,"./LocalRendererStreamStatistics":435,"./LocalSpeakerStatistics":436,"./LocalSpeakerStreamStatistics":437,"./LocalVideoSourceStatistics":438,"./LogDataStatistics":439,"./LogStatistics":440,"./MediaConnectionTransportInformation":441,"./NetworkInterfaceStatistics":442,"./ParticipantGenerationStatistics":443,"./ParticipantStatistic":444,"./RateShaperStatistics":445,"./RemoteMicrophoneStatistics":446,"./RemoteRendererStreamStatistics":447,"./RemoteSpeakerStreamStatistics":448,"./RemoteVideoSourceStatistics":449,"./RoomStatistics":450,"./UserStatistics":452}],452:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./LatencyTestStatistics"),i=function(){return function(){this.Host="",this.Id="",this.LatencyTestStats=new r.LatencyTestStatistics,this.Port=0,this.RoomStats=[],this.ServiceType=""}}();n.UserStatistics=i},{"./LatencyTestStatistics":432}],453:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./ReadOnlyMediaTrack"),i=function(){function e(e){this._mediaStream=e,this._callbacksToRemove=[]}return e.prototype.GetAudioTracks=function(){return this._mediaStream.getAudioTracks().map(function(e){return new r.ReadOnlyMediaTrack(e)})},e.prototype.GetMediaStream=function(){return this._mediaStream},e.prototype.GetTracks=function(){return this._mediaStream.getTracks().map(function(e){return new r.ReadOnlyMediaTrack(e)})},e.prototype.GetVideoTracks=function(){return this._mediaStream.getVideoTracks().map(function(e){return new r.ReadOnlyMediaTrack(e)})},e.prototype.OnTrackAdded=function(e){this._mediaStream.addEventListener("addtrack",e),this._callbacksToRemove.push(new o("addtrack",e))},e.prototype.OnTrackEnabledChanged=function(e){this._mediaStream.addEventListener("trackenabledchanged",e),this._callbacksToRemove.push(new o("trackenabledchanged",e))},e.prototype.OnTrackRemoved=function(e){this._mediaStream.addEventListener("removetrack",e),this._callbacksToRemove.push(new o("removetrack",e))},e.prototype.UnregisterEventListeners=function(){var e=this;this._callbacksToRemove.forEach(function(t){return e._mediaStream.removeEventListener(t.EventType,t.Listener)})},Object.defineProperty(e.prototype,"Id",{get:function(){return this._mediaStream.id},enumerable:!0,configurable:!0}),e}();n.ReadOnlyMediaStream=i;var o=function(){return function(e,t){this.EventType=e,this.Listener=t}}()},{"./ReadOnlyMediaTrack":454}],454:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../Source"),i=function(){function e(e){this._mediaTrack=e}return e.prototype.IsActive=function(){return this.Enabled&&!this.Muted},Object.defineProperty(e.prototype,"Enabled",{get:function(){return this._mediaTrack.enabled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Id",{get:function(){return this._mediaTrack.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Kind",{get:function(){var e=this._mediaTrack.kind;if(r.IsSourceMediaType(e))return e;throw new Error("Unknown track type: "+e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Label",{get:function(){return this._mediaTrack.label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Muted",{get:function(){return this._mediaTrack.muted},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Settings",{get:function(){return this._mediaTrack.getSettings()},enumerable:!0,configurable:!0}),e}();n.ReadOnlyMediaTrack=i},{"../Source":418}],455:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AssignHiddenPropertyValue=function(e,t,n){Object.defineProperty(e,t,{get:function(){return n},configurable:!0})}},{}],456:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.CalculateSampleSize=function(e){var t=Math.log2(e);return t=t<=8?8:t>8&&t<=16?16:32},e.getAudioContext=function(){return e._audioContext},e.GetAudioStats=function(t){var n,r=e._state[t];return r&&(n=r.stats),n},e.Monitor=function(t,n){if(e._audioContext&&!(t.getAudioTracks().length<=0)){var r=new MediaStream;t.getAudioTracks().forEach(function(e){r.addTrack(e.clone())});var i=e._audioContext.createAnalyser(),o=e._audioContext.createMediaStreamSource(r),a=e._audioContext.createScriptProcessor(8192,1,1);e._state[t.id]={analyser:i,clonedStream:r,microphone:o,javascriptNode:a,stats:{}};var s=t.id;i.smoothingTimeConstant=.8;i.fftSize=1024,o.connect(i),i.connect(a),a.connect(e._audioContext.destination),a.onaudioprocess=function(t){var r=new Uint8Array(i.frequencyBinCount);i.getByteFrequencyData(r);for(var o=0,a=r.length,c=0;c<a;c++)o+=r[c];var u=o/a,l=e._state[s];l&&(l.stats={sampleRate:t.inputBuffer.sampleRate,channelsCount:t.inputBuffer.numberOfChannels,sampleSize:e.CalculateSampleSize(t.inputBuffer.sampleRate)}),n(u)}}},e.StopMonitoring=function(t){var n=e._state[t];n&&(n.javascriptNode.onaudioprocess=null,n.microphone.disconnect(),n.analyser.disconnect(),n.clonedStream.getAudioTracks().forEach(function(e){return e.stop()}),e._state[t]=null,delete e._state[t])},e._audioContext="undefined"!=typeof AudioContext?new AudioContext:"undefined"!=typeof webkitAudioContext?new webkitAudioContext:void 0,e._state={},e}();n.AudioAnalyser=r},{}],457:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CreateAutoProperties=function(e,t,n){var r=new(e(Object));Object.getOwnPropertyNames(r).forEach(function(e){return Object.defineProperty(t,e,n(e))})}},{}],458:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./ChromeWebstoreProvider"),i=function(){function e(){}return e.AssertInstalled=function(){return e.ExtensionIsInstalled()?Promise.resolve(void 0):e.Install()},e.ExtensionIsInstalled=function(){return!!document.getElementById("vidyowebrtcscreenshare_is_installed")},e.Install=function(){return e._insertChromeWebStoreItemLink(),new Promise(function(t,n){r.ChromeWebstoreProvider.GetChromeWebstore().install(e._extensionUrl,t,n),e._removeChromeWebStoreItemLink()}).catch(function(t){if(["User cancelled install"].indexOf(t)>=0)return Promise.reject(t);function n(e){return"Inline install failed ("+t+"); Attempted to fall back to Chrome Store but "+e}if(window.open(e._extensionUrl)){if(e._pendingInstall)throw n("extension install is already in progress");e._pendingInstall=!0;var r=30,i=1e3*r,o=0,a=10;return new Promise(function(t,s){!function c(){o>=i?s(n("the user did not install the extension within "+r+" seconds")):(o+=a,e.ExtensionIsInstalled()?t():setTimeout(c,a))}()}).then(function(){e._pendingInstall=!1}).catch(function(t){throw e._pendingInstall=!1,t})}throw n("pop-ups are blocked")}).catch(function(e){throw"Installing Screen Share Extension failed: "+e})},e.StopWaitingForInstall=function(){e._pendingInstall=!1},Object.defineProperty(e,"_extensionUrl",{get:function(){return"https://chrome.google.com/webstore/detail/"+e._extensionId},enumerable:!0,configurable:!0}),Object.defineProperty(e,"_extensionChromeWebStoreItemLinkSelector",{get:function(){return"link[rel='chrome-webstore-item'][href='"+e._extensionUrl+"']"},enumerable:!0,configurable:!0}),e._insertChromeWebStoreItemLink=function(){if(!document.querySelector(e._extensionChromeWebStoreItemLinkSelector)){var t=document.createElement("link");t.rel="chrome-webstore-item",t.href=e._extensionUrl,document.head.appendChild(t)}},e._removeChromeWebStoreItemLink=function(){var t=document.querySelector(e._extensionChromeWebStoreItemLinkSelector);t&&t.parentNode&&t.parentNode.removeChild(t)},e._extensionId="fadjebjcpiiklefiadeicakcnkhgbaoo",e._pendingInstall=!1,e}();n.ChromeExtensionProvider=i},{"./ChromeWebstoreProvider":459}],459:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.GetChromeWebstore=function(){return chrome.webstore},e}();n.ChromeWebstoreProvider=r},{}],460:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./ObjectUtils"),i=function(){return function(e,t){this.Id=e,this.Data=t}}();n.DataWithId=i;var o=function(){function e(e){this._createDefaultValue=e,this._collection={}}return e.prototype.Add=function(e){this._collection[e.Id]=e},e.prototype.All=function(){return Object.values(this._collection)},e.prototype.Create=function(e){var t=this._createDefaultValue(e);return this._collection[e]=t,t},e.prototype.Get=function(e){return this._collection[e]||this.Create(e),this._collection[e]},e.prototype.Remove=function(e){delete this._collection[e]},e.prototype.Where=function(e){return r.default.Filter(this._collection,e)},e}();n.Collection=o},{"./ObjectUtils":471}],461:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../models/ConferenceCommandParameters");n.ApplicationTag="NativeWebRTC",n.BaseTenRadix=10,n.BitsInByteValue=8,n.ScreenRefreshRate=60,n.DefaultLocalStreamFrameRate=30,n.DefaultLocalStreamHeight=480,n.DefaultLocalStreamWidth=640,n.DefaultLocalShareStreamFrameRate=3,n.DefaultLocalShareStreamHeight=1080,n.DefaultLocalShareStreamWidth=1920,n.DefaultPort=443,n.DefaultSelfViewPolicy=r.SelfViewPolicy.HideSelf,n.DefaultTimeOut=60,n.MinimumLocalStreamHeight=180,n.MinimumLocalStreamWidth=320,n.AtomicTimeOut=15,n.BatchTimeOut=30,n.KiloCoefficient=1e3,n.Muc="@muc.",n.NumberOfSelectedAudioSources=3,n.ParticipantLimit=8,n.PreviewParticipantId="__preview",n.ResourceIdDomainSeparator="_",n.SecToMsCoefficient=1e3,n.StatisticsRefreshInterval=1e3,n.SendClientStatisticsInterval=1e4,n.ResourceManagerStatisticsMeasuringInterval=1e3,n.ResourceManagerStatisticsAnalyzingInterval=15e3,n.ResourceManagerInitializationPeriod=15e3,n.StreamMonitoringInterval=250,n.SubscriptionDialogDuration=3600,n.Threshold=.1,n.ReflectorPoolsURL="/static/poolreflectors.json",n.LibVersion="19.2.0",n.LibBuild="8",n.OutgoingBandwidthCalculationInterval=1e4,n.MediaConstraints={audio:!0,video:!0},n.LocationConstraint=!0,n.MaxDisplayNameLength=255,n.LatencyCheckTimeout=1e3,n.LocationCheckTimeout=n.LatencyCheckTimeout},{"../models/ConferenceCommandParameters":410}],462:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){function t(n){var r=e.call(this,n)||this;return r.name=t.Name,r}return i(t,e),t.Name="DuplicateNameError",t}(Error);n.DuplicateNameError=o;var a=function(e){function t(n){var r=e.call(this,n)||this;return r.name=t.Name,r}return i(t,e),t.Name="TimeOutError",t}(Error);n.TimeOutError=a;var s=function(e){function t(n){var r=e.call(this,n)||this;return r.name=t.Name,r}return i(t,e),t.Name="NotValidClientError",t}(Error);n.NotValidClientError=s},{}],463:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e){this.setEventName(e)}return e.prototype.Scoped=function(t){return new e(this.toString()+":"+t)},e.prototype.setEventName=function(e){this._name=e||""},e.prototype.slice=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.toString()).slice.apply(e,t)},e.prototype.toString=function(){return this._name},e}();n.EventDescriptor=r;var i=function(){return function(){}}();n.EventListBase=i,n.CreateEventList=function(e,t){for(var n=new t,r=0,i=Object.keys(n);r<i.length;r++){var o=i[r];n[o].setEventName(e+":"+o)}return n}},{}],464:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};function i(e){return e&&"object"==typeof e?Object.keys(e):[]}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){[e,e.prototype].forEach(function(e){var t=function(t){if(e.hasOwnProperty(t)&&"function"==typeof e[t]&&"_"!==(""+t)[0]){var n=e[t];e[t]=function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return function(e,t,n){var a,s="function"==typeof e?e.name:e.constructor.name;if(o[t]){var c=r({required:{},optional:{}},o[t]),u=r({},c.required,c.optional),l=i(c.required),d=i(c.optional);if(1!==n.length||"object"!=typeof n[0])throw s+"::"+t+': Method accepts 1 argument with type of "object"';var p=i(n[0]),f=l.concat(d),h=p.filter(function(e){return!f.includes(e)});if(h.length)throw s+"::"+t+": Unexpected propert"+(h.length>1?"ies":"y")+": { "+h.toString().replace(/\,/g,", ")+" }";for(var m in u)if(m){if(!n[0].hasOwnProperty(m)&&l.includes(m))throw s+"::"+t+': Missing property "'+m+'": "'+u[m]+'"';if(!u[m].split("|").includes((a=n[0][m],"object"!=typeof a||a?typeof a:"null"))&&void 0!==n[0][m])throw s+"::"+t+': Invalid type of property "'+m+'".\n\r  Expected type: '+u[m]+", but actually got a "+typeof n[0][m]}}else if(n.length)throw s+"::"+t+": Method doesn't accept any arguments"}(e,t,a),n.apply(this,a)}}};for(var n in e)t(n)})};var o={AssignViewToCompositeRenderer:{required:{remoteParticipants:"number",viewId:"string",viewStyle:"string"}},AssignViewToLocalCamera:{required:{allowZoom:"boolean",displayCropped:"boolean",localCamera:"object",viewId:"string"}},AssignViewToLocalMonitor:{required:{allowZoom:"boolean",displayCropped:"boolean",localMonitor:"object",viewId:"string"}},AssignViewToLocalWindowShare:{required:{allowZoom:"boolean",displayCropped:"boolean",localWindowShare:"object",viewId:"string"}},AssignViewToRemoteCamera:{required:{allowZoom:"boolean",displayCropped:"boolean",remoteCamera:"object",viewId:"string"}},AssignViewToRemoteWindowShare:{required:{allowZoom:"boolean",displayCropped:"boolean",remoteWindowShare:"object",viewId:"string"}},Connect:{required:{displayName:"string",host:"string",onDisconnected:"function",onFailure:"function",onSuccess:"function",resourceId:"string",token:"string"},optional:{constraints:"object"}},CreateVidyoConnector:{required:{logFileFilter:"string",logFileName:"string",remoteParticipants:"number",userData:"number|string",viewId:"string|null",viewStyle:"string"},optional:{constraints:"object"}},EnableDebug:{required:{port:"number",logFilter:"string"}},HideView:{required:{viewId:"string"}},RegisterAdvancedSettingsEventListener:{optional:{onAddGoogleConferenceFlagChanged:"function",onCodecExcludeFilterChanged:"function",onDisableStatsChanged:"function",onEnableSimpleAPILoggingChanged:"function",onEnableSimulcastChanged:"function",onEnableVidyoConnectorAPILoggingChanged:"function",onEnableXMPPMessageLoggingChanged:"function",onParticipantLimitChanged:"function",onLogCategoryChanged:"function",onShowStatisticsOverlayChanged:"function"}},RegisterLocalCameraEventListener:{required:{onAdded:"function",onRemoved:"function",onSelected:"function",onStateUpdated:"function"}},RegisterLocalMicrophoneEnergyListener:{required:{onEnergy:"function"}},RegisterLocalMicrophoneEventListener:{required:{onAdded:"function",onRemoved:"function",onSelected:"function",onStateUpdated:"function"}},RegisterLocalMonitorEventListener:{required:{onAdded:"function",onRemoved:"function",onSelected:"function",onStateUpdated:"function"}},RegisterLocalSpeakerEventListener:{required:{onAdded:"function",onRemoved:"function",onSelected:"function",onStateUpdated:"function"}},RegisterLocalWindowShareEventListener:{required:{onAdded:"function",onRemoved:"function",onSelected:"function",onStateUpdated:"function"}},RegisterMessageEventListener:{required:{onChatMessageReceived:"function"}},RegisterLogEventListener:{required:{filter:"string",onLog:"function"}},RegisterParticipantEventListener:{required:{onDynamicChanged:"function",onJoined:"function",onLeft:"function",onLoudestChanged:"function"}},RegisterPermissionEventListener:{required:{onPermissionUpdated:"function"}},RegisterRemoteCameraEventListener:{required:{onAdded:"function",onRemoved:"function",onStateUpdated:"function"}},RegisterRemoteMicrophoneEnergyListener:{required:{onEnergy:"function"}},RegisterRemoteMicrophoneEventListener:{required:{onAdded:"function",onRemoved:"function",onStateUpdated:"function"}},RegisterRemoteWindowShareEventListener:{required:{onAdded:"function",onRemoved:"function",onStateUpdated:"function"}},RegisterResourceManagerEventListener:{required:{onAvailableResourcesChanged:"function",onMaxRemoteSourcesChanged:"function"}},ReportLocalParticipantOnJoined:{required:{reportLocalParticipant:"boolean"}},SelectAudioContentShare:{required:{localMicrophone:"object|null"}},SelectCamera:{required:{camera:"object|null"}},SelectLocalCamera:{required:{localCamera:"object|null"}},SelectMicrophone:{required:{microphone:"object|null"}},SelectLocalMicrophone:{required:{localMicrophone:"object|null"}},SelectLocalMonitor:{required:{localMonitor:"object|null"}},SelectSpeaker:{required:{speaker:"object|null"}},SelectLocalSpeaker:{required:{localSpeaker:"object|null"}},SelectLocalWindowShare:{required:{localWindowShare:"object|null"}},SelectVideoContentShare:{required:{localCamera:"object|null"}},SendChatMessage:{required:{message:"string"}},SetAdvancedConfiguration:{optional:{addGoogleConferenceFlag:"boolean",addLogCategory:"string",codecExcludeFilter:"string",disableStats:"boolean",enableSimpleAPILogging:"boolean",enableSimulcast:"boolean",enableVidyoConnectorAPILogging:"boolean",enableXMPPMessageLogging:"boolean",participantLimit:"number|string",showStatisticsOverlay:"boolean"}},SetCameraPrivacy:{required:{privacy:"boolean"}},SetLocation:{required:{latitude:"number",longitude:"number"}},SetMaxBitRate:{required:{bitRate:"number|null"}},SetMicrophonePrivacy:{required:{privacy:"boolean"}},SetPool:{required:{name:"string"}},SetSpeakerPrivacy:{required:{privacy:"boolean"}},ShowAudioMeters:{required:{showMeters:"boolean",viewId:"string"}},ShowPreview:{required:{preview:"boolean"}},ShowViewAt:{required:{height:"number",viewId:"string",width:"number",x:"number",y:"number"}},ShowViewLabel:{required:{showLabel:"boolean",viewId:"string"}},ShowWindowSharePreview:{required:{preview:"boolean"}}}},{}],465:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.Clear=function(){try{localStorage.clear()}catch(e){}},e.Get=function(e){var t=null;try{t=localStorage.getItem(e)}catch(e){}return t},e.Set=function(e,t){try{t?localStorage.setItem(e,t):localStorage.removeItem(e)}catch(e){}},e}();n.LocalStorageProvider=r},{}],466:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Constants"),i=function(){function e(){}return e.GetCurrentPosition=function(){var t=e._userLocation||e._actualLocation;return t?Promise.resolve(t):e._isLocationRequestEnabled?e._getPositionAsync():Promise.reject("Request is rejected")},e.GetCurrentPositionSync=function(){return e._userLocation||e._actualLocation},e.HasCurrentPosition=function(){return!(!e._userLocation&&!e._actualLocation)},e.Initialize=function(){e._setWatch()},e.SetDefaultLocationStatus=function(t){void 0===t&&(t=!1),e._isLocationRequestEnabled=t},e.SetLocation=function(t){e._clearWatch(),e._userLocation=e._getMinutes(t)},e.toMinutes=function(t){return e._getMinutes(t)},e._clearWatch=function(){e._watchId&&(navigator.geolocation.clearWatch(e._watchId),e._watchId=null)},e._getMinutes=function(e){return{latitude:60*e.latitude|0,longitude:60*e.longitude|0}},e._getPositionAsync=function(){return e._getPositionAsyncPromise?e._getPositionAsyncPromise:(e._getPositionAsyncPromise=new Promise(function(t,n){navigator.geolocation.getCurrentPosition(function(n){e._actualLocation=e._getMinutes(n.coords),e._getPositionAsyncPromise=null,t(e.GetCurrentPositionSync())},function(r){e._getPositionAsyncPromise=null,e.HasCurrentPosition()?t(e.GetCurrentPositionSync()):n(r)},{timeout:r.LocationCheckTimeout})}),e._getPositionAsyncPromise)},e._setWatch=function(){if(e._isLocationRequestEnabled&&!e._watchId){e._watchId=navigator.geolocation.watchPosition(function(t){e._actualLocation=e._getMinutes(t.coords)},function(t){e._actualLocation=null})}},e._actualLocation=null,e._isLocationRequestEnabled=r.LocationConstraint,e._watchId=null,e}();n.LocationProvider=i},{"./Constants":461}],467:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.GetMediaDevices=function(){return navigator.mediaDevices},e}();n.MediaDevicesProvider=r},{}],468:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ConnectionController="Connection Controller: ",n.ConnectionLost="Connection lost",n.ConnectionTimeout="Connection timeout",n.CouldNotGetAudioTrack="Could not get audio tracks: there were no audio tracks returned by the browser",n.CouldNotGetResponseFromMUC="Could not get response from MUC",n.CouldNotGetVideoTrack="Could not get video tracks: there were no video tracks returned by the browser",n.CouldNotGetWindowShareTrack="Could not get window share tracks: there were no window share tracks returned by the browser",n.CouldNotGetWindowShareTrackBecauseUserCancelled="Could not get window share tracks: the operation was cancelled by the user",n.CouldNotParseString='Could not parse "${string}".',n.Disconnecting="Normal disconnecting",n.Disconnected="Normal disconnected",n.ErrorInFindRoomOnServer="Error in FindRoomOnServer",n.ErrorInSendTokenQuery="Error in SendTokenQuery",n.IdCannotBeEmpty="Id cannot be empty",n.InvalidToken="The token that was provided is unknown to the service or unauthorized to log in.",n.LocalMediaOperationNotPermitted="Operation Not Permitted: LocalStreamController will not start a ${mediaType} when it is in ${mediaState}",n.MediaSessionAddingStreamError="Media session adding stream error",n.MediaSessionEnded="Media session ended",n.MediaSessionError="Media session error",n.MediaSessionTransportError="Media session transport error",n.MiscError="Miscellaneous errors",n.MiscLocalError="Miscellaneous local errors",n.MiscRemoteError="Miscellaneous remote errors",n.NoResponse="No response",n.NoSuchParticipant='Could not find participant with id "${id}".',n.NoSuchStream='Could not find stream with id "${id}".',n.NotImplemented="Not implemented.",n.SignallingError="Signalling error",n.SignallingTransportError="Signalling transport error",n.Terminated="Terminated",n.TheElementIdDoesntExist='The element "${id}" doesn`t exist.',n.TheElementOfClassDoesntExist='The element of "${className}" class doesn`t exist.',n.TheViewStyleViewStyleIsNotSupported='The view style "${viewStyle}" is not supported.',n.ValidationErrorInParentRequiredFieldNameIsNotFound='Validation error in "${parent}": required field "${name}" is not found.',n.ErrorWhileConnecting="Error while connecting. VidyoConnector now in state - ${state}"},{}],469:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.NotEqual=function(e,t,n){return 0===e||Math.abs((e-t)/e)>n}},{}],470:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Messages");n.NotImplemented=function(){throw new Error(r.NotImplemented)}},{"./Messages":468}],471:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.BaseAssign=function(e,t){for(var n in t)"constructor"!==n&&(e[n]=t[n])},e.Copy=function(e){var t=e instanceof Array?[]:{};return this.Merge(t,e)},e.Difference=function(e,t){return e.filter(function(e){return-1===t.indexOf(e)})},e.Filter=function(e,t){var n=[];for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],o=!0;for(var a in t)if(i[a]!==t[a]){o=!1;break}o&&n.push(i)}return n},e.Flatten=function(e){return[].concat.apply([],e)},e.IsEmpty=function(e){return 0===Object.keys(e).length},e.IsEqual=function(e,t){if(e.length!==t.length)return!1;for(var n in e)if(e[n]!==t[n])return!1;return!0},e.IsNotEmpty=function(e){return!this.IsEmpty(e)},e.IsNotEqual=function(e,t){return!this.IsEqual(e,t)},e.MapObject=function(e,t){return e instanceof Array?e.map(t):Object.values(e).map(t)},e.MeanValueOfArray=function(e){return e.reduce(function(e,t){return e+t},0)/e.length},e.Merge=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return e._merge(t,n)})},e._merge=function(e,t){if(!e||!t)return e||t||{};for(var n in t)if(t.hasOwnProperty(n)||!(t[n]instanceof Object)){var r=t[n];r instanceof Object&&!(r instanceof Function)?(r instanceof Array?e[n]=[]:e[n]instanceof Object&&!(e[n]instanceof Array)||(e[n]={}),this._merge(e[n],r)):void 0===r&&n in e||(e[n]=r)}return e},e}();n.default=r},{}],472:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.GetOSInfo=function(){return e._osInfo||(e._osInfo=e._getOSInfo()),e._osInfo},e.IsChrome=function(){return void 0===e._isChrome&&(e._isChrome=navigator.userAgent.indexOf("Chrome")>0&&navigator.userAgent.indexOf("OPR")<0&&navigator.userAgent.indexOf("Firefox")<0),e._isChrome},e.IsElectron=function(){return void 0===e._isElectron&&(e._isElectron=navigator.userAgent.indexOf("Electron")>=0&&navigator.userAgent.indexOf("OPR")<0&&navigator.userAgent.indexOf("Firefox")<0),e._isElectron},e.IsSafari=function(){return void 0===e._isSafari&&(e._isSafari=navigator.userAgent.indexOf("Chrome")<0&&navigator.userAgent.indexOf("Safari")>=0),e._isSafari},e.IsWindows=function(){return this.GetOSInfo(),!!e._osInfo&&e._osInfo.OSName.toLowerCase().indexOf("windows")>=0},Object.defineProperty(e,"UserAgent",{get:function(){return navigator.userAgent},enumerable:!0,configurable:!0}),e._getOSInfo=function(){var e,t=navigator.appVersion,n=navigator.userAgent,r="";(e=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 10",r:/(Windows 10|Windows NT 10)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}].find(function(e){return e.r.test(n)})||"")&&(r=e.s);var i="";if(/Windows/.test(r)){var o=/Windows (.*)/.exec(r);o&&o.length>1&&(i=o[1]),r="Windows"}switch(r){case"Mac OS X":(e=/Mac OS X (10[\.\_\d]+)/.exec(n))&&e.length>1&&(i=e[1]);break;case"Android":(e=/Android ([\.\_\d]+)/.exec(n))&&e.length>1&&(i=e[1]);break;case"iOS":i=(e=/OS (\d+)_(\d+)_?(\d+)?/.exec(t))[1]+"."+e[2]+"."+(e[3]||0)}return{OSName:r,OSVersion:i}},e}();n.OperatingSystemInfoProvider=r},{}],473:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.subscribe=function(e){return navigator.permissions?navigator.permissions.query({name:e}):Promise.reject(new Error("Permissions API is not supported in current browser"))},e}();n.PermissionProvider=r},{}],474:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("short-number"),a=function(){return function(e){void 0===e&&(e=0),this.Value=e}}();n.PrettyNumberBase=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.toString=function(){if(this.Value<1e3){var e=void 0;return e=this.Value<100?10:1,(Math.round(this.Value*e)/e).toString()}return o(this.Value).toString()},t}(a);n.PrettyNumber=s;var c=function(e){function t(t,n){void 0===n&&(n=0);var r=e.call(this,n)||this;return r._unit=t,r}return i(t,e),t.prototype.toString=function(){return""+this.Value+this._unit},t}(a);n.PrettyNumberWithUnits=c;var u=function(){function e(e){void 0===e&&(e=[]),this.Values=e}return e.prototype.Push=function(e){var t=this;e.forEach(function(e){t.PushIfNew(e)})},e.prototype.PushIfNew=function(e){this.Values.indexOf(e)<0&&this.Values.push(e)},e.prototype.toString=function(){return this.Values.join(", ")},e}();n.PrettyList=u;var l=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0),this._seperator=e,this._first=t,this._second=n}return Object.defineProperty(e.prototype,"Values",{get:function(){return[this._first,this._second]},enumerable:!0,configurable:!0}),e.prototype.SetValues=function(e,t){this._first=e,this._second=t},e.prototype.toString=function(){return Math.round(this._first)+" "+this._seperator+" "+Math.round(this._second)},e}();n.PrettyTuple=l},{"short-number":258}],475:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Errors"),i=e("es6-promise");n.MakePromiseWithCallback=function(){var e=void 0,t=void 0;return{promise:new i.Promise(function(n,r){e=n,t=r}),reject:t,resolve:e}};var o=function(){return function(e,t){this.timeoutRef=0,this.delay=e,this.cleanUp=t}}();n.PromiseTimeout=o,n.ApplyTimeout=function(e,t){return i.Promise.race([e,new i.Promise(function(e,n){t.timeoutRef=setTimeout(function(){t.cleanUp&&t.cleanUp(),n(new r.TimeOutError("timeout"))},t.delay)})]).then(function(e){return clearTimeout(t.timeoutRef),t.timeoutRef=0,t.cleanUp&&t.cleanUp(),e})},n.RaceResolve=function(e){return new i.Promise(function(t,n){i.Promise.all(e.map(function(e){return new i.Promise(function(t,n){e.then(n).catch(t)})})).then(n).catch(t)})}},{"./Errors":462,"es6-promise":43}],476:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../models/Reflector");n.SelectReflectors=function(e){var t=[];if(e.reflectors.length<=2)t=e.reflectors;else for(var n=e.reflectors.slice(),i=0;i<2;++i){var o=Math.floor(Math.random()*n.length);t.push.apply(t,n.splice(o,1))}return t.map(function(e){return function(t){return new r.default(e,t)}}(e))}},{"../models/Reflector":415}],477:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./TimingProvider"),i=function(){function e(){}return e.Start=function(e,t){var n={height:-1,width:-1};r.TimingProvider.BeforeEachRepaint(function(){n.height===e.clientHeight&&n.width===e.clientWidth||(n={height:e.clientHeight,width:e.clientWidth},t(n))})},e}();n.SizeObserver=i},{"./TimingProvider":480}],478:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../utils/Constants"),i=e("../models/statistics/Statistics"),o=e("../models/VideoResolution"),a=function(){function e(){}return e.catchConnectTime=function(){e.EndpointStatistic.ConnectTime=e.getISODate(new Date)},e.getISODate=function(e){e.getTimezoneOffset();return e.setTime(e.getTime()),e.toISOString().replace(/\T/," ").replace(/\Z/,"")},e.getLocalCameraStatistics=function(t){var n=new i.LocalVideoSourceStatistics,r=this._vidyoCore.Controllers.LocalStreamController.GetLocalStreamVideoConstraints();return n.Id=t.Id||"",n.Name=t.Name||"",n.Height=r.height,n.Width=r.width,n.Format="VIDYO_MEDIAFORMAT_MJPG",n.RemoteRendererStreams=[e.getRemoteRendererStream()],n},e.getLocalMicrophoneStatistics=function(t){var n=new i.LocalMicrophoneStatistics;return n.Id=t.Id||"",n.Name=t.Name||"",n.CodecName="OPUS",n.NumberOfChannels=1,n.BitsPerSample=32,n.SampleRateSet=32e3,n.RemoteSpeakerStreams=[e.getRemoteSpeakerStream()],n},e.getLocalShareStats=function(){var e=function(e){var t=new i.LocalVideoSourceStatistics;return e.Enabled&&(t.Width=e.Settings.width||0,t.Height=e.Settings.height||0,t.FrameIntervalSet=e.Settings.frameRate||0),t};return{window:this._vidyoCore.Controllers.LocalStreamController.WindowShareStream.GetVideoTracks().map(e),monitor:this._vidyoCore.Controllers.LocalStreamController.MonitorShareStream.GetVideoTracks().map(e)}},e.getLocalSpeakerStreamStatistics=function(){var e=new i.LocalSpeakerStreamStatistics;return e.LastEnergy=Math.round(100*Math.random()),e.Delay=1e8,[e]},e.getParticipantsGenerationStats=function(){var t=e,n=t.RoomStatistics.ParticipantStats,r=t._vidyoCore.Controllers.ParticipantController.GetParticipants().filter(function(e){return"remote"===e.Origin}).sort(function(e,t){return e.Generation-t.Generation}),o=[];return r.forEach(function(e){var t=new i.ParticipantGenerationStatistics,r=n.find(function(t){return t.Id===e.Id}),a={};Object.assign(a,e,r),t.Id=a.Id,t.Name=a.Name,a.RemoteCameraStats&&a.RemoteCameraStats.length>0&&(t.CameraName=a.RemoteCameraStats[0].Name||"Unknown",t.FrameInterval=a.RemoteCameraStats[0].FpsRendered,t.Width=a.RemoteCameraStats[0].Width,t.Height=a.RemoteCameraStats[0].Height),o.push(t)}),o},e.getRemoteRendererStream=function(){var t=new i.RemoteRendererStreamStatistics,n=e._vidyoCore.Controllers,r=n.DeviceController.GetSelectedDevices().Camera,a=n.LocalStreamController.GetLocalStreamVideoConstraints();return t.Fps=a.frameRate,t.CodecName=o.GetPreferredCodec(),t.LastHeight=a.height,t.LastWidth=a.width,t.FramesDropped=0,t.Width=a.width,t.Height=a.height,t.Name=r.Name||"",t},e.getRemoteSpeakerStream=function(){var t=new i.RemoteSpeakerStreamStatistics,n=e._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Microphone;return t.Name=n.Name||"",t.CodecName="OPUS",t.SampleRate=48e3,t.NumberOfChannels=2,t.BitsPerSample=32,t},e.Initialize=function(t){e._vidyoCore=t,e.EndpointStatistic=t.Controllers.StatisticsController.EndpointStatistic,e.RoomStatistics=t.Controllers.StatisticsController.RoomStatistics,e.TransportInformation=t.Controllers.StatisticsController.TransportInformation,e.UserStatistic=t.Controllers.StatisticsController.UserStatistic},e.supplementClientStatistics=function(){e.supplementEndpointStatistics(),e.supplementRoomStatistics(),e.supplementUserStatistics()},e.supplementEndpointStatistics=function(){var t=e._vidyoCore.Controllers.ParticipantController.GetLocalParticipant();e.EndpointStatistic.ApplicationTag=r.ApplicationTag,e.EndpointStatistic.BuildTag="Unknown",e.EndpointStatistic.Id=t?t.ObjId:"Unknown",e.EndpointStatistic.LibraryVersion=r.LibVersion||"Unknown",e.EndpointStatistic.ProcessorModel="Unknown",e.EndpointStatistic.ProcessorBrand="Unknown",e.EndpointStatistic.ProcessorLogicalCores=2,e.EndpointStatistic.ProcessorPhysicalCores=navigator.hardwareConcurrency,e.EndpointStatistic.NetworkInterfaceStats=[{IsUp:!0,Name:"Unknown name",Type:"Unknown type"}],e.EndpointStatistic.LogStats={LogErrorDataStats:[{Name:"Unknown error",Occurances:1}],LogWarningDataStats:[{Name:"Unknown warning",Occurances:2}]}},e.supplementRoomStatistics=function(){e.RoomStatistics.AvailableDecodeCpuPercent=100,e.RoomStatistics.AvailableEncodeCpuPercent=100,e.RoomStatistics.CpuUsage=15,e.RoomStatistics.CurrentBandwidthDecodePixelRate=100,e.RoomStatistics.CurrentBandwidthEncodePixelRate=100,e.RoomStatistics.CurrentCpuDecodePixelRate=100,e.RoomStatistics.CurrentCpuEncodePixelRate=100,e.RoomStatistics.MaxDecodePixelRate=100,e.RoomStatistics.MaxEncodePixelRate=100,e.RoomStatistics.ParticipantGenerationStats=e.getParticipantsGenerationStats()},e.supplementUserStatistics=function(){e.UserStatistic.Id="Unknown",e.UserStatistic.LatencyTestStats.LatencyTestDataStats=[{LatencyMs:0,Address:"Unknown address",Latitude:0,Longitude:0,Name:"Unknown name",ResponseReceived:!0}]},e}();n.StatisticsExtention=a},{"../models/VideoResolution":420,"../models/statistics/Statistics":451,"../utils/Constants":461}],479:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.Format=function(e,t){var n=e;for(var r in t)if(t.hasOwnProperty(r)){var i=new RegExp("(<%=\\s?"+r+"\\s?%>)|(\\$\\{"+r+"\\})","gm");n=n.replace(i,t[r])}return n},e.generateRandomString=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=new Uint16Array(30);return window.crypto.getRandomValues(t),t=t.map(function(t){return e.charCodeAt(t%e.length)}),String.fromCharCode.apply(null,t)},e.toSecureString=function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")},e.toStringDate=function(e,t){var n=e.toTimeString().match(/[\+|\-][0-9]{4}/),r="+00:00";return!0===t&&n&&n.length>0&&(r=(r=n[0]).substr(0,3)+":"+r.substr(3,2)),e.toISOString().replace("T"," ").replace("Z","")+" "+r},e}();n.default=r},{}],480:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.BeforeEachRepaint=function(e){window.requestAnimationFrame(function t(){window.requestAnimationFrame(t),e()})},e.ClearInterval=function(e){clearInterval(e)},e.Debounce=function(e,t){void 0===t&&(t=0);var n=!1;return function(){if(!n){n=!0;setTimeout(function(){e(),n=!1},t)}}},e.Interval=function(e,t){return setInterval(t,e)},e}();n.TimingProvider=r},{}],481:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DecodeUserName=function(e){var t="";try{t=atob(e).split("\0")[1].replace("@","_").toLowerCase()}catch(e){}return t},n.DecodeUserDomainName=function(e){var t="";try{var n=atob(e).split("\0");if(n[1]){var r=n[1].split("@"),i=(r[0],r[1]);i&&(t=i.toLowerCase())}}catch(e){}return t},n.ParseUrlParams=function(e){var t={};return e.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,n,r,i){return t[n]=i,""}),t}},{}],482:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Constants"),i=e("./Messages"),o=e("./ChromeExtensionProvider"),a=e("./MediaDevicesProvider"),s=e("./OperatingSystemInfoProvider"),c=function(){function e(){this._windowShareQueue=[],this._listenForChromeExtensionMessages()}return e.prototype.GetAudioTrack=function(t){void 0===t&&(t=!0);var n=e._constraints.audio?{audio:!0===t||{deviceId:t.Id}}:{audio:!1};return a.MediaDevicesProvider.GetMediaDevices().getUserMedia(n).then(function(e){var t=e.getAudioTracks()[0];if(!t)throw i.CouldNotGetAudioTrack;return t})},e.prototype.GetVideoTrack=function(t,n){void 0===t&&(t=!0);var o=n||{width:r.DefaultLocalStreamWidth,height:r.DefaultLocalStreamHeight},s=e._constraints.video?{video:o}:{video:!1};if(!0!==t&&e._constraints.video&&(s.video.deviceId={exact:t.Id}),navigator.userAgent.indexOf("Chrome")<0&&navigator.userAgent.indexOf("Safari")>=0){s.video.height=480,s.video.width=640}return a.MediaDevicesProvider.GetMediaDevices().getUserMedia(s).then(function(e){var t=e.getVideoTracks()[0];if(!t)throw i.CouldNotGetVideoTrack;return t})},e.prototype.GetWindowShareTrack=function(e){var t=this;return e&&s.OperatingSystemInfoProvider.IsChrome()?this._getWindowShareTrack(e):"getDisplayMedia"in a.MediaDevicesProvider.GetMediaDevices()?this._getDisplayMediaTrack():s.OperatingSystemInfoProvider.IsChrome()?o.ChromeExtensionProvider.AssertInstalled().then(function(){return window.postMessage({type:"VidyoRequestGetWindowsAndDesktops"},"*"),new Promise(function(e,n){t._windowShareQueue.push(function(r){t._getWindowShareTrack(r).then(e).catch(n)})})}):Promise.resolve()},e.prototype.Initialize=function(){return a.MediaDevicesProvider.GetMediaDevices().getUserMedia(e._constraints).then(function(e){return e.getTracks().forEach(function(e){e.stop()}),Promise.resolve(!0)}).catch(function(){return Promise.resolve(!1)})},e.prototype._getDisplayMediaTrack=function(){return new Promise(function(e,t){var n={video:{width:r.DefaultLocalShareStreamWidth,height:r.DefaultLocalShareStreamHeight,frameRate:r.DefaultLocalShareStreamFrameRate}},o=a.MediaDevicesProvider.GetMediaDevices();"getDisplayMedia"in o?o.getDisplayMedia(n).then(function(n){var r=n.getVideoTracks()[0];r?e(r):t(i.CouldNotGetWindowShareTrack)}).catch(t):t(i.CouldNotGetWindowShareTrack)})},e.prototype._getWindowShareTrack=function(t){return new Promise(function(n,r){if(t){var o={video:!!e._constraints.video&&{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxWidth:1920,maxHeight:1080,maxFrameRate:3}}};a.MediaDevicesProvider.GetMediaDevices().getUserMedia(o).then(function(e){var t=e.getVideoTracks()[0];t?n(t):r(i.CouldNotGetWindowShareTrack)}).catch(r)}else r(i.CouldNotGetWindowShareTrackBecauseUserCancelled)})},e.prototype._listenForChromeExtensionMessages=function(){var e=this;window.addEventListener("message",function(t){if(t.origin===window.location.origin&&"VidyoOutEventSourceId"===t.data.type){var n=e._windowShareQueue.pop();n&&n(t.data.sourceId)}})},e.SetAudioAndVideoConstraints=function(t){var n=void 0===t?{}:t,r=n.audio,i=void 0!==r&&r,o=n.video,a=void 0!==o&&o;e._constraints.audio=i,e._constraints.video=a},e._constraints=r.MediaConstraints,e}();n.UserMediaProvider=c},{"./ChromeExtensionProvider":458,"./Constants":461,"./MediaDevicesProvider":467,"./Messages":468,"./OperatingSystemInfoProvider":472}],483:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=500,i=function(){function e(){this._height=r,this._width=r;var e=this._createCanvas();if(e){this._canvas=e;var t=this._canvas.getContext("2d");if(!t)throw new Error("Could not get canvas context when creating placeholder track");this._canvasContext=t;var n=this._canvas.captureStream(30),i=this._createProfileImage();i&&(this._profileImage=i,this._drawImageOnCanvas(),this.Track=n.getVideoTracks()[0])}}return e.prototype.Resize=function(e,t){this._width=e,this._height=t,this._drawImageOnCanvas()},e.prototype._createCanvas=function(){var e=document.createElement("canvas");return!!e.captureStream&&e},e.prototype._createProfileImage=function(){var e=new Image;return e.src='data:image/svg+xml;utf8,\n      <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n         viewBox="0 0 500 500" preserveAspectRatio="xMidYMid meet" style="enable-background:new 0 0 500 500;" xml:space="preserve">\n      <style type="text/css">\n        .st0{fill:#C5DBDE;}\n      </style>\n      <path class="st0" d="M349.5,150.8c0,55.1-44.7,99.8-99.8,99.8S150,205.8,150,150.8S194.7,51,249.8,51S349.5,95.7,349.5,150.8z\n         M405.6,337L405.6,337c-98-49-213.3-49.1-311.4-0.2l-0.4,0.2c-26.6,13.3-43.4,40.5-43.4,70.2V500H449v-92.8\n        C449,377.5,432.2,350.3,405.6,337z"/>\n      </svg>\n      '.replace(/\n/g,""),e},e.prototype._drawImageOnCanvas=function(){this._canvas.width=this._width,this._canvas.height=this._height,this._canvasContext.fillStyle="#202020",this._canvasContext.fillRect(0,0,this._width,this._height);var e=this._width/this._height<1,t=e?this._width:this._height,n=e?0:(this._width-t)/2,r=e?(this._height-t)/2:0;this._canvasContext.drawImage(this._profileImage,n,r,t,t)},e}();n.VideoPlaceholderTrack=i},{}],484:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../events/AdvancedSettingsEvents"),i=function(){function e(){}return e.Debug=function(t,n,r){var i=function(i){if("function"==typeof t[i]&&"_"!==(""+i)[0]){var o=t[i];t[i]=function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];if(e.isEnabledAPI[n]&&e.log){var c=e.getFileName(r||"<filename>");e.log.LogDebug(" "+c+": "+i+" method was called")}return o.apply(t,a)}}};for(var o in t)i(o)},e.Initialize=function(t){e._vidyoCore=t,e.log=t.Controllers.LogController,this._vidyoCore.EventDispatcher.on(r.Events.EnableSimpleAPILoggingChanged,function(t){e.isEnabledSimpleAPI=t}),this._vidyoCore.EventDispatcher.on(r.Events.EnableVidyoConnectorAPILoggingChanged,function(t){e.isEnabledVidyoConnectorAPI=t})},e.getFileName=function(e){var t=e.split("\\");return t[t.length-1]},Object.defineProperty(e,"isEnabledSimpleAPI",{get:function(){return e.isEnabledAPI.Simple},set:function(t){e.isEnabledAPI.Simple=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isEnabledVidyoConnectorAPI",{get:function(){return e.isEnabledAPI.VidyoConnector},set:function(t){e.isEnabledAPI.VidyoConnector=t},enumerable:!0,configurable:!0}),e.isEnabledAPI={Simple:!1,VidyoConnector:!1},e}();n.VidyoDebugger=i},{"../events/AdvancedSettingsEvents":394}],485:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=window.RTCPeerConnection.prototype.getStats;e("webrtc-adapter"),window.RTCPeerConnection.prototype.getStats=r},{"webrtc-adapter":338}],486:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("es6-promise");!function(e){e[e.OK=200]="OK"}(r||(r={})),n.Get=function(e){var t=e.url,n=e.headers,o=e.timeout,a=e.validResponseCodesRange;return new i.Promise(function(e,i){var s=new XMLHttpRequest;s.open("GET",t),n&&n.forEach(function(e){s.setRequestHeader(e.name,e.value)}),o&&(s.timeout=o),s.ontimeout=function(){s.abort(),i(new Error("Timed out in "+s.timeout+"ms."))},s.onreadystatechange=function(){s.readyState===XMLHttpRequest.DONE&&(s.status===r.OK||a&&a.begin<=s.status&&s.status<=a.end?e(s.responseText):i(new Error(s.response+" - response code: "+s.status)))},s.send(null)})}},{"es6-promise":43}],487:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.get=0]="get",e[e.error=1]="error",e[e.result=2]="result",e[e.set=3]="set"}(n.StanzaTypes||(n.StanzaTypes={})),function(e){e[e.NormalClosure=1e3]="NormalClosure",e[e.NoStatusProvided=1005]="NoStatusProvided",e[e.AbnormalClosure=1006]="AbnormalClosure"}(n.CloseEventCode||(n.CloseEventCode={}))},{}],488:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./stanzaio/StanzaXmppProvider");n.XmppProvider=r.StanzaXmppProvider,function(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}(e("./XmppBase"))},{"./XmppBase":487,"./stanzaio/StanzaXmppProvider":494}],489:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e){this._simplifiedVidyoCore=e}return e.prototype.AdjustInboundJingleContents=function(e){},e.prototype.AdjustOutboundJingleContents=function(e){},e.prototype._hasPayloads=function(e){return e.application&&e.application.payloads},e}();n.BaseJingleContentAdjustor=o;var a=function(e){function t(t){var n=e.call(this,t)||this;return n._adjustors=[new s(t),new c(t)],n}return i(t,e),t.prototype.AdjustInboundJingleContents=function(e){this._adjustors.forEach(function(t){t.AdjustInboundJingleContents(e)})},t.prototype.AdjustOutboundJingleContents=function(e){this._adjustors.forEach(function(t){t.AdjustOutboundJingleContents(e)})},t}(o);n.JingleContentAdjustor=a;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._nameChanges=[{BrowserName:"VP9",ReflectorName:"preVP9"},{BrowserName:"opus",ReflectorName:"OPUS"}],t}return i(t,e),t.prototype.AdjustInboundJingleContents=function(e){var t=this;this._hasPayloads(e)&&e.application.payloads.forEach(function(e){t._nameChanges.forEach(function(t){e.name===t.ReflectorName&&(e.name=t.BrowserName)})})},t.prototype.AdjustOutboundJingleContents=function(e){var t=this;this._hasPayloads(e)&&e.application.payloads.forEach(function(e){t._nameChanges.forEach(function(t){e.name===t.BrowserName&&(e.name=t.ReflectorName)})})},t}(o),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.AdjustOutboundJingleContents=function(e){var t,n=this._simplifiedVidyoCore.AdvancedSettings.CodecExcludeFilter;try{t=new RegExp(n)}catch(e){t=!1}n&&t&&this._hasPayloads(e)&&e.application.payloads.forEach(function(n,r){if(n.name.match(t)){e.application.payloads.splice(r,1);var i=e.application.payloads.findIndex(function(e){var t=e.parameters.find(function(e){return"apt"===e.key});return"rtx"===e.name&&t&&t.value===n.id});i>=0&&e.application.payloads.splice(i,1)}})},t}(o)},{}],490:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("uuid"),o=e("./JingleContentAdjustor"),a=e("./RtcPeerConnection"),s=e("../../SimplifiedVidyoCore"),c=e("async"),u=e("../../utils/ObjectUtils"),l=e("../../utils/Constants"),d=e("../../events/LogEvents");!function(e){e.InteractiveAudio="interactive audio",e.InteractiveVideo="interactive video",e.NonInteractiveVideo="non-interactive video"}(r||(r={}));var p=function(){function e(e,t){this._rtcPeerConnectionHelper=e,this._simplifiedVidyoCore=t,this._encodingBandwidth={},this._ICECandidatePrecessingTimeout=5e3,this._ICECandidatePrecessingTimeoutID=0,this._contentAdjustor=new o.JingleContentAdjustor(this._simplifiedVidyoCore),this._helpers=new f(this._simplifiedVidyoCore)}return e.prototype.GetLocalStreamMediaProperties=function(e){this._helpers.GetLocalStreamMediaProperties=e},e.prototype.UpdateTransmitedStreamTracksMap=function(e){this._helpers.UpdateTransmitedStreamTracksMap=e},e.prototype._afterConstruction=function(){var e=this;this.ACTIONS={"content-accept":"onContentAccept","content-add":"onContentAdd","content-modify":"onContentModify","content-reject":"onContentReject","content-remove":"onContentRemove","description-info":"onDescriptionInfo","security-info":"onSecurityInfo","session-accept":"onSessionAccept","session-info":"onSessionInfo","session-initiate":"onSessionInitiate","session-terminate":"onSessionTerminate","transport-accept":"onTransportAccept","transport-info":"onTransportInfo","transport-reject":"onTransportReject","transport-replace":"onTransportReplace","source-add":"onSourceAdd","source-remove":"onSourceRemove","anonymous-async-action":"anonymousAsyncAction"};var t=this;this.processingQueue=c.queue(function(e,n){if(t.ended)return n();var r=e.action,i=e.changes,o=e.cb;if(t._simplifiedVidyoCore.Log.LogDebug(r,d.VidyoLogCategory.VidyoJingle),!t.ACTIONS[r])return t._simplifiedVidyoCore.Log.LogError("Invalid action: "+r,d.VidyoLogCategory.VidyoJingle),o({condition:"bad-request"}),n();t[t.ACTIONS[r]](i,function(e,t){return o(e,t),n()})}),u.default.BaseAssign(this.pc,new a.RtcPeerConnection(this._rtcPeerConnectionHelper)),this.pc.pc.ontrack=function(t){e.onAddTrack(t)},this.pc.pc.onnegotiationneeded=function(t){e.onNegotiationNeeded(t)}},e.prototype.pushToQueue=function(e,t){this.processingQueue.push({action:"anonymous-async-action",changes:e,cb:t||function(){}})},e.prototype.anonymousAsyncAction=function(e,t){e(t)},e.prototype.send=function(e,t){(t=t||{}).sid=this.sid,t.action=e,this.emit("send",{to:this.peer,id:i.v4(),type:"set",jingle:t})},e.prototype.start=function(e,t){var n=this;this.state="pending",this.candidates=[],t=t||function(){},this.pc.isInitiator=!0,this.pc.offer(e.offerOptions,function(r,i){if(r)return n._simplifiedVidyoCore.Log.LogError(r,d.VidyoLogCategory.VidyoJingle,"Could not create WebRTC offer"),n.end("failed-application",!0);n._rtcPeerConnectionHelper.CacheCodecList(i.jingle),e.offerOptions&&e.offerOptions.mandatory&&i.jingle.contents.forEach(function(t){var n=t.application.media;t.description&&"rtp"===t.application.applicationType&&(e.offerOptions.mandatory.OfferToReceiveAudio||"audio"!==n||(t.senders="initiator"),e.offerOptions.mandatory.OfferToReceiveVideo||"video"!==n||(t.senders="initiator"))}),i.jingle.contents.forEach(n._helpers.filterUnusedLabels),n._helpers.adjustSourceAttributes(i.jingle),e.identities&&(i.jingle.lmiIdentities=e.identities.slice()),n.waitForEndOfCandidates?n.once("ready-for-session-initiate",function(){n.addAccumulatedCandidates(i.jingle),i.jingle.LmiJingleName={value:e.displayName},n.send("session-initiate",i.jingle)}):(i.jingle.LmiJingleName={value:e.displayName},n.send("session-initiate",i.jingle)),t()})},e.prototype.end=function(e,t){var n=this;this._simplifiedVidyoCore.Log.LogDebug(new Date+': JingleMediaSession: session ended. Reason = "'+e+'"',d.VidyoLogCategory.VidyoJingle),this.streams.forEach(function(e){n.onRemoveStream({stream:e})}),this._super.ended||(this.pc.close(),this._super.end.call(this,e,t),this.emit("mediaSessionEnded",e))},e.prototype.onIceCandidate=function(e,t){var n=this;0!==this._ICECandidatePrecessingTimeoutID&&(clearTimeout(this._ICECandidatePrecessingTimeoutID),this._ICECandidatePrecessingTimeoutID=0),this._simplifiedVidyoCore.Log.LogDebug("Discovered new ICE candidate: "+JSON.stringify(t.jingle),d.VidyoLogCategory.VidyoDevelopment),t.jingle.contents.forEach(function(e){e.transport.candidates.forEach(function(e){e.protocol=e.protocol.toUpperCase()})}),this.candidates.push(t),this._ICECandidatePrecessingTimeoutID=setTimeout(function(){n.onIceEndOfCandidates({signalEndOfCandidates:!0,_msg:"stop gathering ICE candidates by timeout"})},this._ICECandidatePrecessingTimeout),this.waitForEndOfCandidates||this.send("transport-info",t.jingle),this.lastCandidate=t},e.prototype.onIceEndOfCandidates=function(e){if(0!==this._ICECandidatePrecessingTimeoutID&&(clearTimeout(this._ICECandidatePrecessingTimeoutID),this._ICECandidatePrecessingTimeoutID=0),this._simplifiedVidyoCore.Log.LogDebug("ICE end of candidates"+(e&&e._msg?": "+e._msg:": standard mode"),d.VidyoLogCategory.VidyoDevelopment),this.waitForEndOfCandidates)this.emit("ready-for-session-initiate");else{var t=this.lastCandidate.jingle;t.contents[0].transport={transportType:t.contents[0].transport.transportType,gatheringComplete:!0},this.lastCandidate=null,this.send("transport-info",t)}},e.prototype.onIceStateChange=function(){switch(this.pc.iceConnectionState){case"checking":this.connectionState="connecting";break;case"completed":case"connected":this.connectionState="connected",this.emit("iceConnectionStateConnected");break;case"disconnected":"stable"===this.pc.signalingState?this.connectionState="interrupted":this.connectionState="disconnected";break;case"failed":this.connectionState="failed",this._simplifiedVidyoCore.Log.LogError('JingleMediaSession::onIceStateChange: error "failed-transport".',d.VidyoLogCategory.VidyoJingle),this.end("failed-transport");break;case"closed":this.connectionState="disconnected"}},e.prototype.addAccumulatedCandidates=function(e){e.contents.forEach(function(e){var t=this.candidates.filter(function(t){return t.jingle.contents[0].name===e.name&&t.jingle.contents[0].transport.candidates});e.transport.candidates=t.map(function(e){return e.jingle.contents[0].transport.candidates[0]})},this)},e.prototype.onSessionAccept=function(e,t){var n=this;e.contents.forEach(function(e){n._contentAdjustor.AdjustInboundJingleContents(e)});var r=this;this.state="active",this.pc.handleAnswer({type:"answer",jingle:e},function(e){if(e)return r._simplifiedVidyoCore.Log.LogError("Could not process WebRTC answer",d.VidyoLogCategory.VidyoJingle),t({condition:"general-error"});r.emit("accepted",r),t()})},e.prototype.onSourceAdd=function(e,t){var n=this;this._simplifiedVidyoCore.Log.LogDebug("Adding new stream source",d.VidyoLogCategory.VidyoJingle),e.contents.forEach(function(e,t){"application"===e.name&&(e.name="video",e.application.media="video")}),this._helpers.prepareSourcesForMerging(e);var r=u.default.Copy(this.pc.remoteDescription);n._helpers.mergeSources(r,e),this.pc.handleOffer({type:"offer",jingle:r},function(e){if(e)return n._simplifiedVidyoCore.Log.LogError("Error adding new stream source",d.VidyoLogCategory.VidyoJingle),t({condition:"general-error"});n.pc.answer(n.constraints,function(e){if(e)return n._simplifiedVidyoCore.Log.LogError("Error adding new stream source",d.VidyoLogCategory.VidyoJingle),t({condition:"general-error"});t()})})},e.prototype.onContentModify=function(e,t){var n=this;this._simplifiedVidyoCore.Log.LogDebug("Handling incoming content-modify request",d.VidyoLogCategory.VidyoJingle),e.contents.forEach(function(e){n._contentAdjustor.AdjustInboundJingleContents(e),e.transport.fingerprints&&e.transport.fingerprints.forEach(function(e){e.setup="actpass"})}),this._helpers.prepareSourcesForMerging(e);var r=u.default.Copy(e);n._helpers.mergeSources(r,this.pc.remoteDescription),n._helpers.mergeSources(r,e),n.pc.handleOffer({type:"offer",jingle:r},function(e){if(e)return n._simplifiedVidyoCore.Log.LogError("Error while handling content-modify requset",d.VidyoLogCategory.VidyoJingle),t({condition:"general-error"});n.pc.answer(n.constraints,function(e,r){if(e)return n._simplifiedVidyoCore.Log.LogError("Error while answering to content-modify requset",d.VidyoLogCategory.VidyoJingle),t({condition:"general-error"});r.jingle.contents.forEach(function(e){e.transport.candidates.forEach(function(e){e.protocol=e.protocol.toUpperCase()})}),n._helpers.adjustSourceAttributes(r.jingle),n.pushToQueue(function(e){n.send("content-accept",r.jingle),e()}),t()})})},e.prototype.onSessionInfo=function(e,t){return e.ringing?(this._simplifiedVidyoCore.Log.LogDebug("Outgoing session is ringing",d.VidyoLogCategory.VidyoJingle),this.ringing=!0,this.emit("ringing",this),t()):e.hold?(this._simplifiedVidyoCore.Log.LogDebug("On hold",d.VidyoLogCategory.VidyoJingle),this.emit("hold",this),t()):e.active?(this._simplifiedVidyoCore.Log.LogDebug("Resuming from hold",d.VidyoLogCategory.VidyoJingle),this.emit("resumed",this),t()):e.mute?(this._simplifiedVidyoCore.Log.LogDebug("Muting: "+e.mute,d.VidyoLogCategory.VidyoJingle),this.emit("mute",this,e.mute),t()):e.unmute?(this._simplifiedVidyoCore.Log.LogDebug("Unmuting: "+e.unmute,d.VidyoLogCategory.VidyoJingle),this.emit("unmute",this,e.unmute),t()):void t()},e.prototype.onSourceRemove=function(e,t){var n=this;this._simplifiedVidyoCore.Log.LogDebug("Removing stream source",d.VidyoLogCategory.VidyoJingle);var r=u.default.Copy(this.pc.remoteDescription);this.pc.remoteDescription.contents.forEach(function(t,n){var i=t.application,o=i.sources||[],a=i.sourceGroups||[];e.contents.forEach(function(e){if(t.name===e.name){for(var i,s=e.application,c=s.sources||[],u=s.sourceGroups||[],l=0,d=c;l<d.length;l++){var p=d[l];for(var f in i=-1,o)if(p.ssrc===o[f].ssrc){i=f;break}i>-1&&(o.splice(i,1),r.contents[n].application.sources=JSON.parse(JSON.stringify(o)))}for(var h=0,m=u;h<m.length;h++){var v=m[h];for(var f in i=-1,a)if(v.semantics===a[f].semantics&&v.sources.length===a[f].sources.length){var y=!0;for(var g in v.sources)if(v.sources[g]!==a[f].sources[g]){y=!1;break}if(y){i=f;break}}i>-1&&(a.splice(i,1),r.contents[n].application.sourceGroups=JSON.parse(JSON.stringify(a)))}}})}),this.pc.handleOffer({type:"offer",jingle:r},function(e){if(e)return n._simplifiedVidyoCore.Log.LogError("Error removing stream source",d.VidyoLogCategory.VidyoJingle),t({condition:"general-error"});n.pc.answer(n.constraints,function(e){if(e)return n._simplifiedVidyoCore.Log.LogError("Error removing stream source",d.VidyoLogCategory.VidyoJingle),t({condition:"general-error"});t()})}),this.emit("peerSourceRemoved",this.pc.remoteDescription)},e.prototype.onAddStream=function(e){this._simplifiedVidyoCore.Log.LogDebug("Stream added: "+e.stream.id,d.VidyoLogCategory.VidyoDevelopment),this.emit("peerStreamAdded",this,e.stream)},e.prototype.onRemoveStream=function(e){this._simplifiedVidyoCore.Log.LogDebug("Stream removed: "+e.stream.id,d.VidyoLogCategory.VidyoDevelopment),this.emit("peerStreamRemoved",this,e.stream)},e.prototype.onAddTrack=function(e){this._simplifiedVidyoCore.Log.LogDebug("Track added: "+e.streams[0].id,d.VidyoLogCategory.VidyoDevelopment)},e.prototype.onNegotiationNeeded=function(e){this._simplifiedVidyoCore.Log.LogDebug("Negotiation needed",d.VidyoLogCategory.VidyoDevelopment)},e.prototype.addStream=function(e,t,n){var r=this;this._simplifiedVidyoCore.Log.LogDebug("Adding local stream",d.VidyoLogCategory.VidyoJingle),this.pushToQueue(function(n){if(e.getTracks().forEach(function(t){r.pc.pc.addTrack(t,e)}),!t)return n();var i=u.default.Copy(r.pc.remoteDescription);r.pc.handleOffer({type:"offer",jingle:i},function(t){if(t)return r._simplifiedVidyoCore.Log.LogError("Could not process offer for adding new stream",d.VidyoLogCategory.VidyoJingle),n(t);r.pc.answer(r.constraints,function(t,i){if(t)return r._simplifiedVidyoCore.Log.LogError("Could not create answer for adding new stream",d.VidyoLogCategory.VidyoJingle),n(t);r._helpers.createSsrcsToTracksMap(e,i.jingle),r._answerJingle=u.default.Copy(i.jingle);var o=u.default.Copy(r._answerJingle);return r._helpers.adjustContentJingle(o),r.send("content-add",o),r._helpers.adjustSourceAttributes(i.jingle),r.send("content-modify",i.jingle),n(null,i.jingle)})})},n)},e.prototype.muteAudio=function(e){var t=this;this.pushToQueue(function(e){t.pc.pseudoOffer(function(n,r){if(n)return t._rtcPeerConnectionHelper.Log.LogError(n,d.VidyoLogCategory.VidyoClient,"Could not create offer for muteAudio"),e(n);t._helpers.adjustSourceAttributes(r.jingle),t.send("content-modify",r.jingle),t.pc.pseudoHandleAnswer(function(n,r){return n?(t._rtcPeerConnectionHelper.Log.LogError(n,d.VidyoLogCategory.VidyoClient,"Could not handle answer for muteAudio"),e(n)):e()})})},function(){})},e.prototype.removeStream=function(e,t,n){var r=this,i=this;this._simplifiedVidyoCore.Log.LogDebug("Removing local stream",d.VidyoLogCategory.VidyoJingle),this.pushToQueue(function(n){if(e.getTracks().forEach(function(e){var t=i.pc.pc.getSenders().find(function(t){return t.track&&t.track.id===e.id});t&&(r._encodingBandwidth.hasOwnProperty(t.track.id)&&delete r._encodingBandwidth[t.track.id],i.pc.pc.removeTrack(t))}),!t)return n();var o=u.default.Copy(i.pc.remoteDescription);i.pc.handleOffer({type:"offer",jingle:o},function(e){if(e)return i._simplifiedVidyoCore.Log.LogError("Could not process offer for removing stream",d.VidyoLogCategory.VidyoJingle),n(e);i.pc.answer(i.constraints,function(e,t){if(e)return i._simplifiedVidyoCore.Log.LogError("Could not create answer for removing stream",d.VidyoLogCategory.VidyoJingle),n(e);var r=u.default.Copy(i._answerJingle);return i._helpers.adjustContentJingle(r),i.send("content-remove",r),i._answerJingle=u.default.Copy(t.jingle),i._helpers.fixProtocolNameCase(t.jingle),i._helpers.adjustSourceAttributes(t.jingle),i.send("content-modify",t.jingle),n(null,t.jingle)})})},n)},e.prototype.SetMediaEnabled=function(e,t){var n=this;if("RTCRtpSender"in window&&"setParameters"in window.RTCRtpSender.prototype)this.pc.pc.getSenders().filter(function(t){return t.track&&t.track.id===e}).map(function(e){var r=e.getParameters();r.encodings.length>0?(r.encodings[0].active=t,t?r.encodings[0].maxBitrate=n._encodingBandwidth[e.track.id]:(n._encodingBandwidth[e.track.id]=r.encodings[0].maxBitrate,r.encodings[0].maxBitrate=0),e.setParameters(r)):n._simplifiedVidyoCore.Log.LogError("Could not enable/disable media, sender parameters encodings are empty",d.VidyoLogCategory.VidyoClient)})},e.prototype.UpdateStreamTracks=function(e,t){var n=this,r=this;this.pushToQueue(function(t){var i=r.pc.pc.getSenders().map(function(e){return e.track}).filter(function(e){return null!==e}),o=e.getTracks(),a=u.default.Difference(i,o),s=u.default.Difference(o,i);if(a.forEach(function(e){var t=r.pc.pc.getSenders().find(function(t){return null!==t.track&&t.track.id===e.id});t&&(n._encodingBandwidth.hasOwnProperty(t.track.id)&&delete n._encodingBandwidth[t.track.id],r.pc.pc.removeTrack(t))}),s.forEach(function(t){r.pc.pc.addTrack(t,e)}),u.default.IsEmpty(s)&&u.default.IsEmpty(a))return t();var c=u.default.Copy(r.pc.remoteDescription);r.pc.handleOffer({type:"offer",jingle:c},function(n){if(n)return r._simplifiedVidyoCore.Log.LogError("Could not process offer for renegotiating stream",d.VidyoLogCategory.VidyoJingle),t(n);r.pc.answer(r.constraints,function(n,i){if(n)return r._simplifiedVidyoCore.Log.LogError("Could not create answer for renegotiating stream",d.VidyoLogCategory.VidyoJingle),t(n);var o=function(e,t){return t.filter(function(t){var n=t.parameters.find(function(e){return"label"===e.key});return!(void 0===n)&&e.indexOf(n.value)>-1})};if(r._helpers.createSsrcsToTracksMap(e,i.jingle),u.default.IsNotEmpty(a)){var c=a.map(function(e){return e.id}),l=u.default.Copy(r._answerJingle);l.contents.forEach(function(e){e.application.sources=o(c,e.application.sources)}),r._helpers.adjustContentJingle(l),r.send("content-remove",l)}if(u.default.IsNotEmpty(s)){r._answerJingle=u.default.Copy(i.jingle);var p=s.map(function(e){return e.id}),f=u.default.Copy(r._answerJingle);f.contents.forEach(function(e){e.application.sources=o(p,e.application.sources)}),r._helpers.adjustContentJingle(f),r.send("content-add",f),r._helpers.adjustSourceAttributes(i.jingle),r.send("content-modify",i.jingle)}return t(null,i.jingle)})})},t)},e.prototype.UpdateLocalStream=function(e,t,n){void 0===n&&(n=!0);var r=this;this._simplifiedVidyoCore.Log.LogDebug("Updating local stream",d.VidyoLogCategory.VidyoJingle),this.pushToQueue(function(t){r.pc.handleOffer({type:"offer",jingle:u.default.Copy(r.pc.remoteDescription)},function(i){if(i)return r._simplifiedVidyoCore.Log.LogError("Could not process offer for updating stream",d.VidyoLogCategory.VidyoJingle),t(i);r._rtcPeerConnectionHelper.Options=u.default.Merge({},r._rtcPeerConnectionHelper.Options,e),r.pc.answer(r.constraints,function(e,i){return e?(r._simplifiedVidyoCore.Log.LogError("Could not create answer for updating stream",d.VidyoLogCategory.VidyoJingle),t(e)):(r._helpers.fixProtocolNameCase(i.jingle),r._helpers.adjustSourceAttributes(i.jingle),!0===n&&r.send("content-modify",i.jingle),t())})})},t)},e.prototype.ApplyLocalBandwidthLimit=function(e,t){var n=this;if(this._simplifiedVidyoCore.Log.LogDebug("Updating local stream bandwidth"),"RTCRtpSender"in window&&"setParameters"in window.RTCRtpSender.prototype){this.pc.pc.getSenders().filter(function(e){if(!e.track)return!1;var t=n._helpers.GetLocalStreamMediaProperties(e.track.id);return e.track&&(t.mediaType===s.MediaTrackType.Video||t.mediaType===s.MediaTrackType.Application)}).map(function(t){var r=t.getParameters();r.encodings.length>0?(n._encodingBandwidth[t.track.id]=e,r.encodings[0].active&&(r.encodings[0].maxBitrate=e,t.setParameters(r).then(function(){n._simplifiedVidyoCore.Log.LogDebug("Local bandwidth updated")}).catch(function(e){n._simplifiedVidyoCore.Log.LogError(e,d.VidyoLogCategory.VidyoClient,"Could not update local bandwidth")}))):n._simplifiedVidyoCore.Log.LogError("Could not update local bandwidth sender parameters encodings are empty",d.VidyoLogCategory.VidyoClient)});t("",!0)}else{e/=l.KiloCoefficient;var r=this;this.pushToQueue(function(t){r.pc.pseudoOffer(function(n){if(n)return r._rtcPeerConnectionHelper.Log.LogError(n,d.VidyoLogCategory.VidyoClient,"Could not create offer for ApplyLocalBandwidthLimit"),t(n);r._rtcPeerConnectionHelper.Options=u.default.Merge({},r._rtcPeerConnectionHelper.Options,{bandwidth:e}),r.pc.pseudoHandleAnswer(function(e,n){return e?(r._rtcPeerConnectionHelper.Log.LogError(e,d.VidyoLogCategory.VidyoClient,"Could not handle answer for ApplyLocalBandwidthLimit"),t(e)):t()})})},t)}},e}();n.JingleMediaSession=p;var f=function(){function e(e){this._contentAdjustor=new o.JingleContentAdjustor(e)}return e.prototype.createSsrcsToTracksMap=function(e,t){var n={},r=e.getTracks().map(function(e){return e.id});t.contents.forEach(function(e){e.application&&e.application.sources&&e.application.sources.forEach(function(e){var t=e.parameters.find(function(e){return"label"===e.key});t&&r.includes(t.value)&&(n[e.ssrc]=t.value)})}),this.UpdateTransmitedStreamTracksMap(n)},e.prototype.prepareSourcesForMerging=function(e){var t={};e.contents.forEach(function(e){var n,r;t[e.name]?(t[e.name].application.sources?(n=t[e.name].application.sources).push.apply(n,u.default.Copy(e.application.sources)):t[e.name].application.sources=u.default.Copy(e.application.sources),t[e.name].application.sourceGroups?(r=t[e.name].application.sourceGroups).push.apply(r,u.default.Copy(e.application.sourceGroups)):t[e.name].application.sourceGroups=u.default.Copy(e.application.sourceGroups)):t[e.name]=u.default.Copy(e)}),e.contents=Object.values(t)},e.prototype.mergeSources=function(e,t){var n=this;e.contents.forEach(function(r,i){var o=r.application.sources||[],a=r.application.sourceGroups||[];t.contents.forEach(function(t){if(r.name===t.name){var s=t.application.sources||[];if(s.length>0){var c=s[0].parameters[1].value.split(" ")[0];o=o.filter(function(e){return c!==e.parameters[1].value.split(" ")[0]})}s.forEach(function(e){o.some(function(t){return t.ssrc===e.ssrc})||o.push(e)}),e.contents[i].application.sources=JSON.parse(JSON.stringify(o)),(t.application.sourceGroups||[]).forEach(function(e){a.some(function(t){return t.sources.length===e.sources.length&&t.sources.reduce(function(t,n,r){return t||n===e.sources[r]},!1)})||a.push(e)}),e.contents[i].application.sourceGroups=JSON.parse(JSON.stringify(a)),n.filterOutUnusedGroups(e.contents[i])}})})},e.prototype.filterOutUnusedGroups=function(e){e.application.sourceGroups&&(e.application.sourceGroups=e.application.sourceGroups.filter(function(t){var n=!0;return t.sources.forEach(function(t){var r=e.application.sources.some(function(e){return e.ssrc===t});n=n&&r}),n}))},e.prototype.filterContentSources=function(e){"rtp"===e.application.applicationType&&(delete e.transport,delete e.application.payloads,delete e.application.headerExtensions,e.application.mux=!1,this.filterOutUnusedGroups(e))},e.prototype.fixProtocolNameCase=function(e){e.contents.forEach(function(e){e.transport.candidates.forEach(function(e){e.protocol=e.protocol.toUpperCase()})})},e.prototype.adjustSourceAttributes=function(e){var t=this;e.contents.forEach(function(e){var n={};e.application.sources.forEach(function(i){var o=i.parameters.find(function(e){return"label"===e.key});if(o=o?o.value:"",n[o])n[o].ssrcs.push({id:i.ssrc});else{i.name=i.ssrc;var a=i.parameters.find(function(e){return"cname"===e.key});i.cname=a?a.value:"",i.parameters=[];var c=t.GetLocalStreamMediaProperties(o);e.application.media===s.MediaTrackType.Video&&(i.content=c.mediaType===s.MediaTrackType.Application?r.NonInteractiveVideo:r.InteractiveVideo,c.isContentShare&&i.parameters.push({name:"content-semantic",value:"interactive-video"})),e.application.media===s.MediaTrackType.Audio&&(i.content=r.InteractiveAudio,c.isContentShare&&(i.dyn="false",i.signal="unprocessed"),i.parameters.push({name:"paused",value:c.muted.toString()})),i.ssrcs=[{id:i.ssrc}],i.ssrc=void 0,n[o]=i}}),e.application.sources=Object.entries(n).map(function(e){return e[1]}),t._contentAdjustor.AdjustOutboundJingleContents(e),e.transport=e.transport||{transportType:"iceUdp"},e.application.ssrc=void 0})},e.prototype.filterUnusedLabels=function(e){(e.application.sources||[]).forEach(function(e){e.parameters=e.parameters.filter(function(e){return!("mslabel"===e.key||"label"===e.key)})})},e.prototype.adjustContentJingle=function(e){var t=this;this.fixProtocolNameCase(e),e.contents.forEach(function(e){t.filterContentSources(e)}),e.contents=e.contents.filter(function(e){return"rtp"===e.application.applicationType&&e.application.sources&&e.application.sources.length}),delete e.groups,this.adjustSourceAttributes(e)},e.prototype.adjustCName=function(e,t,n){for(var r=function(t){if(t.application.sources&&t.application.sources.length>0){var r=e.getTracks().filter(function(e){return e.kind===t.application.media});r&&r.length>0&&(n&&(r=r.filter(function(e){return n.includes(e.id)})),r&&r.length>0&&(t.application.sources[0].cname=r[0].label))}},i=0,o=t.contents;i<o.length;i++){r(o[i])}},e}()},{"../../SimplifiedVidyoCore":363,"../../events/LogEvents":400,"../../utils/Constants":461,"../../utils/ObjectUtils":471,"./JingleContentAdjustor":489,"./RtcPeerConnection":492,async:2,uuid:332}],491:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ExtendJXT=function(e){var t=e;return t.utils.addValidation=function(e,t){return{get:e.get,set:function(n){t(n),e.set&&e.set.bind(this,n)()}}},t.utils.multiNumberSub=function(e,n){var r=t.utils.multiTextSub(e,n);return{get:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.get.bind(this,e)();return n.map(function(e){return parseInt(e,10)})},set:r.set}},t.utils.speciallyParsedAttribute=function(e,n){var r=t.utils.attribute(e);return{get:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=r.get.bind(this,e)();return n(i)},set:r.set}},t.utils.stringAsBoolAttribute=function(e){var n=t.utils.attribute(e);return{get:function(){return!!n.get&&"true"===n.get.bind(this)()},set:function(e){var t=e?"true":"false";n.set&&n.set.bind(this,t)()}}},t}},{}],492:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("sdp-jingle-json"),i=e("../../utils/ObjectUtils"),o=e("../../utils/OperatingSystemInfoProvider"),a=e("../../events/LogEvents"),s=function(){function e(e){this._helper=e}return e.prototype._answer=function(e,t){t=t||function(){};var n=this;if(!this.pc.remoteDescription)throw new Error("remoteDescription not set");if("closed"===this.pc.signalingState)return t("Already closed");n.pc.createAnswer(function(e){var o=r.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});n._helper.CorrectCodecs(o)&&(e.sdp=r.toSessionSDP(o,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"}),n._helper.RemoveMSIDsAttributes(e));var s=[];if(n.enableChromeNativeSimulcast&&(e.jingle=r.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"}),e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name)){var c=e.jingle.contents[1].application.sourceGroups||[],u=!1;if(c.forEach(function(e){"SIM"===e.semantics&&(u=!0)}),!u&&e.jingle.contents[1].application.sources.length){var l=JSON.parse(JSON.stringify(e.jingle.contents[1].application.sources[0]));l.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].application.sources.push(l),s.push(e.jingle.contents[1].application.sources[0].ssrc),s.push(l.ssrc),c.push({semantics:"SIM",sources:s});var d=JSON.parse(JSON.stringify(l));d.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].application.sources.push(d),c.push({semantics:"FID",sources:[l.ssrc,d.ssrc]}),e.jingle.contents[1].application.sourceGroups=c,e.sdp=r.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"})}}var p={type:"answer",sdp:e.sdp,jingle:void 0};if(n.assumeSetLocalSuccess){var f=i.default.Copy(p);n.emit("answer",f),t(null,f)}n._candidateBuffer=[];var h=r.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});n._helper.Log.LogDebug("SDP Answer sent to the Reflector",a.VidyoLogCategory.VidyoSDP),n._helper.Log.LogDebug(e.sdp,a.VidyoLogCategory.VidyoSDP),n._helper.Log.LogDebug("Jingle Answer sent to the Reflector",a.VidyoLogCategory.VidyoJingle),n._helper.Log.LogDebug(h,a.VidyoLogCategory.VidyoJingle),e.sdp=n._mangleLocalDescription(e.sdp),n.pc.setLocalDescription(e,function(){if(n.config.useJingle){var o=r.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});o.sid=n.config.sid,n.localDescription=o,p.jingle=o}if(n.enableChromeNativeSimulcast&&(p.jingle||(p.jingle=r.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"})),p.jingle.contents[1].application.sources.forEach(function(e,t){e.parameters=e.parameters.map(function(e){return"msid"===e.key&&(e.value+="-"+Math.floor(t/2)),e})}),p.sdp=r.toSessionSDP(p.jingle,{sid:n.sdpSessionID,role:n._role(),direction:"outgoing"})),p.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),!n.assumeSetLocalSuccess){var a=i.default.Copy(p);n.emit("answer",a),t(null,a)}},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},e)},e.prototype._mangleLocalDescription=function(e){if(this._helper.Options.audioMuted){for(var t=e.split("\r\n"),n=!1,r=0;r<t.length;++r)if(0===t[r].indexOf("m=audio")&&(n=!0),n&&0===t[r].indexOf("a=sendrecv")){t[r]="a=recvonly";break}e=t.join("\r\n")}return e},e.prototype.handleAnswer=function(e,t){var n=this;t=t||function(){},this._helper.ResetBandwidthJingle(e.jingle),e.jingle&&(e.sdp=r.toSessionSDP(e.jingle,{sid:this.config.sdpSessionID,role:this._role(),direction:"incoming"}),this._helper.Log.LogDebug("SDP Answer received from Reflector",a.VidyoLogCategory.VidyoSDP),this._helper.Log.LogDebug(e.sdp,a.VidyoLogCategory.VidyoSDP),this._helper.Log.LogDebug("Jingle Answer received from the Reflector",a.VidyoLogCategory.VidyoJingle),this._helper.Log.LogDebug(e.jingle,a.VidyoLogCategory.VidyoJingle),this.remoteDescription=e.jingle,e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})})),e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),this.pc.setRemoteDescription(new RTCSessionDescription(e),function(){n.wtFirefox&&window.setTimeout(function(){n.firefoxcandidatebuffer.forEach(function(e){n.pc.addIceCandidate(new RTCIceCandidate(e),function(){},function(e){this.emit("error",e)}),n._checkRemoteCandidate(e.candidate)}),n.firefoxcandidatebuffer=null},n.wtFirefox),t(null)},t)},e.prototype.handleOffer=function(e,t){t=t||function(){};var n=this;if(e.type="offer",e.jingle){if(n._helper.ResetBandwidthJingle(e.jingle),n._helper.Options.addGoogleConferenceFlag&&e.jingle.contents.forEach(function(e){"video"===e.name&&(e.application.googConferenceFlag=!0)}),o.OperatingSystemInfoProvider.IsSafari()&&e.jingle.contents.forEach(function(e){var t=e.application.sources||[];0!==t.length&&"3735928559"===t[0].ssrc||(t.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"a"},{key:"msid",value:"b c"}]}),e.application.sources=t)}),n.restrictBandwidth>0&&e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name){var i=e.jingle.contents[1];i.application&&i.application.bandwidth&&i.application.bandwidth.bandwidth||(e.jingle.contents[1].application.bandwidth={type:"AS",bandwidth:n.restrictBandwidth.toString()},e.sdp=r.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"}))}e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),e.sdp=r.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n._helper.Log.LogDebug("SDP Offer received from Reflector",a.VidyoLogCategory.VidyoSDP),n._helper.Log.LogDebug(e.sdp,a.VidyoLogCategory.VidyoSDP),n._helper.Log.LogDebug("Jingle Offer received from the Reflector",a.VidyoLogCategory.VidyoJingle),n._helper.Log.LogDebug(e.jingle,a.VidyoLogCategory.VidyoJingle),n.remoteDescription=e.jingle}e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n._helper.MangleOffer(e),n.pc.setRemoteDescription(new RTCSessionDescription(e),function(){t()},t)},e.prototype.offer=function(e,t){var n=this,i=2===arguments.length,o=i&&e?e:{offerToReceiveAudio:!0,offerToReceiveVideo:!0};if(t=(t=i?t:e)||function(){},"closed"===this.pc.signalingState)return t("Already closed");this.pc.createOffer(function(e){var i={type:"offer",sdp:e.sdp,jingle:void 0};n.assumeSetLocalSuccess&&(n.emit("offer",i),t(null,i)),n._candidateBuffer=[];var o=r.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});n._helper.Log.LogDebug("SDP Offer generated by the client",a.VidyoLogCategory.VidyoSDP),n._helper.Log.LogDebug(e.sdp,a.VidyoLogCategory.VidyoSDP),n._helper.Log.LogDebug("Jingle Offer sent to the Reflector",a.VidyoLogCategory.VidyoJingle),n._helper.Log.LogDebug(o,a.VidyoLogCategory.VidyoJingle),e.sdp=n._mangleLocalDescription(e.sdp),n.pc.setLocalDescription(e,function(){if(n.config.useJingle){var o=r.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});o.sid=n.config.sid,n.localDescription=o,o.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.local[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),i.jingle=o}i.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),n.assumeSetLocalSuccess||(n.emit("offer",i),t(null,i))},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},o)},e.prototype.pseudoHandleAnswer=function(e){var t=this;e=e||function(){},this._helper.ResetBandwidthJingle(this.remoteDescription);var n={type:"answer",sdp:this._helper.ResetBandwidthSDP(this.pc.remoteDescription.sdp)};this.pc.setRemoteDescription(n,function(){e()},function(n){t.emit("error",n),e(n)})},e.prototype.pseudoOffer=function(e){var t=this;if(e=e||function(){},"closed"===this.pc.signalingState)return e("Already closed");this.pc.createOffer(function(n){n.sdp=t._mangleLocalDescription(n.sdp),t.pc.setLocalDescription(n,function(){n.jingle=r.toSessionJSON(n.sdp,{role:t._role(),direction:"outgoing"}),e(null,n)},function(n){t.emit("error",n),e(n)})},function(n){t.emit("error",n),e(n)},{offerToReceiveAudio:!0,offerToReceiveVideo:!0})},e}();n.RtcPeerConnection=s},{"../../events/LogEvents":400,"../../utils/ObjectUtils":471,"../../utils/OperatingSystemInfoProvider":472,"sdp-jingle-json":244}],493:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../utils/ObjectUtils"),i=function(){function e(e){this.Log=e,this.Options={}}return e.prototype.CacheCodecList=function(e){var t=this;e&&e.contents&&e.contents.forEach(function(e){"video"===e.name&&e.application&&(t._cachedVideoPayloads=r.default.Copy(e.application.payloads)),"audio"===e.name&&e.application&&(t._cachedAudioPayloads=r.default.Copy(e.application.payloads))})},e.prototype.CorrectCodecs=function(e){var t=this,n=!1;return(this._cachedAudioPayloads||this._cachedVideoPayloads)&&e&&e.contents&&e.contents.forEach(function(e){"video"===e.name&&e.application&&t._cachedVideoPayloads&&(e.application.payloads=r.default.Copy(t._cachedVideoPayloads),n=!0),"audio"===e.name&&e.application&&t._cachedAudioPayloads&&(e.application.payloads=r.default.Copy(t._cachedAudioPayloads),n=!0)}),n},e.prototype.MangleOffer=function(e){this._addTemporalScalabilityAttribute(e),this.RemoveMSIDsAttributes(e)},e.prototype.RemoveMSIDsAttributes=function(e){for(var t=0,n=e.sdp.match(/^a=msid:.+$/gm)||[];t<n.length;t++){var r=n[t];e.sdp=e.sdp.replace(r+"\r\n","")}},e.prototype.ResetBandwidthJingle=function(e){if(!("RTCRtpSender"in window&&"setParameters"in window.RTCRtpSender.prototype)&&this.Options.bandwidth)for(var t=0,n=e.contents;t<n.length;t++){var r=n[t];"video"===r.name&&(r.application.bandwidth={type:"AS",bandwidth:""+this.Options.bandwidth})}},e.prototype.ResetBandwidthSDP=function(e){if(!("RTCRtpSender"in window&&"setParameters"in window.RTCRtpSender.prototype)){e=-1===e.indexOf("b=AS:")?e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+this.Options.bandwidth+"\r\n"):e.replace(new RegExp("b=AS:.*\r\n"),"b=AS:"+this.Options.bandwidth+"\r\n")}return e=e.replace("a=setup:actpass\r\n","a=setup:active\r\n").replace("a=setup:actpass\r\n","a=setup:active\r\n")},e.prototype._addTemporalScalabilityAttribute=function(e){this.Options.addGoogleConferenceFlag&&(e.sdp=e.sdp.replace(/a=mid:video\r\n/g,"a=mid:video\r\na=x-google-flag:conference\r\n"))},e}();n.RtcPeerConnectionHelper=i},{"../../utils/ObjectUtils":471}],494:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../events/ConferenceEvents"),i=e("../../events/ConnectionEvents"),o=e("../../events/MessageEvents"),a=e("../../events/StreamEvents"),s=e("../../utils/Constants"),c=e("../../utils/Errors"),u=e("jingle-media-session"),l=e("../../utils/Messages"),d=e("stanza.io"),p=e("../../utils/PromiseHelper"),f=e("../../events/AdvancedSettingsEvents"),h=e("./JingleMediaSession"),m=e("./xmpp_plugins/Plugins"),v=e("es6-promise"),y=e("./RtcPeerConnectionHelper"),g=e("../../utils/ObjectUtils"),S=e("../XmppBase"),_=e("../../events/ConnectionEvents"),b=e("../../events/ConnectionEvents"),C=e("../../../vidyo_connector_api/VidyoConnector"),w=e("../../events/LogEvents"),E=function(){function e(e,t,n){this._eventDispatcher=e,this._simplifiedVidyoCore=t,this._logger=n,this._lockedLocalBandwidthLimit=!1,this._operationTimeouts=[],this._rtcPeerConnectionHelper=new y.RtcPeerConnectionHelper(this._simplifiedVidyoCore.Log),u.Extend(new h.JingleMediaSession(this._rtcPeerConnectionHelper,this._simplifiedVidyoCore)),this._mapEventDispatcherEvents()}return e.prototype.AddStream=function(e,t){var n=this,r=new v.Promise(function(t,r){n._session.AddStream(e,!0,function(n,i){if(n)r(n);else if(i){var o={};e.getTracks().forEach(function(e){i.contents.forEach(function(t){t.application&&t.application.media===e.kind&&t.application.sources.forEach(function(t){o[t.name]=e.id})})}),t({trackIdsBySsrc:o})}})}),i=this._client;return p.ApplyTimeout(r,this._timeOut(function(){})).catch(function(e){throw n._mapError(e,i)})},e.prototype.ApplyLocalBandwidthLimit=function(e){!0!==this._lockedLocalBandwidthLimit&&this._session&&this._session.ApplyLocalBandwidthLimit(e,function(){})},e.prototype.ConferenceJoin=function(e,t){return this._client.CmcpCommands.ConferenceJoin(e,t)},e.prototype.ConferenceLeave=function(e,t){return this._client.CmcpCommands.ConferenceLeave(e,t)},e.prototype.ConferenceShow=function(e,t){return this._client.CmcpCommands.ConferenceShow(e,t)},e.prototype.ConferenceShowSelected=function(e,t){return this._client.CmcpCommands.ConferenceShowSelected(e,t)},e.prototype.ConferenceUpdate=function(e,t){return this._client.CmcpCommands.ConferenceUpdate(e,t)},e.prototype.Connect=function(){this._client.connect()},e.prototype.CreateClient=function(e){var t=g.default.Merge({},{credentials:e.credentials,server:e.host,wsURL:e.websocketHost,sasl:e.saslMechanisms,sendReceipts:e.sendReceipts,transports:e.transports,timeout:s.AtomicTimeOut});this._client=d.createClient(t),this._addForceDisconnect(),this._addIqSendingErrorChecker(),this._addTransportErrorChecker(),this._client.jingle.config.peerConnectionConfig.iceServers=[],this._client.jingle.iceServers=[],window["client"+Math.floor(10*Math.random())]=this._client,this._mapEvents(),this._loadPlugins()},e.prototype.Disconnect=function(){for(var e=0,t=this._operationTimeouts;e<t.length;e++){var n=t[e];if(0!==n.timeoutRef){if(clearTimeout(n.timeoutRef),n.cleanUp)try{n.cleanUp()}catch(e){this._logger.LogError(e,w.VidyoLogCategory.VidyoClient,"StanzaXmppProvider::Disconnect: operationTimeouts cleanUp error")}n.timeoutRef=0}}this.IsXMPPSessionAlive()&&this._client.jingle.endAllSessions(),this._client&&this._client.disconnect()},e.prototype.Domain=function(){return this._client.jid.domain},e.prototype.FinalizeMedia=function(e){this._client.LmiXmppMucMediaStop(e)},e.prototype.GetDiscoInfo=function(e){var t=this,n=this._client;return this._client.getDiscoInfo(e).catch(function(e){throw t._mapError(e,n)})},e.prototype.IsXMPPSessionAlive=function(){return this._client&&this._client.sessionStarted&&this._client.transport&&!0!==this._client.transport.closing&&this._client.transport.conn&&1===this._client.transport.conn.readyState},e.prototype.Jid=function(){return this._client.jid},e.prototype.JoinRoom=function(e){var t=this,n=e.id||this._client.nextId(),r=new v.Promise(function(r,i){t._client.on("muc:join",n,function(n){n.from.bare.toLowerCase()===e.jid.toLowerCase()&&n.from.resource===e.user&&(t._logger.LogEnter({roomJid:n.from.bare}),r({roomJid:n.from.bare}))})}),i=this._client;return p.ApplyTimeout(r,this._timeOut(function(){t._client.releaseGroup(n)})).catch(function(e){throw t._mapError(e,i)})},e.prototype.LeaveRoom=function(e){var t=this,n=e.id||this._client.nextId(),r=new v.Promise(function(r,i){t._client.on("muc:leave",n,function(n){n.from.bare.toLowerCase()===e.jid.toLowerCase()&&n.from.resource===e.user&&(t._logger.LogLeave({roomJid:n.from.bare}),r({roomJid:n.from.bare}))}),t._client.leaveRoom(e.jid,e.user)}),i=this._client;return p.ApplyTimeout(r,this._timeOut(function(){t._client.releaseGroup(n)})).catch(function(e){throw t._mapError(e,i)})},e.prototype.LockLocalBandwidthLimit=function(e){this._lockedLocalBandwidthLimit=e},e.prototype.MediaStart=function(e){this._client.LmiXmppMucMediaStart(e.jid,e.start)},e.prototype.MuteAudio=function(e){this._rtcPeerConnectionHelper.Options.audioMuted=e,this._session&&this._session.MuteAudio(e)},e.prototype.RemoveStream=function(e){var t=this,n=e.id,r=new v.Promise(function(r,i){var o;t._session.On("send",n,function(e){e.jingle&&"content-modify"===e.jingle.action&&(o=e.id)}),t._session.RemoveStream(e,!0,function(e,a){e?i(e):a?t._client.on("iq:*",n,function(e,t){if(t&&t.id===o&&"result"===t.type){var n=[];a.contents.forEach(function(e){e.application&&e.application.sources.forEach(function(e){n.push(e.name)})}),r({ssrcs:n})}}):r({ssrc:[]})})}),i=this._client;return p.ApplyTimeout(r,this._timeOut(function(){t._client.releaseGroup(n),t._session.ReleaseGroup(n)})).catch(function(e){throw t._mapError(e,i)})},e.prototype.SendClientStats=function(e,t){this.IsXMPPSessionAlive()&&this._client.LmiXmppComponentMessageNotify(e,"client_stats",t)},e.prototype.SendFeccMessage=function(e){this._client.sendMessage({to:e.to,fecc:e.fecc,type:e.type})},e.prototype.SendMessage=function(e){this._client.sendMessage({to:e.to,body:e.message,type:e.type})},e.prototype.SendMessageAcknowledged=function(e){this._client.sendMessage({to:e.to,type:e.type,receipt:e.id,id:e.id})},e.prototype.SendMessageChatState=function(e,t){var n;this._client.sendMessage(((n={to:e})[t]=!0,n))},e.prototype.SendPresence=function(e){this._client.sendPresence({to:e.to,ident:{name:e.idName,version:e.idVersion},props:{loc:e.location,name:e.displayName,pool_name:e.poolName},x:{history:{maxStanzas:e.maxStanzas}}})},e.prototype.SendTokenQuery=function(){var e=this,t=this._client.nextId(),n=this._client;return this._client.LmiXmppTokenAuthQuery().then(function(){var n=new v.Promise(function(n,r){e._client.on("iq:get:lmiXmppTokenAuthItems",t,function(e){n({accessToken:e.items.access_token,refreshToken:e.items.refresh_token})})});return p.ApplyTimeout(n,e._timeOut(function(){e._client.releaseGroup(t)}))}).catch(function(t){throw e._mapError(t,n)})},e.prototype.SetMediaEnabled=function(e,t){this._session&&this._session.SetMediaEnabled(e,t)},e.prototype.SetRoomSubject=function(e,t){var n=this,r=this._client.nextId(),i=new v.Promise(function(i,o){n._client.on("muc:subject",r,function(e){e.id===r&&i(void 0)}),n._client.setSubject(e,t)}),o=this._client;return p.ApplyTimeout(i,this._timeOut(function(){n._client.releaseGroup(r)})).catch(function(e){throw n._mapError(e,o)})},e.prototype.StartMediaSession=function(e){var t=this,n=this._client.nextId(),r=new v.Promise(function(r,i){e.iceServer&&t._client.jingle.addICEServer(e.iceServer);var o="";t._client.on("iq:set:*",n,function(e,t){t.jingle&&t.jingle.sid===n&&"session-accept"===t.jingle.action&&(o=t.id)});var s=null;t._client.on("jingle:accepted",n,function(e){e&&e.sid===n&&(s=t._mapMediaSession(e))}),t._client.on("raw:outgoing",n,function(e){"string"==typeof e&&s&&e.match('<iq xmlns="jabber:client')&&e.match('id="'+o+'"')&&e.match('type="result"')&&r(s)}),t._rtcPeerConnectionHelper.Options.addGoogleConferenceFlag=e.addGoogleConferenceFlag,e.enableSimulcast&&t._client.jingle.config.peerConnectionConstraints.optional.push({enableChromeNativeSimulcast:!0});var c=t._client.jingle.createMediaSession(e.jid,n);c.on("mediaSessionEnded",function(e){t._onMediaSessionEnded(e)}),c.GetLocalStreamMediaProperties&&c.GetLocalStreamMediaProperties(function(e){return t._simplifiedVidyoCore.GetLocalStreamMediaProperties(e)}),c.UpdateTransmitedStreamTracksMap&&c.UpdateTransmitedStreamTracksMap(function(e){return t._simplifiedVidyoCore.UpdateTransmitedStreamTracksMap(e)}),e.stream&&c.addStream(e.stream,!0);var u={};u.displayName=e.displayName,e.identities&&(u.identities=e.identities),c.on("iceConnectionStateConnected",function(){t._eventDispatcher.emit(a.Events.MediaEnabled)}),c.start(u)}),i=this._client;return p.ApplyTimeout(r,this._timeOut(function(){t._client.releaseGroup(n)})).then(function(e){return t._session=e,e}).catch(function(e){throw e instanceof Error&&"timeout"===e.message&&(e.message=l.CouldNotGetResponseFromMUC),t._mapError(e,i)})},e.prototype.Subscribe=function(e,t){return this._client.CmcpCommands.Subscribe(e,t)},e.prototype.Unsubscribe=function(e,t){return this._client.CmcpCommands.Unsubscribe(e,t)},e.prototype.UpdateLocalStream=function(e,t){var n=this;void 0===t&&(t=!0);var r=new v.Promise(function(r,i){n._session.UpdateLocalStream(e,function(e){e?i(e):r()},t)}),i=this._client;return p.ApplyTimeout(r,this._timeOut(function(){})).catch(function(e){throw n._mapError(e,i)})},e.prototype.UpdateStreamTracks=function(e){var t=this;return new v.Promise(function(n,r){t._session?t._session.UpdateStreamTracks(e,function(){n()}):r()})},e.prototype._addForceDisconnect=function(){this._client.__disconnect=this._client.disconnect,this._client.disconnect=function(){var e=this;this.__disconnect(),setTimeout(function(){e.transport&&!0===e.transport.closing&&e.transport.conn&&1===e.transport.conn.readyState&&e.transport.conn.close()},s.AtomicTimeOut)}.bind(this._client)},e.prototype._addIqSendingErrorChecker=function(){this._client.__sendIq=this._client.sendIq;var e=this;this._client.sendIq=function(t,n){var r=this,i=this.__sendIq(t,n);return v.Promise.all([i]).catch(function(){e._client===r&&r.emit("stanza",{type:"error",action:"iq-sending-error",data:t})}),i}.bind(this._client)},e.prototype._addTransportErrorChecker=function(){var e=this._client.connect;this._client.connect=function(t,n){e.call(this,t,n);var r=this.transport;r.__conn_onerror=r.conn.onerror,r.conn.onerror=function(e){r._transportCloseEventCode=S.CloseEventCode.AbnormalClosure,r.__conn_onerror(e)}.bind(this.transport.conn),r.__conn_onclose=r.conn.onclose,r.conn.onclose=function(e){r._transportCloseEventCode=e.code?e.code:S.CloseEventCode.NoStatusProvided,r.__conn_onclose(e)}.bind(this.transport.conn)}.bind(this._client)},e.prototype._disableXMPPMessageLogging=function(){this._logger.SetLogLevelSDK("-sent")},e.prototype._enableXMPPMessageLogging=function(){this._logger.SetLogLevelSDK("sent")},e.prototype._loadPlugins=function(){var e=this;m.Plugins.forEach(function(t){return e._client.use(t)})},e.prototype._mapError=function(e,t){return this._client&&this._client!==t?new c.NotValidClientError(e.error.condition):e instanceof Error?e:"timeout"===e.error.condition?new c.TimeOutError(e.error.condition):new Error(e.error.condition)},e.prototype._mapEventDispatcherEvents=function(){var e=this;this._eventDispatcher.on(f.Events.EnableXMPPMessageLoggingChanged,function(t){t?e._enableXMPPMessageLogging():e._disableXMPPMessageLogging()})},e.prototype._mapEvents=function(){var e=this;this._client.on("*",function(t,n){if("raw:incoming"===t||"raw:outgoing"===t){var r=n;"raw:incoming"===t&&e._logger.LogReceived(r),"raw:outgoing"===t&&e._logger.LogSent(r)}}),this._client.on("message",function(t){if(t.vidyoMessage&&t.vidyoMessage.body){var n={body:t.vidyoMessage.body,id:t.id,resource:t.from.resource,type:t.type,subtype:t.subtype};e._eventDispatcher.emit(o.Events.MessageReceived,n)}}),this._client.on("receipt",function(t){t.receipt&&t.id&&t.from.resource&&e._eventDispatcher.emit(o.Events.MessageRead,{id:t.id,resource:t.from.resource})}),this._client.on("chatState",function(t){t.chatState&&t.from.resource&&e._eventDispatcher.emit(o.Events.MessageChatState,{chatState:t.chatState,resource:t.from.resource})}),this._client.on("presence",function(t){t&&"unavailable"===t.type&&(e._logger.LogInfo('StanzaXmppProvider: on presence = "'+(t?JSON.stringify(t):"")+'"',w.VidyoLogCategory.VidyoDevelopment),e._eventDispatcher.emit(r.Events.SelectedParticipantUnavailable,{id:t.from.resource}))}),this._client.on("available",function(t){var n=t.muc?t.muc.jid.bare:t.from.bare,r=t.muc?t.muc.jid.full:void 0,o=t.from?t.from.resource:t.muc?t.muc.jid.resource:"";n&&o&&e._eventDispatcher.emit(i.Events.Available,{fullJid:r,jid:n,resource:o})}),this._client.on("stream:end",function(t){e._logger.LogInfo("StanzaXmppProvider: on stream:end"),e._client.jingle.endAllSessions(),e._eventDispatcher.emit(i.Events.SignallingDisconnected,_.ConnectionEventsInfo.Disconnected)}),this._client.on("stream:error",function(t){e._logger.LogError("StanzaXmppProvider: on stream:error"),e._client.jingle.endAllSessions(),e._eventDispatcher.emit(i.Events.SignallingError,_.ConnectionEventsInfo.SignallingError)}),this._client.on("stream:data",function(t){if(t&&t.xml&&t.xml.name)switch(t.xml.name){case"error":var n=t.xml.getChild("text");e._logger.LogError("StanzaXmppProvider: on Error"+(n?' - "'+n.textContent+'"':".")),t&&!t.closing&&e.IsXMPPSessionAlive()&&e._client.jingle.endAllSessions();var r=_.ConnectionEventsInfo.SignallingError;n.textContent&&(r=new b.VidyoEventInfo("SignallingError",C.VidyoConnectorDisconnectReason.MiscError,n.textContent,"error")),e._eventDispatcher.emit(i.Events.SignallingError,r)}}),this._client.on("disconnected",function(t){e._logger.LogInfo("StanzaXmppProvider: on disconnected",w.VidyoLogCategory.VidyoDevelopment),t&&!t.closing&&e._client.jingle.endAllSessions(),t&&t._transportCloseEventCode&&t._transportCloseEventCode!==S.CloseEventCode.NormalClosure&&t._transportCloseEventCode!==S.CloseEventCode.NoStatusProvided?e._eventDispatcher.emit(i.Events.SignallingDisconnected,_.ConnectionEventsInfo.SignallingTransportError):e._eventDispatcher.emit(i.Events.SignallingDisconnected,_.ConnectionEventsInfo.Disconnected)}),this._client.on("stanza",function(t){t&&"error"===t.type&&t.jingle&&"session-terminate"===t.jingle.action&&"failed-transport"===t.jingle.reason.condition&&e._eventDispatcher.emit(i.Events.SignallingDisconnected,_.ConnectionEventsInfo.SignallingTransportError),t&&"error"===t.type&&"iq-sending-error"===t.action&&(e.IsXMPPSessionAlive()?(e._logger.LogInfo(new Date+"  XMPP IQ Sending error"),e._logger.LogDebug(new Date+"  XMPP IQ Sending error: "+JSON.stringify(t)),e._eventDispatcher.emit(i.Events.IqSendingError,t)):e._logger.LogDebug(new Date+"  XMPP IQ: trying to send/or_receive_confirmation IQ while XMPP session is not alive: "+JSON.stringify(t)))}),this._client.on("iq:set:conference",function(t){e._eventDispatcher.emit(i.Events.LmiXmppMucMediaConf,t.conference)}),this._client.on("iq:set:lmiCmcpConferenceAccept",function(t){e._eventDispatcher.emit(r.Events.ConferenceAccepted.Scoped(t.dialogId.remote),t)}),this._client.on("iq:set:lmiCmcpConferenceReject",function(t){e._eventDispatcher.emit(r.Events.ConferenceRejected.Scoped(t.dialogId.remote),t)}),this._client.on("iq:set:lmiCmcpNotifyParticipant",function(t){e._eventDispatcher.emit(r.Events.NotifyParticipant.Scoped(t.dialogId.remote),t)}),this._client.on("iq:set:lmiCmcpNotifySelectedParticipant",function(t){e._eventDispatcher.emit(r.Events.NotifySelectedParticipant.Scoped(t.dialogId.remote),t)}),this._client.on("iq:result:lmiCmcpReply",function(t){e._eventDispatcher.emit(r.Events.Reply.Scoped(t.dialogId.local),t)}),this._client.on("jingle:error",function(t){var n=e._client.CmcpCommands.CheckSubscribeHistory(t.id);n&&"timeout"===t.error.condition&&e._eventDispatcher.emit(r.Events.SubscribeTimeout.Scoped(n.LocalId),{dialogId:{local:n.LocalId}})}),this._client.on("iq:set:lmiJingleSourceView",function(t){e._eventDispatcher.emit(i.Events.JingleSourceView,t.jingle.view)}),this._client.on("jingle:accepted",function(t){e._eventDispatcher.emit(i.Events.JingleAccepted,e._mapMediaSession(t))}),this._client.on("jingle:remotestream:added",function(t,n){e._eventDispatcher.emit(i.Events.JingleRemoteStreamAdded,{stream:n})}),this._client.on("jingle:remotestream:removed",function(t,n){e._eventDispatcher.emit(i.Events.JingleRemoteStreamRemoved,{stream:n})}),this._client.on("session:started",function(t){e._eventDispatcher.emit(i.Events.Connected,t)}),this._client.on("sasl:failure",function(t){e._client.jingle.endAllSessions(),e._eventDispatcher.emit(i.Events.AuthenticationError,_.ConnectionEventsInfo.InvalidToken)})},e.prototype._mapMediaSession=function(e){return{sid:e.sid,Accept:function(){e.accept()},AddStream:function(t,n,r){e.addStream(t,n,r)},ApplyLocalBandwidthLimit:function(t){e.ApplyLocalBandwidthLimit(t,function(){})},GetStats:function(){return new v.Promise(function(t){e.pc.getStats(function(e,n){return t(n)})})},GetReceiverSsrcByTrackId:function(t){var n="";e&&e.pc&&e.pc.pc&&e.pc.pc.getReceivers().forEach(function(e){if(e.track&&e.track.id===t&&e.getParameters){var r=e.getParameters();r&&r.encodings&&r.encodings.length>0&&(n=""+r.encodings[0].ssrc)}});return n},MuteAudio:function(t){e.muteAudio(t)},On:function(t,n,r){e.on(t,n,r)},ReleaseGroup:function(t){e.releaseGroup(t)},RemoveStream:function(t,n,r){e.removeStream(t,n,r)},State:function(){return e._connectionState},SetMediaEnabled:function(t,n){e.SetMediaEnabled(t,n)},UpdateLocalStream:function(t,n,r){void 0===r&&(r=!0),e.UpdateLocalStream(t,n,r)},UpdateStreamTracks:function(t,n){return e.UpdateStreamTracks(t,n)}}},e.prototype._onMediaSessionEnded=function(e){switch(e){case"failed-application":this._eventDispatcher.emit(i.Events.MediaSessionFailed,_.ConnectionEventsInfo.MediaSessionError);break;case"failed-transport":this._eventDispatcher.emit(i.Events.MediaSessionFailed,_.ConnectionEventsInfo.MediaSessionTransportError);break;default:this._eventDispatcher.emit(i.Events.MediaSessionEnded,_.ConnectionEventsInfo.MediaSessionEnded)}},e.prototype._timeOut=function(e){var t=new p.PromiseTimeout((s.BatchTimeOut||this._client.config.timeout)*s.SecToMsCoefficient,e);return this._operationTimeouts.push(t),t},e}();n.StanzaXmppProvider=E},{"../../../vidyo_connector_api/VidyoConnector":526,"../../events/AdvancedSettingsEvents":394,"../../events/ConferenceEvents":396,"../../events/ConnectionEvents":397,"../../events/LogEvents":400,"../../events/MessageEvents":401,"../../events/StreamEvents":408,"../../utils/Constants":461,"../../utils/Errors":462,"../../utils/Messages":468,"../../utils/ObjectUtils":471,"../../utils/PromiseHelper":475,"../XmppBase":487,"./JingleMediaSession":490,"./RtcPeerConnectionHelper":493,"./xmpp_plugins/Plugins":499,"es6-promise":43,"jingle-media-session":81,"stanza.io":259}],495:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../JxtExtension"),i=e("./LmiCmcp/CmcpCommands"),o=e("./LmiCmcp/CmcpTypes");n.LmiCmcp=function(e,t){var n=r.ExtendJXT(t),a=n.utils,s="http://www.vidyo.com/ns/LmiCmcp.xsd",c=n.define({name:"event",namespace:s,element:"event"}),u=n.define({name:"notify",namespace:s,element:"notify",fields:{resource:a.textSub(s,"resource"),package:a.textSub(s,"package"),eTag:a.textSub(s,"eTag"),event:a.extension(c)}}),l=n.define({name:"conferenceLeave",namespace:s,element:"conferenceLeave",fields:{conference:a.textSub(s,"conference"),reason:a.numberSub(s,"reason")}}),d=n.define({name:"subscribe",namespace:s,element:"subscribe",fields:{package:a.textSub(s,"package"),resource:a.textSub(s,"resource"),duration:a.numberSub(s,"duration"),suppressIfMatch:a.attribute("suppressIfMatch")}}),p=n.define({name:"unsubscribe",namespace:s,element:"unsubscribe",fields:{package:a.textSub(s,"package"),resource:a.textSub(s,"resource")}}),f=n.define({name:"audio",namespace:s,element:"audio",fields:{count:a.numberSub(s,"count"),policy:a.textSub(s,"policy")}}),h=n.define({name:"generation",namespace:s,element:"generation",fields:{id:a.numberAttribute("id"),state:a.attribute("state")}}),m={policy:a.speciallyParsedAttribute("policy",function(e){return e}),dynamicViewPolicy:a.speciallyParsedAttribute("dynamicViewPolicy",function(e){return e}),generation:a.multiExtension(h)},v=n.define({name:"video",namespace:s,element:"video",fields:m}),y=n.define({name:"application",namespace:s,element:"application",fields:m}),g=n.define({name:"conferenceShowSelected",namespace:s,element:"conferenceShowSelected",fields:{audio:a.extension(f),video:a.extension(v),application:a.extension(y)}}),S=n.define({name:"conferenceJoin",namespace:s,element:"conferenceJoin",fields:{gm:a.attribute("gm"),displayText:a.textSub(s,"displayText"),recording:a.boolAttribute("recording"),hidden:a.boolAttribute("hidden"),selectable:a.boolAttribute("selectable"),conference:a.textSub(s,"conference"),meshId:a.textSub(s,"meshId"),localConferenceId:a.textSub(s,"localConferenceId"),password:a.textSub(s,"password"),session:a.textSub(s,"session")}}),_=n.define({name:"conferenceShow",namespace:s,element:"conferenceShow",fields:{sourceId:a.numberSub(s,"sourceId"),state:a.textSub(s,"state")}}),b=n.define({name:"conferenceUpdate",namespace:s,element:"conferenceUpdate",fields:{recording:a.boolAttribute("recording"),hidden:a.boolAttribute("hidden"),selectable:a.boolAttribute("selectable")}}),C=n.define({name:"command",namespace:s,element:"command",fields:{conferenceAccept:a.boolSub(s,"conferenceAccept"),conferenceReject:a.boolSub(s,"conferenceReject")}});n.extend(C,u),n.extend(C,d),n.extend(C,p),n.extend(C,S),n.extend(C,l),n.extend(C,_),n.extend(C,b),n.extend(C,g);var w=n.define({name:"commands",namespace:s,element:"commands",fields:{from:a.jidSub(s,"from"),atomic:a.boolAttribute("atomic"),command:a.extension(C),version:a.numberAttribute("version",!1,5)}}),E=n.define({name:"reply",namespace:s,element:"reply",fields:{result:a.attribute("result"),errorInfo:a.textSub(s,"errorInfo")}}),R=n.define({name:"replies",namespace:s,element:"replies",fields:{version:a.numberAttribute("version"),from:a.jidSub(s,"from")}});function P(t,n,r){var i={from:t,jingle:{sid:Object.keys(e.jingle.sessions)[0],action:n,contents:r}};e.emit("iq:set:jingle",i)}n.withDefinition("replies",s,function(e){n.extend(e,E,"replies")}),n.withIQ(function(e){n.extend(e,w),n.extend(e,R)}),e.CmcpCommands=new i.CmcpCommands(e),e.on("iq:set:commands",function(t){if(o.IsCmcpIq(t)){if(e.CmcpCommands.ResultReply(t,"200"),t.commands.command.conferenceAccept){var n={dialogId:t.commands.command.dialogId,conferenceAccept:!0};e.emit("iq:set:lmiCmcpConferenceAccept",n)}if(t.commands.command.conferenceReject&&(n={dialogId:t.commands.command.dialogId,conferenceReject:!0},e.emit("iq:set:lmiCmcpConferenceReject",n)),t.commands.command.notify&&(n={dialogId:t.commands.command.dialogId,notify:t.commands.command.notify},e.emit("iq:set:lmiCmcpNotifySelectedParticipant",n)),t.commands.command.notify&&(n={dialogId:t.commands.command.dialogId,notify:t.commands.command.notify},e.emit("iq:set:lmiCmcpNotifyParticipant",n),n&&n.notify&&n.notify.event&&n.notify.event.participantPackageContent&&n.notify.event.participantPackageContent.participants)){var r=[],i=[];n.notify.event.participantPackageContent.participants.forEach(function(t){var n,o,a;t.sources?t.sources.forEach(function(e){r.push(function(e,t){"audio"===t.type&&delete t.secondaryId;var n=[],r=e,i=t.idStr;[t.id,t.secondaryId].forEach(function(e){e&&n.push({ssrc:e.toString(),parameters:[{key:"cname",value:t.name},{key:"msid",value:r+" "+i},{key:"mslabel",value:r},{key:"label",value:i}]})});var o=[];return t.secondaryId&&o.push({semantics:"FID",sources:[t.id.toString(),t.secondaryId.toString()]}),{creator:"initiator",disposition:"session",name:t.type,senders:"both",application:{ssrc:t.id.toString(),applicationType:"rtp",media:t.type,sources:n,sourceGroups:o},transport:{transportType:"iceUdp"}}}(t.participantUri,e))}):"leave"===t.event&&i.push((n=t.participantUri,o=Object.keys(e.jingle.sessions)[0],(a=e.jingle.sessions[o].pc.remoteDescription.contents).forEach(function(e){e.application.sources=e.application.sources.filter(function(e){return!e.parameters.some(function(e){return"mslabel"===e.key&&e.value===n})}),e.application.sourceGroups=e.application.sourceGroups.filter(function(t){return t.sources.some(function(t){return e.application.sources.some(function(e){return e.ssrc===t.toString()})})})}),a))}),r.length&&P(t.from,"source-add",r),i.length&&P(t.from,"source-remove",i)}}}),e.on("iq:*",function(t,n){"iq:result:lmiCmcpReply"!==t&&o.IsCmcpReplyIq(n)&&n.replies.replies.forEach(function(t){e.emit("iq:result:lmiCmcpReply",t)})})}},{"../../JxtExtension":491,"./LmiCmcp/CmcpCommands":496,"./LmiCmcp/CmcpTypes":498}],496:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./CmcpMediaSource"),i=e("./CmcpTypes"),o=e("../../../../../utils/ObjectUtils"),a=function(){function e(e){this.ConferenceState=i.CmcpConferenceState,this.MediaSource=r.CmcpMediaSource,this._subscribeHistory={},this._client=e}return e.prototype.CheckSubscribeHistory=function(e){return this._subscribeHistory[e]},e.prototype.ConferenceJoin=function(e,t){var n={conference:e.Conference,localConferenceId:e.Conference,session:e.Session};return n=o.default.Merge(n,t),this._sendCmcpIq(e,{conferenceJoin:n})},e.prototype.ConferenceLeave=function(e,t){return this._sendCmcpIq(e,{conferenceLeave:{conference:e.Conference,reason:t.reason}})},e.prototype.ConferenceShow=function(e,t){return this._sendCmcpIq(e,{conferenceShow:t})},e.prototype.ConferenceShowSelected=function(e,t){return this._sendCmcpIq(e,{conferenceShowSelected:t})},e.prototype.ConferenceUpdate=function(e,t){return this._sendCmcpIq(e,{conferenceUpdate:{recording:!!(t.conferenceState&i.CmcpConferenceState.Recording),hidden:!!(t.conferenceState&i.CmcpConferenceState.Hidden),selectable:!!(t.conferenceState&i.CmcpConferenceState.Selectable)}})},e.prototype.ErrorReply=function(e,t,n){return this._client.sendIq(e.errorReply(this._replyData(e.commands.command.dialogId,t,n)))},e.prototype.ResultReply=function(e,t){return this._client.sendIq(e.resultReply(this._replyData(e.commands.command.dialogId,t)))},e.prototype.Subscribe=function(e,t){var n={resource:e.Conference};n=o.default.Merge(n,t);var r=this._sendCmcpIq(e,{subscribe:n},!0),i=r.promise,a=r.id;return this._subscribeHistory[a]=e,i},e.prototype.Unsubscribe=function(e,t){var n={resource:e.Conference};return n=o.default.Merge(n,t),this._sendCmcpIq(e,{unsubscribe:n})},e.prototype._replyData=function(e,t,n){return{replies:{version:5,from:this._client.jid.full,reply:{result:t,errorInfo:n,dialogId:e}}}},e.prototype._sendCmcpIq=function(e,t,n){var r=this._client.nextId(),i={dialogId:{local:e.LocalId},id:r};e.RemoteId&&(i.dialogId.remote=e.RemoteId),Object.keys(t).forEach(function(e){i[e]=t[e]});var o=this._client.sendIq({from:this._client.jid.full,to:e.Reflector,type:"set",commands:{from:this._client.jid.full,command:i,version:5}});return n?{id:r,promise:o}:o},e}();n.CmcpCommands=a},{"../../../../../utils/ObjectUtils":471,"./CmcpMediaSource":497,"./CmcpTypes":498}],497:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(e){switch(this.enabled=!0,e.Type){case"Camera":this.type="video";break;case"Microphone":this.type="audio";break;default:Error("Not suppported device type: "+e.Type+".")}this.ssrcMap={connId:1,ssrc:[1,2,3]},this.id=parseInt(e.Id,10),this.idStr=e.Id,"video"===this.type?this.secondaryId=567:this.secondaryId=456;this.name=e.Name,this.label=e.Name}}();n.CmcpMediaSource=r},{}],498:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.IsCmcpIq=function(e){var t=e;return!(!t.commands||!t.commands.command)},n.IsCmcpReplyIq=function(e){return!!(e.replies&&e.replies.replies&&e.replies.replies.length)},function(e){e[e.Recording=1]="Recording",e[e.Hidden=2]="Hidden",e[e.Selectable=4]="Selectable"}(n.CmcpConferenceState||(n.CmcpConferenceState={}))},{}],499:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Cmcp/LmiCmcp"),i=e("./Signaling/LmiComponentProperties"),o=e("./Xmpp/jingle/LmiJingle"),a=e("./Xmpp/jingle/LmiJingleConfInfo"),s=e("./Xmpp/jingle/LmiJingleErrors"),c=e("./Xmpp/jingle/LmiJingleRtcpFeedback"),u=e("./Xmpp/jingle/LmiJingleRtp"),l=e("./Xmpp/jingle/LmiJingleRtpErrors"),d=e("./Xmpp/jingle/LmiJingleRtpHeaderExt"),p=e("./Xmpp/jingle/LmiJingleRtpInfo"),f=e("./Xmpp/jingle/LmiJingleSource"),h=e("./Xmpp/jingle/LmiJingleSourceView"),m=e("./Xmpp/jingle/LmiJingleTransport"),v=e("./Signaling/LmiParticipantPackage"),y=e("./Signaling/LmiProtocol"),g=e("./Signaling/LmiSelectedParticipantPackage"),S=e("./Xmpp/LmiXmppComponentMessage"),_=e("./Xmpp/LmiXmppMucMedia"),b=e("./Xmpp/LmiXmppTokenAuth"),C=e("./Xmpp/LmiXmppStanzas"),w=e("./Xmpp/LmiXmppFecc");n.Plugins=[r.LmiCmcp,i.LmiComponentProperties,o.LmiJingle,a.LmiJingleConfInfo,s.LmiJingleErrors,c.LmiJingleRtcpFeedback,u.LmiJingleRtp,l.LmiJingleRtpErrors,d.LmiJingleRtpHeaderExt,p.LmiJingleRtpInfo,f.LmiJingleSource,h.LmiJingleSourceView,m.LmiJingleTransport,v.LmiParticipantPackage,y.LmiProtocol,g.LmiSelectedParticipantPackage,S.LmiXmppComponentMessage,_.LmiXmppMucMedia,b.LmiXmppTokenAuth,C.LmiXmppStanzas,w.LmiXmppFecc]},{"./Cmcp/LmiCmcp":495,"./Signaling/LmiComponentProperties":500,"./Signaling/LmiParticipantPackage":501,"./Signaling/LmiProtocol":502,"./Signaling/LmiSelectedParticipantPackage":503,"./Xmpp/LmiXmppComponentMessage":504,"./Xmpp/LmiXmppFecc":505,"./Xmpp/LmiXmppMucMedia":506,"./Xmpp/LmiXmppStanzas":507,"./Xmpp/LmiXmppTokenAuth":508,"./Xmpp/jingle/LmiJingle":509,"./Xmpp/jingle/LmiJingleConfInfo":510,"./Xmpp/jingle/LmiJingleErrors":511,"./Xmpp/jingle/LmiJingleRtcpFeedback":512,"./Xmpp/jingle/LmiJingleRtp":513,"./Xmpp/jingle/LmiJingleRtpErrors":514,"./Xmpp/jingle/LmiJingleRtpHeaderExt":515,"./Xmpp/jingle/LmiJingleRtpInfo":516,"./Xmpp/jingle/LmiJingleSource":517,"./Xmpp/jingle/LmiJingleSourceView":518,"./Xmpp/jingle/LmiJingleTransport":519}],500:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../JxtExtension");n.LmiComponentProperties=function(e,t){var n=r.ExtendJXT(t),i=n.utils,o="http://www.vidyo.com/ns/LmiProps.xsd",a=n.define({name:"x",namespace:"http://jabber.org/protocol/muc",element:"x",fields:{history:{set:function(e){var t=i.createElement(o,"history",o);this.xml.appendChild(t),t.setAttribute("maxstanzas",""+e.maxStanzas)}}}}),s=n.define({name:"props",namespace:o,element:"props",fields:{name:i.textSub(o,"name"),pool_name:i.textSub(o,"pool_name")}}),c=n.define({name:"loc",namespace:o,element:"loc",fields:{latitude:i.numberSub(o,"lat"),longitude:i.numberSub(o,"lon")}}),u=n.define({name:"ident",namespace:"jabber:client",element:"id",fields:{name:i.textSub("http://www.vidyo.com/ns/LmiProtocol.xsd","name"),version:i.textSub("http://www.vidyo.com/ns/LmiProtocol.xsd","version")}});n.extend(s,c),n.withPresence(function(e){n.extend(e,s),n.extend(e,a),n.extend(e,u)})}},{"../../JxtExtension":491}],501:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../JxtExtension");n.LmiParticipantPackage=function(e,t){var n=r.ExtendJXT(t),i=n.utils,o="http://www.vidyo.com/ns/LmiParticipantPackage.xsd",a=n.define({name:"participant",namespace:o,element:"p",fields:{participantUri:i.textSub(o,"uri"),displayText:i.textSub(o,"dt"),duration:i.textSub(o,"dur"),confUri:i.textSub(o,"c"),event:i.textSub(o,"evt")}}),s=n.define({name:"participantPackageContent",namespace:o,element:"content",fields:{status:i.attribute("status"),participants:i.multiExtension(a)}});n.withDefinition("event","http://www.vidyo.com/ns/LmiCmcp.xsd",function(e){n.extend(e,s)})}},{"../../JxtExtension":491}],502:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../JxtExtension");n.LmiProtocol=function(e,t){var n=r.ExtendJXT(t),i=n.utils,o="http://www.vidyo.com/ns/LmiProtocol.xsd",a=n.define({name:"identity",namespace:o,element:"id",fields:{name:i.textSub(o,"name"),version:i.textSub(o,"version")}}),s=n.define({name:"dialogId",namespace:o,element:"dialogId",fields:{local:i.numberSub(o,"local"),remote:i.numberSub(o,"remote")}}),c=n.define({name:"parameters",namespace:o,element:"parameter",fields:{id:i.attribute("id"),mode:i.attribute("mode")}}),u=(n.define({name:"rc",namespace:o,element:"rc",fields:{id:i.attribute("id"),parameters:i.multiExtension(c)}}),n.define({name:"ssrcMap",namespace:o,element:"ssrcMap",fields:{connId:i.numberAttribute("connId"),ssrc:i.multiNumberSub(o,"ssrc")}})),l=n.define({name:"properties",namespace:o,element:"prop",fields:{name:i.textSub(o,"nm"),value:i.textSub(o,"val")}}),d=n.define({name:"source",namespace:"http://www.vidyo.com/ns/LmiParticipantPackage.xsd",element:"src",fields:{enabled:i.boolSub("http://www.vidyo.com/ns/LmiParticipantPackage.xsd","enabled"),dyn:i.attribute("dyn"),type:i.attribute("type"),id:i.numberAttribute("id"),idStr:i.attribute("idStr"),secondaryId:i.numberAttribute("secondaryId"),name:i.attribute("name"),label:i.attribute("label"),signal:i.attribute("signal"),ssrcMap:i.extension(u),properties:i.multiExtension(l)}}),p={width:i.numberSub(o,"width"),height:i.numberSub(o,"height")},f=n.define({name:"windowSize",namespace:o,element:"windowSize",fields:p}),h=n.define({name:"minWindowSize",namespace:o,element:"minWindowSize",fields:p}),m=n.define({name:"params",namespace:o,element:"params",fields:{windowSize:i.extension(f),framesPerSec:i.numberSub(o,"framesPerSec"),pixelRate:i.numberSub(o,"pixelRate"),preference:i.numberSub(o,"preference"),bandwidth:i.numberSub(o,"bandwidth"),minWindowSize:i.extension(h),minFramesPerSec:i.numberSub(o,"minFramesPerSec"),minPixelRate:i.numberSub(o,"minPixelRate"),minBandwidth:i.numberSub(o,"minBandwidth"),temporalSpatialTradeoff:i.numberSub(o,"temporalSpatialTradeoff"),connectionId:i.numberSub(o,"connectionId")}});n.withDefinition("jingle","urn:xmpp:jingle:1",function(e){n.extend(e,a)}),n.withDefinition("p","http://www.vidyo.com/ns/LmiParticipantPackage.xsd",function(e){n.extend(e,a),n.extend(e,d,"sources")}),n.withDefinition("conferenceJoin","http://www.vidyo.com/ns/LmiCmcp.xsd",function(e){n.extend(e,d,"sources")}),n.withDefinition("command","http://www.vidyo.com/ns/LmiCmcp.xsd",function(e){n.extend(e,s)}),n.withDefinition("reply","http://www.vidyo.com/ns/LmiCmcp.xsd",function(e){n.extend(e,s)}),n.withDefinition("generation","http://www.vidyo.com/ns/LmiCmcp.xsd",function(e){n.extend(e,m)}),n.withDefinition("conferenceShow","http://www.vidyo.com/ns/LmiCmcp.xsd",function(e){n.extend(e,m)})}},{"../../JxtExtension":491}],503:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../JxtExtension");n.LmiSelectedParticipantPackage=function(e,t){var n=r.ExtendJXT(t),i=n.utils,o="http://www.vidyo.com/ns/LmiSelectedParticipantPackage.xsd",a=n.define({name:"selectedParticipant",namespace:o,element:"sp",fields:{active:i.attribute("active"),generation:i.numberAttribute("generation",!1),id:i.attribute("id"),value:i.text()}}),s=n.define({name:"selectedParticipantPackageContent",namespace:o,element:"content",fields:{conference:i.textSub(o,"c"),version:i.numberAttribute("version",!1,72)}});n.extend(s,a,"selectedParticipants",!0),n.withDefinition("event","http://www.vidyo.com/ns/LmiCmcp.xsd",function(e){n.extend(e,s)})}},{"../../JxtExtension":491}],504:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiXmppComponentMessage=function(e,t){var n=t.utils,r="http://www.vidyo.com/ns/LmiXmppComponentMessage.xsd",i=t.define({name:"notify",namespace:r,element:"notify",fields:{topic:n.textSub(r,"topic"),message:n.textSub(r,"message")}}),o=t.define({name:"request",namespace:r,element:"request",fields:{topic:n.textSub(r,"topic"),message:n.textSub(r,"message")}}),a=t.define({name:"reply",namespace:r,element:"reply",fields:{topic:n.textSub(r,"topic"),message:n.textSub(r,"message")}});t.withIQ(function(e){t.extend(e,o),t.extend(e,a),t.extend(e,i)}),e.LmiXmppComponentMessageNotify=function(t,n,r){return e.sendIq({to:t,type:"set",notify:{topic:n,message:r}})}}},{}],505:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiXmppFecc=function(e,t){var n=t.utils,r="http://www.vidyo.com/ns/LmiXmppFecc.xsd",i=t.define({name:"nudge",namespace:r,element:"nudge",fields:{param:n.attribute("param"),nudges:n.attribute("nudges")}}),o=t.define({name:"capture",namespace:r,element:"capture",fields:{id:n.attribute("id")}}),a=t.define({name:"cmds",namespace:r,element:"cmds",fields:{source:n.attribute("source"),nudge:n.multiExtension(i),capture:n.multiExtension(o)}}),s=t.define({name:"fecc",namespace:r,element:"fecc",fields:{cmds:n.extension(a),occ:n.attribute("occ")}});t.withMessage(function(e){t.extend(e,s)})}},{}],506:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiXmppMucMedia=function(e,t){var n=t.utils,r="http://www.vidyo.com/ns/LmiXmppMucMedia.xsd",i=t.define({name:"conference",namespace:r,element:"conf",fields:{id:n.attribute("id"),reflector:n.attribute("reflector")}}),o=t.define({name:"_propertry",namespace:r,element:"prop",fields:{name:n.attribute("name"),value:n.attribute("value"),type:n.attribute("type")}});t.extend(i,o,"properties");var a=t.define({name:"start",namespace:r,element:"start",fields:{ips:n.multiTextSub(r,"ip")}}),s=t.define({name:"location",namespace:r,element:"loc",fields:{latitude:n.numberAttribute("lat",!0),longitude:n.numberAttribute("lon",!0)}});t.extend(a,s);var c=t.define({name:"stop",namespace:r,element:"stop",fields:{}});t.withIQ(function(e){t.extend(e,i),t.extend(e,a),t.extend(e,c)}),e.LmiXmppMucMediaStart=function(t,n){return e.sendIq({to:t,type:"set",start:n})},e.LmiXmppMucMediaStop=function(t){return e.sendIq({to:t,type:"set",stop:{}})},e.on("iq:set:conference",function(t){t.conference&&e.sendIq(t.resultReply())})}},{}],507:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiXmppStanzas=function(e,t){var n=t.utils,r=t.define({name:"vidyoMessage",namespace:"http://www.vidyo.com/ns/LmiXmpp.xsd",element:"body",fields:{body:n.text()}});t.withMessage(function(e){t.extend(e,r),t.add(e,"subtype",n.attribute("subtype","normal"))})}},{}],508:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiXmppTokenAuth=function(e,t){var n=t.utils,r="erlang-solutions.com:xmpp:token-auth:0",i=t.define({name:"lmiXmppTokenAuthQuery",namespace:r,element:"query"}),o=t.define({name:"lmiXmppTokenAuthItems",namespace:r,element:"items",fields:{accessToken:n.textSub(r,"access_token"),refreshToken:n.textSub(r,"refresh_token")}});t.withIQ(function(e){t.extend(e,i),t.extend(e,o)}),e.LmiXmppTokenAuthQuery=function(){return e.sendIq({to:e.jid.domain,type:"get",lmiXmppTokenAuthQuery:{}})}}},{}],509:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingle=function(e,t){var n=t.utils,r=t.define({name:"LmiJingleName",namespace:"urn:xmpp:jingle:1",element:"name",fields:{value:n.text()}}),i="http://www.vidyo.com/ns/LmiProtocol.xsd",o=t.define({name:"id",namespace:i,element:"id",fields:{name:n.textSub(i,"name"),version:n.textSub(i,"version")}});t.withDefinition("jingle","urn:xmpp:jingle:1",function(e){t.extend(e,r),t.extend(e,o,"lmiIdentities")})}},{}],510:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleConfInfo=function(e,t){var n=t.utils,r=t.define({name:"LmiJingleConfInfo",namespace:"urn:xmpp:jingle:apps:coin:1",element:"conference-info",fields:{dummy:n.boolSub("dummy"),isfocus:n.boolAttribute("isfocus")}});t.withDefinition("jingle","urn:xmpp:jingle:1",function(e){t.extend(e,r)})}},{}],511:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleErrors=function(e,t){}},{}],512:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleRtcpFeedback=function(e,t){}},{}],513:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleRtp=function(e,t){}},{}],514:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleRtpErrors=function(e,t){}},{}],515:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleRtpHeaderExt=function(e,t){}},{}],516:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleRtpInfo=function(e,t){}},{}],517:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../../JxtExtension"),i=e("../../../../../utils/Messages"),o=e("../../../../../utils/StringUtils");n.LmiJingleSource=function(e,t){var n=r.ExtendJXT(t),a=n.utils,s="urn:xmpp:jingle:apps:rtp:src-desc:1",c=n.define({name:"_ssrc",namespace:s,element:"ssrc",fields:{id:a.attribute("id")}}),u=n.define({name:"_ssrcGroup",namespace:s,element:"ssrc-group",fields:{semantic:a.attribute("semantic"),srefs:a.multiTextSub(s,"sref")}}),l=n.define({name:"_parameter",namespace:s,element:"parameter",fields:{name:a.attribute("name"),value:a.attribute("value")}}),d=n.define({name:"_source",namespace:s,element:"source",fields:{name:a.attribute("name"),dyn:a.attribute("dyn"),cname:a.attribute("cname"),content:a.attribute("content"),signal:a.attribute("signal"),ssrcs:a.multiExtension(c),ssrcGroups:a.multiExtension(u),parameters:a.multiExtension(l)}}),p=i.ValidationErrorInParentRequiredFieldNameIsNotFound;n.withDefinition("description","urn:xmpp:jingle:apps:rtp:1",function(e){n.add(e,"sources",a.addValidation(a.multiExtension(d),function(e){e.forEach(function(e){if(!e.name)throw new Error(o.default.Format(p,{parent:"source",name:"name"}));if(!e.cname)throw new Error(o.default.Format(p,{parent:"source",name:"cname"}));if(!e.content)throw new Error(o.default.Format(p,{parent:"source",name:"content"}))})}))})}},{"../../../../../utils/Messages":468,"../../../../../utils/StringUtils":479,"../../../JxtExtension":491}],518:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleSourceView=function(e,t){var n=t.utils,r=t.define({name:"view",namespace:"http://www.vidyo.com/ns/LmiJingleSource.xsd",element:"view",fields:{}}),i=t.define({name:"_source",namespace:"http://www.vidyo.com/ns/LmiJingleSource.xsd",element:"source",fields:{id:n.attribute("id"),enable:n.boolAttribute("enable")}}),o=t.define({name:"params",namespace:"http://www.vidyo.com/ns/LmiJingleSource.xsd",element:"params",fields:{width:n.attribute("width"),height:n.attribute("height"),framerate:n.attribute("framerate"),pixelrate:n.attribute("pixelrate"),bandwidth:n.attribute("bandwidth"),preference:n.attribute("preference"),tsto:n.attribute("tsto"),minWidth:n.attribute("minWidth"),minHeight:n.attribute("minHeight"),minFrameRate:n.attribute("minFrameRate"),minPixelRate:n.attribute("minPixelRate"),minBandwidth:n.attribute("minBandwidth")}});t.extend(i,o),t.extend(r,i,"sources"),t.withDefinition("jingle","urn:xmpp:jingle:1",function(e){t.extend(e,r)}),e.on("iq:set:jingle",function(t){t.jingle.view&&e.emit("iq:set:lmiJingleSourceView",t)})}},{}],519:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleTransport=function(e,t){var n=t.utils;t.withDefinition("transport","urn:xmpp:jingle:transports:ice-udp:1",function(e){t.add(e,"usertcpmux",n.attribute("usertcpmux"))})}},{}],520:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("./IntegrationTestHelper"),o=e("./vidyo_connector_api/VidyoConnector");!function(e){var t=function(){return function(e,t){return setTimeout(function(){t({state:"READY",description:"Native XMPP + WebRTC"})}),o.VidyoConnector}}();e.VidyoClient=t,e.IntegrationTestHelper=i}(r=n.VidyoClientLib||(n.VidyoClientLib={})),window.StartVidyoSimple=i.StartVidyoSimple,window.saveGlobalVidyoClient=i.SaveGlobalVidyoClient,window.VCState="READY",window.VidyoClientLib={VidyoClient:r.VidyoClient}},{"./IntegrationTestHelper":361,"./vidyo_connector_api/VidyoConnector":526}],521:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../core/events/EventDispatcher"),i=e("../core/events/RenderEvents"),o=e("./Templates"),a=e("../core/models/VideoResolution"),s=e("../core/utils/NotImplemented"),c=e("../core/utils/SizeObserver"),u=e("../core/utils/AudioAnalyser"),l=e("../core/utils/StringUtils"),d=e("async"),p=e("es6-promise"),f="aspectRatioTooHigh",h="aspectRatioTooWide",m=function(){function e(e){var t=this;this._streamPopups={},this._participantsAudios={},this._vidyoCore=e;window.addEventListener("beforeunload",function(){Object.keys(t._streamPopups).forEach(function(e){t._closeStreamPopup(e)})}),this._actionsQueue=d.queue(function(e,t){e().then(t).catch(t)})}return e.prototype.CreateView=function(e){var t=this;this._vidyoCore.EventDispatcher.releaseGroup(r.RenderListeners),this._vidyoCore.EventDispatcher.on(i.Events.SpeakerSelected,r.RenderListeners,function(e){return t._onSpeakerSelected(e)}),this._vidyoCore.EventDispatcher.on(i.Events.SpeakerPrivacyChanged,r.RenderListeners,function(e){return t._onSpeakerPrivacyChanged(e)}),this._vidyoCore.EventDispatcher.on(i.Events.VideoCropSettingsChanged,r.RenderListeners,function(e){return t._onVideoCropSettingsChanged(e)}),this._vidyoCore.EventDispatcher.on(i.Events.RecheckEachVideoSize,r.RenderListeners,function(){return t._onRecheckEachVideoSize()}),this._vidyoCore.EventDispatcher.on(i.Events.StatisticsUpdate,r.RenderListeners,function(){return t._onStatisticsUpdate()}),this._vidyoCore.EventDispatcher.on(i.Events.UpdateLocalViewLabel,r.RenderListeners,function(){return t._updateLocalViewLabel()}),this._onRecheckEachVideoSizeRef=this._onRecheckEachVideoSize.bind(this),this._expandPreviewRef=this._expandPreview.bind(this),this._parent=this._createParent(e),this._parent&&c.SizeObserver.Start(this._parent,function(){return t._onRecheckEachVideoSize()})},e.prototype.Destroy=function(){this._destroyAudioElements()},e.prototype._addVideoElement=function(e,t,n,r,i,o,a){var s=r.Id,c={name:n.name,updateGeneration:(n.updateGeneration||1/0).toString(),participantId:""+i,streamId:""+s,cellId:""+s,trackId:s+"-track",trackType:o?"local-track":"remote-track",displayCroppedText:n.displayCropped?"displayCropped":"",allowZoomText:n.allowZoom?"allowZoom":""},u=document.createElement("div");u.innerHTML=l.default.Format(e,c);var d=u.firstElementChild;if(d&&t){d.addEventListener("dblclick",this._expandPreviewRef);var p=a?"application-type":"video-type";d.classList.add(p),this._attachDragEventsToElement(d);var f=document.getElementById("vidyo-global-stats-overlay");if(f?t.insertBefore(d,f):t.appendChild(d),a){var h=d.querySelector(".video-placeholder");h&&h.classList.add("hide"),this._initApplicationPopup(t,d,r,n.name,i,s)}var m=document.getElementById(c.trackId);if(m){m.autoplay=!0;var v=r.GetMediaStream();m.srcObject=v,setTimeout(function(){m.load()},0),m.addEventListener("resize",this._onRecheckEachVideoSizeRef),navigator.userAgent.indexOf("iPhone")>=0&&navigator.userAgent.indexOf("Safari")>=0&&navigator.userAgent.indexOf("Chrome")<0&&m.setAttribute("playsinline","true"),m.classList.add("video-loading"),m.addEventListener("play",function(){m.classList.remove("video-loading")}),m.addEventListener("loadstart",function(){m.classList.add("video-loading")});var y=d.querySelector(".volume-indicator");if(y&&!a){var g=!1,S=void 0;if(o)S=v,g=this._vidyoCore.Controllers.DeviceController.GetAudioMuteState();else{var _=this._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantAudioStream(i);_&&(S=_.GetMediaStream());var b=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(i);b&&(g=b.AudioMuted())}S&&!g&&this._monitorTrackAudio(S,y)}}}return d},e.prototype._attachDragEventsToElement=function(e){var t,n,r,i=!1,o=0,a=0,s=function(){i=!1,t=void 0};e.addEventListener("mousedown",function(){e.closest(".application-grid")||(i=new p.Promise(function(t,i){(n=e.querySelector("video"))?setTimeout(function(){n&&setTimeout(function(){if(n)if(r=n.closest(".video-container")){var e=r.getBoundingClientRect(),s=e.height,c=e.width,u=n.getBoundingClientRect(),l=u.height,d=u.width;o=Math.abs((d-c)/2),a=Math.abs((l-s)/2),t()}else i("Failed to find parent container");else i("Failed to find video element")})}):i("Failed to find video element")}).then(function(){i=!0}))}),e.addEventListener("mouseleave",s),e.addEventListener("mouseup",s),e.addEventListener("mousemove",function(e){if(i){var r=function(){if(!t){if(!n)return;var r=parseInt(n.style.marginTop,10),i=isNaN(r)?0:r,s=parseInt(n.style.marginLeft,10),c=isNaN(s)?0:s;t={dragStartTop:e.clientY,dragStartLeft:e.clientX,elementTop:i,elementLeft:c}}var u=-1*(t.dragStartLeft-e.clientX)+t.elementLeft,l=-1*(t.dragStartTop-e.clientY)+t.elementTop;u=0===u?0:Math.abs(u)<o?u:u/Math.abs(u)*o,l=0===l?0:Math.abs(l)<a?l:l/Math.abs(l)*a,n&&(n.style.marginLeft=0===u?"":u.toString()+"px",n.style.marginTop=0===l?"":l.toString()+"px")};!0!==i&&i.then?i.then(r):r()}})},e.prototype._closeStreamPopup=function(e){this._streamPopups[e]&&(this._streamPopups[e].popup.onbeforeunload=function(){},this._streamPopups[e].popup.close(),delete this._streamPopups[e])},e.prototype._createParent=function(e){return s.NotImplemented()},e.prototype._destroyAudioElements=function(){var e=this;Object.keys(this._participantsAudios).forEach(function(t){delete e._participantsAudios[t]})},e.prototype._eachVideoElement=function(e){if(this._parent){var t=this._parent.querySelectorAll(".vidyo-rendering-container .video-container:not(.vidyo-fake)");Array.prototype.forEach.call(t,e)}},e.prototype._elementsApplicationForParticipant=function(e){var t=document.querySelectorAll(".vidyo-rendering-container .application-type.video-container[data-participant-id='"+e+"']");return Array.from(t)},e.prototype._elementsForParticipant=function(e){var t=document.querySelectorAll(".vidyo-rendering-container .video-container[data-participant-id='"+e+"']");return Array.from(t)},e.prototype._elementsVideoForParticipant=function(e){var t=document.querySelectorAll(".vidyo-rendering-container .video-type.video-container[data-participant-id='"+e+"']");return Array.from(t)},e.prototype._expandPreview=function(e){},e.prototype._getVideoMediaResolution=function(e){return{width:e.videoWidth,height:e.videoHeight}},e.prototype._monitorTrackAudio=function(e,t){var n=t.getContext("2d");n&&(n.fillStyle="green",u.AudioAnalyser.Monitor(e,function(e){if(n){n.clearRect(0,0,t.width,t.height);var r=e/130;n.fillRect(0,0,t.width*r,t.height)}}))},e.prototype._onRecheckEachVideoSize=function(){},e.prototype._onVideoCropSettingsChanged=function(e){var t=this,n=this._parent.querySelectorAll("[data-participant-id='"+e.Id+"']");Array.prototype.forEach.call(n,function(n){t._setAspectRatioClassToContainer(n,e)})},e.prototype._safelyRemoveAllMediaElement=function(e){this._safelyRemoveVideoElement(e),this._safelyRemoveApplicationElement(e)},e.prototype._safelyRemoveApplicationElement=function(e){var t=this;this._elementsApplicationForParticipant(e).forEach(function(e){t._removeVideoElements(e)});for(var n=0,r=Object.entries(this._streamPopups);n<r.length;n++){var i=r[n],o=i[0];i[1].participantId===e&&this._closeStreamPopup(o)}},e.prototype._safelyRemoveVideoElement=function(e){var t=this;u.AudioAnalyser.StopMonitoring(e),this._elementsVideoForParticipant(e).forEach(function(e){t._removeVideoElements(e)})},e.prototype._setAspectRatioClassToContainer=function(e,t){var n=e.querySelector("video");t.AspectRatio<1?(e.classList.contains(h)&&e.classList.remove(h),e.classList.contains(f)&&e.classList.remove(f),e.classList.contains("aspectRatioInversed")||e.classList.add("aspectRatioInversed")):t.AspectRatioRatioType===a.AspectRatioRatioType.Taller?(e.classList.contains("aspectRatioInversed")&&e.classList.remove("aspectRatioInversed"),e.classList.contains(h)&&e.classList.remove(h),e.classList.contains(f)||e.classList.add(f),n&&(n.style.marginLeft="")):(e.classList.contains("aspectRatioInversed")&&e.classList.remove("aspectRatioInversed"),e.classList.contains(f)&&e.classList.remove(f),e.classList.contains(h)||e.classList.add(h),n&&(n.style.marginTop=""))},e.prototype._setSinkId=function(e,t){return this._pushToAsyncQueue(function(){return e.setSinkId?e.setSinkId(t).catch(function(t){if(["AbortError: The operation could not be performed and was aborted"].indexOf(t.toString())<0)throw new Error("Failed to set speaker for "+e.id+". "+t)}):(e.sinkId=t,p.Promise.resolve(void 0))})},e.prototype._updateAudioStreams=function(){var e=this,t=this._vidyoCore.Controllers.ParticipantController.GetParticipants({Origin:"remote"}).map(function(e){return e.Id}),n=[];t.forEach(function(t){var r=e._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantAudioStream(t);r&&(n.push(r.Id),e._updateParticipantAudioStream(r))}),Object.keys(this._participantsAudios).forEach(function(t){-1===n.indexOf(t)&&delete e._participantsAudios[t]})},e.prototype._updateAudioStreamSource=function(e){this._updateParticipantAudioStream(e)},e.prototype._updateParticipantAudioStream=function(e){var t=this._participantsAudios[e.Id];t||((t=new Audio).id=e.Id,t.autoplay=!0,t.srcObject=e.GetMediaStream(),this._participantsAudios[e.Id]=t);var n=this._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Speaker,r=this._vidyoCore.Controllers.DeviceController.GetSpeakerMuteState();"boolean"!=typeof n&&n.Id?(t.muted=r,this._setSinkId(t,n.Id)):t.muted=!0,t.load()},e.prototype._containerHasAspectRatioClass=function(e){return[f,h].some(function(t){return e.classList.contains(t)})},e.prototype._createApplicationPopup=function(e,t,n,r){var i=this,a=window.open("","","width=1280,height=720,status=0,menubar=0,toolbar=0,location=0"),s=document.createElement("title");s.innerHTML=r,a.document.head.appendChild(s);var c=document.createElement("style");c.innerHTML=o.streamPopupStyle,a.document.head.appendChild(c);var u=document.createElement("video");u.autoplay=!0,u.muted=!0,a.document.body.appendChild(u);var l=document.createElement("img");l.src=o.dockSVGImage,a.document.body.appendChild(l);var d=document.createElement("span");d.className="name",d.innerHTML=r,a.document.body.appendChild(d),l.onclick=function(){a.close()},setTimeout(function(){u.srcObject=n.GetMediaStream()},0),e.removeChild(t);var p=function(){e.appendChild(t);var n=t.querySelector("video");n&&n.play(),i._onRecheckEachVideoSize()};return a.onbeforeunload=p,a.onpagehide=p,a},e.prototype._getElementAspectRatio=function(e){return e.clientWidth/e.clientHeight},e.prototype._initApplicationPopup=function(e,t,n,r,i,o){var a=this,s=t.querySelector(".popup-application");s&&(s.classList.remove("hide"),s.addEventListener("click",function(){var s=a._createApplicationPopup(e,t,n,r);a._onRecheckEachVideoSize(),a._streamPopups[o]={element:t,participantId:i,popup:s}}))},e.prototype._onSpeakerPrivacyChanged=function(e){var t=this,n=this._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Speaker;Object.keys(this._participantsAudios).forEach(function(r){var i=t._participantsAudios[r];!e&&"boolean"!=typeof n&&n.Id?(i.muted=!1,t._setSinkId(i,n.Id),i.load()):i.muted=!0})},e.prototype._onSpeakerSelected=function(e){var t=this,n=this._vidyoCore.Controllers.DeviceController.GetSpeakerMuteState();Object.keys(this._participantsAudios).forEach(function(r){var i=t._participantsAudios[r];e.speakerId?(i.muted=n,t._setSinkId(i,e.speakerId)):i.muted=!0})},e.prototype._onStatisticsUpdate=function(){var e=this,t=this._vidyoCore.Controllers.StatisticsController.GetCallStats(),n=[],r=this._vidyoCore.Controllers.AdvancedSettingsController.ShowStatisticsOverlay;t.ParticipantStatistics.All().forEach(function(t){var i=e._parent.querySelectorAll("[data-participant-id='"+t.Id+"'] .stats-overlay")[0];if(i){e._setElementVisible(i,r);var a=e._statisticsToFormattedHTML(t,["FillFromRemoteMicrophoneStatistics","FillFromRemoteVideoSourceStatistics"]);i.innerHTML=l.default.Format(o.statisticsBlock,{lines:a})}else{var s=t.AudioBytesReceived+" audio bytes",c=t.VideoPacketsReceived+" video packets";n.push(["Orphaned stream '"+t.Id+"'",s+", "+c])}});var i=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream,a=this._parent.querySelectorAll("[data-participant-id='"+i.Id+"'] .stats-overlay")[0];if(a)if(this._setElementVisible(a,r),r){var s=this._statisticsToFormattedHTML(t,["ParticipantStatistics","FillFromBandwidthSummaryStatistics","FillFromLocalMicrophoneStatistics","FillFromLocalVideoSourceStatistics","_activeParticipantsStatistics","_calculateStatisticsTotalBy"])+"\n"+this._statisticsToFormattedHTML(n);a.innerHTML=l.default.Format(o.statisticsBlock,{lines:s})}else a.innerHTML=""},e.prototype._pushToAsyncQueue=function(e){var t=this;return new p.Promise(function(n,r){t._actionsQueue.push(e,function(e){e?r(e):n()})})},e.prototype._removeVideoElement=function(e){e.removeEventListener("resize",this._onRecheckEachVideoSizeRef),e.pause&&(e.pause(),e.src="",e.load())},e.prototype._removeVideoElements=function(e){var t=this,n=e.parentElement;if(n){var r=e.getElementsByTagName("video");if(Array.prototype.forEach.call(r,function(e){t._removeVideoElement(e)}),e.classList.contains("vidyo-expanded")){var i=n.querySelector(".vidyo-fake");i&&n.removeChild(i)}e.removeEventListener("dblclick",this._expandPreviewRef),n.removeChild(e)}},e.prototype._setElementVisible=function(e,t){t?e.classList.remove("hide"):e.classList.add("hide")},e.prototype._statisticsToArray=function(e,t){void 0===t&&(t=[]);var n=[];for(var r in e)t.indexOf(r)<0&&n.push([r,e[r].toString()]);return n},e.prototype._statisticsToFormattedHTML=function(e,t){return void 0===t&&(t=[]),this._statisticsToArray(e,t).map(function(e){return l.default.Format(o.statisticsBlockLine,{statKey:e[0],statValue:e[1]})}).join("\n")},e.prototype._updateLocalViewLabel=function(){var e=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream,t=this._parent.querySelector("[data-stream-id='"+e.Id+"']"),n=this._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Camera,r="Preview";if("boolean"!=typeof n&&(r=n.PreviewLabel),t){var i=t.querySelector(".video-display-name");i&&(i.innerHTML=l.default.toSecureString(r))}},e}();n.RendererBase=m},{"../core/events/EventDispatcher":399,"../core/events/RenderEvents":404,"../core/models/VideoResolution":420,"../core/utils/AudioAnalyser":456,"../core/utils/NotImplemented":470,"../core/utils/SizeObserver":477,"../core/utils/StringUtils":479,"./Templates":523,async:2,"es6-promise":43}],522:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./composite/VidyoRenderer"),i=e("./custom/CustomVidyoRenderer"),o=e("../core/utils/Messages"),a=e("../core/models/RendererTypes"),s=e("./RendererBase");n.Type=s.RendererBase;var c=e("../core/utils/StringUtils"),u={};u[a.RenderMode.Composite]=r.VidyoRenderer,u[a.RenderMode.Custom]=i.CustomVidyoRenderer,n.CreateRenderer=function(e,t,n){if(n.Controllers.RendererController.RenderMode=e?a.RenderMode.Composite:a.RenderMode.Custom,u[n.Controllers.RendererController.RenderMode]){var r=new u[n.Controllers.RendererController.RenderMode](n);return r.CreateView(e),r}var i=new Error(c.default.Format(o.TheViewStyleViewStyleIsNotSupported,{viewStyle:t}));throw n.Controllers.LogController.LogError(i),i}},{"../core/models/RendererTypes":416,"../core/utils/Messages":468,"../core/utils/StringUtils":479,"./RendererBase":521,"./composite/VidyoRenderer":524,"./custom/CustomVidyoRenderer":525}],523:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.containerTemplate="<div class='vidyo-rendering-container'>\n  <style></style>\n  <div class='media-grid video-grid'></div>\n  <div class='media-grid application-grid'></div>\n </div>",n.dockSVGImage='data:image/svg+xml;utf8,\n  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n     viewBox="0 0 1000 1000" style="enable-background:new 0 0 1000 1000;" xml:space="preserve">\n  <filter id="shadow">\n    <feDropShadow stdDeviation="55"/>\n  </filter>\n  <style type="text/css">\n    .st0{fill:%23FFFFFF; filter:url(%23shadow);}\n  </style>\n  <path class="st0" d="M688.4,248.8H311.6c-34.6,0-62.8,28.2-62.8,62.8v376.8c0,34.6,28.2,62.8,62.8,62.8h376.8\n    c34.6,0,62.8-28.2,62.8-62.8V311.6C751.2,277,723,248.8,688.4,248.8z M311.6,688.4l94.2-125.6l63.8,85.1l93.3-116.5l125.6,157H311.6\n    L311.6,688.4z M820,100h-80H260h-80c-44,0-80,36-80,80v80v480v80c0,44,36,80,80,80h80h480h80c44,0,80-36,80-80v-80V260v-80\n    C900,136,864,100,820,100z M820,740v80h-80H260h-80v-80V260v-80h80h480h80v80V740z"/>\n  </svg>\n',n.undockSVGImage='data:image/svg+xml;utf8,\n  <svg version="1.1" id="Layer_3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n     viewBox="0 -75 1100 1075" style="enable-background:new 0 0 1100 1100;" xml:space="preserve">\n  <filter id="shadow">\n    <feDropShadow stdDeviation="55"/>\n  </filter>\n  <style type="text/css">\n    .st0{fill:%23FFFFFF; filter:url(%23shadow);}\n  </style>\n  <path class="st0" d="M820,686.2V820H180V180h133.8v-80H180c-44,0-80,36-80,80v640c0,44,36,80,80,80h640c44,0,80-36,80-80V686.2H820z\n     M937.2,25H560.4c-34.6,0-62.8,28.2-62.8,62.8v376.8c0,34.6,28.2,62.8,62.8,62.8h376.8c34.6,0,62.8-28.2,62.8-62.8V87.8\n    C1000,53.2,971.8,25,937.2,25z M560.4,464.6L654.6,339l63.8,85.1l93.3-116.5l125.6,157H560.4z"/>\n  </svg>\n',n.trackTemplate="<div\n  id='<%= cellId %>'\n  data-participant-id='<%= participantId %>'\n  data-stream-id='<%= streamId %>'\n  class='video-container <%= trackType %> <%= displayCroppedText %> <%= allowZoomText %>'>\n    <div class='video-display-name-wrapper'>\n      <span class='video-display-name' data-font-size='2em'><%= name %></span>\n      <canvas class='volume-indicator'></canvas>\n    </div>\n    <div class='stats-overlay hide'></div>\n    <div class=\"video-wrapper-container\">\n      <div class='video-wrapper'>\n        <video id='<%= trackId %>' autoplay muted>\n        </video>\n        <img class='video-placeholder' src='data:image/svg+xml;utf8,\n            <svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\n               viewBox=\"0 0 500 500\n               \" style=\"enable-background:new 0 0 500 500;\" xml:space=\"preserve\">\n            <style type=\"text/css\">\n              .st0{fill:%23C5DBDE;}\n            </style>\n            <path class=\"st0\" d=\"M349.5,150.8c0,55.1-44.7,99.8-99.8,99.8S150,205.8,150,150.8S194.7,51,249.8,51S349.5,95.7,349.5,150.8z\n               M405.6,337L405.6,337c-98-49-213.3-49.1-311.4-0.2l-0.4,0.2c-26.6,13.3-43.4,40.5-43.4,70.2V500H449v-92.8\n              C449,377.5,432.2,350.3,405.6,337z\"/>\n            </svg>\n          '></img>\n        <img src='"+n.undockSVGImage+"' class='popup-application hide' />\n      </div>\n    </div>\n </div>",n.customTrackTemplate="<div class='vidyo-rendering-container-custom'>\n  "+n.trackTemplate+"\n</div>",n.statisticsBlock="<ul class='statistics-list'>\n<%= lines %>\n</ul>\n",n.statisticsBlockLine="<li class='statistics-line'>\n  <span class='statistics-key'><%= statKey %></span>: <span class='statistics-value'><%= statValue %></span>\n</li>",n.compositeLayoutDefaultStyle="\n.media-grid {\n  grid-template-columns: 1fr, 1fr;\n  grid-template-rows: 1fr;\n}",n.compositeLayoutStyle="\n.media-grid<%= scope %> {\n  grid-template-columns: repeat(calc(<%= columns %> * 2), 1fr);\n  grid-template-rows: repeat(<%= rows %>, 1fr);\n}",n.compositeLayoutStyleSpaceBeforeVideo="\n.media-grid<%= scope %> .video-container:nth-of-type(<%= index %>) {\n  grid-column-start: 2;\n}",n.compositeLayoutGridSplitStyle=function(e,t){switch(e){case"VideoOnly":return'\n.vidyo-rendering-container {\n  grid-template-columns: 1fr;\n  grid-template-rows: 1fr;\n  grid-template-areas: "video";\n}';case"HorizontalSplit":return"\n.vidyo-rendering-container {\n  grid-template-columns: "+(t>1?"7fr 3fr;":"4fr 1fr;")+'\n  grid-template-rows: 1fr;\n  grid-template-areas: "application video";\n}';case"VerticalSplit":return'\n.vidyo-rendering-container {\n  grid-template-columns: 1fr;\n  grid-template-rows: 4fr 1fr;\n  grid-template-areas:\n    "application"\n    "video";\n}'}},n.streamPopupStyle="\nbody {\n  background-color: #000000;\n  margin: 0;\n  padding: 0;\n  position: relative;\n  font-family: 'robotolight', 'Open Sans', 'Helvetica', 'Arial', sans-serif;\n}\n\nvideo {\n  width: 100%;\n  height: 100%;\n}\n\nimg {\n  bottom: 60px;\n  left: 60px;\n  position: absolute;\n  width: 50px;\n  height: 50px;\n}\n\nspan.name {\n  justify-content: left;\n  position: absolute;\n  left: 0;\n  bottom: 0;\n  color: white;\n  background: black;\n  opacity: 0.25;\n  padding: 0 1em;\n  font-size: 2em;\n  width: 100%;\n  line-height: 1.5em;\n}\n"},{}],524:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../core/events/EventDispatcher"),a=e("../../core/utils/Messages"),s=e("../../core/events/RenderEvents"),c=e("../Templates"),u=e("../../core/models/Participant"),l=e("../RendererBase"),d=e("../../core/utils/AudioAnalyser"),p=e("../../core/utils/ObjectUtils"),f=e("../../core/utils/StringUtils"),h=e("../../core/models/VideoResolution"),m=e("../../core/events/ConnectionEvents"),v=e("../../core/utils/OperatingSystemInfoProvider"),y=function(){function e(){}return e.duration=500,e.position={bottom:"2%",left:"2%",right:"2%",top:"2%"},e}(),g=function(e){function t(t){var n=e.call(this,t)||this;return n._previewLoad=!1,n._streamCache={},n._viewLabel=!0,n._viewMeters=!0,n}return i(t,e),t.prototype.CreateView=function(t){var n=this;e.prototype.CreateView.call(this,t),this._vidyoCore.EventDispatcher.on(s.Events.Update,o.RenderListeners,function(e){return n._onUpdate(e)}),this._vidyoCore.EventDispatcher.on(s.Events.UpdateSource,o.RenderListeners,function(e){return n._updateStreamSource(e)}),this._vidyoCore.EventDispatcher.on(s.Events.GridLayoutChanged,o.RenderListeners,function(){return n._updateGridLayouts()}),this._vidyoCore.EventDispatcher.on(s.Events.UpdateCompositeRenderer,o.RenderListeners,function(e){return n._updateView(e)}),this._vidyoCore.EventDispatcher.on(m.Events.Connected,o.RenderListeners,function(){return n._connectionState=!0}),this._vidyoCore.EventDispatcher.on(m.Events.Disconnecting,o.RenderListeners,function(){return n._closePreviewExpansion()}),this._vidyoCore.EventDispatcher.on(s.Events.UpdateViewLabel,o.RenderListeners,function(e){return n._updateViewLabel(e)}),this._vidyoCore.EventDispatcher.on(s.Events.UpdateAudioMeters,o.RenderListeners,function(e){return n._updateAudioMeters(e)})},t.prototype.Destroy=function(){e.prototype.Destroy.call(this),this._removeAllElements()},t.prototype._createParent=function(e){if(e){var t=document.getElementById(e);if(t)return t}var n=new Error(f.default.Format(a.TheElementIdDoesntExist,{id:e}));throw this._vidyoCore.Controllers.LogController.LogError(n),n},t.prototype._expandPreview=function(e){var t=this;if(!this._expandLocked){var n=e.target.closest(".video-container");if(n){this._expandLocked=!0;var r=Promise.resolve(),i=n.classList.contains("vidyo-expanded-label"),o=i?n:this._parent.querySelector(".vidyo-expanded-label");o&&(r=r.then(function(){return t._minimizePreview(o,y.duration)})),!i&&this._connectionState&&(r=r.then(function(){return t._maximizePreview(n)})),r.then(function(){t._onRecheckEachVideoSize(),t._expandLocked=!1})}}},t.prototype._onRecheckEachVideoSize=function(){var e=this,t=new h.BasicVideoResolution;this._parent&&(t.Width=this._parent.clientWidth,t.Height=this._parent.clientHeight);var n=[];this._eachVideoElement(function(t){var r=new h.BasicVideoResolution(t.clientWidth,t.clientHeight),i=t.getElementsByTagName("video")[0],o=new h.VideoResolution(t.getAttribute("data-stream-id")||"");if(o.ContainerResolution=r,i){var a=e._getVideoMediaResolution(i);o.Width=a.width,o.Height=a.height}e._setAspectRatioClassToContainer(t,o),n.push(o)}),this._vidyoCore.Controllers.RendererController.UpdateVideoResolutions(t,n)},t.prototype._onUpdate=function(e){var t=this,n=this._vidyoCore.Controllers.ParticipantController.GetParticipants({Active:!0}),r=this._vidyoCore.Controllers.RendererController.ShowLocalPreview,i=n.map(function(e){return e.Id});e&&(i=p.default.Difference(i,e));var o=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream;if(o&&r&&i.push(o.Id),Array.prototype.forEach.call(document.querySelectorAll(".video-type.video-container"),function(e){var n=e.getAttribute("data-participant-id");n&&i.indexOf(n)<0&&(t._updateContainerState(),t._safelyRemoveVideoElement(n))}),n.forEach(function(e){var n=t._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantVideoStream(e.Id);n&&t._addStream(n,e.Id,e.Name,!1)}),o&&r){var a=this._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Camera,s="Preview";"boolean"!=typeof a&&(s=a.PreviewLabel),this._addStream(o,o.Id,s,!0)}this._updateApplicationsStreams(),this._updateContainerState(),this._updateAudioStreams(),this._onRecheckEachVideoSize()},t.prototype._addStream=function(e,t,n,r){var i=this._getOrCreateContainer(),o={name:n,displayCropped:!0,allowZoom:!0};if(this._updateContainerState(),!(this._elementsVideoForParticipant(t).length>0)){var a=i.querySelector(".video-grid");this._addVideoElement(c.trackTemplate,a,o,e,t,r,!1),this._updateViewLabel({showLabel:this._viewLabel}),this._updateAudioMeters({showMeters:this._viewMeters})}this._updateParticipantApplications(t,r)},t.prototype._closePreviewExpansion=function(){this._connectionState=!1;var e=this._parent.querySelector(".vidyo-expanded-label");e&&this._minimizePreview(e),this._destroyAudioElements()},t.prototype._fitParticipantNames=function(e){Array.prototype.forEach.call(e.querySelectorAll(".media-grid span.video-display-name"),function(e){e.style.fontSize=e.getAttribute("data-font-size");for(var t,n;e.scrollWidth>e.offsetWidth;)t=void 0,n=void 0,t=window.getComputedStyle(e).getPropertyValue("font-size"),n=parseInt(t,10)-1+"px",e.style.fontSize=n})},t.prototype._getElementPosition=function(e){var t=this._getOrCreateContainer();return{top:e.offsetTop+"px",left:e.offsetLeft+"px",bottom:t.offsetHeight-e.offsetTop-e.clientHeight+"px",right:t.offsetWidth-e.offsetLeft-e.clientWidth+1+"px"}},t.prototype._getOrCreateContainer=function(){var e=this._parent.querySelector(".vidyo-rendering-container");if(!(e||(this._parent.innerHTML=c.containerTemplate,e=this._parent.querySelector(".vidyo-rendering-container")))){var t=new Error(f.default.Format(a.TheElementIdDoesntExist,{id:"vidyo-rendering-container"}));throw this._vidyoCore.Controllers.LogController.LogError(t),t}return this._updateGridLayouts(),e},t.prototype._maximizePreview=function(e){var t=this;return e.parentElement?new Promise(function(n,r){var i=document.createElement("div");i.className=e.className,i.classList.add("vidyo-fake"),t._setElementPosition(e,t._getElementPosition(e)),e.offsetHeight,e.classList.add("vidyo-expanded-label","vidyo-expanded"),e.parentElement&&e.parentElement.insertBefore(i,e),t._setElementPosition(e,y.position),setTimeout(function(){return n()},y.duration)}):Promise.resolve()},t.prototype._minimizePreview=function(e,t){if(void 0===t&&(t=0),!e.parentElement)return Promise.resolve();e.classList.remove("vidyo-expanded-label");var n=this._parent.querySelector(".vidyo-fake");t&&this._setElementPosition(e,this._getElementPosition(n));var r=e.getElementsByTagName("video")[0];return r.style.marginLeft="0",r.style.marginTop="0",new Promise(function(r,i){setTimeout(function(){n.parentElement&&n.parentElement.removeChild(n),e.classList.remove("vidyo-expanded"),Object.keys(y.position).forEach(function(t){return e.style[t]=""}),r()},t)})},t.prototype._removeAllElements=function(){var e=this;if(this._parent){var t=this._parent.querySelectorAll(".video-container");for(Array.prototype.forEach.call(t,function(t){var n=t.getAttribute("data-participant-id");n&&e._safelyRemoveAllMediaElement(n)});this._parent.lastChild;)this._parent.removeChild(this._parent.lastChild)}},t.prototype._setElementPosition=function(e,t){Object.keys(t).forEach(function(n){return e.style[n]=t[n]})},t.prototype._updateApplicationsStreams=function(){var e=this,t=this._vidyoCore.Controllers.ParticipantController.GetParticipants({Origin:u.ParticipantOrigin.Remote}),n=t.map(function(e){return e.Id});if(Array.prototype.forEach.call(document.querySelectorAll(".application-type.video-container"),function(t){var r=t.getAttribute("data-participant-id"),i=t.classList.contains("local-track")&&e._vidyoCore.Controllers.RendererController.ShowLocalSharePreview;r&&n.indexOf(r)<0&&!i&&e._safelyRemoveApplicationElement(r)}),t.forEach(function(t){e._updateParticipantApplications(t.Id,!1)}),this._vidyoCore.Controllers.RendererController.ShowLocalSharePreview){var r=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream.Id;this._updateParticipantApplications(r,!0)}},t.prototype._updateAudioMeters=function(e){var t=this,n=document.querySelectorAll(".volume-indicator");this._viewMeters=e.showMeters,Array.from(n).forEach(function(e){return e.hidden=!t._viewMeters})},t.prototype._updateContainerState=function(){this._getOrCreateContainer()},t.prototype._updateGridLayouts=function(){var e=this._parent.querySelector(".vidyo-rendering-container");if(e){var t="",n=this._vidyoCore.Controllers.RendererController.VideoGridLayout,r=".video-grid";t+=f.default.Format(c.compositeLayoutStyle,{scope:r,columns:n.Columns,rows:n.Rows}),n.SpaceBefore.forEach(function(e){t+=f.default.Format(c.compositeLayoutStyleSpaceBeforeVideo,{index:e,scope:r})});var i=this._vidyoCore.Controllers.RendererController.ApplicationGridLayout,o=i.Cells>0,a="VideoOnly";o&&(a="horizontal"===this._vidyoCore.Controllers.RendererController.MediaGridSplit?"HorizontalSplit":"VerticalSplit",r=".application-grid",t+=f.default.Format(c.compositeLayoutStyle,{scope:r,columns:i.Columns,rows:i.Rows}),i.SpaceBefore.forEach(function(e){t+=f.default.Format(c.compositeLayoutStyleSpaceBeforeVideo,{index:e,scope:r})})),t+=c.compositeLayoutGridSplitStyle(a,n.Columns);var s=e.querySelector("style");if(!s)throw new Error("Failed to find style element in rendering container, cannot update grid layout");s.innerHTML=t;var u=e.querySelector(".video-grid");if(!u)throw new Error("Failed to find video grid in rendering container, cannot update picture-in-picture settings");u.classList.toggle("picture-in-picture",!o&&2===n.Cells),Array.prototype.forEach.call(e.querySelectorAll(".media-grid video"),function(e){e.style.marginLeft="",e.style.marginTop=""}),this._fitParticipantNames(e)}},t.prototype._updateParticipantApplications=function(e,t){var n=this,r=[],i="";if(t)r=this._vidyoCore.Controllers.RendererController.ShowLocalSharePreview?this._vidyoCore.Controllers.LocalStreamController.GetApplicationStreams():[],i="Preview share";else{var o=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e);o&&(r=this._vidyoCore.Controllers.RemoteStreamController.GetParticipantApplicationStreams(e),i=o.Name)}var a=this._getOrCreateContainer().querySelector(".application-grid");if(a){for(var s={name:i,displayCropped:!0,allowZoom:!0},u=r.map(function(e){return e.Id}),l=a.querySelectorAll(".vidyo-rendering-container .video-container[data-participant-id='"+e+"']"),d=l.length-1;d>=0;--d){var p=l[d];if(-1===u.indexOf(p.getAttribute("data-stream-id"))){var f=p.parentElement;if(f){if(p.classList.contains("vidyo-expanded")){var h=f.querySelector(".vidyo-fake");h&&f.removeChild(h)}f.removeChild(p)}}}for(var m=0,v=Object.entries(this._streamPopups);m<v.length;m++){var y=v[m],g=y[0];y[1].participantId===e&&-1===u.indexOf(g)&&this._closeStreamPopup(g)}r.forEach(function(r){document.querySelector(".vidyo-rendering-container .video-container[data-stream-id='"+r.Id+"']")||n._streamPopups[r.Id]||n._addVideoElement(c.trackTemplate,a,s,r,e,t,!0)})}},t.prototype._updateStreamSource=function(e){this._updateContainerState();var t=this._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantVideoStream(e),n=this._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantAudioStream(e),r=!1;if(!t){var i=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream;i&&(r=!0,n=t=i)}var o,a=!1,s=!1;if(r||(o=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e))&&(a=o.HasVideoSource(),s=!o.AudioMuted()),t){var c=a||r&&t.GetVideoTracks().length&&t.GetVideoTracks()[0].IsActive(),u=s||!(!(r&&n&&n.GetAudioTracks().length&&n.GetAudioTracks()[0].IsActive())||this._vidyoCore.Controllers.DeviceController.GetAudioMuteState()),l=this._parent.querySelector("[data-stream-id='"+t.Id+"']");if(l){var p=l.querySelector("video");if(p){t.GetMediaStream();if((r&&v.OperatingSystemInfoProvider.IsElectron()||v.OperatingSystemInfoProvider.IsSafari())&&(this._previewLoad!==u?this._previewLoad=u:p.load()),l.classList.toggle("audio-muted",!u),l.classList.toggle("video-muted",!c),n)if(u){d.AudioAnalyser.StopMonitoring(n.Id);var f=l.getElementsByClassName("volume-indicator")[0];f&&this._monitorTrackAudio(n.GetMediaStream(),f)}else d.AudioAnalyser.StopMonitoring(n.Id)}}if(r||o&&o.IsRemote){var h=r?t.Id:e;this._updateParticipantApplications(h,r)}this._updateGridLayouts(),this._onRecheckEachVideoSize(),!r&&n&&this._updateAudioStreamSource(n)}},t.prototype._updateView=function(e){document.getElementById(e.viewId)&&(this._removeAllElements(),this.CreateView(e.viewId),this._onUpdate(void 0))},t.prototype._updateViewLabel=function(e){var t=this,n=document.querySelectorAll(".video-display-name");this._viewLabel=e.showLabel,Array.from(n).forEach(function(e){return e.hidden=!t._viewLabel})},t}(l.RendererBase);n.VidyoRenderer=g},{"../../core/events/ConnectionEvents":397,"../../core/events/EventDispatcher":399,"../../core/events/RenderEvents":404,"../../core/models/Participant":413,"../../core/models/VideoResolution":420,"../../core/utils/AudioAnalyser":456,"../../core/utils/Messages":468,"../../core/utils/ObjectUtils":471,"../../core/utils/OperatingSystemInfoProvider":472,"../../core/utils/StringUtils":479,"../RendererBase":521,"../Templates":523}],525:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../core/events/EventDispatcher"),a=e("../../core/utils/Messages"),s=e("../../core/events/RenderEvents"),c=e("../RendererBase"),u=e("../Templates"),l=e("../../core/utils/ObjectUtils"),d=e("../../core/utils/StringUtils"),p=e("../../core/utils/AudioAnalyser"),f=e("../../core/utils/OperatingSystemInfoProvider"),h=function(e){function t(t){var n=e.call(this,t)||this;return n._previewLoad=!1,n}return i(t,e),t.prototype.CreateView=function(t){var n=this;e.prototype.CreateView.call(this,t),this._vidyoCore.EventDispatcher.on(s.Events.Update,o.RenderListeners,function(e){return n._onUpdate(e)}),this._vidyoCore.EventDispatcher.on(s.Events.Hide,o.RenderListeners,function(e){return n._onHide(e)}),this._vidyoCore.EventDispatcher.on(s.Events.UpdateSource,o.RenderListeners,function(e){return n._updateStreamSource(e)}),this._vidyoCore.EventDispatcher.on(s.Events.UpdateViewLabel,o.RenderListeners,function(e){return n._updateViewLabel(e)}),this._vidyoCore.EventDispatcher.on(s.Events.UpdateAudioMeters,o.RenderListeners,function(e){return n._updateAudioMeters(e)})},t.prototype.Destroy=function(){var e=this;Object.keys(this._vidyoCore.Controllers.RendererController.Views).reverse().forEach(function(t){e._vidyoCore.Controllers.RendererController.HideView({viewId:t})})},t.prototype._createParent=function(){return document.body},t.prototype._onHide=function(e){this._hideView(e.viewId)},t.prototype._onUpdate=function(e){var t=this,n=this._vidyoCore.Controllers.RendererController.Views,r=l.default.MapObject(n,function(e){return e.streamId});for(var i in e&&(r=l.default.Difference(r,e)),Object.values(n).filter(function(e){return!r.includes(e.streamId)}).forEach(function(e){t._hideView(e.viewId)}),n)if(n.hasOwnProperty(i)){var o=n[i];this._updateView(o)}this._updateAudioStreams()},t.prototype._findElementById=function(e){var t=document.getElementById(e);if(!t){var n=d.default.Format(a.TheElementIdDoesntExist,{id:e});this._vidyoCore.Controllers.LogController.LogWarning(n)}return t},t.prototype._hideView=function(e){var t=this,n=this._findElementById(e);if(n){var r=n.querySelectorAll(".video-container");for(Array.prototype.forEach.call(r,function(e){var n=e.getAttribute("data-participant-id");n&&t._safelyRemoveVideoElement(n)});n.lastChild;)n.removeChild(n.lastChild)}},t.prototype._updateAudioMeters=function(e){var t=document.querySelector("#"+e.viewId+" .volume-indicator");t&&(t.hidden=!e.showMeters)},t.prototype._updateStreamSource=function(e){var t=this._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantVideoStream(e),n=this._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantAudioStream(e),r=!1;if(!t){var i=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream;i&&(r=!0,n=t=i)}var o,a=!1;if(r||(o=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e))&&(a=!o.AudioMuted()),t){var s=a||!(!(r&&n&&n.GetAudioTracks().length&&n.GetAudioTracks()[0].IsActive())||this._vidyoCore.Controllers.DeviceController.GetAudioMuteState()),c=this._parent.querySelector("[data-stream-id='"+t.Id+"']");if(c){var u=c.querySelector("video");if(u){t.GetMediaStream();if((r&&f.OperatingSystemInfoProvider.IsElectron()||f.OperatingSystemInfoProvider.IsSafari())&&(this._previewLoad!==s?this._previewLoad=s:u.load()),n)if(s){p.AudioAnalyser.StopMonitoring(n.Id);var l=c.getElementsByClassName("volume-indicator")[0];l&&this._monitorTrackAudio(n.GetMediaStream(),l)}else p.AudioAnalyser.StopMonitoring(n.Id)}}!r&&n&&this._updateAudioStreamSource(n)}},t.prototype._updateView=function(e){var t,n=this._findElementById(e.viewId);t=e.isLocal?e.isApplication?this._vidyoCore.Controllers.LocalStreamController.GetApplicationStreamById(e.streamId):this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream:this._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantStream(e.streamId);var r=e.label;if(t){var i={name:r,displayCropped:e.displayCropped,allowZoom:e.allowZoom},o=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e.participantId);if(!!!document.querySelector(".vidyo-rendering-container-custom .video-container[data-stream-id='"+t.Id+"']")&&(e.isLocal||o&&o.IsRemote)){var a=o&&o.Id||t.Id;this._addVideoElement(u.customTrackTemplate,n,i,t,a,e.isLocal,e.isApplication)}}},t.prototype._updateViewLabel=function(e){var t=document.querySelector("#"+e.viewId+" .video-display-name");t&&(t.hidden=!e.showLabel)},t}(c.RendererBase);n.CustomVidyoRenderer=h},{"../../core/events/EventDispatcher":399,"../../core/events/RenderEvents":404,"../../core/utils/AudioAnalyser":456,"../../core/utils/Messages":468,"../../core/utils/ObjectUtils":471,"../../core/utils/OperatingSystemInfoProvider":472,"../../core/utils/StringUtils":479,"../RendererBase":521,"../Templates":523}],526:[function(e,t,n){(function(t){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var i,o,a,s=e("../vidyo_simple_api/VidyoSimple"),c=e("../core/utils/AssignHiddenPropertyValue"),u=e("../core/utils/PromiseHelper"),l=e("es6-promise"),d=e("uuid"),p=e("../core/utils/Constants"),f=e("../core/events/ConnectionEvents"),h=e("../core/utils/VidyoDebugger"),m=e("../core/utils/StringUtils"),v=e("../core/utils/Messages"),y=e("../core/utils/UserMediaProvider"),g=e("../core/utils/LocationProvider"),S=e("../core/models/APITypes"),_=e("../core/utils/JSValidation"),b=function(){};!function(e){e.Idle="VIDYO_CONNECTORSTATE_Idle",e.Ready="VIDYO_CONNECTORSTATE_Ready",e.EstablishingConnection="VIDYO_CONNECTORSTATE_EstablishingConnection",e.FindingResource="VIDYO_CONNECTORSTATE_FindingResource",e.ConnectingToResource="VIDYO_CONNECTORSTATE_ConnectingToResource",e.EnablingMedia="VIDYO_CONNECTORSTATE_EnablingMedia",e.Disconecting="VIDYO_CONNECTORSTATE_Disconecting",e.Connected="VIDYO_CONNECTORSTATE_Connected"}(i=n.VidyoConnectorState||(n.VidyoConnectorState={})),function(e){e.Disconnected="VIDYO_CONNECTORDISCONNECTREASON_Disconnected",e.ConnectionLost="VIDYO_CONNECTORDISCONNECTREASON_ConnectionLost",e.ConnectionTimeout="VIDYO_CONNECTORDISCONNECTREASON_ConnectionTimeout",e.NoResponse="VIDYO_CONNECTORDISCONNECTREASON_NoResponse",e.Terminated="VIDYO_CONNECTORDISCONNECTREASON_Terminated",e.MiscLocalError="VIDYO_CONNECTORDISCONNECTREASON_MiscLocalError",e.MiscRemoteError="VIDYO_CONNECTORDISCONNECTREASON_MiscRemoteError",e.MiscError="VIDYO_CONNECTORDISCONNECTREASON_MiscError"}(o=n.VidyoConnectorDisconnectReason||(n.VidyoConnectorDisconnectReason={})),function(e){e.ConnectionFailed="VIDYO_CONNECTORFAILREASON_ConnectionFailed",e.ConnectionLost="VIDYO_CONNECTORFAILREASON_ConnectionLost",e.ConnectionTimeout="VIDYO_CONNECTORFAILREASON_ConnectionTimeout",e.NoResponse="VIDYO_CONNECTORFAILREASON_NoResponse",e.Terminated="VIDYO_CONNECTORFAILREASON_Terminated",e.InvalidToken="VIDYO_CONNECTORFAILREASON_InvalidToken",e.InvalidDisplayNameLength="VIDYO_CONNECTORFAILREASON_InvalidDisplayNameLength",e.UnableToCreateResource="VIDYO_CONNECTORFAILREASON_UnableToCreateResource",e.NoResponseFromResource="VIDYO_CONNECTORFAILREASON_NoResponseFromResource",e.InvalidResourceId="VIDYO_CONNECTORFAILREASON_InvalidResourceId",e.ResourceFull="VIDYO_CONNECTORFAILREASON_ResourceFull",e.NotMember="VIDYO_CONNECTORFAILREASON_NotMember",e.Banned="VIDYO_CONNECTORFAILREASON_Banned",e.MediaNotEnabled="VIDYO_CONNECTORFAILREASON_MediaNotEnabled",e.MediaFailed="VIDYO_CONNECTORFAILREASON_MediaFailed",e.MiscLocalError="VIDYO_CONNECTORFAILREASON_MiscLocalError",e.MiscRemoteError="VIDYO_CONNECTORFAILREASON_MiscRemoteError",e.MiscError="VIDYO_CONNECTORFAILREASON_MiscError"}(a=n.VidyoConnectorFailReason||(n.VidyoConnectorFailReason={}));var C=function(){return function(){this.AbortLogin=null,this.State=i.Idle,this.VidyoParticipantCallbacks={}}}(),w=function(){var e,n=e=function(){this.objType="VidyoConnector",c.AssignHiddenPropertyValue(this,"_hidden",new C),this._hidden.VidyoSimple=new s.VidyoSimple,this.objId=d.v4(),h.VidyoDebugger.Debug(this,S.API.VidyoConnector,t)};return n.prototype.AssignViewToCompositeRenderer=function(e){return this._hidden.VidyoEndpoint.AssignViewToCompositeRenderer(e)},n.prototype.AssignViewToLocalCamera=function(e){return this._hidden.VidyoEndpoint.AssignViewToLocalCamera(e),l.Promise.resolve(!0)},n.prototype.AssignViewToLocalMonitor=function(e){return this._hidden.VidyoEndpoint.AssignViewToLocalMonitor(e),l.Promise.resolve(!0)},n.prototype.AssignViewToLocalWindowShare=function(e){return this._hidden.VidyoEndpoint.AssignViewToLocalWindowShare(e),l.Promise.resolve(!0)},n.prototype.AssignViewToRemoteCamera=function(e){return this._hidden.VidyoEndpoint.AssignViewToRemoteCamera(e),l.Promise.resolve(!0)},n.prototype.AssignViewToRemoteWindowShare=function(e){return this._hidden.VidyoEndpoint.AssignViewToRemoteWindowShare(e),l.Promise.resolve(!0)},n.prototype.Connect=function(e){var t=this,n=e.host,r=e.token,s=e.displayName,c=e.resourceId,d=e.onSuccess,p=e.onFailure,h=e.onDisconnected;if(this._hidden.State!==i.Ready)return l.Promise.reject(new Error(m.default.Format(v.ErrorWhileConnecting,{state:this._hidden.State})));this._hidden.VidyoUser.SetDisplayName({displayName:s});var y=u.MakePromiseWithCallback(),g=y.promise,S=y.resolve,_=y.reject;this._hidden.AbortLogin=_;var C=u.MakePromiseWithCallback(),w=C.promise,E=C.resolve;this._hidden.DisconnectionPromise=w,this._hidden.DisconnectionPromise.then(function(e){t._changeState(i.Ready),e&&e!==f.ConnectionEventsInfo.MediaSessionEnded&&e!==f.ConnectionEventsInfo.Disconnected?p(e.reasonCode):h(e.reasonCode)});var R=u.MakePromiseWithCallback(),P=R.promise,L=R.resolve,T=u.MakePromiseWithCallback(),x=T.promise,M=T.resolve,A=u.MakePromiseWithCallback(),I=A.promise,O=A.resolve;return this._changeState(i.EstablishingConnection),this._hidden.VidyoUser.LoginWithTenantToken(r,n,void 0,void 0,S,E,function(){},function(){},function(){}).then(function(){return g}).then(function(){return t._changeState(i.FindingResource),t._hidden.VidyoUser.CreateRoomFromId(c,r,L).then(function(){return P})}).then(function(e){return t._hidden.VidyoRoom=e,t._changeState(i.ConnectingToResource),e.Enter(M,function(){}).then(function(){return x})}).then(function(){return t._hidden.VidyoRoom.RegisterParticipantEventListener(t._hidden.VidyoParticipantCallbacks.onJoined||b,t._hidden.VidyoParticipantCallbacks.onLeft||b,t._hidden.VidyoParticipantCallbacks.onDynamicChanged||b,t._hidden.VidyoParticipantCallbacks.onLoudestChanged||b),t._hidden.VidyoMessagesCallbacks&&t._hidden.VidyoRoom.RegisterMessageEventListener({onMessageAcknowledged:function(){},onMessageRead:function(){},onMessageReceived:t._hidden.VidyoMessagesCallbacks.onChatMessageReceived,onMessageTypingIndication:function(){}}),t._changeState(i.EnablingMedia),t._hidden.VidyoRoom.EnableMedia(O,p,function(){}).then(function(){return I})}).then(function(){return t._hidden.AbortLogin=null,t._changeState(i.Connected),d(),!0}).catch(function(e){var n=e===o.Terminated||e===a.InvalidDisplayNameLength?e:o.MiscError;return t._changeState(i.Ready),p(n),!1})},n.prototype.CycleCamera=function(){return this._hidden.VidyoEndpoint.CycleCamera(),l.Promise.resolve(!0)},n.prototype.CycleMicrophone=function(){return this._hidden.VidyoEndpoint.CycleMicrophone(),l.Promise.resolve(!0)},n.prototype.CycleSpeaker=function(){return this._hidden.VidyoEndpoint.CycleSpeaker(),l.Promise.resolve(!0)},n.prototype.Destruct=function(){return this.Disable()},n.prototype.Disable=function(){return this._hidden.VidyoSimple.Disable()},n.prototype.Disconnect=function(){if(this._hidden.State!==i.Connected){if(!this._hidden.AbortLogin)return l.Promise.reject(void 0);this._hidden.AbortLogin(o.Terminated),this._hidden.AbortLogin=null}return this._changeState(i.Disconecting),this._hidden.VidyoUser.Logout(),this._hidden.DisconnectionPromise},n.prototype.EnableDebug=function(e){return this._hidden.VidyoEndpoint.EnableDebug(e)},n.prototype.GetState=function(){return l.Promise.resolve(this._hidden.State)},n.prototype.GetStatsJson=function(){return this._hidden.VidyoEndpoint.GetStatsJson()},n.prototype.GetVersion=function(){return l.Promise.resolve(p.LibVersion+"."+p.LibBuild)},n.prototype.GetVersionWithoutBuildNumber=function(){return l.Promise.resolve(p.LibVersion)},n.prototype.HideView=function(e){return this._hidden.VidyoEndpoint.HideView(e),l.Promise.resolve(!0)},n.prototype.RegisterLocalCameraEventListener=function(e){return this._hidden.VidyoEndpoint.RegisterLocalCameraEventListener(e)},n.prototype.RegisterLocalMicrophoneEnergyListener=function(e){return this._hidden.VidyoEndpoint.RegisterLocalMicrophoneEnergyListener(e)},n.prototype.RegisterLocalMicrophoneEventListener=function(e){return this._hidden.VidyoEndpoint.RegisterLocalMicrophoneEventListener(e)},n.prototype.RegisterLocalMonitorEventListener=function(e){return this._hidden.VidyoEndpoint.RegisterLocalMonitorEventListener(e)},n.prototype.RegisterLocalSpeakerEventListener=function(e){return this._hidden.VidyoEndpoint.RegisterLocalSpeakerEventListener(e)},n.prototype.RegisterLocalWindowShareEventListener=function(e){return this._hidden.VidyoEndpoint.RegisterLocalWindowShareEventListener(e)},n.prototype.RegisterMessageEventListener=function(e){return this._hidden.VidyoMessagesCallbacks=e,this._hidden.VidyoRoom&&this._hidden.VidyoRoom.RegisterMessageEventListener({onMessageAcknowledged:function(){},onMessageRead:function(){},onMessageReceived:e.onChatMessageReceived,onMessageTypingIndication:function(){}}),l.Promise.resolve(!0)},n.prototype.RegisterLogEventListener=function(e){return this._hidden.VidyoEndpoint.RegisterLogEventListener(e)},n.prototype.RegisterParticipantEventListener=function(e){var t=l.Promise.resolve(!0);return this._hidden.VidyoParticipantCallbacks=e,this._hidden.VidyoRoom&&(t=this._hidden.VidyoRoom.RegisterParticipantEventListener(this._hidden.VidyoParticipantCallbacks.onJoined||b,this._hidden.VidyoParticipantCallbacks.onLeft||b,this._hidden.VidyoParticipantCallbacks.onDynamicChanged||b,this._hidden.VidyoParticipantCallbacks.onLoudestChanged||b)),t},n.prototype.RegisterPermissionEventListener=function(e){return this._hidden.VidyoPermission.RegisterPermissionEventListener(e)},n.prototype.RegisterRemoteCameraEventListener=function(e){return this._hidden.VidyoEndpoint.RegisterRemoteCameraEventListener(e)},n.prototype.RegisterRemoteMicrophoneEnergyListener=function(e){return this._hidden.VidyoEndpoint.RegisterRemoteMicrophoneEnergyListener(e)},n.prototype.RegisterRemoteMicrophoneEventListener=function(e){return this._hidden.VidyoEndpoint.RegisterRemoteMicrophoneEventListener(e)},n.prototype.RegisterRemoteWindowShareEventListener=function(e){return this._hidden.VidyoEndpoint.RegisterRemoteWindowShareEventListener(e)},n.prototype.RegisterResourceManagerEventListener=function(e){return this._hidden.VidyoEndpoint.RegisterResourceManagerEventListener(e)},n.prototype.ReportLocalParticipantOnJoined=function(e){return this._hidden.VidyoEndpoint.ReportLocalParticipantOnJoined(e),l.Promise.resolve(!0)},n.prototype.SelectAudioContentShare=function(e){return this._hidden.VidyoEndpoint.SelectAudioContentShare(e)},n.prototype.SelectDefaultCamera=function(){return this._hidden.VidyoEndpoint.SelectDefaultCamera(),l.Promise.resolve(!0)},n.prototype.SelectDefaultMicrophone=function(){return this._hidden.VidyoEndpoint.SelectDefaultMicrophone(),l.Promise.resolve(!0)},n.prototype.SelectDefaultSpeaker=function(){return this._hidden.VidyoEndpoint.SelectDefaultSpeaker(),l.Promise.resolve(!0)},n.prototype.SelectLocalCamera=function(e){var t=e.localCamera;return this._hidden.VidyoEndpoint.SelectCamera({camera:t}),l.Promise.resolve(!0)},n.prototype.SelectLocalMicrophone=function(e){var t=e.localMicrophone;return this._hidden.VidyoEndpoint.SelectMicrophone({microphone:t}),l.Promise.resolve(!0)},n.prototype.SelectLocalMonitor=function(e){return this._hidden.VidyoEndpoint.SelectLocalMonitor(e)},n.prototype.SelectLocalSpeaker=function(e){var t=e.localSpeaker;return this._hidden.VidyoEndpoint.SelectSpeaker({speaker:t}),l.Promise.resolve(!0)},n.prototype.SelectLocalWindowShare=function(e){return this._hidden.VidyoEndpoint.SelectLocalWindowShare(e)},n.prototype.SelectVideoContentShare=function(e){return this._hidden.VidyoEndpoint.SelectVideoContentShare(e)},n.prototype.SendChatMessage=function(e){return this._hidden.VidyoRoom?this._hidden.VidyoRoom.SendMessage(e):l.Promise.resolve(!1)},n.prototype.SetAdvancedConfiguration=function(e){this._hidden.VidyoEndpoint.SetAdvancedConfiguration(e)},n.prototype.SetCameraPrivacy=function(e){return this._hidden.VidyoEndpoint.SetCameraPrivacy(e)},n.prototype.SetConsoleLoggerFilter=function(e){this._hidden.VidyoEndpoint.SetConsoleLoggerFilter(e)},n.prototype.SetFileLoggerFilter=function(e){this._hidden.VidyoEndpoint.SetFileLoggerFilter(e)},n.prototype.SetLocation=function(e){return this._hidden.VidyoEndpoint.SetLocation(e)},n.prototype.SetMaxBitRate=function(e){return this._hidden.VidyoEndpoint.SetMaxBitRate(e)},n.prototype.SetMicrophonePrivacy=function(e){return this._hidden.VidyoEndpoint.SetMicrophonePrivacy(e)},n.prototype.SetPool=function(e){return this._hidden.VidyoEndpoint.SetPool(e)},n.prototype.SetSpeakerPrivacy=function(e){return this._hidden.VidyoEndpoint.SetSpeakerPrivacy(e)},n.prototype.ShowAudioMeters=function(e){return this._hidden.VidyoEndpoint.ShowAudioMeters(e)},n.prototype.ShowPreview=function(e){return this._hidden.VidyoEndpoint.ShowPreview(e)},n.prototype.ShowViewAt=function(e){return this._hidden.VidyoEndpoint.ShowViewAt(e)},n.prototype.ShowViewLabel=function(e){return this._hidden.VidyoEndpoint.ShowViewLabel(e)},n.prototype.ShowWindowSharePreview=function(e){return this._hidden.VidyoEndpoint.ShowWindowSharePreview(e),l.Promise.resolve(!0)},n.prototype.UnregisterLocalCameraEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterLocalCameraEventListener()},n.prototype.UnregisterLocalMicrophoneEnergyListener=function(){return this._hidden.VidyoEndpoint.UnregisterLocalMicrophoneEnergyListener()},n.prototype.UnregisterLocalMicrophoneEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterLocalMicrophoneEventListener()},n.prototype.UnregisterLocalMonitorEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterLocalMonitorEventListener()},n.prototype.UnregisterLocalSpeakerEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterLocalSpeakerEventListener()},n.prototype.UnregisterLocalWindowShareEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterLocalWindowShareEventListener()},n.prototype.UnregisterLogEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterLogEventListener()},n.prototype.UnregisterMessageEventListener=function(){return this._hidden.VidyoRoom?this._hidden.VidyoRoom.UnregisterMessageEventListener():l.Promise.resolve(!1)},n.prototype.UnregisterParticipantEventListener=function(){return this._hidden.VidyoRoom?(this._hidden.VidyoRoom.UnregisterParticipantEventListener(),l.Promise.resolve(!0)):(this._hidden.VidyoParticipantCallbacks={},l.Promise.resolve(!0))},n.prototype.UnregisterPermissionEventListener=function(){return this._hidden.VidyoPermission.UnregisterPermissionEventListener()},n.prototype.UnregisterRemoteCameraEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterRemoteCameraEventListener()},n.prototype.UnregisterRemoteMicrophoneEnergyListener=function(){return this._hidden.VidyoEndpoint.UnregisterRemoteMicrophoneEnergyListener()},n.prototype.UnregisterRemoteMicrophoneEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterRemoteMicrophoneEventListener()},n.prototype.UnregisterRemoteWindowShareEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterRemoteWindowShareEventListener()},n.prototype.UnregisterResourceManagerEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterResourceManagerEventListener()},n.prototype._changeState=function(e){this._hidden.State=e},n.prototype._initialize=function(e,t,n,r,o,a){var s=this;return this._hidden.VidyoSimple.Initialize().then(function(){return s._hidden.VidyoEndpoint=s._hidden.VidyoSimple.CreateVidyoEndpoint(e,t,n,r,r,o),s._hidden.VidyoUser=s._hidden.VidyoSimple.CreateVidyoUser(s._hidden.VidyoEndpoint),s._hidden.VidyoPermission=s._hidden.VidyoSimple.CreateVidyoPermission(),s._changeState(i.Ready),!0})},n.prototype._noopPromise=function(){return console.warn("Not Implemented"),console.trace(),new l.Promise(function(){return!1})},n.prototype._registerAdvancedSettingsEventListener=function(e){var t=e.onAddGoogleConferenceFlagChanged,n=e.onDisableStatsChanged,r=e.onLogCategoryChanged,i=e.onEnableSimpleAPILoggingChanged,o=e.onEnableSimulcastChanged,a=e.onEnableXMPPMessageLoggingChanged,s=e.onParticipantLimitChanged,c=e.onShowStatisticsOverlayChanged,u=e.onCodecExcludeFilterChanged;this._hidden.VidyoEndpoint.RegisterAdvancedSettingsEventListener({onAddGoogleConferenceFlagChanged:t,onCodecExcludeFilterChanged:u,onDisableStatsChanged:n,onEnableSimulcastChanged:o,onParticipantLimitChanged:s,onShowStatisticsOverlayChanged:c,onEnableXMPPMessageLoggingChanged:a,onEnableSimpleAPILoggingChanged:i,onLogCategoryChanged:r})},n.CreateVidyoConnector=function(t){var n=t.viewId,r=t.viewStyle,i=t.remoteParticipants,o=t.logFileFilter,a=t.logFileName,s=t.userData,c=t.constraints,u=new e;return void 0!==c&&(y.UserMediaProvider.SetAudioAndVideoConstraints(c.mediaConstraints),g.LocationProvider.SetDefaultLocationStatus(c.location)),u._initialize(n,r,i,o,a,s).then(function(){return window.vidyoConnector=u,u})},n=e=r([_.default],n)}();n.VidyoConnector=w}).call(this,"/src/vidyo_connector_api/VidyoConnector.ts")},{"../core/events/ConnectionEvents":397,"../core/models/APITypes":409,"../core/utils/AssignHiddenPropertyValue":455,"../core/utils/Constants":461,"../core/utils/JSValidation":464,"../core/utils/LocationProvider":466,"../core/utils/Messages":468,"../core/utils/PromiseHelper":475,"../core/utils/StringUtils":479,"../core/utils/UserMediaProvider":482,"../core/utils/VidyoDebugger":484,"../vidyo_simple_api/VidyoSimple":537,"es6-promise":43,uuid:332}],527:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(e,t,n,r,i){this.id=e,this.name=t,this.objId=n,this.objType="Vidyo"+r+i}}();n.BaseModel=r},{}],528:[function(e,t,n){"use strict";var r,i;Object.defineProperty(n,"__esModule",{value:!0}),function(e){e.User="VIDYO_CHATMESSAGESENDERTYPE_User",e.Room="VIDYO_CHATMESSAGESENDERTYPE_Room",e.System="VIDYO_CHATMESSAGESENDERTYPE_System",e.None="VIDYO_CHATMESSAGESENDERTYPE_None"}(r=n.VidyoChatMessageSenderType||(n.VidyoChatMessageSenderType={})),function(e){e.Chat="VIDYO_CHATMESSAGETYPE_Chat",e.MediaStart="VIDYO_CHATMESSAGETYPE_MediaStart",e.MediaStop="VIDYO_CHATMESSAGETYPE_MediaStop"}(i=n.VidyoChatMessageType||(n.VidyoChatMessageType={}));var o={user:r.User,room:r.Room},a={chat:i.Chat,mediastart:i.MediaStart,mediastop:i.MediaStop},s=function(){return function(e){this.objType="VidyoChatMessage",this.objId=e.objId,this.timestamp=e.timestamp,this.userId=e.userId,this.body=e.body,this.id=e.id,this.senderType=o[e.senderType]||r.None,this.type=a[e.type]||i.Chat}}();n.ChatMessage=s},{}],529:[function(e,t,n){(function(t){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("./BaseModel"),a=e("../core/utils/NotImplemented"),s=e("./Origin"),c=e("../core/utils/VidyoDebugger"),u=e("../core/models/APITypes"),l=e("../core/utils/AssignHiddenPropertyValue"),d=function(e){function n(n,r,i){void 0===i&&(i=s.Origin.Local);var o=e.call(this,r.Id,r.Name,r.ObjId,i,r.Type)||this;return l.AssignHiddenPropertyValue(o,"_vidyoCore",n),c.VidyoDebugger.Debug(o,u.API.Simple,t),o}return i(n,e),n.prototype.GetId=function(){return Promise.resolve(this.id)},n.prototype.GetName=function(){return Promise.resolve(this.name)},n.prototype.GetType=function(){return Promise.resolve(this.objType)},n}(o.BaseModel);n.Device=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.AllowRemoteCameraControl=function(e){return this._vidyoCore.Controllers.DeviceController.AllowRemoteCameraControl(this.id,e.allow)},t.prototype.GetPosition=function(){a.NotImplemented()},t.prototype.GetPreviewLabel=function(){var e=this._vidyoCore.Controllers.DeviceController.GetPreviewLabel(this.id);return Promise.resolve(e)},t.prototype.IsControllable=function(){return this._vidyoCore.Controllers.DeviceController.IsLocalCameraControllable(this.id)},t.prototype.IsSuspended=function(){a.NotImplemented()},t.prototype.SetMaxConstraint=function(e){return this._vidyoCore.Controllers.DeviceController.SetMaxConstraint(e,this.id),Promise.resolve(!0)},t.prototype.SetPreviewLabel=function(e){return this._vidyoCore.Controllers.DeviceController.SetPreviewLabel(e.previewLabel,this.id),Promise.resolve(!0)},t}(d);n.Camera=p;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(d);n.Microphone=f;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(d);n.Speaker=h;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.ControlPTZ=function(e){return this._vidyoCore.Controllers.DeviceController.ControlRemoteCameraPTZ(this.id,e)},t.prototype.GetPosition=function(){a.NotImplemented()},t.prototype.HasPanAndTilt=function(){return this._vidyoCore.Controllers.DeviceController.RemoteCameraHasPanAndTilt(this.id)},t.prototype.HasZoom=function(){return this._vidyoCore.Controllers.DeviceController.RemoteCameraHasZoom(this.id)},t.prototype.IsControllable=function(){return this._vidyoCore.Controllers.DeviceController.IsRemoteCameraControllable(this.id)},t.prototype.IsSuspended=function(){a.NotImplemented()},t}(d);n.RemoteCamera=m;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(d);n.RemoteMicrophone=v;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(d);n.RemoteWindowShare=y,function(e){e.Added="VIDYO_DEVICESTATE_Added",e.Removed="VIDYO_DEVICESTATE_Removed",e.Started="VIDYO_DEVICESTATE_Started",e.Stopped="VIDYO_DEVICESTATE_Stopped",e.Suspended="VIDYO_DEVICESTATE_Suspended",e.Unsuspended="VIDYO_DEVICESTATE_Unsuspended",e.InUse="VIDYO_DEVICESTATE_InUse",e.Available="VIDYO_DEVICESTATE_Available",e.Paused="VIDYO_DEVICESTATE_Paused",e.Resumed="VIDYO_DEVICESTATE_Resumed",e.Controllable="VIDYO_DEVICESTATE_Controllable",e.NotControllable="VIDYO_DEVICESTATE_NotControllable",e.DefaultChanged="VIDYO_DEVICESTATE_DefaultChanged",e.ConfigureSuccess="VIDYO_DEVICESTATE_ConfigureSuccess",e.ConfigureError="VIDYO_DEVICESTATE_ConfigureError",e.Error="VIDYO_DEVICESTATE_Error"}(n.VidyoDeviceState||(n.VidyoDeviceState={}))}).call(this,"/src/vidyo_simple_api/Devices.ts")},{"../core/models/APITypes":409,"../core/utils/AssignHiddenPropertyValue":455,"../core/utils/NotImplemented":470,"../core/utils/VidyoDebugger":484,"./BaseModel":527,"./Origin":532}],530:[function(e,t,n){(function(t){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var i=e("../core/events/AdvancedSettingsEvents"),o=e("../core/events/DeviceEvents"),a=e("../core/events/StreamEvents"),s=e("uuid"),c=e("../core/utils/AssignHiddenPropertyValue"),u=e("../core/models/device/Camera"),l=e("./Devices"),d=e("../core/utils/VidyoDebugger"),p=e("../core/models/device/Microphone"),f=e("../core/utils/LocationProvider"),h=e("../core/utils/NotImplemented"),m=e("../vidyo_simple_api/Participant"),v=e("../core/models/device/Speaker"),y=e("../core/utils/LocalStorageProvider"),g=e("../core/events/EventDispatcher"),S=e("./stats/Stats"),_=e("./WindowShare"),b=e("./Monitor"),C=e("es6-promise"),w=e("./Origin"),E=e("../core/events/LogEvents"),R=e("../core/models/APITypes"),P=e("../core/utils/JSValidation"),L=function(){function e(e){this.objType="VidyoEndpoint",c.AssignHiddenPropertyValue(this,"_vidyoCore",e),this._vidyoCore.Controllers.CallStateController.EnableMedia(),this.objId=this._createEndpointID(),d.VidyoDebugger.Debug(this,R.API.Simple,t)}return e.prototype.AssignViewToCompositeRenderer=function(e){return this._vidyoCore.Controllers.RendererController.AssignViewToCompositeRenderer(e),C.Promise.resolve(!0)},e.prototype.AssignViewToLocalCamera=function(e){var t=e.viewId,n=e.localCamera,r=e.displayCropped,i=e.allowZoom,o=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream.Id;this._vidyoCore.Controllers.RendererController.AssignViewToLocalSource({viewId:t,sourceId:n.id,displayCropped:r,allowZoom:i,isApplication:!1,streamId:o})},e.prototype.AssignViewToLocalMonitor=function(e){var t=e.allowZoom,n=e.displayCropped,r=e.localMonitor,i=e.viewId,o=this._vidyoCore.Controllers.LocalStreamController.MonitorShareStream.Id;this._vidyoCore.Controllers.RendererController.AssignViewToLocalSource({viewId:i,sourceId:r.id,displayCropped:n,allowZoom:t,isApplication:!0,streamId:o})},e.prototype.AssignViewToLocalWindowShare=function(e){var t=e.allowZoom,n=e.displayCropped,r=e.viewId,i=e.localWindowShare,o=this._vidyoCore.Controllers.LocalStreamController.WindowShareStream.Id;this._vidyoCore.Controllers.RendererController.AssignViewToLocalSource({viewId:r,sourceId:i.id,displayCropped:n,allowZoom:t,isApplication:!0,streamId:o})},e.prototype.AssignViewToRemoteCamera=function(e){var t=e.allowZoom,n=e.displayCropped,r=e.remoteCamera,i=e.viewId,o=this._vidyoCore.Controllers.ParticipantController.GetParticipantBySsrc(r.id);o&&o.IsRemote&&(this._vidyoCore.Controllers.RendererController.AssignViewToRemoteSource({viewId:i,sourceId:r.id,isApplication:!1,displayCropped:n,allowZoom:t}),this._vidyoCore.Controllers.ConferenceController.ActivateParticipantSource(o,r.id))},e.prototype.AssignViewToRemoteWindowShare=function(e){var t=e.allowZoom,n=e.displayCropped,r=e.remoteWindowShare,i=e.viewId,o=this._vidyoCore.Controllers.ParticipantController.GetParticipantBySsrc(r.id);o&&o.IsRemote&&(this._vidyoCore.Controllers.RendererController.AssignViewToRemoteSource({viewId:i,sourceId:r.id,isApplication:!0,displayCropped:n,allowZoom:t}),this._vidyoCore.Controllers.ConferenceController.ActivateParticipantSource(o,r.id))},e.prototype.CycleCamera=function(){this._vidyoCore.Controllers.DeviceController.CycleCamera()},e.prototype.CycleMicrophone=function(){this._vidyoCore.Controllers.DeviceController.CycleMicrophone()},e.prototype.CycleSpeaker=function(){this._vidyoCore.Controllers.DeviceController.CycleSpeaker()},e.prototype.Disable=function(){h.NotImplemented()},e.prototype.DisableDebug=function(){h.NotImplemented()},e.prototype.EnableDebug=function(e){e.port;var t=e.logFilter;return this._vidyoCore.Controllers.LogController.LogWarning("Debug logs printed to console regardless of the port"),this._vidyoCore.Controllers.LogController.EnableDebug(t)},e.prototype.EnableFileLogger=function(){h.NotImplemented()},e.prototype.GetId=function(){h.NotImplemented()},e.prototype.GetStats=function(){var e=this._vidyoCore.Controllers.StatisticsController.GetEndpointStatistics();return new S.EndpointStats(e)},e.prototype.GetStatsJson=function(){return C.Promise.resolve(JSON.stringify(this.GetStats()))},e.prototype.HideView=function(e){this._vidyoCore.Controllers.RendererController.HideView(e)},e.prototype.RegisterAdvancedSettingsEventListener=function(e){var t=e.onAddGoogleConferenceFlagChanged,n=e.onCodecExcludeFilterChanged,r=e.onDisableStatsChanged,o=e.onEnableSimpleAPILoggingChanged,a=e.onEnableSimulcastChanged,s=e.onEnableVidyoConnectorAPILoggingChanged,c=e.onEnableXMPPMessageLoggingChanged,u=e.onParticipantLimitChanged,l=e.onLogCategoryChanged,d=e.onShowStatisticsOverlayChanged;t&&(t(this._vidyoCore.Controllers.AdvancedSettingsController.AddGoogleConferenceFlag),this._vidyoCore.EventDispatcher.on(i.Events.AddGoogleConferenceFlagChanged,g.VidyoAdvancedSettingsEventListeners,t)),l&&(l(this._vidyoCore.Controllers.AdvancedSettingsController.ShowLogCategory),this._vidyoCore.EventDispatcher.on(i.Events.LogCategoryChanged,g.VidyoAdvancedSettingsEventListeners,l)),n&&(n(this._vidyoCore.Controllers.AdvancedSettingsController.CodecExcludeFilter),this._vidyoCore.EventDispatcher.on(i.Events.CodecExcludeFilterChanged,g.VidyoAdvancedSettingsEventListeners,n)),r&&(r(this._vidyoCore.Controllers.AdvancedSettingsController.DisableStats),this._vidyoCore.EventDispatcher.on(i.Events.DisableStatsChanged,g.VidyoAdvancedSettingsEventListeners,r)),a&&(a(this._vidyoCore.Controllers.AdvancedSettingsController.EnableSimulcast),this._vidyoCore.EventDispatcher.on(i.Events.EnableSimulcastChanged,g.VidyoAdvancedSettingsEventListeners,a)),u&&(u(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit),this._vidyoCore.EventDispatcher.on(i.Events.ParticipantLimitChanged,g.VidyoAdvancedSettingsEventListeners,u)),d&&(d(this._vidyoCore.Controllers.AdvancedSettingsController.ShowStatisticsOverlay),this._vidyoCore.EventDispatcher.on(i.Events.ShowStatisticsOverlayChanged,g.VidyoAdvancedSettingsEventListeners,d)),c&&(c(this._vidyoCore.Controllers.AdvancedSettingsController.EnableXMPPMessageLogging),this._vidyoCore.EventDispatcher.on(i.Events.EnableXMPPMessageLoggingChanged,g.VidyoAdvancedSettingsEventListeners,c)),o&&(o(this._vidyoCore.Controllers.AdvancedSettingsController.EnableSimpleAPILogging),this._vidyoCore.EventDispatcher.on(i.Events.EnableSimpleAPILoggingChanged,g.VidyoAdvancedSettingsEventListeners,o)),s&&(s(this._vidyoCore.Controllers.AdvancedSettingsController.EnableVidyoConnectorAPILogging),this._vidyoCore.EventDispatcher.on(i.Events.EnableVidyoConnectorAPILoggingChanged,g.VidyoAdvancedSettingsEventListeners,s))},e.prototype.RegisterLocalCameraEventListener=function(e){var t=this,n=e.onAdded,r=e.onRemoved,i=e.onSelected,a=(e.onStateUpdated,function(e){n(new l.Camera(t._vidyoCore,e.camera))});this._vidyoCore.EventDispatcher.on(o.Events.CameraAdded,g.VidyoLocalCameraEventListeners,a);var s=function(e){r(new l.Camera(t._vidyoCore,e.camera))};this._vidyoCore.EventDispatcher.on(o.Events.CameraRemoved,g.VidyoLocalCameraEventListeners,s),this._vidyoCore.EventDispatcher.on(o.Events.CameraUnplugged,g.VidyoLocalCameraEventListeners,s);var c=function(e){var n=e?new l.Camera(t._vidyoCore,e.camera):null;i(n)};this._vidyoCore.EventDispatcher.on(o.Events.CameraSelected,g.VidyoLocalCameraEventListeners,c);var u=!1;return this._vidyoCore.Controllers.DeviceController.DevicesAreBeingDetected&&(this._vidyoCore.Controllers.DeviceController.GetCameraList().forEach(function(e){return a({camera:e})}),u=!0),this._vidyoCore.Controllers.DeviceController.StartDeviceDetection().then(function(){if(t._vidyoCore.Controllers.DeviceController.IsCameraSelected()){if(u){var e=t._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Camera;"boolean"!=typeof e&&c({camera:e})}}else t._vidyoCore.Controllers.DeviceController.SelectDefaultCamera();return t._registerLocalCameraPlugInOutManager(),!0}).catch(function(){return!1})},e.prototype.RegisterLocalMicrophoneEnergyListener=function(e){return this._vidyoCore.Controllers.MicrophoneEnergyLevelController.RegisterLocalMicrophoneEnergyListener(e)},e.prototype.RegisterLocalMicrophoneEventListener=function(e){var t=this,n=e.onAdded,r=e.onRemoved,i=e.onSelected,a=(e.onStateUpdated,function(e){n(new l.Microphone(t._vidyoCore,e.microphone))});this._vidyoCore.EventDispatcher.on(o.Events.MicrophoneAdded,g.VidyoLocalMicrophoneEventListeners,a);var s=function(e){r(new l.Microphone(t._vidyoCore,e.microphone))};this._vidyoCore.EventDispatcher.on(o.Events.MicrophoneRemoved,g.VidyoLocalMicrophoneEventListeners,s),this._vidyoCore.EventDispatcher.on(o.Events.MicrophoneUnplugged,g.VidyoLocalMicrophoneEventListeners,s);var c=function(e){i(new l.Microphone(t._vidyoCore,e.microphone))};this._vidyoCore.EventDispatcher.on(o.Events.MicrophoneSelected,g.VidyoLocalMicrophoneEventListeners,c);var u=!1;return this._vidyoCore.Controllers.DeviceController.DevicesAreBeingDetected&&(this._vidyoCore.Controllers.DeviceController.GetMicrophoneList().forEach(function(e){return a({microphone:e})}),u=!0),this._vidyoCore.Controllers.DeviceController.StartDeviceDetection().then(function(){if(t._vidyoCore.Controllers.DeviceController.IsMicrophoneSelected()){if(u){var e=t._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Microphone;"boolean"!=typeof e&&c({microphone:e})}}else t._vidyoCore.Controllers.DeviceController.SelectDefaultMicrophone();return t._registerLocalMicrophonePlugInOutManager(),!0}).catch(function(){return!1})},e.prototype.RegisterLocalMonitorEventListener=function(e){var t=e.onAdded,n=e.onRemoved,r=e.onSelected;e.onStateUpdated;this._vidyoCore.EventDispatcher.releaseGroup(g.VidyoLocalMonitorEventListeners);var i=new b.Monitor("Select Monitor");return this._vidyoCore.EventDispatcher.on(a.Events.LocalMonitorAdded,g.VidyoLocalMonitorEventListeners,function(){return t(i)}),this._vidyoCore.EventDispatcher.on(a.Events.LocalMonitorSelected,g.VidyoLocalMonitorEventListeners,function(){return r(i)}),this._vidyoCore.EventDispatcher.on(a.Events.LocalMonitorDeselected,g.VidyoLocalMonitorEventListeners,function(){return r(void 0)}),this._vidyoCore.EventDispatcher.on(a.Events.LocalMonitorRemoved,g.VidyoLocalMonitorEventListeners,function(){return n(i)}),t(i),C.Promise.resolve(!0)},e.prototype.RegisterLocalSpeakerEventListener=function(e){var t=this,n=e.onAdded,r=e.onRemoved,i=e.onSelected,a=(e.onStateUpdated,function(e){n(new l.Speaker(t._vidyoCore,e.speaker))});this._vidyoCore.EventDispatcher.on(o.Events.SpeakerAdded,g.VidyoLocalSpeakerEventListeners,a);var s=function(e){r(new l.Speaker(t._vidyoCore,e.speaker))};this._vidyoCore.EventDispatcher.on(o.Events.SpeakerRemoved,g.VidyoLocalSpeakerEventListeners,s),this._vidyoCore.EventDispatcher.on(o.Events.SpeakerUnplugged,g.VidyoLocalSpeakerEventListeners,s);var c=function(e){i(new l.Speaker(t._vidyoCore,e.speaker))};this._vidyoCore.EventDispatcher.on(o.Events.SpeakerSelected,g.VidyoLocalSpeakerEventListeners,c);var u=!1;return this._vidyoCore.Controllers.DeviceController.DevicesAreBeingDetected&&(this._vidyoCore.Controllers.DeviceController.GetSpeakerList().forEach(function(e){return a({speaker:e})}),u=!0),this._vidyoCore.Controllers.DeviceController.StartDeviceDetection().then(function(){if(t._vidyoCore.Controllers.DeviceController.IsSpeakerSelected()){if(u){var e=t._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Speaker;"boolean"!=typeof e&&c({speaker:e})}}else t._vidyoCore.Controllers.DeviceController.SelectDefaultSpeaker();return t._registerLocalSpeakerPlugInOutManager(),!0}).catch(function(){return!1})},e.prototype.RegisterLocalWindowShareEventListener=function(e){var t=e.onAdded,n=e.onRemoved,r=e.onSelected;e.onStateUpdated;this._vidyoCore.EventDispatcher.releaseGroup(g.VidyoLocalWindowShareEventListeners);var i=new _.WindowShare("Select Share",w.Origin.Local,"Application");return this._vidyoCore.EventDispatcher.on(a.Events.LocalWindowShareAdded,g.VidyoLocalWindowShareEventListeners,function(){return t(i)}),this._vidyoCore.EventDispatcher.on(a.Events.LocalWindowShareSelected,g.VidyoLocalWindowShareEventListeners,function(){return r(i)}),this._vidyoCore.EventDispatcher.on(a.Events.LocalWindowShareDeselected,g.VidyoLocalWindowShareEventListeners,function(){return r(null)}),this._vidyoCore.EventDispatcher.on(a.Events.LocalWindowShareRemoved,g.VidyoLocalWindowShareEventListeners,function(){return n(i)}),t(i),C.Promise.resolve(!0)},e.prototype.RegisterLogEventListener=function(e){return this._vidyoCore.Controllers.LogController.SetLogLevelApp(e.filter),this._vidyoCore.EventDispatcher.on(E.LogEventApp,g.VidyoCustomLoggingEventListeners,e.onLog),C.Promise.resolve(!0)},e.prototype.RegisterRemoteCameraEventListener=function(e){var t=this,n=e.onAdded,r=e.onRemoved,i=e.onStateUpdated;return this._vidyoCore.EventDispatcher.on(a.Events.RemoteCameraAdded,g.VidyoRemoteCameraEventListeners,function(e){n(new l.RemoteCamera(t._vidyoCore,e.camera,w.Origin.Remote),new m.Participant(e.participant))}),this._vidyoCore.EventDispatcher.on(a.Events.RemoteCameraRemoved,g.VidyoRemoteCameraEventListeners,function(e){r(new l.RemoteCamera(t._vidyoCore,e.camera,w.Origin.Remote),new m.Participant(e.participant))}),this._vidyoCore.EventDispatcher.on(a.Events.RemoteCameraStateUpdated,g.VidyoRemoteCameraEventListeners,function(e){i(new l.RemoteCamera(t._vidyoCore,e.camera,w.Origin.Remote),new m.Participant(e.participant))}),C.Promise.resolve(!0)},e.prototype.RegisterRemoteMicrophoneEnergyListener=function(e){return this._vidyoCore.Controllers.MicrophoneEnergyLevelController.RegisterRemoteMicrophoneEnergyListener(e)},e.prototype.RegisterRemoteMicrophoneEventListener=function(e){var t=this,n=e.onAdded,r=e.onRemoved,i=e.onStateUpdated;return this._vidyoCore.EventDispatcher.on(a.Events.RemoteMicrophoneAdded,g.VidyoRemoteMicrophoneEventListeners,function(e){n(new l.RemoteMicrophone(t._vidyoCore,e.microphone,w.Origin.Remote),new m.Participant(e.participant))}),this._vidyoCore.EventDispatcher.on(a.Events.RemoteMicrophoneRemoved,g.VidyoRemoteMicrophoneEventListeners,function(e){r(new l.RemoteMicrophone(t._vidyoCore,e.microphone,w.Origin.Remote),new m.Participant(e.participant))}),this._vidyoCore.EventDispatcher.on(a.Events.RemoteMicrophoneStateUpdated,g.VidyoRemoteMicrophoneEventListeners,function(e){i(new l.RemoteMicrophone(t._vidyoCore,e.microphone,w.Origin.Remote),new m.Participant(e.participant),e.state)}),C.Promise.resolve(!0)},e.prototype.RegisterRemoteWindowShareEventListener=function(e){var t=this,n=e.onAdded,r=e.onRemoved,i=e.onStateUpdated;return this._vidyoCore.EventDispatcher.on(a.Events.RemoteWindowShareAdded,g.VidyoRemoteWindowShareEventListeners,function(e){n(new l.RemoteWindowShare(t._vidyoCore,e.windowShare,w.Origin.Remote),new m.Participant(e.participant))}),this._vidyoCore.EventDispatcher.on(a.Events.RemoteWindowShareRemoved,g.VidyoRemoteWindowShareEventListeners,function(e){r(new l.RemoteWindowShare(t._vidyoCore,e.windowShare,w.Origin.Remote),new m.Participant(e.participant))}),this._vidyoCore.EventDispatcher.on(a.Events.RemoteWindowShareStateUpdated,g.VidyoRemoteWindowShareEventListeners,function(e){i(new l.RemoteWindowShare(t._vidyoCore,e.windowShare,w.Origin.Remote),new m.Participant(e.participant))}),C.Promise.resolve(!0)},e.prototype.RegisterResourceManagerEventListener=function(e){return this._vidyoCore.Controllers.ResourcesManager.RegisterResourceManagerEventListener(e)},e.prototype.ReportLocalParticipantOnJoined=function(e){this._vidyoCore.Controllers.ParticipantController.ReportLocalParticipant(e)},e.prototype.SelectAudioContentShare=function(e){var t=e.localMicrophone;return t?this._vidyoCore.Controllers.DeviceController.SelectAudioContentShareDevice(new p.Microphone(t.name,t.id,t.objId)):this._vidyoCore.Controllers.DeviceController.SelectAudioContentShareDevice(),C.Promise.resolve(!0)},e.prototype.SelectCamera=function(e){var t=e.camera;t?this._vidyoCore.Controllers.DeviceController.SelectCamera(new u.Camera(t.name,t.id,t.objId)):this._vidyoCore.Controllers.DeviceController.SelectCamera(),this._setDefaultCamera(t)},e.prototype.SelectDefaultCamera=function(){this._vidyoCore.Controllers.DeviceController.SelectDefaultCamera()},e.prototype.SelectDefaultMicrophone=function(){this._vidyoCore.Controllers.DeviceController.SelectDefaultMicrophone()},e.prototype.SelectDefaultSpeaker=function(){this._vidyoCore.Controllers.DeviceController.SelectDefaultSpeaker()},e.prototype.SelectLocalMicrophone=function(){h.NotImplemented()},e.prototype.SelectLocalMonitor=function(e){return this._vidyoCore.Controllers.DeviceController.SelectMonitor(e.localMonitor).then(function(){return!0},function(){return!1}).catch(function(){return!1})},e.prototype.SelectLocalSpeaker=function(){h.NotImplemented()},e.prototype.SelectLocalWindowShare=function(e){return this._vidyoCore.Controllers.DeviceController.SelectWindowShare(e.localWindowShare).then(function(){return!0},function(){return!1}).catch(function(){return!1})},e.prototype.SelectMicrophone=function(e){var t=e.microphone;t?this._vidyoCore.Controllers.DeviceController.SelectMicrophone(new p.Microphone(t.name,t.id,t.objId)):this._vidyoCore.Controllers.DeviceController.SelectMicrophone(),this._setDefaultMicrophone(t)},e.prototype.SelectSpeaker=function(e){var t=e.speaker,n=t?new v.Speaker(t.name,t.id,t.objId):new v.Speaker("","","");this._vidyoCore.Controllers.DeviceController.SelectSpeaker(n),this._setDefaultSpeaker(t)},e.prototype.SelectVideoContentShare=function(e){var t=e.localCamera;return t?this._vidyoCore.Controllers.DeviceController.SelectVideoContentShareDevice(new u.Camera(t.name,t.id,t.objId)):this._vidyoCore.Controllers.DeviceController.SelectVideoContentShareDevice(),C.Promise.resolve(!0)},e.prototype.SetAdvancedConfiguration=function(e){void 0!==e.addGoogleConferenceFlag&&(this._vidyoCore.Controllers.AdvancedSettingsController.AddGoogleConferenceFlag=e.addGoogleConferenceFlag),void 0!==e.addLogCategory&&(this._vidyoCore.Controllers.LogController.SetLogLevelSDK(e.addLogCategory),this._vidyoCore.Controllers.AdvancedSettingsController.ShowLogCategory=e.addLogCategory),void 0!==e.codecExcludeFilter&&(this._vidyoCore.Controllers.AdvancedSettingsController.CodecExcludeFilter=e.codecExcludeFilter),void 0!==e.disableStats&&(this._vidyoCore.Controllers.AdvancedSettingsController.DisableStats=e.disableStats),void 0!==e.enableSimulcast&&(this._vidyoCore.Controllers.AdvancedSettingsController.EnableSimulcast=e.enableSimulcast),void 0!==e.participantLimit&&(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit=+e.participantLimit),void 0!==e.showStatisticsOverlay&&(this._vidyoCore.Controllers.AdvancedSettingsController.ShowStatisticsOverlay=e.showStatisticsOverlay),void 0!==e.enableXMPPMessageLogging&&(this._vidyoCore.Controllers.AdvancedSettingsController.EnableXMPPMessageLogging=e.enableXMPPMessageLogging),void 0!==e.enableSimpleAPILogging&&(this._vidyoCore.Controllers.AdvancedSettingsController.EnableSimpleAPILogging=e.enableSimpleAPILogging),void 0!==e.enableVidyoConnectorAPILogging&&(this._vidyoCore.Controllers.AdvancedSettingsController.EnableVidyoConnectorAPILogging=e.enableVidyoConnectorAPILogging)},e.prototype.SetCameraPrivacy=function(e){return e&&"boolean"==typeof e.privacy?(this._vidyoCore.Controllers.DeviceController.SetVideoMuteState(e.privacy),C.Promise.resolve(!0)):C.Promise.resolve(!1)},e.prototype.SetConsoleLoggerFilter=function(e){this._vidyoCore.Controllers.LogController.SetLogLevelSDK(e.consoleLogFilter)},e.prototype.SetFileLoggerFilter=function(e){this.SetConsoleLoggerFilter({consoleLogFilter:e.fileLogFilter})},e.prototype.SetLocation=function(e){return"number"==typeof e.latitude&&"number"==typeof e.longitude?(f.LocationProvider.SetLocation(e),C.Promise.resolve(!0)):C.Promise.resolve(!1)},e.prototype.SetMaxBitRate=function(e){return this._vidyoCore.Controllers.LocalStreamController.SetMaxBitrate(e.bitRate),C.Promise.resolve(!0)},e.prototype.SetMicrophonePrivacy=function(e){return e&&"boolean"==typeof e.privacy?(this._vidyoCore.Controllers.DeviceController.SetAudioMuteState(e.privacy),C.Promise.resolve(!0)):C.Promise.resolve(!1)},e.prototype.SetMode=function(){h.NotImplemented()},e.prototype.SetPool=function(e){return this._vidyoCore.Controllers.ConnectionController.ReflectorsPoolName=e.name,C.Promise.resolve(!0)},e.prototype.SetPreview=function(e){this._vidyoCore.Controllers.RendererController.SetPreview(e)},e.prototype.SetSpeakerPrivacy=function(e){return e&&"boolean"==typeof e.privacy?(this._vidyoCore.Controllers.DeviceController.SetSpeakerMuteState(e.privacy),C.Promise.resolve(!0)):C.Promise.resolve(!1)},e.prototype.SetViewAnimationSpeed=function(e){e.viewId,e.speedPercentage;h.NotImplemented()},e.prototype.SetViewBackgroundColor=function(e){e.viewId,e.red,e.green,e.blue;h.NotImplemented()},e.prototype.ShowAudioMeters=function(e){return this._vidyoCore.Controllers.RendererController.ShowAudioMeters(e)},e.prototype.ShowPreview=function(e){var t=e.preview;return this._vidyoCore.Controllers.RendererController.ShowLocalPreview=t,C.Promise.resolve(!0)},e.prototype.ShowViewAt=function(e){var t=this,n=e.viewId,r=e.x,i=e.y,o=e.width,a=e.height;return this._vidyoCore.Controllers.RendererController.ShowViewAt({viewId:n,width:o,height:a,x:r,y:i}).then(function(){var e=t._vidyoCore.Controllers.RendererController.Views[n].sourceId;if(e){var r=t._vidyoCore.Controllers.ParticipantController.GetParticipantBySsrc(e);r&&t._vidyoCore.Controllers.ConferenceController.ActivateParticipantSource(r,e)}return!0})},e.prototype.ShowViewLabel=function(e){return this._vidyoCore.Controllers.RendererController.ShowViewLabel(e)},e.prototype.ShowWindowSharePreview=function(e){this._vidyoCore.Controllers.RendererController.ShowLocalShare(e.preview)},e.prototype.StartDeviceDetection=function(){return this._vidyoCore.Controllers.DeviceController.StartDeviceDetection()},e.prototype.StartLocationDetection=function(){h.NotImplemented()},e.prototype.StartShareDetection=function(){h.NotImplemented()},e.prototype.StopDeviceDetection=function(){h.NotImplemented()},e.prototype.StopLocationDetection=function(){h.NotImplemented()},e.prototype.StopShareDetection=function(){h.NotImplemented()},e.prototype.UnregisterLocalCameraEventListener=function(){return this._vidyoCore.Controllers.DeviceController.ClearLocalCameras(),this._vidyoCore.EventDispatcher.releaseGroup(g.VidyoLocalCameraEventListeners),C.Promise.resolve(!0)},e.prototype.UnregisterLocalMicrophoneEnergyListener=function(){return this._vidyoCore.Controllers.MicrophoneEnergyLevelController.UnregisterLocalMicrophoneEnergyListener()},e.prototype.UnregisterLocalMicrophoneEventListener=function(){return this._vidyoCore.Controllers.DeviceController.ClearLocalMicrophones(),this._vidyoCore.EventDispatcher.releaseGroup(g.VidyoLocalMicrophoneEventListeners),C.Promise.resolve(!0)},e.prototype.UnregisterLocalMonitorEventListener=function(){return this._vidyoCore.EventDispatcher.emit(a.Events.LocalMonitorRemoved),this._vidyoCore.EventDispatcher.releaseGroup(g.VidyoLocalMonitorEventListeners),C.Promise.resolve(!0)},e.prototype.UnregisterLocalRendererEventListener=function(){h.NotImplemented()},e.prototype.UnregisterLocalSpeakerEventListener=function(){return this._vidyoCore.Controllers.DeviceController.ClearLocalSpeakers(),this._vidyoCore.EventDispatcher.releaseGroup(g.VidyoLocalSpeakerEventListeners),C.Promise.resolve(!0)},e.prototype.UnregisterLocalWindowShareEventListener=function(){return this._vidyoCore.EventDispatcher.emit(a.Events.LocalWindowShareRemoved),this._vidyoCore.EventDispatcher.releaseGroup(g.VidyoLocalWindowShareEventListeners),C.Promise.resolve(!0)},e.prototype.UnregisterLogEventListener=function(){return this._vidyoCore.EventDispatcher.releaseGroup(g.VidyoCustomLoggingEventListeners),C.Promise.resolve(!0)},e.prototype.UnregisterRemoteCameraEventListener=function(){return this._vidyoCore.EventDispatcher.releaseGroup(g.VidyoRemoteCameraEventListeners),C.Promise.resolve(!0)},e.prototype.UnregisterRemoteMicrophoneEnergyListener=function(){return this._vidyoCore.Controllers.MicrophoneEnergyLevelController.UnregisterRemoteMicrophoneEnergyListener()},e.prototype.UnregisterRemoteMicrophoneEventListener=function(){return this._vidyoCore.EventDispatcher.releaseGroup(g.VidyoRemoteMicrophoneEventListeners),C.Promise.resolve(!0)},e.prototype.UnregisterRemoteRendererEventListener=function(){h.NotImplemented()},e.prototype.UnregisterRemoteSpeakerEventListener=function(){h.NotImplemented()},e.prototype.UnregisterRemoteWindowShareEventListener=function(){return this._vidyoCore.EventDispatcher.releaseGroup(g.VidyoRemoteWindowShareEventListeners),C.Promise.resolve(!0)},e.prototype.UnregisterResourceManagerEventListener=function(){return this._vidyoCore.Controllers.ResourcesManager.UnregisterResourceManagerEventListener()},e.prototype._createEndpointID=function(){var e=y.LocalStorageProvider.Get("VidyoCore::EndpointID");return e||(e=s.v4(),y.LocalStorageProvider.Set("VidyoCore::EndpointID",e)),e},e.prototype._onLocalCameraAdded=function(e){var t=this._vidyoCore.Controllers.DeviceController;if(!t.IsDefaultCameraSelected()&&!0!==t.GetSelectedDevices().Camera){var n=new l.Camera(this._vidyoCore,e.camera);this.SelectCamera({camera:n}),this._setDefaultCamera(n)}},e.prototype._onLocalCameraRemoved=function(e){this._vidyoCore.Controllers.DeviceController.IsDefaultCamera(e.camera)&&this._setDefaultCamera(null)},e.prototype._onLocalCameraUnplugged=function(e){var t=this._vidyoCore.Controllers.DeviceController;this._onLocalCameraRemoved(e),t.IsDefaultCameraSelected()||!0===t.GetSelectedDevices().Camera||this._vidyoCore.Controllers.DeviceController.SelectDefaultCamera()},e.prototype._onLocalMicrophoneAdded=function(e){var t=this._vidyoCore.Controllers.DeviceController;if(!t.IsDefaultMicrophoneSelected()&&!0!==t.GetSelectedDevices().Microphone){var n=new l.Microphone(this._vidyoCore,e.microphone);this.SelectMicrophone({microphone:n}),this._setDefaultMicrophone(n)}},e.prototype._onLocalMicrophoneRemoved=function(e){this._vidyoCore.Controllers.DeviceController.IsDefaultMicrophone(e.microphone)&&this._setDefaultMicrophone(null)},e.prototype._onLocalMicrophoneUnplugged=function(e){var t=this._vidyoCore.Controllers.DeviceController;this._onLocalMicrophoneRemoved(e),t.IsDefaultMicrophoneSelected()||!0===t.GetSelectedDevices().Microphone||this._vidyoCore.Controllers.DeviceController.SelectDefaultMicrophone()},e.prototype._onLocalSpeakerAdded=function(e){var t=this._vidyoCore.Controllers.DeviceController;if(!t.IsDefaultSpeakerSelected()&&""!==t.GetSelectedDevices().Speaker.Id){var n=new l.Speaker(this._vidyoCore,e.speaker);this.SelectSpeaker({speaker:n}),this._setDefaultSpeaker(n)}},e.prototype._onLocalSpeakerRemoved=function(e){this._vidyoCore.Controllers.DeviceController.IsDefaultSpeaker(e.speaker)&&this._setDefaultSpeaker(null)},e.prototype._onLocalSpeakerUnplugged=function(e){var t=this._vidyoCore.Controllers.DeviceController;this._onLocalSpeakerRemoved(e),t.IsDefaultSpeakerSelected()||""===t.GetSelectedDevices().Speaker.Id||this._vidyoCore.Controllers.DeviceController.SelectDefaultSpeaker()},e.prototype._registerLocalCameraPlugInOutManager=function(){var e=this;this._vidyoCore.EventDispatcher.on(o.Events.CameraAdded,g.VidyoLocalCameraEventListeners,function(t){e._onLocalCameraAdded(t)}),this._vidyoCore.EventDispatcher.on(o.Events.CameraRemoved,g.VidyoLocalCameraEventListeners,function(t){e._onLocalCameraRemoved(t)}),this._vidyoCore.EventDispatcher.on(o.Events.CameraUnplugged,g.VidyoLocalCameraEventListeners,function(t){e._onLocalCameraUnplugged(t)})},e.prototype._registerLocalMicrophonePlugInOutManager=function(){var e=this;this._vidyoCore.EventDispatcher.on(o.Events.MicrophoneAdded,g.VidyoLocalMicrophoneEventListeners,function(t){e._onLocalMicrophoneAdded(t)}),this._vidyoCore.EventDispatcher.on(o.Events.MicrophoneRemoved,g.VidyoLocalMicrophoneEventListeners,function(t){e._onLocalMicrophoneRemoved(t)}),this._vidyoCore.EventDispatcher.on(o.Events.MicrophoneUnplugged,g.VidyoLocalMicrophoneEventListeners,function(t){e._onLocalMicrophoneUnplugged(t)})},e.prototype._registerLocalSpeakerPlugInOutManager=function(){var e=this;this._vidyoCore.EventDispatcher.on(o.Events.SpeakerAdded,g.VidyoLocalSpeakerEventListeners,function(t){e._onLocalSpeakerAdded(t)}),this._vidyoCore.EventDispatcher.on(o.Events.SpeakerRemoved,g.VidyoLocalSpeakerEventListeners,function(t){e._onLocalSpeakerRemoved(t)}),this._vidyoCore.EventDispatcher.on(o.Events.SpeakerUnplugged,g.VidyoLocalSpeakerEventListeners,function(t){e._onLocalSpeakerUnplugged(t)})},e.prototype._setDefaultCamera=function(e){this._vidyoCore.Controllers.DeviceController.SetDefaultCamera(null!==e?new u.Camera(e.name,e.id,e.objId):null)},e.prototype._setDefaultMicrophone=function(e){this._vidyoCore.Controllers.DeviceController.SetDefaultMicrophone(null!==e?new p.Microphone(e.name,e.id,e.objId):null)},e.prototype._setDefaultSpeaker=function(e){this._vidyoCore.Controllers.DeviceController.SetDefaultSpeaker(null!==e?new v.Speaker(e.name,e.id,e.objId):null)},e=r([P.default],e)}();n.EndPoint=L}).call(this,"/src/vidyo_simple_api/EndPoint.ts")},{"../core/events/AdvancedSettingsEvents":394,"../core/events/DeviceEvents":398,"../core/events/EventDispatcher":399,"../core/events/LogEvents":400,"../core/events/StreamEvents":408,"../core/models/APITypes":409,"../core/models/device/Camera":421,"../core/models/device/Microphone":425,"../core/models/device/Speaker":426,"../core/utils/AssignHiddenPropertyValue":455,"../core/utils/JSValidation":464,"../core/utils/LocalStorageProvider":465,"../core/utils/LocationProvider":466,"../core/utils/NotImplemented":470,"../core/utils/VidyoDebugger":484,"../vidyo_simple_api/Participant":533,"./Devices":529,"./Monitor":531,"./Origin":532,"./WindowShare":538,"./stats/Stats":561,"es6-promise":43,uuid:332}],531:[function(e,t,n){(function(t){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("uuid"),a=e("./Origin"),s=e("./BaseModel"),c=e("../core/utils/VidyoDebugger"),u=e("../core/models/APITypes"),l=function(e){function n(n,r){void 0===r&&(r=a.Origin.Local);var i=e.call(this,o.v4(),n,o.v4(),r,"Monitor")||this;return c.VidyoDebugger.Debug(i,u.API.Simple,t),i}return i(n,e),n.prototype.GetId=function(){return this.id},n.prototype.GetName=function(){return this.name},n.prototype.SetFrameInterval=function(e){},n}(s.BaseModel);n.Monitor=l}).call(this,"/src/vidyo_simple_api/Monitor.ts")},{"../core/models/APITypes":409,"../core/utils/VidyoDebugger":484,"./BaseModel":527,"./Origin":532,uuid:332}],532:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("../core/models/Participant");!function(e){e.Local="Local",e.Remote="Remote"}(r=n.Origin||(n.Origin={})),n.FromCoreOrigin=function(e){switch(e){case i.ParticipantOrigin.Local:return r.Local;case i.ParticipantOrigin.Remote:return r.Remote}}},{"../core/models/Participant":413}],533:[function(e,t,n){(function(t){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("./BaseModel"),a=e("../core/utils/NotImplemented"),s=e("es6-promise"),c=e("../core/utils/VidyoDebugger"),u=e("../core/models/APITypes"),l=function(e){function n(n){var r=e.call(this,n.Id,n.Name,n.ObjId,"","Participant")||this;return c.VidyoDebugger.Debug(r,u.API.Simple,t),r.userId=n.UserId,r.isLocal=n.IsLocal,r}return i(n,e),n.prototype.GetId=function(){return s.Promise.resolve(this.id)},n.prototype.GetName=function(){return s.Promise.resolve(this.name)},n.prototype.GetUserId=function(){return s.Promise.resolve(this.userId)},n.prototype.IsHidden=function(){a.NotImplemented()},n.prototype.IsLocal=function(){return s.Promise.resolve(this.isLocal)},n.prototype.IsRecording=function(){a.NotImplemented()},n.prototype.IsSelectable=function(){a.NotImplemented()},n}(o.BaseModel);n.Participant=l}).call(this,"/src/vidyo_simple_api/Participant.ts")},{"../core/models/APITypes":409,"../core/utils/NotImplemented":470,"../core/utils/VidyoDebugger":484,"./BaseModel":527,"es6-promise":43}],534:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../core/events/EventDispatcher"),i=e("../core/events/PermissionEvents"),o=e("../core/utils/AssignHiddenPropertyValue"),a=e("../core/models/Permission");n.PermissionType=a.PermissionType;var s=function(){function e(e){o.AssignHiddenPropertyValue(this,"_vidyoCore",e)}return e.prototype.RegisterPermissionEventListener=function(e){var t=e.onPermissionUpdated;return this._vidyoCore.EventDispatcher.on(i.Events.PermissionUpdated,r.VidyoPermissionEventListeners,function(e){return t(e.permission,e.granted)}),this._vidyoCore.EventDispatcher.emit(i.Events.PermissionListenerRegistered),Promise.resolve(!0)},e.prototype.UnregisterPermissionEventListener=function(){return this._vidyoCore.EventDispatcher.emit(i.Events.PermissionListenerUnregistered),this._vidyoCore.EventDispatcher.releaseGroup(r.VidyoPermissionEventListeners),Promise.resolve(!0)},e}();n.Permission=s},{"../core/events/EventDispatcher":399,"../core/events/PermissionEvents":403,"../core/models/Permission":414,"../core/utils/AssignHiddenPropertyValue":455}],535:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../core/events/ParticipantEvents"),i=e("../core/events/MessageEvents"),o=e("uuid"),a=e("../core/utils/AssignHiddenPropertyValue"),s=e("../core/events/RoomEvents"),c=e("../core/events/StreamEvents"),u=e("../core/utils/NotImplemented"),l=e("../vidyo_simple_api/Participant"),d=e("../vidyo_simple_api/ChatMessage"),p=e("../core/events/EventDispatcher"),f=e("../core/utils/VidyoDebugger"),h=e("../core/models/APITypes"),m=function(){function e(e,n){this.objType="VidyoRoom",this.objId=o.v4(),a.AssignHiddenPropertyValue(this,"_vidyoCore",e),a.AssignHiddenPropertyValue(this,"_coreRoom",n),f.VidyoDebugger.Debug(this,h.API.Simple,t)}return e.prototype.AcceptIncoming=function(){u.NotImplemented()},e.prototype.Delete=function(){u.NotImplemented()},e.prototype.DisableMedia=function(){u.NotImplemented()},e.prototype.EnableMedia=function(e,t,n){return this._vidyoCore.EventDispatcher.releaseGroup(p.VidyoEnableMediaRoomListeners),this._vidyoCore.EventDispatcher.once(c.Events.MediaFailed,p.VidyoEnableMediaRoomListeners,function(e){t(e.reason)}),this._vidyoCore.EventDispatcher.once(c.Events.MediaDisabled,p.VidyoEnableMediaRoomListeners,function(e){n(e.reason)}),this._vidyoCore.EventDispatcher.once(c.Events.MediaEnabled,p.VidyoEnableMediaRoomListeners,function(t){e()}),this._vidyoCore.Controllers.ConnectionController.StartMediaExchange(),Promise.resolve(!0)},e.prototype.Enter=function(e,t){return this._vidyoCore.EventDispatcher.releaseGroup(p.VidyoEnterRoomListeners),this._vidyoCore.EventDispatcher.once(s.Events.Entered,p.VidyoEnterRoomListeners,function(t){e()}),this._vidyoCore.EventDispatcher.once(s.Events.Left,p.VidyoEnterRoomListeners,function(e){t()}),this._vidyoCore.Controllers.RoomController.Enter(this._coreRoom),Promise.resolve(!0)},e.prototype.GetHistory=function(){u.NotImplemented()},e.prototype.GetHistoryById=function(){u.NotImplemented()},e.prototype.GetHistoryByTime=function(){u.NotImplemented()},e.prototype.GetId=function(){u.NotImplemented()},e.prototype.GetRoomProperties=function(){u.NotImplemented()},e.prototype.GetType=function(){u.NotImplemented()},e.prototype.Invite=function(){u.NotImplemented()},e.prototype.InviteN=function(){u.NotImplemented()},e.prototype.Leave=function(){return this._vidyoCore.Controllers.RoomController.Leave(this._coreRoom),!0},e.prototype.MessageSearch=function(){u.NotImplemented()},e.prototype.RegisterMessageEventListener=function(e){var t=e.onMessageReceived,n=e.onMessageAcknowledged,r=e.onMessageRead,o=e.onMessageTypingIndication;return this._vidyoCore.EventDispatcher.releaseGroup(p.VidyoMessageEventListeners),this._vidyoCore.EventDispatcher.on(i.Events.OnMessage,p.VidyoMessageEventListeners,function(e){t(new l.Participant(e.participant),new d.ChatMessage(e.message))}),this._vidyoCore.EventDispatcher.on(i.Events.OnMessageAcknowledged,p.VidyoMessageEventListeners,function(e){n(new d.ChatMessage(e.message))}),this._vidyoCore.EventDispatcher.on(i.Events.OnMessageRead,p.VidyoMessageEventListeners,function(e){r(new l.Participant(e.participant),+e.messageId)}),this._vidyoCore.EventDispatcher.on(i.Events.OnMessageChatState,p.VidyoMessageEventListeners,function(e){o(new l.Participant(e.participant),e.state)}),Promise.resolve(!0)},e.prototype.RegisterParticipantEventListener=function(e,t,n,i){return this._vidyoCore.EventDispatcher.releaseGroup(p.VidyoRoomParticipantEventListeners),this._vidyoCore.EventDispatcher.on(r.Events.ParticipantJoined,p.VidyoRoomParticipantEventListeners,function(t){e(new l.Participant(t.participant))}),this._vidyoCore.EventDispatcher.on(r.Events.ParticipantLeft,p.VidyoRoomParticipantEventListeners,function(e){t(new l.Participant(e.participant))}),this._vidyoCore.EventDispatcher.on(r.Events.DynamicParticipantChanged,p.VidyoRoomParticipantEventListeners,function(e){n(e.participants.map(function(e){return new l.Participant(e)}))}),this._vidyoCore.EventDispatcher.on(r.Events.LoudestParticipantChanged,p.VidyoRoomParticipantEventListeners,function(e){i(new l.Participant(e.participant),void 0)}),Promise.resolve(!0)},e.prototype.RegisterResourceManagerEventListener=function(e){return this._vidyoCore.Controllers.ResourcesManager.RegisterResourceManagerEventListener(e)},e.prototype.RegisterRoomPropertiesEventListener=function(){u.NotImplemented()},e.prototype.RegisterSubjectEventListener=function(){u.NotImplemented()},e.prototype.RejectIncoming=function(){u.NotImplemented()},e.prototype.SendMessage=function(e){var t=e.message;return this._vidyoCore.Controllers.MessageController.SendMessage(t),Promise.resolve(!0)},e.prototype.SendMessageAcknowledged=function(e){var t=e.messageId;return this._vidyoCore.Controllers.MessageController.SendMessageAcknowledged(t)},e.prototype.SendMessageTypingIndication=function(e){var t=e.typingIndication;return this._vidyoCore.Controllers.MessageController.SendMessageTypingIndication(t)},e.prototype.SetRoomProperties=function(){u.NotImplemented()},e.prototype.SetSubject=function(){u.NotImplemented()},e.prototype.UnregisterMessageEventListener=function(){return this._vidyoCore.EventDispatcher.releaseGroup(p.VidyoMessageEventListeners),Promise.resolve(!0)},e.prototype.UnregisterParticipantEventListener=function(){this._vidyoCore.EventDispatcher.releaseGroup(p.VidyoRoomParticipantEventListeners)},e.prototype.UnregisterResourceManagerEventListener=function(){return this._vidyoCore.Controllers.ResourcesManager.UnregisterResourceManagerEventListener()},e.prototype.UnregisterRoomPropertiesEventListener=function(){u.NotImplemented()},e.prototype.UnregisterSubjectEventListener=function(){u.NotImplemented()},e}();n.Room=m}).call(this,"/src/vidyo_simple_api/Room.ts")},{"../core/events/EventDispatcher":399,"../core/events/MessageEvents":401,"../core/events/ParticipantEvents":402,"../core/events/RoomEvents":406,"../core/events/StreamEvents":408,"../core/models/APITypes":409,"../core/utils/AssignHiddenPropertyValue":455,"../core/utils/NotImplemented":470,"../core/utils/VidyoDebugger":484,"../vidyo_simple_api/ChatMessage":528,"../vidyo_simple_api/Participant":533,uuid:332}],536:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../core/events/ConnectionEvents"),i=e("uuid"),o=e("../core/utils/AssignHiddenPropertyValue"),a=e("../core/events/RoomEvents"),s=e("../core/utils/NotImplemented"),c=e("../core/events/EventDispatcher"),u=e("./stats/Stats"),l=e("../vidyo_connector_api/VidyoConnector"),d=e("../core/events/ConnectionEvents"),p=e("../core/utils/VidyoDebugger"),f=e("../core/models/APITypes"),h=function(){function e(e){this.objType="VidyoUser",this.objId=i.v4(),o.AssignHiddenPropertyValue(this,"_vidyoCore",e),p.VidyoDebugger.Debug(this,f.API.Simple,t)}return e.prototype.AddRosterContact=function(){s.NotImplemented()},e.prototype.CreateRoomFromId=function(e,t,n){return this._vidyoCore.EventDispatcher.once(a.Events.Created,c.VidyoUserListeners,function(e){n(e.room,e.result,e.token)}),this._vidyoCore.Controllers.RoomController.CreateRoom({token:t,resourceId:e}),Promise.resolve(!0)},e.prototype.CreateRoomWithId=function(e,t,n){return this._vidyoCore.EventDispatcher.once(a.Events.Created,c.VidyoUserListeners,function(e){n(e.room,e.result,e.token)}),this._vidyoCore.Controllers.RoomController.CreateRoom({token:t,isNewRoom:!0,resourceId:e}),!0},e.prototype.CreateTopicRoom=function(e,t,n,r){return this._vidyoCore.EventDispatcher.once(a.Events.Created,c.VidyoUserListeners,function(e){r(e.room,e.result,e.token)}),this._vidyoCore.Controllers.RoomController.CreateRoom({token:n,isNewRoom:!0,subject:t,resourceId:e}),!0},e.prototype.GetContact=function(){s.NotImplemented()},e.prototype.GetConversationRoom=function(){s.NotImplemented()},e.prototype.GetId=function(){s.NotImplemented()},e.prototype.GetRecentRooms=function(){s.NotImplemented()},e.prototype.GetStats=function(){var e=this._vidyoCore.Controllers.StatisticsController.GetUserStatistics();return new u.UserStats(e)},e.prototype.Login=function(e,t,n,i,o,a,s,u,l,d){return this._vidyoCore.EventDispatcher.releaseGroup(c.VidyoUserListeners),this._vidyoCore.EventDispatcher.on(r.Events.Connected,c.VidyoUserListeners,function(e){a(e.result,e.isSecure)}),this._vidyoCore.EventDispatcher.on(r.Events.Disconnected,c.VidyoUserListeners,function(e){s(e)}),this._vidyoCore.EventDispatcher.on(r.Events.ConnectionStatusChanged,c.VidyoUserListeners,function(e){u(e.reason)}),this._vidyoCore.EventDispatcher.on(r.Events.TokenReceived,c.VidyoUserListeners,function(e){l(e.token,e.tokenType)}),this._vidyoCore.EventDispatcher.on(r.Events.GetWebProxyCredentials,c.VidyoUserListeners,function(e){d(e.webProxyAddress)}),this._vidyoCore.Controllers.ConnectionController.CreateConnection({credentials:{username:e,password:t},host:n,port:i,serviceType:o}),this._vidyoCore.Controllers.ConnectionController.Connect(),!0},e.prototype.LoginAsGuest=function(e,t,n,i,o,a,s,u,l){return this._vidyoCore.EventDispatcher.releaseGroup(c.VidyoUserListeners),this._vidyoCore.EventDispatcher.on(r.Events.Connected,c.VidyoUserListeners,function(e){o(e.result,e.isSecure)}),this._vidyoCore.EventDispatcher.on(r.Events.Disconnected,c.VidyoUserListeners,function(e){a(e)}),this._vidyoCore.EventDispatcher.on(r.Events.ConnectionStatusChanged,c.VidyoUserListeners,function(e){s(e.reason)}),this._vidyoCore.EventDispatcher.on(r.Events.TokenReceived,c.VidyoUserListeners,function(e){u(e.token,e.tokenType)}),this._vidyoCore.EventDispatcher.on(r.Events.GetWebProxyCredentials,c.VidyoUserListeners,function(e){l(e.webProxyAddress)}),this._vidyoCore.Controllers.ConnectionController.CreateConnection({displayName:e,saslMechanisms:["anonymous"],host:t,port:n,serviceType:i}),this._vidyoCore.Controllers.ConnectionController.Connect(),!0},e.prototype.LoginWithAccessToken=function(e,t,n,r,i,o,a,s,c){return this.LoginWithTenantToken(e,t,n,r,i,o,a,s,c)},e.prototype.LoginWithRefreshToken=function(e,t,n,r,i,o,a,s,c){return this.LoginWithTenantToken(e,t,n,r,i,o,a,s,c)},e.prototype.LoginWithTenantToken=function(e,t,n,i,o,a,s,u,d){var p=this;return this._vidyoCore.EventDispatcher.releaseGroup(c.VidyoUserListeners),this._vidyoCore.EventDispatcher.on(r.Events.Connected,c.VidyoUserListeners,function(e){o(e.result,e.isSecure)}),this._vidyoCore.EventDispatcher.on(r.Events.Disconnected,c.VidyoUserListeners,function(e){a(e)}),this._vidyoCore.EventDispatcher.on(r.Events.ConnectionStatusChanged,c.VidyoUserListeners,function(e){s(e.reason)}),this._vidyoCore.EventDispatcher.on(r.Events.TokenReceived,c.VidyoUserListeners,function(e){u(e.token,e.tokenType)}),this._vidyoCore.EventDispatcher.on(r.Events.GetWebProxyCredentials,c.VidyoUserListeners,function(e){d(e.webProxyAddress)}),this._vidyoCore.Controllers.ConnectionController.CreateConnection({credentials:{password:e,token:e},displayName:this._displayName,host:t,port:n,serviceType:i}).then(function(){return p._vidyoCore.Controllers.ConnectionController.Connect(),Promise.resolve(!0)}).catch(function(e){return e===l.VidyoConnectorFailReason.InvalidDisplayNameLength&&p._vidyoCore.Controllers.LogController.LogError("Display Name is too long"),Promise.reject(e)})},e.prototype.Logout=function(){return this._vidyoCore.Controllers.ConnectionController.Disconnect(d.ConnectionEventsInfo.Disconnecting),!0},e.prototype.RegisterContactEventListener=function(){s.NotImplemented()},e.prototype.RegisterRoomEventListener=function(){s.NotImplemented()},e.prototype.RemoveRosterContact=function(){s.NotImplemented()},e.prototype.SearchConversationRooms=function(){s.NotImplemented()},e.prototype.SearchRooms=function(){s.NotImplemented()},e.prototype.SearchRoomsWithName=function(){s.NotImplemented()},e.prototype.SearchRoomsWithOwner=function(){s.NotImplemented()},e.prototype.SearchRoomsWithSubject=function(){s.NotImplemented()},e.prototype.SearchTopicRooms=function(){s.NotImplemented()},e.prototype.SearchUsers=function(){s.NotImplemented()},e.prototype.SetDisplayName=function(e){var t=e.displayName;o.AssignHiddenPropertyValue(this,"_displayName",t)},e.prototype.SetWebProxyAddressCredentials=function(){s.NotImplemented()},e.prototype.UnregisterCallEventListener=function(){s.NotImplemented()},e.prototype.UnregisterContactEventListener=function(){s.NotImplemented()},e.prototype.UnregisterLicenseEventListener=function(){s.NotImplemented()},e.prototype.UnregisterRoomEventListener=function(){s.NotImplemented()},e.prototype.UpdatePresence=function(){s.NotImplemented()},e}();n.User=h}).call(this,"/src/vidyo_simple_api/User.ts")},{"../core/events/ConnectionEvents":397,"../core/events/EventDispatcher":399,"../core/events/RoomEvents":406,"../core/models/APITypes":409,"../core/utils/AssignHiddenPropertyValue":455,"../core/utils/NotImplemented":470,"../core/utils/VidyoDebugger":484,"../vidyo_connector_api/VidyoConnector":526,"./stats/Stats":561,uuid:332}],537:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("uuid"),i=e("../core/utils/AssignHiddenPropertyValue"),o=e("../core/events/LogEvents"),a=e("../core/VidyoCore"),s=e("../core/utils/VidyoDebugger"),c=e("../core/models/APITypes"),u=e("../core/controllers/LogController/LogController"),l=function(){function e(){this.objType="VidyoSimple",this.objId=r.v4(),i.AssignHiddenPropertyValue(this,"_vidyoCore",new a.VidyoCore),s.VidyoDebugger.Debug(this,c.API.Simple,t)}return e.prototype.CreateVidyoEndpoint=function(e,t,n,r,i,o){return this._vidyoCore.CreateEndpoint(e,t,n,r,i,o)},e.prototype.CreateVidyoPermission=function(){return this._vidyoCore.CreatePermission()},e.prototype.CreateVidyoUser=function(e){return this._vidyoCore.CreateUser(e)},e.prototype.Disable=function(){return this._vidyoCore.Disable()},e.prototype.Initialize=function(){var e=this;return this._vidyoCore.Initialize().then(function(){return e._vidyoCore.EventDispatcher.on(o.LogEventsSDK.fatal,function(e){console.error("%c"+u.LogRecord.toLogString(e),"color: "+(e.categoryName===o.VidyoLogCategory.VidyoDevelopment?"darkviolet":"#dd0000"))}),e._vidyoCore.EventDispatcher.on(o.LogEventsSDK.error,function(e){console.error("%c"+u.LogRecord.toLogString(e),"color: "+(e.categoryName===o.VidyoLogCategory.VidyoDevelopment?"darkviolet":"#dd0000"))}),e._vidyoCore.EventDispatcher.on(o.LogEventsSDK.warning,function(e){console.warn("%c"+u.LogRecord.toLogString(e),"color: "+(e.categoryName===o.VidyoLogCategory.VidyoDevelopment?"darkviolet":"#774400"))}),e._vidyoCore.EventDispatcher.on(o.LogEventsSDK.info,function(e){console.log("%c"+u.LogRecord.toLogString(e),"color: "+(e.categoryName===o.VidyoLogCategory.VidyoDevelopment?"darkviolet":"black"))}),e._vidyoCore.EventDispatcher.on(o.LogEventsSDK.debug,function(e){console.debug("%c"+u.LogRecord.toLogString(e),"color: "+(e.categoryName===o.VidyoLogCategory.VidyoDevelopment?"darkviolet":"#202020"))}),e._vidyoCore.EventDispatcher.on(o.LogEventsSDK.sent,function(e){console.debug("%c"+u.LogRecord.toLogString(e),"color: "+(e.categoryName===o.VidyoLogCategory.VidyoDevelopment?"darkviolet":"darkgreen"))}),e._vidyoCore.EventDispatcher.on(o.LogEventsSDK.received,function(e){console.debug("%c"+u.LogRecord.toLogString(e),"color: "+(e.categoryName===o.VidyoLogCategory.VidyoDevelopment?"darkviolet":"darkblue"))}),e._vidyoCore.EventDispatcher.on(o.LogEventsSDK.enter,function(e){console.log("%c"+u.LogRecord.toLogString(e),"color: "+(e.categoryName===o.VidyoLogCategory.VidyoDevelopment?"darkviolet":"darkslateblue"))}),e._vidyoCore.EventDispatcher.on(o.LogEventsSDK.leave,function(e){console.log("%c"+u.LogRecord.toLogString(e),"color: "+(e.categoryName===o.VidyoLogCategory.VidyoDevelopment?"darkviolet":"darkmagenta"))}),!0})},e}();n.VidyoSimple=l;var d=e("./Devices");n.VidyoCamera=d.Camera,n.VidyoMicrophone=d.Microphone,n.VidyoSpeaker=d.Speaker,n.VidyoRemoteCamera=d.RemoteCamera,n.VidyoRemoteMicrophone=d.RemoteMicrophone,n.VidyoRemoteWindowShare=d.RemoteWindowShare,n.VidyoDeviceState=d.VidyoDeviceState;var p=e("./ChatMessage");n.VidyoChatMessage=p.ChatMessage;var f=e("./Room");n.VidyoRoom=f.Room;var h=e("./User");n.VidyoUser=h.User;var m=e("./Participant");n.VidyoParticipant=m.Participant;var v=e("./Permission");n.VidyoPermision=v.Permission,n.VidyoPermissionType=v.PermissionType;var y=e("./EndPoint");n.VidyoEndpoint=y.EndPoint}).call(this,"/src/vidyo_simple_api/VidyoSimple.ts")},{"../core/VidyoCore":364,"../core/controllers/LogController/LogController":375,"../core/events/LogEvents":400,"../core/models/APITypes":409,"../core/utils/AssignHiddenPropertyValue":455,"../core/utils/VidyoDebugger":484,"./ChatMessage":528,"./Devices":529,"./EndPoint":530,"./Participant":533,"./Permission":534,"./Room":535,"./User":536,uuid:332}],538:[function(e,t,n){(function(t){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=e("uuid"),a=e("./Origin"),s=e("./BaseModel"),c=e("../core/utils/VidyoDebugger"),u=e("../core/models/APITypes"),l=function(e){function n(n,r,i,s){void 0===r&&(r=a.Origin.Local);var l=e.call(this,o.v4(),n,o.v4(),r,"WindowShare")||this;return l.applicationName=i,l.processId=s,c.VidyoDebugger.Debug(l,u.API.Simple,t),l}return i(n,e),n.prototype.GetApplicationName=function(){return this.applicationName},n.prototype.GetId=function(){return this.id},n.prototype.GetName=function(){return this.name},n.prototype.GetProcessId=function(){return this.processId},n.prototype.IsApplicationNameSet=function(){return!!this.applicationName},n.prototype.IsNameSet=function(){return!!this.name},n.prototype.SetFrameInterval=function(e){},n}(s.BaseModel);n.WindowShare=l}).call(this,"/src/vidyo_simple_api/WindowShare.ts")},{"../core/models/APITypes":409,"../core/utils/VidyoDebugger":484,"./BaseModel":527,"./Origin":532,uuid:332}],539:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){return function(e){void 0===e&&(e=new r.BandwidthSummaryStatistics),this.actualEncoderBitRate=e.ActualEncoderBitRate,this.availableBandwidth=e.AvailableBandwidth,this.leakyBucketDelay=e.LeakyBucketDelay,this.retransmitBitRate=e.RetransmitBitRate,this.targetEncoderBitRate=e.TargetEncoderBitRate,this.totalTransmitBitRate=e.TotalTransmitBitRate}}();n.BandwidthSummaryStats=i},{"../../core/models/statistics/Statistics":451}],540:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){return function(e){void 0===e&&(e=new r.EndpointStatistics),this.applicationTag=e.ApplicationTag,this.buildTag=e.BuildTag,this.bytesReceivedTcp=e.BytesReceivedTcp,this.bytesReceivedUdp=e.BytesReceivedUdp,this.bytesSentTcp=e.BytesSentTcp,this.bytesSentUdp=e.BytesSentUdp,this.connectTime=e.ConnectTime,this.id=e.Id,this.libraryVersion=e.LibraryVersion,this.localCameraStats=e.LocalCameraStats.map(function(e){return new i.LocalVideoSourceStats(e)}),this.localMicrophoneStats=e.LocalMicrophoneStats.map(function(e){return new i.LocalMicrophoneStats(e)}),this.localMonitorStats=e.LocalMonitorStats.map(function(e){return new i.LocalVideoSourceStats(e)}),this.localRendererStats=e.LocalRendererStats.map(function(e){return new i.LocalRendererStats(e)}),this.localSpeakerStats=e.LocalSpeakerStats.map(function(e){return new i.LocalSpeakerStats(e)}),this.localWindowShareStats=e.LocalWindowShareStats.map(function(e){return new i.LocalVideoSourceStats(e)}),this.loginTimeConsumedMs=e.LoginTimeConsumedMs,this.logStats=new i.LogStats(e.LogStats),this.maxBitRate=e.MaxBitRate,this.maxEncodePixelRateInitial=e.MaxEncodePixelRateInitial,this.mediaEnableTimeConsumedMs=e.MediaEnableTimeConsumedMs,this.mediaRouteAcquireTimeConsumedMs=e.MediaRouteAcquireTimeConsumedMs,this.networkInterfaceStats=e.NetworkInterfaceStats.map(function(e){return new i.NetworkInterfaceStats(e)}),this.osName=e.OsName,this.osVersion=e.OsVersion,this.processorBrand=e.ProcessorBrand,this.processorLogicalCores=e.ProcessorLogicalCores,this.processorModel=e.ProcessorModel,this.processorPhysicalCores=e.ProcessorPhysicalCores,this.processorSpeed=e.ProcessorSpeed,this.roomEnterTimeConsumedMs=e.RoomEnterTimeConsumedMs,this.timeStamp=e.TimeStamp,this.userAgent=e.UserAgent,this.userStats=e.UserStats.map(function(e){return new i.UserStats(e)})}}();n.EndpointStats=o},{"../../core/models/statistics/Statistics":451,"./Stats":561}],541:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){return function(e){void 0===e&&(e=new r.LatencyTestDataStatistics),this.address=e.Address,this.latencyMs=e.LatencyMs,this.latitude=e.Latitude,this.longitude=e.Longitude,this.name=e.Name,this.responseReceived=e.ResponseReceived}}();n.LatencyTestDataStats=i},{"../../core/models/statistics/Statistics":451}],542:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){return function(e){void 0===e&&(e=new r.LatencyTestStatistics),this.latencyTestDataStats=e.LatencyTestDataStats.map(function(e){return new i.LatencyTestDataStats(e)})}}();n.LatencyTestStats=o},{"../../core/models/statistics/Statistics":451,"./Stats":561}],543:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){return function(e){void 0===e&&(e=new r.LocalMicrophoneStatistics),this.aecEchoCoupling=e.AecEchoCoupling,this.agcAverageGain=e.AgcAverageGain,this.bitsPerSample=e.BitsPerSample,this.format=e.Format,this.id=e.Id,this.localSpeakerStreams=e.LocalSpeakerStreams.map(function(e){return new i.LocalSpeakerStreamStats(e)}),this.name=e.Name,this.noiseSuppressionSnr=e.NoiseSuppressionSnr,this.numberOfChannels=e.NumberOfChannels,this.remoteSpeakerStreams=e.RemoteSpeakerStreams.map(function(e){return new i.RemoteSpeakerStreamStats(e)}),this.sampleRateMeasured=e.SampleRateMeasured,this.sampleRateSet=e.SampleRateSet}}();n.LocalMicrophoneStats=o},{"../../core/models/statistics/Statistics":451,"./Stats":561}],544:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){return function(e){void 0===e&&(e=new r.LocalRendererStatistics),this.format=e.Format,this.frameIntervalMeasured=e.FrameIntervalMeasured,this.frameIntervalSet=e.FrameIntervalSet,this.height=e.Height,this.id=e.Id,this.name=e.Name,this.totalFrames=e.TotalFrames,this.totalPixels=e.TotalPixels,this.width=e.Width}}();n.LocalRendererStats=i},{"../../core/models/statistics/Statistics":451}],545:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){return function(e){void 0===e&&(e=new r.LocalRendererStreamStatistics),this.bufferDropped=e.BufferDropped,this.bufferSize=e.BufferSize,this.height=e.Height,this.id=e.Id,this.name=e.Name,this.width=e.Width}}();n.LocalRendererStreamStats=i},{"../../core/models/statistics/Statistics":451}],546:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){return function(e){void 0===e&&(e=new r.LocalSpeakerStatistics),this.bitsPerSample=e.BitsPerSample,this.format=e.Format,this.id=e.Id,this.name=e.Name,this.numberOfChannels=e.NumberOfChannels,this.sampleRateMeasured=e.SampleRateMeasured,this.sampleRateSet=e.SampleRateSet}}();n.LocalSpeakerStats=i},{"../../core/models/statistics/Statistics":451}],547:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){return function(e){void 0===e&&(e=new r.LocalSpeakerStreamStatistics),this.bitsPerSample=e.BitsPerSample,this.delay=e.Delay,this.format=e.Format,this.highestThreshold=e.HighestThreshold,this.highThreshold=e.HighThreshold,this.isActive=e.IsActive,this.lastEnergy=e.LastEnergy,this.lastPlayed=e.LastPlayed,this.lowestThreshold=e.LowestThreshold,this.lowThreshold=e.LowThreshold,this.maxThreshold=e.MaxThreshold,this.name=e.Name,this.numberOfChannels=e.NumberOfChannels,this.overrun=e.Overrun,this.played=e.Played,this.sampleRate=e.SampleRate,this.underrun=e.Underrun}}();n.LocalSpeakerStreamStats=i},{"../../core/models/statistics/Statistics":451}],548:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){return function(e){void 0===e&&(e=new r.LocalVideoSourceStatistics),this.format="",this.format=e.Format,this.frameIntervalMeasured=e.FrameIntervalMeasured,this.frameIntervalSet=e.FrameIntervalSet,this.height=e.Height,this.id=e.Id,this.localRendererStreams=e.LocalRendererStreams.map(function(e){return new i.LocalRendererStreamStats(e)}),this.name=e.Name,this.remoteRendererStreams=e.RemoteRendererStreams.map(function(e){return new i.RemoteRendererStreamStats(e)}),this.totalFrames=e.TotalFrames,this.width=e.Width}}();n.LocalVideoSourceStats=o},{"../../core/models/statistics/Statistics":451,"./Stats":561}],549:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){return function(e){void 0===e&&(e=new r.LogDataStatistics),this.name="",this.occurances=0,this.name=e.Name,this.occurances=e.Occurances}}();n.LogDataStats=i},{"../../core/models/statistics/Statistics":451}],550:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){return function(e){void 0===e&&(e=new r.LogStatistics),this.logErrorDataStats=e.LogErrorDataStats.map(function(e){return new i.LogDataStats(e)}),this.logWarningDataStats=e.LogWarningDataStats.map(function(e){return new i.LogDataStats(e)})}}();n.LogStats=o},{"../../core/models/statistics/Statistics":451,"./Stats":561}],551:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){return function(e){void 0===e&&(e=new r.MediaConnectionTransportInformation),this.addressType=e.AddressType,this.componentType=e.ComponentType,this.connectionId=e.ConnectionId,this.connectionType=e.ConnectionType,this.externalLocalAddr=e.ExternalLocalAddr,this.externalRemoteAddr=e.ExternalRemoteAddr,this.interfaceName=e.InterfaceName,this.interfaceType=e.InterfaceType,this.internalLocalAddr=e.InternalLocalAddr,this.internalRemoteAddr=e.InternalRemoteAddr,this.transportPlugIn=e.TransportPlugIn}}();n.MediaConnectionTransportInfo=i},{"../../core/models/statistics/Statistics":451}],552:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){return function(e){void 0===e&&(e=new r.NetworkInterfaceStatistics),this.isUp=e.IsUp,this.name=e.Name,this.type=e.Type}}();n.NetworkInterfaceStats=i},{"../../core/models/statistics/Statistics":451}],553:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){return function(e){void 0===e&&(e=new r.ParticipantGenerationStatistics),this.id="",this.name="",this.cameraId=e.CameraId,this.cameraName=e.CameraName,this.enabled=e.Enabled,this.frameInterval=e.FrameInterval,this.height=e.Height,this.id=e.Id,this.name=e.Name,this.pixelRate=e.PixelRate,this.width=e.Width}}();n.ParticipantGenerationStats=i},{"../../core/models/statistics/Statistics":451}],554:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){return function(e){void 0===e&&(e=new r.ParticipantStatistic),this.id=e.Id,this.name=e.Name,this.remoteCameraStats=e.RemoteCameraStats.map(function(e){return new i.RemoteVideoSourceStats(e)}),this.remoteMicrophoneStats=e.RemoteMicrophoneStats.map(function(e){return new i.RemoteMicrophoneStats(e)}),this.remoteWindowShareStats=e.RemoteWindowShareStats.map(function(e){return new i.RemoteVideoSourceStats(e)}),this.userId=e.UserId}}();n.ParticipantStats=o},{"../../core/models/statistics/Statistics":451,"./Stats":561}],555:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){return function(e){void 0===e&&(e=new r.RateShaperStatistics),this.delayNormal=e.DelayNormal,this.delayRetransmit=e.DelayRetransmit,this.dropNormal=e.DropNormal,this.packetsNormal=e.PacketsNormal,this.packetsRetransmit=e.PacketsRetransmit}}();n.RateShaperStats=i},{"../../core/models/statistics/Statistics":451}],556:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){return function(e){void 0===e&&(e=new r.RemoteMicrophoneStatistics),this.bitsPerSample=e.BitsPerSample,this.codecDtx=e.CodecDtx,this.codecName=e.CodecName,this.codecQualitySetting=e.CodecQualitySetting,this.id=e.Id,this.lastFrameMs=e.LastFrameMs,this.localSpeakerStreams=e.LocalSpeakerStreams.map(function(e){return new i.LocalSpeakerStreamStats(e)}),this.name=e.Name,this.numberOfChannels=e.NumberOfChannels,this.receiveNetworkBitRate=e.ReceiveNetworkBitRate,this.receiveNetworkDelay=e.ReceiveNetworkDelay,this.receiveNetworkDroppedPackets=e.ReceiveNetworkDroppedPackets,this.receiveNetworkJitter=e.ReceiveNetworkJitter,this.receiveNetworkPacketsConcealed=e.ReceiveNetworkPacketsConcealed,this.receiveNetworkPacketsLost=e.ReceiveNetworkPacketsLost,this.sampleRateMeasured=e.SampleRateMeasured,this.sampleRateSet=e.SampleRateSet}}();n.RemoteMicrophoneStats=o},{"../../core/models/statistics/Statistics":451,"./Stats":561}],557:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){return function(e){void 0===e&&(e=new r.RemoteRendererStreamStatistics),this.codecFir=e.CodecFir,this.codecIFrames=e.CodecIFrames,this.codecLayers=e.CodecLayers,this.codecNacks=e.CodecNacks,this.codecName=e.CodecName,this.fps=e.Fps,this.fpsInput=e.FpsInput,this.fpsSent=e.FpsSent,this.framesDropped=e.FramesDropped,this.height=e.Height,this.lastHeight=e.LastHeight,this.lastWidth=e.LastWidth,this.name=e.Name,this.sendNetworkBitRate=e.SendNetworkBitRate,this.sendNetworkRtt=e.SendNetworkRtt,this.width=e.Width}}();n.RemoteRendererStreamStats=i},{"../../core/models/statistics/Statistics":451}],558:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){return function(e){void 0===e&&(e=new r.RemoteSpeakerStreamStatistics),this.bitsPerSample=e.BitsPerSample,this.codecDtx=e.CodecDtx,this.codecName=e.CodecName,this.codecQualitySetting=e.CodecQualitySetting,this.name=e.Name,this.numberOfChannels=e.NumberOfChannels,this.sampleRate=e.SampleRate,this.sendNetworkBitRate=e.SendNetworkBitRate,this.sendNetworkRtt=e.SendNetworkRtt}}();n.RemoteSpeakerStreamStats=i},{"../../core/models/statistics/Statistics":451}],559:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){return function(e){void 0===e&&(e=new r.RemoteVideoSourceStatistics),this.codecFir=e.CodecFir,this.codecIFrames=e.CodecIFrames,this.codecLayers=e.CodecLayers,this.codecNacks=e.CodecNacks,this.codecName=e.CodecName,this.fpsDecoded=e.FpsDecoded,this.fpsDecoderInput=e.FpsDecoderInput,this.fpsRendered=e.FpsRendered,this.height=e.Height,this.id=e.Id,this.localRendererStreams=e.LocalRendererStreams.map(function(e){return new i.LocalRendererStreamStats(e)}),this.maxStreamFrameRate=e.MaxStreamFrameRate,this.maxStreamHeight=e.MaxStreamHeight,this.maxStreamWidth=e.MaxStreamWidth,this.name=e.Name,this.receiveNetworkBitRate=e.ReceiveNetworkBitRate,this.receiveNetworkPacketsConcealed=e.ReceiveNetworkPacketsConcealed,this.receiveNetworkPacketsLost=e.ReceiveNetworkPacketsLost,this.receiveNetworkPacketsReordered=e.ReceiveNetworkPacketsReordered,this.receiveNetworkRecoveredWithFec=e.ReceiveNetworkRecoveredWithFec,this.showFrameRate=e.ShowFrameRate,this.showHeight=e.ShowHeight,this.showPixelRate=e.ShowPixelRate,this.showState=e.ShowState,this.showWidth=e.ShowWidth,this.width=e.Width}}();n.RemoteVideoSourceStats=o},{"../../core/models/statistics/Statistics":451,"./Stats":561}],560:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=e("./RateShaperStats"),a=e("./BandwidthSummaryStats"),s=function(){return function(e){void 0===e&&(e=new r.RoomStatistics),this.availableDecodeCpuPercent=e.AvailableDecodeCpuPercent,this.availableEncodeCpuPercent=e.AvailableEncodeCpuPercent,this.availableDecodeBwPercent=e.AvailableDecodeBwPercent,this.availableEncodeBwPercent=e.AvailableEncodeBwPercent,this.bandwidthApp=new a.BandwidthSummaryStats(e.BandwidthApp),this.bandwidthAudio=new a.BandwidthSummaryStats(e.BandwidthAudio),this.bandwidthVideo=new a.BandwidthSummaryStats(e.BandwidthVideo),this.conferenceId=e.ConferenceId,this.cpuUsage=e.CpuUsage,this.callId=e.CallId,this.currentBandwidthDecodePixelRate=e.CurrentBandwidthDecodePixelRate,this.currentBandwidthEncodePixelRate=e.CurrentBandwidthEncodePixelRate,this.currentCpuDecodePixelRate=e.CurrentCpuDecodePixelRate,this.currentCpuEncodePixelRate=e.CurrentCpuEncodePixelRate,this.id=e.Id,this.maxDecodePixelRate=e.MaxDecodePixelRate,this.maxEncodePixelRate=e.MaxEncodePixelRate,this.maxVideoSources=e.MaxVideoSources,this.participantGenerationStats=e.ParticipantGenerationStats.map(function(e){return new i.ParticipantGenerationStats(e)}),this.participantStats=e.ParticipantStats.map(function(e){return new i.ParticipantStats(e)}),this.rateShaperApp=new o.RateShaperStats(e.RateShaperApp),this.rateShaperAudio=new o.RateShaperStats(e.RateShaperAudio),this.rateShaperVideo=new o.RateShaperStats(e.RateShaperVideo),this.receiveBitRateAvailable=e.ReceiveBitRateAvailable,this.receiveBitRateTotal=e.ReceiveBitRateTotal,this.reflectorId=e.ReflectorId,this.sendBitRateAvailable=e.SendBitRateAvailable,this.sendBitRateTotal=e.SendBitRateTotal,this.staticSources=e.StaticSources,this.transportInformation=e.TransportInformation.map(function(e){return new i.MediaConnectionTransportInfo(e)})}}();n.RoomStats=s},{"../../core/models/statistics/Statistics":451,"./BandwidthSummaryStats":539,"./RateShaperStats":555,"./Stats":561}],561:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./BandwidthSummaryStats");n.BandwidthSummaryStats=r.BandwidthSummaryStats;var i=e("./EndpointStats");n.EndpointStats=i.EndpointStats;var o=e("./LocalMicrophoneStats");n.LocalMicrophoneStats=o.LocalMicrophoneStats;var a=e("./LocalRendererStats");n.LocalRendererStats=a.LocalRendererStats;var s=e("./LocalRendererStreamStats");n.LocalRendererStreamStats=s.LocalRendererStreamStats;var c=e("./LocalSpeakerStats");n.LocalSpeakerStats=c.LocalSpeakerStats;var u=e("./LocalSpeakerStreamStats");n.LocalSpeakerStreamStats=u.LocalSpeakerStreamStats;var l=e("./LocalVideoSourceStats");n.LocalVideoSourceStats=l.LocalVideoSourceStats;var d=e("./MediaConnectionTransportInfo");n.MediaConnectionTransportInfo=d.MediaConnectionTransportInfo;var p=e("./NetworkInterfaceStats");n.NetworkInterfaceStats=p.NetworkInterfaceStats;var f=e("./ParticipantGenerationStats");n.ParticipantGenerationStats=f.ParticipantGenerationStats;var h=e("./ParticipantStats");n.ParticipantStats=h.ParticipantStats;var m=e("./RateShaperStats");n.RateShaperStats=m.RateShaperStats;var v=e("./RemoteMicrophoneStats");n.RemoteMicrophoneStats=v.RemoteMicrophoneStats;var y=e("./RemoteRendererStreamStats");n.RemoteRendererStreamStats=y.RemoteRendererStreamStats;var g=e("./RemoteSpeakerStreamStats");n.RemoteSpeakerStreamStats=g.RemoteSpeakerStreamStats;var S=e("./RemoteVideoSourceStats");n.RemoteVideoSourceStats=S.RemoteVideoSourceStats;var _=e("./RoomStats");n.RoomStats=_.RoomStats;var b=e("./UserStats");n.UserStats=b.UserStats;var C=e("./LogDataStats");n.LogDataStats=C.LogDataStats;var w=e("./LogStats");n.LogStats=w.LogStats;var E=e("./LatencyTestDataStats");n.LatencyTestDataStats=E.LatencyTestDataStats;var R=e("./LatencyTestStats");n.LatencyTestStats=R.LatencyTestStats},{"./BandwidthSummaryStats":539,"./EndpointStats":540,"./LatencyTestDataStats":541,"./LatencyTestStats":542,"./LocalMicrophoneStats":543,"./LocalRendererStats":544,"./LocalRendererStreamStats":545,"./LocalSpeakerStats":546,"./LocalSpeakerStreamStats":547,"./LocalVideoSourceStats":548,"./LogDataStats":549,"./LogStats":550,"./MediaConnectionTransportInfo":551,"./NetworkInterfaceStats":552,"./ParticipantGenerationStats":553,"./ParticipantStats":554,"./RateShaperStats":555,"./RemoteMicrophoneStats":556,"./RemoteRendererStreamStats":557,"./RemoteSpeakerStreamStats":558,"./RemoteVideoSourceStats":559,"./RoomStats":560,"./UserStats":562}],562:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){return function(e){void 0===e&&(e=new r.UserStatistics),this.host=e.Host,this.latencyTestStats=new i.LatencyTestStats(e.LatencyTestStats),this.id=e.Id,this.port=e.Port,this.roomStats=e.RoomStats.map(function(e){return new i.RoomStats(e)}),this.serviceType=e.ServiceType}}();n.UserStats=o},{"../../core/models/statistics/Statistics":451,"./Stats":561}],563:[function(e,t,n){arguments[4][7][0].apply(n,arguments)},{dup:7}]},{},[520,563]);